WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#40: FILE: security/tomoyo/file.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:EMBEDDED_FILENAME: It's generally not useful to have the filename in the file
#41: FILE: security/tomoyo/file.c:2:
+ * security/tomoyo/file.c

Embedding the complete filename path inside the file isn't particularly
useful as often the path is moved around and becomes incorrect.

CHECK:SPACING: spaces preferred around that '&' (ctx:VxV)
#54: FILE: security/tomoyo/file.c:15:
+#define ACC_MODE(x) ("\000\004\002\006"[(x)&O_ACCMODE])
                                            ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:TYPO_SPELLING: 'unconditionnaly' may be misspelled - perhaps 'unconditionally'?
#279: FILE: security/tomoyo/file.c:240:
+ * is_globally_readable_file - Check if the file is unconditionnaly permitted to be open()ed for reading.
                                                     ^^^^^^^^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:LONG_LINE_COMMENT: line length of 105 exceeds 100 columns
#279: FILE: security/tomoyo/file.c:240:
+ * is_globally_readable_file - Check if the file is unconditionnaly permitted to be open()ed for reading.

A comment starts before but extends beyond the maximum line length.
To use a different maximum line length, the --max-line-length=n option
may be added while invoking checkpatch.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings

WARNING:LINE_SPACING: Missing a blank line after declarations
#324: FILE: security/tomoyo/file.c:285:
+		struct tomoyo_globally_readable_file_entry *ptr;
+		ptr = list1_entry(pos,

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:LINE_SPACING: Missing a blank line after declarations
#450: FILE: security/tomoyo/file.c:411:
+		struct tomoyo_pattern_entry *ptr;
+		ptr = list1_entry(pos, struct tomoyo_pattern_entry, list);

WARNING:TYPO_SPELLING: 'rewrited' may be misspelled - perhaps 'rewrote'?
#517: FILE: security/tomoyo/file.c:478:
+ * tomoyo_is_no_rewrite_file - Check if the given pathname is not permitted to be rewrited.
                                                                                   ^^^^^^^^

WARNING:LINE_SPACING: Missing a blank line after declarations
#564: FILE: security/tomoyo/file.c:525:
+		struct tomoyo_no_rewrite_entry *ptr;
+		ptr = list1_entry(pos, struct tomoyo_no_rewrite_entry, list);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#596: FILE: security/tomoyo/file.c:557:
+		printk(KERN_DEBUG "%s: Invalid permission '%d %s'\n",

WARNING:LINE_SPACING: Missing a blank line after declarations
#639: FILE: security/tomoyo/file.c:600:
+		struct tomoyo_single_path_acl_record *acl;
+		if (tomoyo_acl_type2(ptr) != TOMOYO_TYPE_SINGLE_PATH_ACL)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#683: FILE: security/tomoyo/file.c:644:
+		BUG();

BUG() or BUG_ON() should be avoided totally.
Use WARN() and WARN_ON() instead, and handle the "impossible"
error condition as gracefully as possible.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on

CHECK:LOGICAL_CONTINUATIONS: Logical continuations should be on the previous line
#713: FILE: security/tomoyo/file.c:674:
+	    (domain->flags & TOMOYO_DOMAIN_FLAGS_IGNORE_GLOBAL_ALLOW_READ) == 0
+	    && is_globally_readable_file(filename))

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#724: FILE: security/tomoyo/file.c:685:
+		BUG();

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#728: FILE: security/tomoyo/file.c:689:
+		printk(KERN_WARNING "TOMOYO-%s: Access '%s(%s) %s' denied "

WARNING:SPLIT_STRING: quoted string split across lines
#729: FILE: security/tomoyo/file.c:690:
+		printk(KERN_WARNING "TOMOYO-%s: Access '%s(%s) %s' denied "
+		       "for %s\n", tomoyo_get_msg(is_enforce), msg, operation,

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

WARNING:SSCANF_TO_KSTRTO: Prefer kstrto<type> to single variable sscanf
#763: FILE: security/tomoyo/file.c:724:
+	if (sscanf(data, "%u", &perm) == 1)
+		return tomoyo_update_file_acl(filename, (u8) perm, domain,
+					      is_delete);

CHECK:SPACING: No space is necessary after a cast
#764: FILE: security/tomoyo/file.c:725:
+		return tomoyo_update_file_acl(filename, (u8) perm, domain,

WARNING:LINE_SPACING: Missing a blank line after declarations
#993: FILE: security/tomoyo/file.c:954:
+		struct tomoyo_double_path_acl_record *acl;
+		if (tomoyo_acl_type2(ptr) != TOMOYO_TYPE_DOUBLE_PATH_ACL)

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#1035: FILE: security/tomoyo/file.c:996:
+		printk(KERN_WARNING "TOMOYO-%s: Access '%s %s' denied for %s\n",

WARNING:LINE_SPACING: Missing a blank line after declarations
#1040: FILE: security/tomoyo/file.c:1001:
+		const char *name = tomoyo_get_file_pattern(filename)->name;
+		tomoyo_update_single_path_acl(operation, name, domain, false);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1140: FILE: security/tomoyo/file.c:1101:
+		error = tomoyo_check_single_path_permission2(domain,
+						     TOMOYO_TYPE_REWRITE_ACL,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1148: FILE: security/tomoyo/file.c:1109:
+		error = tomoyo_check_single_path_permission2(domain,
+						     TOMOYO_TYPE_TRUNCATE_ACL,

WARNING:LONG_LINE_COMMENT: line length of 154 exceeds 100 columns
#1158: FILE: security/tomoyo/file.c:1119:
+ * tomoyo_check_1path_perm - Check permission for "create", "unlink", "mkdir", "rmdir", "mkfifo", "mksock", "mkblock", "mkchar", "truncate" and "symlink".

CHECK:SPACING: No space is necessary after a cast
#1186: FILE: security/tomoyo/file.c:1147:
+			strcat((char *) buf->name, "/");

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#1203: FILE: security/tomoyo/file.c:1164:
+ * @filp: Pointer to "struct file".
     ^^^^

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#1208: FILE: security/tomoyo/file.c:1169:
+				    struct file *filp)
 				                 ^^^^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1262: FILE: security/tomoyo/file.c:1223:
+		struct dentry *dentry = path1->dentry;
+		if (dentry->d_inode && S_ISDIR(dentry->d_inode->i_mode)) {

CHECK:SPACING: No space is necessary after a cast
#1267: FILE: security/tomoyo/file.c:1228:
+				strcat((char *) buf1->name, "/");

CHECK:SPACING: No space is necessary after a cast
#1271: FILE: security/tomoyo/file.c:1232:
+				strcat((char *) buf2->name, "/");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#1281: FILE: security/tomoyo/file.c:1242:
+		printk(KERN_WARNING "TOMOYO-%s: Access '%s %s %s' "

WARNING:SPLIT_STRING: quoted string split across lines
#1282: FILE: security/tomoyo/file.c:1243:
+		printk(KERN_WARNING "TOMOYO-%s: Access '%s %s %s' "
+		       "denied for %s\n", tomoyo_get_msg(is_enforce),

WARNING:LINE_SPACING: Missing a blank line after declarations
#1288: FILE: security/tomoyo/file.c:1249:
+		const char *name2 = tomoyo_get_file_pattern(buf2)->name;
+		tomoyo_update_double_path_acl(operation, name1, name2, domain,

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000201769.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 0 errors, 25 warnings, 8 checks, 1258 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000201769.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
