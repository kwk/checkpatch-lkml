WARNING:TYPO_SPELLING: 'EXPERMENTAL' may be misspelled - perhaps 'EXPERIMENTAL'?
#74: FILE: drivers/mtd/Kconfig:313:
+	  This enables new and very EXPERMENTAL support for SmartMedia/xD
 	                            ^^^^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:TYPO_SPELLING: 'tanslation' may be misspelled - perhaps 'translation'?
#75: FILE: drivers/mtd/Kconfig:314:
+	  FTL (Flash tanslation layer)
 	             ^^^^^^^^^^

WARNING:TYPO_SPELLING: 'caluculated' may be misspelled - perhaps 'calculated'?
#85: FILE: drivers/mtd/Kconfig:324:
+	  Very old SmartMedia cards need ECC to be caluculated in the FTL
 	                                           ^^^^^^^^^^^

WARNING:FILE_PATH_CHANGES: added, moved or deleted file(s), does MAINTAINERS need updating?
#105: 
new file mode 100644

Whenever files are added, moved, or deleted, the MAINTAINERS file
patterns can be out of sync or outdated.

So MAINTAINERS might need updating in these cases.

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#110: FILE: drivers/mtd/sm_ftl.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

CHECK:LINE_SPACING: Please don't use multiple blank lines
#134: FILE: drivers/mtd/sm_ftl.c:25:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO' are not preferred. Consider using octal permissions '0444'.
#138: FILE: drivers/mtd/sm_ftl.c:29:
+module_param(cache_timeout, bool, S_IRUGO);

Permission bits in the octal form are more readable and easier to
understand than their symbolic counterparts because many command-line
tools use this notation. Experienced kernel developers have been using
these traditional Unix permission bits for decades and so they find it
easier to understand the octal notation than the symbolic macros.
For example, it is harder to read S_IWUSR|S_IRUGO than 0644, which
obscures the developer's intent rather than clarifying it.

See: https://lore.kernel.org/lkml/CA+55aFw5v23T-zvDZp-MmD_EYxF8WbafwwB59934FV7g21uMGQ@mail.gmail.com/

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#149: FILE: drivers/mtd/sm_ftl.c:40:
+ssize_t sm_attr_show(struct device *dev, struct device_attribute *attr,
+			char *buf)

CHECK:LINE_SPACING: Please don't use multiple blank lines
#158: FILE: drivers/mtd/sm_ftl.c:49:
+
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#171: FILE: drivers/mtd/sm_ftl.c:62:
+	char *vendor = kmalloc(vendor_len, GFP_KERNEL);
+	memcpy(vendor, ftl->cis_buffer + SM_CIS_VENDOR_OFFSET, vendor_len);

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO' are not preferred. Consider using octal permissions '0444'.
#181: FILE: drivers/mtd/sm_ftl.c:72:
+	vendor_attribute->dev_attr.attr.mode = S_IRUGO;

CHECK:LINE_SPACING: Please don't use multiple blank lines
#184: FILE: drivers/mtd/sm_ftl.c:75:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#187: FILE: drivers/mtd/sm_ftl.c:78:
+	attributes = kzalloc(sizeof(struct attribute *) * (NUM_ATTRIBUTES + 1),
+								GFP_KERNEL);

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*attr_group)...) over kzalloc(sizeof(struct attribute_group)...)
#191: FILE: drivers/mtd/sm_ftl.c:82:
+	attr_group = kzalloc(sizeof(struct attribute_group), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#202: FILE: drivers/mtd/sm_ftl.c:93:
+	for (i = 0; attributes[i] ; i++) {
+

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#208: FILE: drivers/mtd/sm_ftl.c:99:
+			container_of(dev_attr,
+				struct sm_sysfs_attribute, dev_attr);

CHECK:LINE_SPACING: Please don't use multiple blank lines
#218: FILE: drivers/mtd/sm_ftl.c:109:
+
+

WARNING:TYPO_SPELLING: 'endianess' may be misspelled - perhaps 'endianness'?
#227: FILE: drivers/mtd/sm_ftl.c:118:
+	/* check parity - endianess doesn't matter */
 	                  ^^^^^^^^^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#234: FILE: drivers/mtd/sm_ftl.c:125:
+
+

WARNING:TYPO_SPELLING: 'asscociated' may be misspelled - perhaps 'associated'?
#236: FILE: drivers/mtd/sm_ftl.c:127:
+ * Read LBA asscociated with block
             ^^^^^^^^^^^

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#253: FILE: drivers/mtd/sm_ftl.c:144:
+	lba_test = *(u16 *)oob->lba_copy1 ^ *(u16*)oob->lba_copy2;

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#278: FILE: drivers/mtd/sm_ftl.c:169:
+	oob->lba_copy1[0] = oob->lba_copy2[0] = tmp[0];

Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#279: FILE: drivers/mtd/sm_ftl.c:170:
+	oob->lba_copy1[1] = oob->lba_copy2[1] = tmp[1];

CHECK:LINE_SPACING: Please don't use multiple blank lines
#282: FILE: drivers/mtd/sm_ftl.c:173:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#299: FILE: drivers/mtd/sm_ftl.c:190:
+static void sm_break_offset(struct sm_ftl *ftl, loff_t offset,
+					int *zone, int *block, int *boffset)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#330: FILE: drivers/mtd/sm_ftl.c:221:
+static int sm_read_sector(struct sm_ftl *ftl,
+			int zone, int block, int boffset,

WARNING:TYPO_SPELLING: 'vertification' may be misspelled - perhaps 'verification'?
#345: FILE: drivers/mtd/sm_ftl.c:236:
+	/* User might not need the oob, but we do for data vertification */
 	                                                   ^^^^^^^^^^^^^

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#360: FILE: drivers/mtd/sm_ftl.c:251:
+		/* Avoid infinite recursion on CIS reads, sm_recheck_media
+			won't help anyway */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#360: FILE: drivers/mtd/sm_ftl.c:251:
+			won't help anyway */

CHECK:LINE_SPACING: Please don't use multiple blank lines
#370: FILE: drivers/mtd/sm_ftl.c:261:
+
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#372: FILE: drivers/mtd/sm_ftl.c:263:
+	/* Unfortunelly, oob read will _always_ succeed,
+		despite card removal..... */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#372: FILE: drivers/mtd/sm_ftl.c:263:
+		despite card removal..... */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#378: FILE: drivers/mtd/sm_ftl.c:269:
+		dbg("read of block %d at zone %d, failed due to error (%d)",
+			block, zone, ret);

ERROR:SPACING: space prohibited before that ',' (ctx:WxW)
#396: FILE: drivers/mtd/sm_ftl.c:287:
+			" as bad" , block, zone);
 			          ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:SPLIT_STRING: quoted string split across lines
#396: FILE: drivers/mtd/sm_ftl.c:287:
+		dbg("read of block %d at zone %d, failed because it is marked"
+			" as bad" , block, zone);

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#402: FILE: drivers/mtd/sm_ftl.c:293:
+	if (ret == -EBADMSG ||
+		(ftl->smallpagenand && sm_correct_sector(buffer, oob))) {

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#403: FILE: drivers/mtd/sm_ftl.c:294:
+		(ftl->smallpagenand && sm_correct_sector(buffer, oob))) {
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#405: FILE: drivers/mtd/sm_ftl.c:296:
+		dbg("read of block %d at zone %d, failed due to ECC error",
+			block, zone);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#414: FILE: drivers/mtd/sm_ftl.c:305:
+static int sm_write_sector(struct sm_ftl *ftl,
+			int zone, int block, int boffset,

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#421: FILE: drivers/mtd/sm_ftl.c:312:
+	BUG_ON(ftl->readonly);

BUG() or BUG_ON() should be avoided totally.
Use WARN() and WARN_ON() instead, and handle the "impossible"
error condition as gracefully as possible.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#445: FILE: drivers/mtd/sm_ftl.c:336:
+		dbg("write to block %d at zone %d, failed with error %d",
+			block, zone, ret);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#462: FILE: drivers/mtd/sm_ftl.c:353:
+static int sm_write_block(struct sm_ftl *ftl, u8 *buf,
+				int zone, int block, int lba,

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#475: FILE: drivers/mtd/sm_ftl.c:366:
+				boffset += SM_SECTOR_SIZE) {
+

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#479: FILE: drivers/mtd/sm_ftl.c:370:
+		if (test_bit(boffset / SM_SECTOR_SIZE, &invalid_bitmap)) {
+

WARNING:TYPO_SPELLING: 'coudn't' may be misspelled - perhaps 'couldn't'?
#481: FILE: drivers/mtd/sm_ftl.c:372:
+				" coudn't be read, marking it as invalid",
 				  ^^^^^^^

WARNING:SPLIT_STRING: quoted string split across lines
#481: FILE: drivers/mtd/sm_ftl.c:372:
+			sm_printk("sector %d of block at LBA %d of zone %d"
+				" coudn't be read, marking it as invalid",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#490: FILE: drivers/mtd/sm_ftl.c:381:
+			__nand_calculate_ecc(buf + boffset,
+						SM_SMALL_PAGE, oob.ecc1);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#493: FILE: drivers/mtd/sm_ftl.c:384:
+			__nand_calculate_ecc(buf + boffset + SM_SMALL_PAGE,
+						SM_SMALL_PAGE, oob.ecc2);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#497: FILE: drivers/mtd/sm_ftl.c:388:
+		if (!sm_write_sector(ftl, zone, block, boffset,
+							buf + boffset, &oob))

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#501: FILE: drivers/mtd/sm_ftl.c:392:
+		if (!retry) {
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#504: FILE: drivers/mtd/sm_ftl.c:395:
+			/* This is safe, because we never write in blocks
+				that contain valuable data.

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#506: FILE: drivers/mtd/sm_ftl.c:397:
+			as erased, but that isn't fully erased*/

CHECK:LINE_SPACING: Please don't use multiple blank lines
#521: FILE: drivers/mtd/sm_ftl.c:412:
+
+

WARNING:TYPO_SPELLING: 'completly' may be misspelled - perhaps 'completely'?
#541: FILE: drivers/mtd/sm_ftl.c:432:
+		any bad blocks till fail completly */
 		                         ^^^^^^^^^

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#541: FILE: drivers/mtd/sm_ftl.c:432:
+	/* This also fails on fake xD cards, but I guess these won't expose
+		any bad blocks till fail completly */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#541: FILE: drivers/mtd/sm_ftl.c:432:
+		any bad blocks till fail completly */

WARNING:TYPO_SPELLING: 'succedes' may be misspelled - perhaps 'succeeds'?
#548: FILE: drivers/mtd/sm_ftl.c:439:
+ * If erase succedes, it updates free block fifo, otherwise marks block as bad
             ^^^^^^^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#551: FILE: drivers/mtd/sm_ftl.c:442:
+static int sm_erase_block(struct sm_ftl *ftl, int zone_num, u16 block,
+								int put_free)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#566: FILE: drivers/mtd/sm_ftl.c:457:
+	BUG_ON(ftl->readonly);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#575: FILE: drivers/mtd/sm_ftl.c:466:
+		sm_printk("erase of block %d in zone %d failed",
+							block, zone_num);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#584: FILE: drivers/mtd/sm_ftl.c:475:
+		sm_printk("erase of block %d in zone %d failed after wait",
+			block, zone_num);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#590: FILE: drivers/mtd/sm_ftl.c:481:
+		kfifo_in(&zone->free_sectors,
+			(const unsigned char *)&block, sizeof(block));

WARNING:LINE_SPACING: Missing a blank line after declarations
#601: FILE: drivers/mtd/sm_ftl.c:492:
+	struct sm_ftl *ftl = (struct sm_ftl *)self->priv;
+	complete(&ftl->erase_completion);

CHECK:LINE_SPACING: Please don't use multiple blank lines
#613: FILE: drivers/mtd/sm_ftl.c:504:
+
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#616: FILE: drivers/mtd/sm_ftl.c:507:
+	/* Only blocks that are valid or are sliced in two parts, are
+		accepted */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#616: FILE: drivers/mtd/sm_ftl.c:507:
+		accepted */

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#619: FILE: drivers/mtd/sm_ftl.c:510:
+					boffset += SM_SECTOR_SIZE) {
+

WARNING:TYPO_SPELLING: 'shoudn't' may be misspelled - perhaps 'shouldn't'?
#620: FILE: drivers/mtd/sm_ftl.c:511:
+		/* This shoudn't happen anyway */
 		        ^^^^^^^^

WARNING:TYPO_SPELLING: 'partialy' may be misspelled - perhaps 'partially'?
#634: FILE: drivers/mtd/sm_ftl.c:525:
+	/* If the block is sliced (partialy erased usually) erase it */
 	                           ^^^^^^^^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#660: FILE: drivers/mtd/sm_ftl.c:551:
+
+

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#664: FILE: drivers/mtd/sm_ftl.c:555:
+};
+/* Find out media parameters.

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#665: FILE: drivers/mtd/sm_ftl.c:556:
+ * This ideally has to be based on nand id, but for now device size is enough */

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#695: FILE: drivers/mtd/sm_ftl.c:586:
+		} else {
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#718: FILE: drivers/mtd/sm_ftl.c:609:
+	/* Minimum xD size is 16M. Also, all xD cards have standard zone
+	   sizes. SmartMedia cards exist up to 128 Mb and have same layout*/

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#718: FILE: drivers/mtd/sm_ftl.c:609:
+	   sizes. SmartMedia cards exist up to 128 Mb and have same layout*/

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 24)
#765: FILE: drivers/mtd/sm_ftl.c:656:
+	if (sm_read_sector(ftl,
[...]
+			return -EIO;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#766: FILE: drivers/mtd/sm_ftl.c:657:
+	if (sm_read_sector(ftl,
+		0, ftl->cis_block, ftl->cis_boffset, ftl->cis_buffer, &oob))

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#776: FILE: drivers/mtd/sm_ftl.c:667:
+	if (!memcmp(ftl->cis_buffer + SM_SMALL_PAGE, cis_signature,
+						sizeof(cis_signature)))

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#790: FILE: drivers/mtd/sm_ftl.c:681:
+	for (block = 0 ; block < ftl->zone_size - ftl->max_lba ; block++) {
+

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#806: FILE: drivers/mtd/sm_ftl.c:697:
+						boffset += SM_SECTOR_SIZE) {
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#823: FILE: drivers/mtd/sm_ftl.c:714:
+		dbg("CIS block found at offset %d",
+			block * ftl->block_size + boffset);

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#834: FILE: drivers/mtd/sm_ftl.c:725:
+	if (sm_read_cis(ftl)) {
+

CHECK:LINE_SPACING: Please don't use multiple blank lines
#862: FILE: drivers/mtd/sm_ftl.c:753:
+
+

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#871: FILE: drivers/mtd/sm_ftl.c:762:
+	for (block = 0 ; block < ftl->zone_size ; block++) {
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#881: FILE: drivers/mtd/sm_ftl.c:772:
+		/* Test to see if block is erased. It is enough to test
+			first sector, because erase happens in one shot */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#881: FILE: drivers/mtd/sm_ftl.c:772:
+			first sector, because erase happens in one shot */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#884: FILE: drivers/mtd/sm_ftl.c:775:
+			kfifo_in(&zone->free_sectors,
+				(unsigned char *)&block, 2);

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#891: FILE: drivers/mtd/sm_ftl.c:782:
+		/* However the way the block valid status is defined, ensures
+			very low probability of failure here */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#891: FILE: drivers/mtd/sm_ftl.c:782:
+			very low probability of failure here */

CHECK:LINE_SPACING: Please don't use multiple blank lines
#897: FILE: drivers/mtd/sm_ftl.c:788:
+
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#902: FILE: drivers/mtd/sm_ftl.c:793:
+		/* We can try to erase it, or mark it as bad, but
+			lets leave that to recovery application */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#902: FILE: drivers/mtd/sm_ftl.c:793:
+			lets leave that to recovery application */

CHECK:LINE_SPACING: Please don't use multiple blank lines
#908: FILE: drivers/mtd/sm_ftl.c:799:
+
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#910: FILE: drivers/mtd/sm_ftl.c:801:
+		/* If there is no collision,
+			just put the sector in the FTL table */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#910: FILE: drivers/mtd/sm_ftl.c:801:
+			just put the sector in the FTL table */

WARNING:SPLIT_STRING: quoted string split across lines
#918: FILE: drivers/mtd/sm_ftl.c:809:
+		sm_printk("collision"
+			" of LBA %d between blocks %d and %d in zone %d",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#927: FILE: drivers/mtd/sm_ftl.c:818:
+		if (sm_check_block(ftl, zone_num,
+					zone->lba_to_phys_table[lba])) {

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#933: FILE: drivers/mtd/sm_ftl.c:824:
+		/* If both blocks are valid and share same LBA, it means that
+			they hold different versions of same data. It not

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#944: FILE: drivers/mtd/sm_ftl.c:835:
+	/* No free sectors, means that the zone is heavily damaged, write won't
+		work, but it can still can be (partially) read */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#944: FILE: drivers/mtd/sm_ftl.c:835:
+		work, but it can still can be (partially) read */

WARNING:TYPO_SPELLING: 'automaticly' may be misspelled - perhaps 'automatically'?
#961: FILE: drivers/mtd/sm_ftl.c:852:
+/* Get and automaticly initialize an FTL mapping for one zone */
            ^^^^^^^^^^^

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#967: FILE: drivers/mtd/sm_ftl.c:858:
+	BUG_ON(zone_num >= ftl->zone_count);

CHECK:LINE_SPACING: Please don't use multiple blank lines
#979: FILE: drivers/mtd/sm_ftl.c:870:
+
+

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 24)
#1003: FILE: drivers/mtd/sm_ftl.c:894:
+	if (test_bit(boffset / SM_SECTOR_SIZE,
[...]
+			return -1;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1004: FILE: drivers/mtd/sm_ftl.c:895:
+	if (test_bit(boffset / SM_SECTOR_SIZE,
+		&ftl->cache_data_invalid_bitmap))

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1027: FILE: drivers/mtd/sm_ftl.c:918:
+	BUG_ON(zone_num < 0);

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1031: FILE: drivers/mtd/sm_ftl.c:922:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1034: FILE: drivers/mtd/sm_ftl.c:925:
+	for_each_bit(sector_num, &ftl->cache_data_invalid_bitmap,
+		ftl->block_size / SM_SECTOR_SIZE) {

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#1035: FILE: drivers/mtd/sm_ftl.c:926:
+		ftl->block_size / SM_SECTOR_SIZE) {
+

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (16, 32)
#1036: FILE: drivers/mtd/sm_ftl.c:927:
+		if (!sm_read_sector(ftl,
[...]
+				clear_bit(sector_num,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1037: FILE: drivers/mtd/sm_ftl.c:928:
+		if (!sm_read_sector(ftl,
+			zone_num, block_num, sector_num * SM_SECTOR_SIZE,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1040: FILE: drivers/mtd/sm_ftl.c:931:
+				clear_bit(sector_num,
+					&ftl->cache_data_invalid_bitmap);

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#1045: FILE: drivers/mtd/sm_ftl.c:936:
+	/* We could still continue by erasing the current block,
+		but for such worn out media it doesn't worth the trouble,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1046: FILE: drivers/mtd/sm_ftl.c:937:
+			and the dangers */

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 24)
#1055: FILE: drivers/mtd/sm_ftl.c:946:
+	if (sm_write_block(ftl, ftl->cache_data, zone_num, write_sector,
[...]
+			goto restart;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1056: FILE: drivers/mtd/sm_ftl.c:947:
+	if (sm_write_block(ftl, ftl->cache_data, zone_num, write_sector,
+		ftl->cache_block, ftl->cache_data_invalid_bitmap))

WARNING:TYPO_SPELLING: 'succesfull' may be misspelled - perhaps 'successful'?
#1062: FILE: drivers/mtd/sm_ftl.c:953:
+	/* Write succesfull, so erase and free the old block */
 	         ^^^^^^^^^^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1070: FILE: drivers/mtd/sm_ftl.c:961:
+
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#1075: FILE: drivers/mtd/sm_ftl.c:966:
+	struct sm_ftl *ftl = (struct sm_ftl *)data;
+	queue_work(cache_flush_workqueue, &ftl->flush_work);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1082: FILE: drivers/mtd/sm_ftl.c:973:
+	struct sm_ftl *ftl = container_of(work, struct sm_ftl, flush_work);
+	mutex_lock(&ftl->mutex);

WARNING:RETURN_VOID: void function return statements are not generally useful
#1086: FILE: drivers/mtd/sm_ftl.c:977:
+	return;
+}

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1092: FILE: drivers/mtd/sm_ftl.c:983:
+static int sm_read(struct mtd_blktrans_dev *dev,
+				unsigned long sect_no, char *buf)

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1102: FILE: drivers/mtd/sm_ftl.c:993:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1138: FILE: drivers/mtd/sm_ftl.c:1029:
+static int sm_write(struct mtd_blktrans_dev *dev,
+				unsigned long sec_no, char *buf)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1144: FILE: drivers/mtd/sm_ftl.c:1035:
+	BUG_ON(ftl->readonly);

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#1159: FILE: drivers/mtd/sm_ftl.c:1050:
+	if (ftl->cache_block != block || ftl->cache_zone != zone_num) {
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#1204: FILE: drivers/mtd/sm_ftl.c:1095:
+	struct sm_ftl *ftl = dev->priv;
+	geo->heads = ftl->heads;

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*ftl)...) over kzalloc(sizeof(struct sm_ftl)...)
#1217: FILE: drivers/mtd/sm_ftl.c:1108:
+	ftl = kzalloc(sizeof(struct sm_ftl), GFP_KERNEL);

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1226: FILE: drivers/mtd/sm_ftl.c:1117:
+
+

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*ftl->zones)...) over kzalloc(sizeof(struct ftl_zone)...)
#1237: FILE: drivers/mtd/sm_ftl.c:1128:
+	ftl->zones = kzalloc(sizeof(struct ftl_zone) * ftl->zone_count,

WARNING:ALLOC_WITH_MULTIPLY: Prefer kcalloc over kzalloc with multiply
#1237: FILE: drivers/mtd/sm_ftl.c:1128:
+	ftl->zones = kzalloc(sizeof(struct ftl_zone) * ftl->zone_count,
+								GFP_KERNEL);

Prefer kmalloc_array/kcalloc over kmalloc/kzalloc with a
sizeof multiply.

See: https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1238: FILE: drivers/mtd/sm_ftl.c:1129:
+	ftl->zones = kzalloc(sizeof(struct ftl_zone) * ftl->zone_count,
+								GFP_KERNEL);

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*trans)...) over kzalloc(sizeof(struct mtd_blktrans_dev)...)
#1251: FILE: drivers/mtd/sm_ftl.c:1142:
+	trans = kzalloc(sizeof(struct mtd_blktrans_dev), GFP_KERNEL);

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1264: FILE: drivers/mtd/sm_ftl.c:1155:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1271: FILE: drivers/mtd/sm_ftl.c:1162:
+	sm_printk("Found %d MiB xD/SmartMedia FTL on mtd%d",
+		(int)(mtd->size / (1024 * 1024)), mtd->index);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1275: FILE: drivers/mtd/sm_ftl.c:1166:
+	dbg("%d zone(s), each consists of %d blocks (+%d spares)",
+		ftl->zone_count, ftl->max_lba,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1278: FILE: drivers/mtd/sm_ftl.c:1169:
+	dbg("each block consists of %d bytes",
+		ftl->block_size);

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#1308: FILE: drivers/mtd/sm_ftl.c:1199:
+	for (i = 0 ; i < ftl->zone_count; i++) {
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#1344: FILE: drivers/mtd/sm_ftl.c:1235:
+	int error = 0;
+	cache_flush_workqueue = create_freezeable_workqueue("smflush");

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#1354: FILE: drivers/mtd/sm_ftl.c:1245:
+
+}

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#1374: FILE: drivers/mtd/sm_ftl.h:1:
+/*

WARNING:TYPO_SPELLING: 'loosly' may be misspelled - perhaps 'loosely'?
#1378: FILE: drivers/mtd/sm_ftl.h:5:
+ * Based loosly on ssfdc.c which is
          ^^^^^^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1392: FILE: drivers/mtd/sm_ftl.h:19:
+
+

WARNING:MISORDERED_TYPE: type 'long unsigned int' should be specified in [[un]signed] [short|int|long|long long] order
#1422: FILE: drivers/mtd/sm_ftl.h:49:
+	long unsigned int cache_data_invalid_bitmap;

WARNING:UNNECESSARY_INT: Prefer 'unsigned long' over 'long unsigned int' as the int is unnecessary
#1422: FILE: drivers/mtd/sm_ftl.h:49:
+	long unsigned int cache_data_invalid_bitmap;

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1443: FILE: drivers/mtd/sm_ftl.h:70:
+
+

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#1447: FILE: drivers/mtd/sm_ftl.h:74:
+	printk(KERN_WARNING "sm_ftl" ": " format "\n", ## __VA_ARGS__)

WARNING:STRING_FRAGMENTS: Consecutive strings are generally better as a single string
#1447: FILE: drivers/mtd/sm_ftl.h:74:
+	printk(KERN_WARNING "sm_ftl" ": " format "\n", ## __VA_ARGS__)

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1449: FILE: drivers/mtd/sm_ftl.h:76:
+
+

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#1453: FILE: drivers/mtd/sm_ftl.h:80:
+	printk(KERN_DEBUG "sm_ftl" ": " format "\n", ## __VA_ARGS__)

WARNING:STRING_FRAGMENTS: Consecutive strings are generally better as a single string
#1453: FILE: drivers/mtd/sm_ftl.h:80:
+	printk(KERN_DEBUG "sm_ftl" ": " format "\n", ## __VA_ARGS__)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1462: FILE: drivers/mtd/sm_ftl.h:89:
+static int sm_erase_block(struct sm_ftl *ftl, int zone_num, u16 block,
+								int put_free);

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000018149.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 2 errors, 71 warnings, 79 checks, 1384 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000018149.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
