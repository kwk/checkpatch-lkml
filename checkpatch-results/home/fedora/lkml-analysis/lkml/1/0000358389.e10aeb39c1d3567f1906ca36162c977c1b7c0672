CHECK:SPACING: No space is necessary after a cast
#133: FILE: arch/x86/kernel/ptrace_32.c:634:
+			 (struct ptrace_bts_record __user *) addr);

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:LINE_SPACING: Please don't use multiple blank lines
#156: FILE: include/asm-x86/ptrace-abi.h:81:
 
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#158: FILE: include/asm-x86/ptrace-abi.h:83:
+/* Initialize bts tracing. Needs to be called once.
+   Return the type of tracing available */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#158: FILE: include/asm-x86/ptrace-abi.h:83:
+   Return the type of tracing available */

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#169: FILE: include/asm-x86/ptrace-abi.h:94:
+/* Allocate new bts buffer (free old one, if exists) of size DATA bts records;
+   parameter ADDR is ignored.

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#173: FILE: include/asm-x86/ptrace-abi.h:98:
+   ENOMEM...out of memory */

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#177: FILE: include/asm-x86/ptrace-abi.h:102:
+/* Return the size of the bts buffer in number of bts records,
+   if successful; -1, otherwise.

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#178: FILE: include/asm-x86/ptrace-abi.h:103:
+   ENXIO....ptrace bts not initialized or no buffer allocated */

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#182: FILE: include/asm-x86/ptrace-abi.h:107:
+/* Return the index of the next bts record to be written,
+   if successful; -1, otherwise.

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#184: FILE: include/asm-x86/ptrace-abi.h:109:
+   ENXIO....ptrace bts not initialized or no buffer allocated */

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#188: FILE: include/asm-x86/ptrace-abi.h:113:
+/* Read the DATA'th bts record into a ptrace_bts_record buffer provided in ADDR.
+   Return 0, if successful; -1, otherwise

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#190: FILE: include/asm-x86/ptrace-abi.h:115:
+   EINVAL...invalid index */

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#194: FILE: include/asm-x86/ptrace-abi.h:119:
+/* Configure last branch trace; the configuration is given as a bit-mask of
+   PTRACE_BTS_O_* options in DATA; parameter ADDR is ignored. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#194: FILE: include/asm-x86/ptrace-abi.h:119:
+   PTRACE_BTS_O_* options in DATA; parameter ADDR is ignored. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#238: FILE: include/asm-x86/ptrace.h:30:
+		/* PTRACE_BTS_TASK_ARRIVES or
+		   PTRACE_BTS_TASK_DEPARTS */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#238: FILE: include/asm-x86/ptrace.h:30:
+		   PTRACE_BTS_TASK_DEPARTS */

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#247: FILE: include/asm-x86/ptrace.h:39:
+extern void ptrace_bts_task_arrives(struct task_struct *tsk);

Function prototypes don't need to be declared extern in .h
files.  It's assumed by the compiler and is unnecessary.

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#248: FILE: include/asm-x86/ptrace.h:40:
+extern void ptrace_bts_task_departs(struct task_struct *tsk);

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#260: FILE: arch/x86/kernel/ptrace_bts.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

CHECK:ARCH_INCLUDE_LINUX: Consider using #include <linux/uaccess.h> instead of <asm/uaccess.h>
#274: FILE: arch/x86/kernel/ptrace_bts.c:15:
+#include <asm/uaccess.h>

Whenever asm/file.h is included and linux/file.h exists, a
conversion can be made when linux/file.h includes asm/file.h.
However this is not always the case (See signal.h).
This message type is emitted only for includes from arch/.

CHECK:LINE_SPACING: Please don't use multiple blank lines
#276: FILE: arch/x86/kernel/ptrace_bts.c:17:
+
+

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#291: FILE: arch/x86/kernel/ptrace_bts.c:32:
+#ifdef __i386__

Architecture specific defines should be avoided wherever
possible.

WARNING:LINE_SPACING: Missing a blank line after declarations
#295: FILE: arch/x86/kernel/ptrace_bts.c:36:
+	unsigned long long debugctl_msr = 0;
+	rdmsrl(MSR_IA32_DEBUGCTLMSR, debugctl_msr);

WARNING:LINE_SPACING: Missing a blank line after declarations
#307: FILE: arch/x86/kernel/ptrace_bts.c:48:
+	unsigned long long debugctl_msr = 0;
+	rdmsrl(MSR_IA32_DEBUGCTLMSR, debugctl_msr);

WARNING:LINE_SPACING: Missing a blank line after declarations
#320: FILE: arch/x86/kernel/ptrace_bts.c:61:
+	unsigned long long debugctl_msr = 0;
+	rdmsrl(MSR_IA32_DEBUGCTLMSR, debugctl_msr);

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#341: FILE: arch/x86/kernel/ptrace_bts.c:82:
+#ifdef __i386__

WARNING:LINE_SPACING: Missing a blank line after declarations
#345: FILE: arch/x86/kernel/ptrace_bts.c:86:
+	unsigned long long debugctl_msr = 0;
+	rdmsrl(MSR_IA32_DEBUGCTLMSR, debugctl_msr);

WARNING:LINE_SPACING: Missing a blank line after declarations
#357: FILE: arch/x86/kernel/ptrace_bts.c:98:
+	unsigned long long debugctl_msr = 0;
+	rdmsrl(MSR_IA32_DEBUGCTLMSR, debugctl_msr);

WARNING:LINE_SPACING: Missing a blank line after declarations
#370: FILE: arch/x86/kernel/ptrace_bts.c:111:
+	unsigned long long debugctl_msr = 0;
+	rdmsrl(MSR_IA32_DEBUGCTLMSR, debugctl_msr);

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#396: FILE: arch/x86/kernel/ptrace_bts.c:137:
+#ifdef __i386__

WARNING:LINE_SPACING: Missing a blank line after declarations
#436: FILE: arch/x86/kernel/ptrace_bts.c:177:
+		int err = ptrace_bts_allocate_ds(child);
+		if (err < 0)

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#451: FILE: arch/x86/kernel/ptrace_bts.c:192:
+#ifdef __i386__

WARNING:TYPO_SPELLING: 'occured' may be misspelled - perhaps 'occurred'?
#505: FILE: arch/x86/kernel/ptrace_bts.c:246:
+ * Return -Eerrno, if an error occured
                                ^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#517: FILE: arch/x86/kernel/ptrace_bts.c:258:
+#ifdef __i386__

WARNING:TYPO_SPELLING: 'occured' may be misspelled - perhaps 'occurred'?
#544: FILE: arch/x86/kernel/ptrace_bts.c:285:
+ * Returns -Eerrno, if an error occured.
                                 ^^^^^^^

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#556: FILE: arch/x86/kernel/ptrace_bts.c:297:
+#ifdef __i386__

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#607: FILE: arch/x86/kernel/ptrace_bts.c:348:
+#ifdef __i386__

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#612: FILE: arch/x86/kernel/ptrace_bts.c:353:
+	struct ptrace_bts_ds_32 *ds = (

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#689: FILE: arch/x86/kernel/ptrace_bts.c:430:
+#ifdef __i386__

WARNING:ONE_SEMICOLON: Statements terminations use 1 semicolon
#718: FILE: arch/x86/kernel/ptrace_bts.c:459:
+			(struct ptrace_bts_32 *)&record;;

WARNING:ONE_SEMICOLON: Statements terminations use 1 semicolon
#769: FILE: arch/x86/kernel/ptrace_bts.c:510:
+			(struct ptrace_bts_64_noflags *)&record;;

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#895: FILE: arch/x86/kernel/ptrace_bts.c:636:
+#ifdef __i386__

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#942: FILE: arch/x86/kernel/ptrace_bts.c:683:
+#ifdef __i386__

CHECK:ARCH_DEFINES: architecture specific defines should be avoided
#962: FILE: arch/x86/kernel/ptrace_bts.c:703:
+#ifdef __i386__

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#984: FILE: arch/x86/kernel/ptrace_bts.c:725:
+}
+int ptrace_bts_init(void)

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#1006: FILE: include/asm-x86/ptrace_bts.h:1:
+/*

ERROR:SPACING: space prohibited before that ':' (ctx:WxW)
#1083: FILE: include/asm-x86/ptrace_bts.h:78:
+	u32 : 4;
 	    ^

ERROR:SPACING: space prohibited before that ':' (ctx:WxW)
#1085: FILE: include/asm-x86/ptrace_bts.h:80:
+	u32 : 27;
 	    ^

WARNING:PREFER_DEFINED_ATTRIBUTE_MACRO: Prefer __packed over __attribute__((packed))
#1086: FILE: include/asm-x86/ptrace_bts.h:81:
+} __attribute__((packed, aligned(4)));

WARNING:PREFER_DEFINED_ATTRIBUTE_MACRO: Prefer __aligned(4) over __attribute__((aligned(4)))
#1086: FILE: include/asm-x86/ptrace_bts.h:81:
+} __attribute__((packed, aligned(4)));

ERROR:SPACING: space prohibited before that ':' (ctx:WxW)
#1092: FILE: include/asm-x86/ptrace_bts.h:87:
+	u64 : 64;
 	    ^

ERROR:COMPLEX_MACRO: Macros with complex values should be enclosed in parentheses
#1100: FILE: include/asm-x86/ptrace_bts.h:95:
+#define PTRACE_BTS_ESCAPE_ADDRESS (__u64)(0)

WARNING:PREFER_DEFINED_ATTRIBUTE_MACRO: Prefer __packed over __attribute__((packed))
#1108: FILE: include/asm-x86/ptrace_bts.h:103:
+} __attribute__((packed, aligned(4)));

WARNING:PREFER_DEFINED_ATTRIBUTE_MACRO: Prefer __aligned(4) over __attribute__((aligned(4)))
#1108: FILE: include/asm-x86/ptrace_bts.h:103:
+} __attribute__((packed, aligned(4)));

ERROR:SPACING: space prohibited before that ':' (ctx:WxW)
#1115: FILE: include/asm-x86/ptrace_bts.h:110:
+	u64 : 64;
 	    ^

WARNING:PREFER_DEFINED_ATTRIBUTE_MACRO: Prefer __packed over __attribute__((packed))
#1116: FILE: include/asm-x86/ptrace_bts.h:111:
+} __attribute__((packed, aligned(8)));

WARNING:PREFER_DEFINED_ATTRIBUTE_MACRO: Prefer __aligned(8) over __attribute__((aligned(8)))
#1116: FILE: include/asm-x86/ptrace_bts.h:111:
+} __attribute__((packed, aligned(8)));

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct task_struct *' should also have an identifier name
#1128: FILE: include/asm-x86/ptrace_bts.h:123:
+	int (*allocate_ds)(struct task_struct *);

This warning is emitted due to any of the following reasons:

  1. Arguments for the function declaration do not follow
     the identifier name.  Example::

       void foo
       (int bar, int baz)

     This should be corrected to::

       void foo(int bar, int baz)

  2. Some arguments for the function definition do not
     have an identifier name.  Example::

       void foo(int)

     All arguments should have identifier names.

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct task_struct *' should also have an identifier name
#1129: FILE: include/asm-x86/ptrace_bts.h:124:
+	int (*allocate_bts)(struct task_struct *, long);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'long' should also have an identifier name
#1129: FILE: include/asm-x86/ptrace_bts.h:124:
+	int (*allocate_bts)(struct task_struct *, long);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct task_struct *' should also have an identifier name
#1130: FILE: include/asm-x86/ptrace_bts.h:125:
+	int (*get_buffer_size)(struct task_struct *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct task_struct *' should also have an identifier name
#1131: FILE: include/asm-x86/ptrace_bts.h:126:
+	int (*get_index)(struct task_struct *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct task_struct *' should also have an identifier name
#1132: FILE: include/asm-x86/ptrace_bts.h:127:
+	int (*read_record)(struct task_struct *, long,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'long' should also have an identifier name
#1132: FILE: include/asm-x86/ptrace_bts.h:127:
+	int (*read_record)(struct task_struct *, long,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct ptrace_bts_record __user *' should also have an identifier name
#1132: FILE: include/asm-x86/ptrace_bts.h:127:
+	int (*read_record)(struct task_struct *, long,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct task_struct *' should also have an identifier name
#1134: FILE: include/asm-x86/ptrace_bts.h:129:
+	int (*write_record)(struct task_struct *,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'const struct ptrace_bts_record*' should also have an identifier name
#1134: FILE: include/asm-x86/ptrace_bts.h:129:
+	int (*write_record)(struct task_struct *,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1138: FILE: include/asm-x86/ptrace_bts.h:133:
+extern int ptrace_bts_init(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1139: FILE: include/asm-x86/ptrace_bts.h:134:
+extern int ptrace_bts_allocate_bts(struct task_struct *child,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1141: FILE: include/asm-x86/ptrace_bts.h:136:
+extern int ptrace_bts_get_buffer_size(struct task_struct *child);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1142: FILE: include/asm-x86/ptrace_bts.h:137:
+extern int ptrace_bts_get_index(struct task_struct *child);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1143: FILE: include/asm-x86/ptrace_bts.h:138:
+extern int ptrace_bts_read_record(struct task_struct *child,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1146: FILE: include/asm-x86/ptrace_bts.h:141:
+extern void ptrace_bts_config(struct task_struct *child,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1148: FILE: include/asm-x86/ptrace_bts.h:143:
+extern unsigned long ptrace_bts_status(struct task_struct *child);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#1149: FILE: include/asm-x86/ptrace_bts.h:144:
+extern void ptrace_bts_task_detached(struct task_struct *tsk);

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#1184: FILE: include/asm-x86/thread_info_32.h:157:
+#define _TIF_BTS_TRACE		(1<<TIF_BTS_TRACE)
                       		  ^

CHECK:BIT_MACRO: Prefer using the BIT macro
#1184: FILE: include/asm-x86/thread_info_32.h:157:
+#define _TIF_BTS_TRACE		(1<<TIF_BTS_TRACE)

Defines like: 1 << <digit> could be BIT(digit).
The BIT() macro is defined via include/linux/bits.h::

  #define BIT(nr)         (1UL << (nr))

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#1185: FILE: include/asm-x86/thread_info_32.h:158:
+#define _TIF_BTS_TRACE_TS	(1<<TIF_BTS_TRACE_TS)
                          	  ^

CHECK:BIT_MACRO: Prefer using the BIT macro
#1185: FILE: include/asm-x86/thread_info_32.h:158:
+#define _TIF_BTS_TRACE_TS	(1<<TIF_BTS_TRACE_TS)

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1198: FILE: include/asm-x86/processor_32.h:357:
+ *               goes into MSR_IA32_DS_AREA */

CHECK:SPACING: No space is necessary after a cast
#1282: FILE: arch/x86/kernel/ptrace_64.c:579:
+			 (struct ptrace_bts_record __user *) addr);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1306: FILE: include/asm-x86/processor_64.h:227:
+ *               goes into MSR_IA32_DS_AREA */

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#1328: FILE: include/asm-x86/thread_info_64.h:144:
+#define _TIF_BTS_TRACE		(1<<TIF_BTS_TRACE)
                       		  ^

CHECK:BIT_MACRO: Prefer using the BIT macro
#1328: FILE: include/asm-x86/thread_info_64.h:144:
+#define _TIF_BTS_TRACE		(1<<TIF_BTS_TRACE)

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#1329: FILE: include/asm-x86/thread_info_64.h:145:
+#define _TIF_BTS_TRACE_TS	(1<<TIF_BTS_TRACE_TS)
                          	  ^

CHECK:BIT_MACRO: Prefer using the BIT macro
#1329: FILE: include/asm-x86/thread_info_64.h:145:
+#define _TIF_BTS_TRACE_TS	(1<<TIF_BTS_TRACE_TS)

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000358389.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 5 errors, 45 warnings, 36 checks, 1190 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000358389.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
