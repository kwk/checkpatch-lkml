WARNING:COMMIT_LOG_LONG_LINE: Possible unwrapped commit description (prefer a maximum 75 chars per line)
#38: 
This driver sets X86_64 'dma_ops', so hook into standard DMA APIs. In this way,

WARNING:TYPO_SPELLING: 'gaurd' may be misspelled - perhaps 'guard'?
#108: FILE: Documentation/Intel-IOMMU.txt:51:
+We also allocate gaurd pages with each mapping, so we can attempt to catch
                  ^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#227: FILE: drivers/pci/intel-iommu.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

ERROR:FSF_MAILING_ADDRESS: Do not include the paragraph about writing to the Free Software Foundation's mailing address from the sample GPL notice. The FSF has changed addresses in the past, and may do so again. Linux already includes a copy of the GPL.
#240: FILE: drivers/pci/intel-iommu.c:14:
+ * this program; if not, write to the Free Software Foundation, Inc., 59 Temple$

Kernel maintainers reject new instances of the GPL boilerplate paragraph
directing people to write to the FSF for a copy of the GPL, since the
FSF has moved in the past and may do so again.
So do not write paragraphs about writing to the Free Software Foundation's
mailing address.

See: https://lore.kernel.org/lkml/20131006222342.GT19510@leaf/

WARNING:INCLUDE_LINUX: Use #include <linux/cacheflush.h> instead of <asm/cacheflush.h>
#262: FILE: drivers/pci/intel-iommu.c:36:
+#include <asm/cacheflush.h>

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'pdev' may be better as '(pdev)' to avoid precedence issues
#265: FILE: drivers/pci/intel-iommu.c:39:
+#define IS_GFX_DEVICE(pdev) ((pdev->class >> 16) == PCI_BASE_CLASS_DISPLAY)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'pdev' may be better as '(pdev)' to avoid precedence issues
#266: FILE: drivers/pci/intel-iommu.c:40:
+#define IS_ISA_DEVICE(pdev) ((pdev->class >> 8) == PCI_CLASS_BRIDGE_ISA)

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#274: FILE: drivers/pci/intel-iommu.c:48:
+#define DMAR_OPERATION_TIMEOUT (HZ*60) /* 1m */
                                   ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'gaw' may be better as '(gaw)' to avoid precedence issues
#276: FILE: drivers/pci/intel-iommu.c:50:
+#define DOMAIN_MAX_ADDR(gaw) ((((u64)1) << gaw) - 1)

WARNING:MISPLACED_INIT: __initdata should be placed after dmar_map_gfx
#281: FILE: drivers/pci/intel-iommu.c:55:
+static int __initdata dmar_map_gfx = 1;

It is possible to use section markers on variables in a way
which gcc doesn't understand (or at least not the way the
developer intended)::

  static struct __initdata samsung_pll_clock exynos4_plls[nr_plls] = {

does not put exynos4_plls in the .initdata section. The __initdata
marker can be virtually anywhere on the line, except right after
"struct". The preferred location is before the "=" sign if there is
one, or before the trailing ";" otherwise.

See: https://lore.kernel.org/lkml/1377655732.3619.19.camel@joe-AO722/

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#294: FILE: drivers/pci/intel-iommu.c:68:
+			printk(KERN_INFO"Intel-IOMMU: disabled\n");

CHECK:CONCATENATED_STRING: Concatenated strings should use spaces between elements
#294: FILE: drivers/pci/intel-iommu.c:68:
+			printk(KERN_INFO"Intel-IOMMU: disabled\n");

Concatenated elements should have a space in between.
Example::

  printk(KERN_INFO"bar");

should be::

  printk(KERN_INFO "bar");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#297: FILE: drivers/pci/intel-iommu.c:71:
+			printk(KERN_INFO"Intel-IOMMU: disable GFX device mapping\n");

CHECK:CONCATENATED_STRING: Concatenated strings should use spaces between elements
#297: FILE: drivers/pci/intel-iommu.c:71:
+			printk(KERN_INFO"Intel-IOMMU: disable GFX device mapping\n");

CHECK:UNDOCUMENTED_SETUP: __setup appears un-documented -- check Documentation/admin-guide/kernel-parameters.txt
#306: FILE: drivers/pci/intel-iommu.c:80:
+__setup("intel_iommu=", intel_iommu_setup);

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#345: FILE: drivers/pci/intel-iommu.c:119:
+static inline void * alloc_devinfo_mem(void)

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#372: FILE: drivers/pci/intel-iommu.c:146:
+static struct context_entry * device_to_context_entry(struct intel_iommu *iommu,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#373: FILE: drivers/pci/intel-iommu.c:147:
+static struct context_entry * device_to_context_entry(struct intel_iommu *iommu,
+		u8 bus, u8 devfn)

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#382: FILE: drivers/pci/intel-iommu.c:156:
+	if (!(context = get_context_addr_from_root(*root))) {

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#407: FILE: drivers/pci/intel-iommu.c:181:
+	if (!(context = get_context_addr_from_root(*root))) {

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#425: FILE: drivers/pci/intel-iommu.c:199:
+	if ((context = get_context_addr_from_root(*root))) {

WARNING:LINE_CONTINUATIONS: Avoid unnecessary line continuations
#427: FILE: drivers/pci/intel-iommu.c:201:
+		__iommu_flush_cache(iommu, &context[devfn], \

WARNING:BRACES: braces {} are not necessary for single statement blocks
#441: FILE: drivers/pci/intel-iommu.c:215:
+	if (!iommu->root_entry) {
+		goto out;
+	}

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#446: FILE: drivers/pci/intel-iommu.c:220:
+		if ((context = get_context_addr_from_root(*root)))

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'val' may be better as '(val)' to avoid precedence issues
#459: FILE: drivers/pci/intel-iommu.c:233:
+#define agaw_to_width(val) (30 + val * LEVEL_STRIDE)

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#460: FILE: drivers/pci/intel-iommu.c:234:
+#define width_to_agaw(w)  ((w - 30)/LEVEL_STRIDE)
                                    ^

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'w' may be better as '(w)' to avoid precedence issues
#460: FILE: drivers/pci/intel-iommu.c:234:
+#define width_to_agaw(w)  ((w - 30)/LEVEL_STRIDE)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'l' may be better as '(l)' to avoid precedence issues
#461: FILE: drivers/pci/intel-iommu.c:235:
+#define level_to_offset_bits(l) (12 + (l - 1) * LEVEL_STRIDE)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'addr' may be better as '(addr)' to avoid precedence issues
#462: FILE: drivers/pci/intel-iommu.c:236:
+#define address_level_offset(addr, level) \
+	((addr >> level_to_offset_bits(level)) & LEVEL_MASK)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'addr' may be better as '(addr)' to avoid precedence issues
#466: FILE: drivers/pci/intel-iommu.c:240:
+#define align_to_level(addr, l) ((addr + level_size(l) - 1) & level_mask(l))

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'l' - possible side-effects?
#466: FILE: drivers/pci/intel-iommu.c:240:
+#define align_to_level(addr, l) ((addr + level_size(l) - 1) & level_mask(l))

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#467: FILE: drivers/pci/intel-iommu.c:241:
+static struct dma_pte * addr_to_dma_pte(struct domain *domain, u64 addr)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#475: FILE: drivers/pci/intel-iommu.c:249:
+	BUG_ON(!domain->pgd);

BUG() or BUG_ON() should be avoided totally.
Use WARN() and WARN_ON() instead, and handle the "impossible"
error condition as gracefully as possible.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#516: FILE: drivers/pci/intel-iommu.c:290:
+static struct dma_pte *dma_addr_level_pte(struct domain *domain, u64 addr,
+		int level)

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#591: FILE: drivers/pci/intel-iommu.c:365:
+				free_pgtable_page(

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'iommu' may be better as '(iommu)' to avoid precedence issues
#626: FILE: drivers/pci/intel-iommu.c:400:
+#define IOMMU_WAIT_OP(iommu, offset, op, cond, sts) \
+{\
+	unsigned long start_time = jiffies;\
+	while (1) {\
+		sts = op (iommu->reg, offset);\
+		if (cond)\
+			break;\
+		if (time_after(jiffies, start_time + DMAR_OPERATION_TIMEOUT))\
+			panic("DMAR hardware is malfunctional, please disable IOMMU\n");\
+		cpu_relax();\
+	}\
+}

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#630: FILE: drivers/pci/intel-iommu.c:404:
+		sts = op (iommu->reg, offset);\

ERROR:SPACING: space required after that close brace '}'
#636: FILE: drivers/pci/intel-iommu.c:410:
+	}\

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#679: FILE: drivers/pci/intel-iommu.c:453:
+static int __iommu_flush_context(struct intel_iommu *iommu,
+	u16 did, u16 source_id, u8 function_mask, u64 type,

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#694: FILE: drivers/pci/intel-iommu.c:468:
+			return 1;
+		else

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#698: FILE: drivers/pci/intel-iommu.c:472:
+	switch (type)
+	{

The opening brace should be following the function definitions on the
next line.  For any non-functional block it should be on the same line
as the last construct.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#704: FILE: drivers/pci/intel-iommu.c:478:
+		val = DMA_CCMD_DOMAIN_INVL|DMA_CCMD_DID(did);
 		                          ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#707: FILE: drivers/pci/intel-iommu.c:481:
+		val = DMA_CCMD_DEVICE_INVL|DMA_CCMD_DID(did)
 		                          ^

CHECK:SPACING: spaces preferred around that '|' (ctx:ExV)
#708: FILE: drivers/pci/intel-iommu.c:482:
+			|DMA_CCMD_SID(source_id)|DMA_CCMD_FM(function_mask);
 			^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#708: FILE: drivers/pci/intel-iommu.c:482:
+			|DMA_CCMD_SID(source_id)|DMA_CCMD_FM(function_mask);
 			                        ^

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#711: FILE: drivers/pci/intel-iommu.c:485:
+		BUG();

WARNING:TYPO_SPELLING: 'implictly' may be misspelled - perhaps 'implicitly'?
#723: FILE: drivers/pci/intel-iommu.c:497:
+	/* flush context entry will implictly flush write buffer */
 	                            ^^^^^^^^^

ERROR:INLINE_LOCATION: inline keyword should sit between storage class and type
#727: FILE: drivers/pci/intel-iommu.c:501:
+static int inline iommu_flush_context_global(struct intel_iommu *iommu,

The inline keyword should sit between storage class and type.

For example, the following segment::

  inline static int example_function(void)
  {
          ...
  }

should be::

  static inline int example_function(void)
  {
          ...
  }

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#728: FILE: drivers/pci/intel-iommu.c:502:
+static int inline iommu_flush_context_global(struct intel_iommu *iommu,
+	int non_present_entry_flush)

ERROR:INLINE_LOCATION: inline keyword should sit between storage class and type
#734: FILE: drivers/pci/intel-iommu.c:508:
+static int inline iommu_flush_context_domain(struct intel_iommu *iommu, u16 did,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#735: FILE: drivers/pci/intel-iommu.c:509:
+static int inline iommu_flush_context_domain(struct intel_iommu *iommu, u16 did,
+	int non_present_entry_flush)

ERROR:INLINE_LOCATION: inline keyword should sit between storage class and type
#741: FILE: drivers/pci/intel-iommu.c:515:
+static int inline iommu_flush_context_device(struct intel_iommu *iommu,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#742: FILE: drivers/pci/intel-iommu.c:516:
+static int inline iommu_flush_context_device(struct intel_iommu *iommu,
+	u16 did, u16 source_id, u8 function_mask, int non_present_entry_flush)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#750: FILE: drivers/pci/intel-iommu.c:524:
+static int __iommu_flush_iotlb(struct intel_iommu *iommu, u16 did,
+	u64 addr, unsigned int size_order, u64 type,

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#766: FILE: drivers/pci/intel-iommu.c:540:
+			return 1;
+		else

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#773: FILE: drivers/pci/intel-iommu.c:547:
+		val = DMA_TLB_GLOBAL_FLUSH|DMA_TLB_IVT;
 		                          ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#776: FILE: drivers/pci/intel-iommu.c:550:
+		val = DMA_TLB_DSI_FLUSH|DMA_TLB_IVT|DMA_TLB_DID(did);
 		                       ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#776: FILE: drivers/pci/intel-iommu.c:550:
+		val = DMA_TLB_DSI_FLUSH|DMA_TLB_IVT|DMA_TLB_DID(did);
 		                                   ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#779: FILE: drivers/pci/intel-iommu.c:553:
+		val = DMA_TLB_PSI_FLUSH|DMA_TLB_IVT|DMA_TLB_DID(did);
 		                       ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#779: FILE: drivers/pci/intel-iommu.c:553:
+		val = DMA_TLB_PSI_FLUSH|DMA_TLB_IVT|DMA_TLB_DID(did);
 		                                   ^

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#784: FILE: drivers/pci/intel-iommu.c:558:
+		BUG();

WARNING:IF_0: Consider removing the code enclosed by this #if 0 and its #endif
#787: FILE: drivers/pci/intel-iommu.c:561:
+#if 0

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#811: FILE: drivers/pci/intel-iommu.c:585:
+		printk(KERN_ERR"IOMMU: flush IOTLB failed\n");

CHECK:CONCATENATED_STRING: Concatenated strings should use spaces between elements
#811: FILE: drivers/pci/intel-iommu.c:585:
+		printk(KERN_ERR"IOMMU: flush IOTLB failed\n");

WARNING:PRINTF_L: %Lx is non-standard C, use %llx
#813: FILE: drivers/pci/intel-iommu.c:587:
+		pr_debug("IOMMU: tlb flush request %Lx, actual %Lx\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#814: FILE: drivers/pci/intel-iommu.c:588:
+		pr_debug("IOMMU: tlb flush request %Lx, actual %Lx\n",
+			DMA_TLB_IIRG(type), DMA_TLB_IAIG(val));

WARNING:TYPO_SPELLING: 'implictly' may be misspelled - perhaps 'implicitly'?
#815: FILE: drivers/pci/intel-iommu.c:589:
+	/* flush context entry will implictly flush write buffer */
 	                            ^^^^^^^^^

ERROR:INLINE_LOCATION: inline keyword should sit between storage class and type
#819: FILE: drivers/pci/intel-iommu.c:593:
+static int inline iommu_flush_iotlb_global(struct intel_iommu *iommu,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#820: FILE: drivers/pci/intel-iommu.c:594:
+static int inline iommu_flush_iotlb_global(struct intel_iommu *iommu,
+	int non_present_entry_flush)

ERROR:INLINE_LOCATION: inline keyword should sit between storage class and type
#826: FILE: drivers/pci/intel-iommu.c:600:
+static int inline iommu_flush_iotlb_dsi(struct intel_iommu *iommu, u16 did,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#827: FILE: drivers/pci/intel-iommu.c:601:
+static int inline iommu_flush_iotlb_dsi(struct intel_iommu *iommu, u16 did,
+	int non_present_entry_flush)

ERROR:INLINE_LOCATION: inline keyword should sit between storage class and type
#833: FILE: drivers/pci/intel-iommu.c:607:
+static int inline get_alignment(u64 base, unsigned int size)

ERROR:INLINE_LOCATION: inline keyword should sit between storage class and type
#847: FILE: drivers/pci/intel-iommu.c:621:
+static int inline iommu_flush_iotlb_psi(struct intel_iommu *iommu, u16 did,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#848: FILE: drivers/pci/intel-iommu.c:622:
+static int inline iommu_flush_iotlb_psi(struct intel_iommu *iommu, u16 did,
+	u64 addr, unsigned int pages, int non_present_entry_flush)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#852: FILE: drivers/pci/intel-iommu.c:626:
+	BUG_ON(addr & (~PAGE_MASK_4K));

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#853: FILE: drivers/pci/intel-iommu.c:627:
+	BUG_ON(pages == 0);

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#883: FILE: drivers/pci/intel-iommu.c:657:
+	dmar_writel(iommu->reg, DMAR_GCMD_REG, iommu->gcmd|DMA_GCMD_TE);
 	                                                  ^

ERROR:SPACING: space prohibited after that '~' (ctx:WxW)
#899: FILE: drivers/pci/intel-iommu.c:673:
+	iommu->gcmd &= ~ DMA_GCMD_TE;
 	               ^

WARNING:TYPO_SPELLING: 'supportd' may be misspelled - perhaps 'supported'?
#915: FILE: drivers/pci/intel-iommu.c:689:
+	pr_debug("Number of Domains supportd <%ld>\n", ndomains);
 	                            ^^^^^^^^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#921: FILE: drivers/pci/intel-iommu.c:695:
+		printk(KERN_ERR "Allocating domain id array failed\n");

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#921: FILE: drivers/pci/intel-iommu.c:695:
+	if (!iommu->domain_ids) {
+		printk(KERN_ERR "Allocating domain id array failed\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#926: FILE: drivers/pci/intel-iommu.c:700:
+		printk(KERN_ERR "Allocating domain array failed\n");

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#926: FILE: drivers/pci/intel-iommu.c:700:
+	if (!iommu->domains) {
+		printk(KERN_ERR "Allocating domain array failed\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#952: FILE: drivers/pci/intel-iommu.c:726:
+		printk(KERN_ERR "IOMMU: can't map the region\n");

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#960: FILE: drivers/pci/intel-iommu.c:734:
+	map_size = max_t(int, ecap_max_iotlb_offset(iommu->ecap),
+		cap_max_fault_reg_offset(iommu->cap));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#966: FILE: drivers/pci/intel-iommu.c:740:
+			printk(KERN_ERR "IOMMU: can't map the region\n");

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#973: FILE: drivers/pci/intel-iommu.c:747:
+	pr_debug("IOMMU %llx: ver %d:%d cap %llx ecap %llx\n",
+		drhd->reg_base_addr, VER_MAJOR(ver), VER_MINOR(ver),

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'iommu' - possible side-effects?
#991: FILE: drivers/pci/intel-iommu.c:765:
+#define iommu_for_each_domain_id(iommu, i) \
+for (i = find_first_bit(iommu->domain_ids, cap_ndoms(iommu->cap)); \
+	i < cap_ndoms(iommu->cap); \
+	i = find_next_bit(iommu->domain_ids, cap_ndoms(iommu->cap), i+1))

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'iommu' may be better as '(iommu)' to avoid precedence issues
#991: FILE: drivers/pci/intel-iommu.c:765:
+#define iommu_for_each_domain_id(iommu, i) \
+for (i = find_first_bit(iommu->domain_ids, cap_ndoms(iommu->cap)); \
+	i < cap_ndoms(iommu->cap); \
+	i = find_next_bit(iommu->domain_ids, cap_ndoms(iommu->cap), i+1))

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'i' - possible side-effects?
#991: FILE: drivers/pci/intel-iommu.c:765:
+#define iommu_for_each_domain_id(iommu, i) \
+for (i = find_first_bit(iommu->domain_ids, cap_ndoms(iommu->cap)); \
+	i < cap_ndoms(iommu->cap); \
+	i = find_next_bit(iommu->domain_ids, cap_ndoms(iommu->cap), i+1))

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#994: FILE: drivers/pci/intel-iommu.c:768:
+	i = find_next_bit(iommu->domain_ids, cap_ndoms(iommu->cap), i+1))
 	                                                             ^

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#1031: FILE: drivers/pci/intel-iommu.c:805:
+static struct domain * iommu_alloc_domain(struct intel_iommu *iommu)

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1049: FILE: drivers/pci/intel-iommu.c:823:
+		printk(KERN_ERR "IOMMU: no free domain ids\n");

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1082: FILE: drivers/pci/intel-iommu.c:856:
+		pr_debug("Start %lx, end %lx\n",
+			iova->pfn_lo, iova->pfn_hi);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1099: FILE: drivers/pci/intel-iommu.c:873:
+	iova = reserve_iova(&reserved_iova_list, IOVA_PFN(IOAPIC_RANGE_START),
+		IOVA_PFN(IOAPIC_RANGE_END));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1101: FILE: drivers/pci/intel-iommu.c:875:
+		printk(KERN_ERR "Reserve IOAPIC range failed\n");

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1116: FILE: drivers/pci/intel-iommu.c:890:
+			iova = reserve_iova(&reserved_iova_list, IOVA_PFN(addr),
+				IOVA_PFN(size + addr) - 1);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1118: FILE: drivers/pci/intel-iommu.c:892:
+				printk(KERN_ERR "Reserve iova failed\n");

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1184: FILE: drivers/pci/intel-iommu.c:958:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1216: FILE: drivers/pci/intel-iommu.c:990:
+	BUG_ON(!domain->pgd);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1236: FILE: drivers/pci/intel-iommu.c:1010:
+	if (iommu_flush_context_device(iommu, domain->id,
+			(((u16)bus) << 8) | devfn, DMA_CCMD_MASK_NOBIT, 1))

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1251: FILE: drivers/pci/intel-iommu.c:1025:
+	ret = domain_context_mapping_one(domain, pdev->bus->number,
+		pdev->devfn);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1263: FILE: drivers/pci/intel-iommu.c:1037:
+		ret = domain_context_mapping_one(domain, parent->bus->number,
+			parent->devfn);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1292: FILE: drivers/pci/intel-iommu.c:1066:
+		ret = device_context_mapped(domain->iommu, parent->bus->number,
+			parent->devfn);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1307: FILE: drivers/pci/intel-iommu.c:1081:
+domain_page_mapping(struct domain *domain, dma_addr_t iova,
+			u64 hpa, size_t size, int prot)

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1313: FILE: drivers/pci/intel-iommu.c:1087:
+	if ((prot & (DMA_PTE_READ|DMA_PTE_WRITE)) == 0)
 	                         ^

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1324: FILE: drivers/pci/intel-iommu.c:1098:
+		BUG_ON(dma_pte_addr(*pte));

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1334: FILE: drivers/pci/intel-iommu.c:1108:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1350: FILE: drivers/pci/intel-iommu.c:1124:
+		info = list_entry(domain->devices.next,
+			struct device_domain_info, link);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1382: FILE: drivers/pci/intel-iommu.c:1156:
+static int dmar_pci_device_match(struct pci_dev *devices[], int cnt,
+			     struct pci_dev *dev)

ERROR:SPACING: space prohibited before that '++' (ctx:WxB)
#1387: FILE: drivers/pci/intel-iommu.c:1161:
+		for (index = 0; index < cnt; index ++)
 		                                   ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1405: FILE: drivers/pci/intel-iommu.c:1179:
+		if (drhd->include_all || dmar_pci_device_match(drhd->devices,
+						drhd->devices_cnt, dev))

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1412: FILE: drivers/pci/intel-iommu.c:1186:
+
+

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1455: FILE: drivers/pci/intel-iommu.c:1229:
+		printk(KERN_ERR "IOMMU: can't find DMAR for device %s\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1456: FILE: drivers/pci/intel-iommu.c:1230:
+		printk(KERN_ERR "IOMMU: can't find DMAR for device %s\n",
+			pci_name(pdev));

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1514: FILE: drivers/pci/intel-iommu.c:1288:
+	if ((found = find_domain(pdev)) != NULL) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1540: FILE: drivers/pci/intel-iommu.c:1314:
+	printk(KERN_INFO

WARNING:PRINTF_L: %Lx is non-standard C, use %llx
#1541: FILE: drivers/pci/intel-iommu.c:1315:
+		"IOMMU: Setting identity map for device %s [0x%Lx - 0x%Lx]\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1553: FILE: drivers/pci/intel-iommu.c:1327:
+	if (!reserve_iova(&domain->iovad, IOVA_PFN(base),
+			IOVA_PFN(base + size) - 1)) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1554: FILE: drivers/pci/intel-iommu.c:1328:
+		printk(KERN_ERR "IOMMU: reserve iova failed\n");

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1560: FILE: drivers/pci/intel-iommu.c:1334:
+	pr_debug("Mapping reserved region %lx@%llx for %s\n",
+		size, base, pci_name(pdev));

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1568: FILE: drivers/pci/intel-iommu.c:1342:
+	ret = domain_page_mapping(domain, base, base, size,
+		DMA_PTE_READ|DMA_PTE_WRITE);

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1568: FILE: drivers/pci/intel-iommu.c:1342:
+		DMA_PTE_READ|DMA_PTE_WRITE);
 		            ^

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#1580: FILE: drivers/pci/intel-iommu.c:1354:
+
+}

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1583: FILE: drivers/pci/intel-iommu.c:1357:
+static inline int iommu_prepare_rmrr_dev(struct dmar_rmrr_unit *rmrr,
+	struct pci_dev *pdev)

WARNING:TYPO_SPELLING: 'amoung' may be misspelled - perhaps 'among'?
#1617: FILE: drivers/pci/intel-iommu.c:1391:
+		 * amoung all IOMMU's. Need to Split it later.
 		   ^^^^^^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1621: FILE: drivers/pci/intel-iommu.c:1395:
+			printk(KERN_ERR "IOMMU: allocate root entry failed\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1643: FILE: drivers/pci/intel-iommu.c:1417:
+			printk(KERN_ERR "IOMMU: mapping reserved region failed\n");

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#1644: FILE: drivers/pci/intel-iommu.c:1418:
+	end_for_each_rmrr_device(rmrr, pdev)
[...]
+	for_each_drhd_unit(drhd) {

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1657: FILE: drivers/pci/intel-iommu.c:1431:
+		sprintf (iommu->name, "dmar%d", unit++);

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'host_addr' may be better as '(host_addr)' to avoid precedence issues
#1682: FILE: drivers/pci/intel-iommu.c:1456:
+#define aligned_size(host_addr, size) \
+	PAGE_ALIGN_4K((host_addr & (~PAGE_MASK_4K)) + size)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'size' may be better as '(size)' to avoid precedence issues
#1682: FILE: drivers/pci/intel-iommu.c:1456:
+#define aligned_size(host_addr, size) \
+	PAGE_ALIGN_4K((host_addr & (~PAGE_MASK_4K)) + size)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1686: FILE: drivers/pci/intel-iommu.c:1460:
+iommu_alloc_iova(struct domain *domain, void *host_addr, size_t size,
+		u64 start, u64 end)

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around 'start > DOMAIN_MAX_ADDR(domain->gaw)'
#1692: FILE: drivers/pci/intel-iommu.c:1466:
+	if ((start > DOMAIN_MAX_ADDR(domain->gaw)) || end < start)

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1706: FILE: drivers/pci/intel-iommu.c:1480:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1709: FILE: drivers/pci/intel-iommu.c:1483:
+static dma_addr_t __intel_map_single(struct device *dev, void *addr,
+	size_t size, int dir, u64 *flush_addr, unsigned int *flush_size)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1721: FILE: drivers/pci/intel-iommu.c:1495:
+	domain = get_domain_for_dev(pdev,
+			DEFAULT_DOMAIN_ADDRESS_WIDTH);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1723: FILE: drivers/pci/intel-iommu.c:1497:
+		printk(KERN_ERR"Allocating domain for %s failed", pci_name(pdev));

CHECK:CONCATENATED_STRING: Concatenated strings should use spaces between elements
#1723: FILE: drivers/pci/intel-iommu.c:1497:
+		printk(KERN_ERR"Allocating domain for %s failed", pci_name(pdev));

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1731: FILE: drivers/pci/intel-iommu.c:1505:
+		iova = iommu_alloc_iova(domain, addr, size, start_addr,
+			pdev->dma_mask);

WARNING:TYPO_SPELLING: 'higer' may be misspelled - perhaps 'higher'?
#1736: FILE: drivers/pci/intel-iommu.c:1510:
+		 * from higer range
 		        ^^^^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1739: FILE: drivers/pci/intel-iommu.c:1513:
+		iova = iommu_alloc_iova(domain, addr, size, start_addr,
+			DMA_32BIT_MASK);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1742: FILE: drivers/pci/intel-iommu.c:1516:
+			iova = iommu_alloc_iova(domain, addr, size, start_addr,
+			pdev->dma_mask);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1746: FILE: drivers/pci/intel-iommu.c:1520:
+		printk(KERN_ERR"Allocating iova for %s failed", pci_name(pdev));

CHECK:CONCATENATED_STRING: Concatenated strings should use spaces between elements
#1746: FILE: drivers/pci/intel-iommu.c:1520:
+		printk(KERN_ERR"Allocating iova for %s failed", pci_name(pdev));

WARNING:LINE_CONTINUATIONS: Avoid unnecessary line continuations
#1761: FILE: drivers/pci/intel-iommu.c:1535:
+	if (dir == DMA_TO_DEVICE || dir == DMA_BIDIRECTIONAL || \

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1773: FILE: drivers/pci/intel-iommu.c:1547:
+	ret = domain_page_mapping(domain, iova->pfn_lo << PAGE_SHIFT_4K,
+		((u64)addr) & PAGE_MASK_4K,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1779: FILE: drivers/pci/intel-iommu.c:1553:
+	pr_debug("Device %s request: %lx@%llx mapping: %lx@%llx, dir %d\n",
+		pci_name(pdev), size, (u64)addr,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1788: FILE: drivers/pci/intel-iommu.c:1562:
+	printk(KERN_ERR"Device %s request: %lx@%llx dir %d --- failed\n",

CHECK:CONCATENATED_STRING: Concatenated strings should use spaces between elements
#1788: FILE: drivers/pci/intel-iommu.c:1562:
+	printk(KERN_ERR"Device %s request: %lx@%llx dir %d --- failed\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1789: FILE: drivers/pci/intel-iommu.c:1563:
+	printk(KERN_ERR"Device %s request: %lx@%llx dir %d --- failed\n",
+		pci_name(pdev), size, (u64)addr, dir);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1794: FILE: drivers/pci/intel-iommu.c:1568:
+static dma_addr_t intel_map_single(struct device *hwdev, void *addr,
+	size_t size, int dir)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1802: FILE: drivers/pci/intel-iommu.c:1576:
+	BUG_ON(dir == DMA_NONE);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1811: FILE: drivers/pci/intel-iommu.c:1585:
+		if (iommu_flush_iotlb_psi(domain->iommu, domain->id,
+				flush_addr, flush_size >> PAGE_SHIFT_4K, 1))

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1818: FILE: drivers/pci/intel-iommu.c:1592:
+static void __intel_unmap_single(struct device *dev, dma_addr_t dev_addr,
+	size_t size, int dir, u64 *flush_addr, unsigned int *flush_size)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1825: FILE: drivers/pci/intel-iommu.c:1599:
+	BUG_ON(!domain);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1833: FILE: drivers/pci/intel-iommu.c:1607:
+	pr_debug("Device %s unmapping: %lx@%llx\n",
+		pci_name(pdev), (iova->pfn_hi - iova->pfn_lo + 1) << PAGE_SHIFT_4K,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1847: FILE: drivers/pci/intel-iommu.c:1621:
+static void intel_unmap_single(struct device *dev, dma_addr_t dev_addr,
+	size_t size, int dir)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1862: FILE: drivers/pci/intel-iommu.c:1636:
+	if (iommu_flush_iotlb_psi(domain->iommu, domain->id, flush_addr,
+			flush_size >> PAGE_SHIFT_4K, 0))

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#1866: FILE: drivers/pci/intel-iommu.c:1640:
+static void * intel_alloc_coherent(struct device *hwdev, size_t size,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1867: FILE: drivers/pci/intel-iommu.c:1641:
+static void * intel_alloc_coherent(struct device *hwdev, size_t size,
+		       dma_addr_t *dma_handle, gfp_t flags)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1889: FILE: drivers/pci/intel-iommu.c:1663:
+static void intel_free_coherent(struct device *hwdev, size_t size,
+	void *vaddr, dma_addr_t dma_handle)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1901: FILE: drivers/pci/intel-iommu.c:1675:
+static void intel_unmap_sg(struct device *hwdev, struct scatterlist *sg,
+	int nelems, int dir)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1915: FILE: drivers/pci/intel-iommu.c:1689:
+		__intel_unmap_single(hwdev, sg->dma_address,
+			sg->dma_length, dir, &flush_addr, &flush_size);

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'sg' - possible side-effects?
#1921: FILE: drivers/pci/intel-iommu.c:1695:
+#define SG_ENT_VIRT_ADDRESS(sg)	(page_address((sg)->page) + (sg)->offset)

ERROR:POINTER_LOCATION: "foo* bar" should be "foo *bar"
#1922: FILE: drivers/pci/intel-iommu.c:1696:
+static int intel_nontranslate_map_sg(struct device* hddev,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1923: FILE: drivers/pci/intel-iommu.c:1697:
+static int intel_nontranslate_map_sg(struct device* hddev,
+	struct scatterlist *sg, int nelems, int dir)

ERROR:CODE_INDENT: code indent should use tabs where possible
#1927: FILE: drivers/pci/intel-iommu.c:1701:
+ ^Ifor (i = 0; i < nelems; i++) {$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#1927: FILE: drivers/pci/intel-iommu.c:1701:
+ ^Ifor (i = 0; i < nelems; i++) {$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#1927: FILE: drivers/pci/intel-iommu.c:1701:
+ ^Ifor (i = 0; i < nelems; i++) {$

WARNING:LINE_SPACING: Missing a blank line after declarations
#1929: FILE: drivers/pci/intel-iommu.c:1703:
+		struct scatterlist *s = &sg[i];
+		BUG_ON(!s->page);

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1929: FILE: drivers/pci/intel-iommu.c:1703:
+		BUG_ON(!s->page);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1937: FILE: drivers/pci/intel-iommu.c:1711:
+static int intel_map_sg(struct device *hwdev, struct scatterlist *sg,
+	int nelems, int dir)

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1947: FILE: drivers/pci/intel-iommu.c:1721:
+	BUG_ON(dir == DMA_NONE);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1954: FILE: drivers/pci/intel-iommu.c:1728:
+		dma_handle = __intel_map_single(hwdev, addr,
+				sg->length, dir, &flush_addr, &flush_size);

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#2000: FILE: drivers/pci/intel-iommu.c:1774:
+{
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#2034: FILE: drivers/pci/intel-iommu.c:1808:
+	int ret;
+	ret = iommu_iova_pool_init();

WARNING:BRACES: braces {} are not necessary for single statement blocks
#2071: FILE: drivers/pci/intel-iommu.c:1845:
+	if (early_dmar_detect()) {
+		iommu_detected = 1;
+	}

WARNING:LINE_SPACING: Missing a blank line after declarations
#2083: FILE: drivers/pci/intel-iommu.c:1857:
+			int i;
+			for (i=0; i < drhd->devices_cnt; i++)

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2083: FILE: drivers/pci/intel-iommu.c:1857:
+			for (i=0; i < drhd->devices_cnt; i++)
 			      ^

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "drhd->devices[i]"
#2084: FILE: drivers/pci/intel-iommu.c:1858:
+				if (drhd->devices[i] != NULL)

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

WARNING:LINE_SPACING: Missing a blank line after declarations
#2096: FILE: drivers/pci/intel-iommu.c:1870:
+		int i;
+		if (drhd->ignored || drhd->include_all)

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#2124: FILE: drivers/pci/intel-iommu.c:1898:
+^I^Ireturn ^I-ENODEV;$

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#2133: FILE: drivers/pci/intel-iommu.c:1907:
+		printk(KERN_ERR "IOMMU: dmar init failed\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#2138: FILE: drivers/pci/intel-iommu.c:1912:
+	printk(KERN_INFO

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#2150: FILE: drivers/pci/intel-iommu.h:1:
+/*

ERROR:FSF_MAILING_ADDRESS: Do not include the paragraph about writing to the Free Software Foundation's mailing address from the sample GPL notice. The FSF has changed addresses in the past, and may do so again. Linux already includes a copy of the GPL.
#2163: FILE: drivers/pci/intel-iommu.h:14:
+ * this program; if not, write to the Free Software Foundation, Inc., 59 Temple$

WARNING:INCLUDE_LINUX: Use #include <linux/io.h> instead of <asm/io.h>
#2175: FILE: drivers/pci/intel-iommu.h:26:
+#include <asm/io.h>

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'dmar' may be better as '(dmar)' to avoid precedence issues
#2201: FILE: drivers/pci/intel-iommu.h:52:
+#define dmar_readl(dmar, reg) readl(dmar + reg)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'reg' may be better as '(reg)' to avoid precedence issues
#2201: FILE: drivers/pci/intel-iommu.h:52:
+#define dmar_readl(dmar, reg) readl(dmar + reg)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'dmar' may be better as '(dmar)' to avoid precedence issues
#2202: FILE: drivers/pci/intel-iommu.h:53:
+#define dmar_writel(dmar, reg, val) writel((val), dmar + reg)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'reg' may be better as '(reg)' to avoid precedence issues
#2202: FILE: drivers/pci/intel-iommu.h:53:
+#define dmar_writel(dmar, reg, val) writel((val), dmar + reg)

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'dmar' - possible side-effects?
#2203: FILE: drivers/pci/intel-iommu.h:54:
+#define dmar_readq(dmar, reg) ({ \
+		u32 lo, hi; \
+		lo = dmar_readl(dmar, reg); \
+		hi = dmar_readl(dmar, reg + 4); \
+		(((u64) hi) << 32) + lo; })

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'reg' - possible side-effects?
#2203: FILE: drivers/pci/intel-iommu.h:54:
+#define dmar_readq(dmar, reg) ({ \
+		u32 lo, hi; \
+		lo = dmar_readl(dmar, reg); \
+		hi = dmar_readl(dmar, reg + 4); \
+		(((u64) hi) << 32) + lo; })

CHECK:SPACING: No space is necessary after a cast
#2207: FILE: drivers/pci/intel-iommu.h:58:
+		(((u64) hi) << 32) + lo; })

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'dmar' - possible side-effects?
#2208: FILE: drivers/pci/intel-iommu.h:59:
+#define dmar_writeq(dmar, reg, val) do {\
+		dmar_writel(dmar, reg, (u32)(val)); \
+		dmar_writel(dmar, reg + 4, (u32)((val) >> 32)); \
+	} while (0)

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'reg' - possible side-effects?
#2208: FILE: drivers/pci/intel-iommu.h:59:
+#define dmar_writeq(dmar, reg, val) do {\
+		dmar_writel(dmar, reg, (u32)(val)); \
+		dmar_writel(dmar, reg + 4, (u32)((val) >> 32)); \
+	} while (0)

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'val' - possible side-effects?
#2208: FILE: drivers/pci/intel-iommu.h:59:
+#define dmar_writeq(dmar, reg, val) do {\
+		dmar_writel(dmar, reg, (u32)(val)); \
+		dmar_writel(dmar, reg + 4, (u32)((val) >> 32)); \
+	} while (0)

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'c' - possible side-effects?
#2230: FILE: drivers/pci/intel-iommu.h:81:
+#define cap_max_fault_reg_offset(c) \
+	(cap_fault_reg_offset(c) + cap_num_fault_regs(c) * 16)

WARNING:TYPECAST_INT_CONSTANT: Unnecessary typecast of c90 int constant - '(unsigned long)1' could be '1UL'
#2242: FILE: drivers/pci/intel-iommu.h:93:
+#define cap_ndoms(c)		(((unsigned long)1) << (4 + 2 * ((c) & 0x7)))

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#2248: FILE: drivers/pci/intel-iommu.h:99:
+#define ecap_iotlb_offset(e) ^I((((e) >> 8) & 0x3ff) * 16)$

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'e' - possible side-effects?
#2249: FILE: drivers/pci/intel-iommu.h:100:
+#define ecap_max_iotlb_offset(e) \
+	(ecap_iotlb_offset(e) + ecap_niotlb_iunits(e) * 16)

CHECK:LINE_SPACING: Please don't use multiple blank lines
#2253: FILE: drivers/pci/intel-iommu.h:104:
+
+

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'd' may be better as '(d)' to avoid precedence issues
#2304: FILE: drivers/pci/intel-iommu.h:155:
+#define dma_frcd_type(d) ((d >> 30) & 1)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'c' may be better as '(c)' to avoid precedence issues
#2305: FILE: drivers/pci/intel-iommu.h:156:
+#define dma_frcd_fault_reason(c) (c & 0xff)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'c' may be better as '(c)' to avoid precedence issues
#2306: FILE: drivers/pci/intel-iommu.h:157:
+#define dma_frcd_source_id(c) (c & 0xffff)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'd' may be better as '(d)' to avoid precedence issues
#2307: FILE: drivers/pci/intel-iommu.h:158:
+#define dma_frcd_page_addr(d) (d & (((u64)-1) << 12)) /* low 64 bit */

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#2319: FILE: drivers/pci/intel-iommu.h:170:
+};
+#define ROOT_ENTRY_NR (PAGE_SIZE_4K/sizeof(struct root_entry))

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#2319: FILE: drivers/pci/intel-iommu.h:170:
+#define ROOT_ENTRY_NR (PAGE_SIZE_4K/sizeof(struct root_entry))
                                    ^

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2321: FILE: drivers/pci/intel-iommu.h:172:
+#define set_root_present(root) do {(root).val |= 1;} while(0)
                                                   ^

ERROR:SPACING: space required before the open parenthesis '('
#2321: FILE: drivers/pci/intel-iommu.h:172:
+#define set_root_present(root) do {(root).val |= 1;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2321: FILE: drivers/pci/intel-iommu.h:172:
+#define set_root_present(root) do {(root).val |= 1;} while(0)

For the multi-statement macros, it is necessary to use the do-while
loop to avoid unpredictable code paths. The do-while loop helps to
group the multiple statements into a single one so that a
function-like macro can be used as a function only.

But for the single statement macros, it is unnecessary to use the
do-while loop. Although the code is syntactically correct but using
the do-while loop is redundant. So remove the do-while loop for single
statement macros.

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#2327: FILE: drivers/pci/intel-iommu.h:178:
+^Ireturn (struct context_entry *) (root_present(root)?phys_to_virt( ^I\$

CHECK:SPACING: No space is necessary after a cast
#2327: FILE: drivers/pci/intel-iommu.h:178:
+	return (struct context_entry *) (root_present(root)?phys_to_virt( 	\

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#2327: FILE: drivers/pci/intel-iommu.h:178:
+	return (struct context_entry *) (root_present(root)?phys_to_virt( 	\
 	                                                   ^

WARNING:LINE_CONTINUATIONS: Avoid unnecessary line continuations
#2327: FILE: drivers/pci/intel-iommu.h:178:
+	return (struct context_entry *) (root_present(root)?phys_to_virt( 	\

ERROR:SPACING: spaces required around that ':' (ctx:VxE)
#2328: FILE: drivers/pci/intel-iommu.h:179:
+		(root).val & PAGE_MASK_4K):					\
 		                          ^

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2332: FILE: drivers/pci/intel-iommu.h:183:
+#define set_root_value(root, value) \
+	do {(root).val |= ((value) & PAGE_MASK_4K);} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2333: FILE: drivers/pci/intel-iommu.h:184:
+	do {(root).val |= ((value) & PAGE_MASK_4K);} while(0)
 	                                          ^

ERROR:SPACING: space required before the open parenthesis '('
#2333: FILE: drivers/pci/intel-iommu.h:184:
+	do {(root).val |= ((value) & PAGE_MASK_4K);} while(0)

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#2350: FILE: drivers/pci/intel-iommu.h:201:
+};
+#define context_present(c) ((c).lo & 1)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2357: FILE: drivers/pci/intel-iommu.h:208:
+#define context_set_present(c) do {(c).lo |= 1;} while(0)
                                               ^

ERROR:SPACING: space required before the open parenthesis '('
#2357: FILE: drivers/pci/intel-iommu.h:208:
+#define context_set_present(c) do {(c).lo |= 1;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2357: FILE: drivers/pci/intel-iommu.h:208:
+#define context_set_present(c) do {(c).lo |= 1;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2358: FILE: drivers/pci/intel-iommu.h:209:
+#define context_set_fault_enable(c) \
+	do {(c).lo &= (((u64)-1) << 2) | 1;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2359: FILE: drivers/pci/intel-iommu.h:210:
+	do {(c).lo &= (((u64)-1) << 2) | 1;} while(0)
 	                                  ^

ERROR:SPACING: space required before the open parenthesis '('
#2359: FILE: drivers/pci/intel-iommu.h:210:
+	do {(c).lo &= (((u64)-1) << 2) | 1;} while(0)

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'c' - possible side-effects?
#2360: FILE: drivers/pci/intel-iommu.h:211:
+#define context_set_translation_type(c, val) do { \
+		(c).lo &= (((u64)-1) << 4) | 3; \
+		(c).lo |= ((val) & 3) << 2; \
+	} while(0)

ERROR:SPACING: space required before the open parenthesis '('
#2363: FILE: drivers/pci/intel-iommu.h:214:
+	} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2365: FILE: drivers/pci/intel-iommu.h:216:
+#define context_set_address_root(c, val) \
+	do {(c).lo |= (val) & PAGE_MASK_4K;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2366: FILE: drivers/pci/intel-iommu.h:217:
+	do {(c).lo |= (val) & PAGE_MASK_4K;} while(0)
 	                                  ^

ERROR:SPACING: space required before the open parenthesis '('
#2366: FILE: drivers/pci/intel-iommu.h:217:
+	do {(c).lo |= (val) & PAGE_MASK_4K;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2367: FILE: drivers/pci/intel-iommu.h:218:
+#define context_set_address_width(c, val) do {(c).hi |= (val) & 7;} while(0)
                                                                  ^

ERROR:SPACING: space required before the open parenthesis '('
#2367: FILE: drivers/pci/intel-iommu.h:218:
+#define context_set_address_width(c, val) do {(c).hi |= (val) & 7;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2367: FILE: drivers/pci/intel-iommu.h:218:
+#define context_set_address_width(c, val) do {(c).hi |= (val) & 7;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2368: FILE: drivers/pci/intel-iommu.h:219:
+#define context_set_domain_id(c, val) \
+	do {(c).hi |= ((val) & ((1 << 16) - 1)) << 8;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2369: FILE: drivers/pci/intel-iommu.h:220:
+	do {(c).hi |= ((val) & ((1 << 16) - 1)) << 8;} while(0)
 	                                            ^

ERROR:SPACING: space required before the open parenthesis '('
#2369: FILE: drivers/pci/intel-iommu.h:220:
+	do {(c).hi |= ((val) & ((1 << 16) - 1)) << 8;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2370: FILE: drivers/pci/intel-iommu.h:221:
+#define context_clear_entry(c) do {(c).lo = 0; (c).hi = 0;} while(0)
                                                          ^

ERROR:SPACING: space required before the open parenthesis '('
#2370: FILE: drivers/pci/intel-iommu.h:221:
+#define context_clear_entry(c) do {(c).lo = 0; (c).hi = 0;} while(0)

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'c' - possible side-effects?
#2370: FILE: drivers/pci/intel-iommu.h:221:
+#define context_clear_entry(c) do {(c).lo = 0; (c).hi = 0;} while(0)

WARNING:TYPO_SPELLING: 'physcial' may be misspelled - perhaps 'physical'?
#2378: FILE: drivers/pci/intel-iommu.h:229:
+ * 12-63: Host physcial address
                ^^^^^^^^

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#2383: FILE: drivers/pci/intel-iommu.h:234:
+};
+#define dma_clear_pte(p)	do {(p).val = 0;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2383: FILE: drivers/pci/intel-iommu.h:234:
+#define dma_clear_pte(p)	do {(p).val = 0;} while(0)
                         	               ^

ERROR:SPACING: space required before the open parenthesis '('
#2383: FILE: drivers/pci/intel-iommu.h:234:
+#define dma_clear_pte(p)	do {(p).val = 0;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2383: FILE: drivers/pci/intel-iommu.h:234:
+#define dma_clear_pte(p)	do {(p).val = 0;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2388: FILE: drivers/pci/intel-iommu.h:239:
+#define dma_set_pte_readable(p) do {(p).val |= DMA_PTE_READ;} while(0)
                                                            ^

ERROR:SPACING: space required before the open parenthesis '('
#2388: FILE: drivers/pci/intel-iommu.h:239:
+#define dma_set_pte_readable(p) do {(p).val |= DMA_PTE_READ;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2388: FILE: drivers/pci/intel-iommu.h:239:
+#define dma_set_pte_readable(p) do {(p).val |= DMA_PTE_READ;} while(0)

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2389: FILE: drivers/pci/intel-iommu.h:240:
+#define dma_set_pte_writable(p) do {(p).val |= DMA_PTE_WRITE;} while(0)
                                                             ^

ERROR:SPACING: space required before the open parenthesis '('
#2389: FILE: drivers/pci/intel-iommu.h:240:
+#define dma_set_pte_writable(p) do {(p).val |= DMA_PTE_WRITE;} while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2389: FILE: drivers/pci/intel-iommu.h:240:
+#define dma_set_pte_writable(p) do {(p).val |= DMA_PTE_WRITE;} while(0)

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'p' - possible side-effects?
#2390: FILE: drivers/pci/intel-iommu.h:241:
+#define dma_set_pte_prot(p, prot) do {\
+	(p).val = ((p).val & ~3) | ((prot) & 3); } while(0)

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2390: FILE: drivers/pci/intel-iommu.h:241:
+#define dma_set_pte_prot(p, prot) do {\
+	(p).val = ((p).val & ~3) | ((prot) & 3); } while(0)

ERROR:SPACING: space required before the open parenthesis '('
#2391: FILE: drivers/pci/intel-iommu.h:242:
+	(p).val = ((p).val & ~3) | ((prot) & 3); } while(0)

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2391: FILE: drivers/pci/intel-iommu.h:242:
+	(p).val = ((p).val & ~3) | ((prot) & 3); } while(0)

Trailing statements (for example after any conditional) should be
on the next line.
Statements, such as::

  if (x == y) break;

should be::

  if (x == y)
          break;

WARNING:SINGLE_STATEMENT_DO_WHILE_MACRO: Single statement macros should not use a do {} while (0) loop
#2393: FILE: drivers/pci/intel-iommu.h:244:
+#define dma_set_pte_addr(p, addr) do {\
+		(p).val |= ((addr) & PAGE_MASK_4K); } while(0)

ERROR:SPACING: space required before the open parenthesis '('
#2394: FILE: drivers/pci/intel-iommu.h:245:
+		(p).val |= ((addr) & PAGE_MASK_4K); } while(0)

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2394: FILE: drivers/pci/intel-iommu.h:245:
+		(p).val |= ((addr) & PAGE_MASK_4K); } while(0)

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#2403: FILE: drivers/pci/intel-iommu.h:254:
+^Istruct list_head devices; ^I/* all devices' list */$

WARNING:TYPO_SPELLING: 'numer' may be misspelled - perhaps 'number'?
#2419: FILE: drivers/pci/intel-iommu.h:270:
+	u8 bus;			/* PCI bus numer */
 	       			           ^^^^^

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#2425: FILE: drivers/pci/intel-iommu.h:276:
+extern int init_dmars(void);

Function prototypes don't need to be declared extern in .h
files.  It's assumed by the compiler and is unnecessary.

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#2431: FILE: drivers/pci/intel-iommu.h:282:
+^Iunsigned long ^I*domain_ids; /* bitmap of domains */$

WARNING:TYPO_SPELLING: 'TE' may be misspelled - perhaps 'THE'?
#2434: FILE: drivers/pci/intel-iommu.h:285:
+	u32		gcmd; /* Holds TE, EAFL. Don't need SRTP, SFL, WBF */
 	   		               ^^

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#2460: FILE: include/linux/dmar.h:32:
+extern void detect_intel_iommu(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#2461: FILE: include/linux/dmar.h:33:
+extern int intel_iommu_init(void);

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'rmrr' - possible side-effects?
#2474: FILE: include/linux/dmar.h:63:
+#define begin_for_each_rmrr_device(rmrr, pdev) \
+	for_each_rmrr_units(rmrr) { \
+		int _i; \
+		for (_i = 0; _i < rmrr->devices_cnt; _i++) { \
+			pdev = rmrr->devices[_i]; \
+			/* some BIOS lists non-exist devices in DMAR table */\
+			if (!pdev) \
+				continue;

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'pdev' - possible side-effects?
#2474: FILE: include/linux/dmar.h:63:
+#define begin_for_each_rmrr_device(rmrr, pdev) \
+	for_each_rmrr_units(rmrr) { \
+		int _i; \
+		for (_i = 0; _i < rmrr->devices_cnt; _i++) { \
+			pdev = rmrr->devices[_i]; \
+			/* some BIOS lists non-exist devices in DMAR table */\
+			if (!pdev) \
+				continue;

WARNING:TRAILING_SEMICOLON: macros should not use a trailing semicolon
#2474: FILE: include/linux/dmar.h:63:
+#define begin_for_each_rmrr_device(rmrr, pdev) \
+	for_each_rmrr_units(rmrr) { \
+		int _i; \
+		for (_i = 0; _i < rmrr->devices_cnt; _i++) { \
+			pdev = rmrr->devices[_i]; \
+			/* some BIOS lists non-exist devices in DMAR table */\
+			if (!pdev) \
+				continue;

Macro definition should not end with a semicolon. The macro
invocation style should be consistent with function calls.
This can prevent any unexpected code paths::

  #define MAC do_something;

If this macro is used within a if else statement, like::

  if (some_condition)
          MAC;

  else
          do_something;

Then there would be a compilation error, because when the macro is
expanded there are two trailing semicolons, so the else branch gets
orphaned.

See: https://lore.kernel.org/lkml/1399671106.2912.21.camel@joe-AO725/

ERROR:COMPLEX_MACRO: Macros with complex values should be enclosed in parentheses
#2482: FILE: include/linux/dmar.h:71:
+#define end_for_each_rmrr_device(rmrr, pdev) \
+		} \
+	}

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000422648.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 55 errors, 86 warnings, 129 checks, 2396 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000422648.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
