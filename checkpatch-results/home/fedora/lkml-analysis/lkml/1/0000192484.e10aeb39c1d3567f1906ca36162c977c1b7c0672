WARNING:COMMIT_LOG_LONG_LINE: Possible unwrapped commit description (prefer a maximum 75 chars per line)
#42: 
optimal already, though my results on Power show atomic_long is a bad choice

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#127: FILE: init/main.c:553:
+};
+struct local2 {

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#130: FILE: init/main.c:556:
+};
+struct local3 {

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#135: FILE: init/main.c:561:
+#define NUM_LOCAL_TEST (1024*1024)
                             ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#136: FILE: init/main.c:562:
+#define NUM_LOCAL_RUNS (NUM_LOCAL_TEST*32)
                                       ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#145: FILE: init/main.c:571:
+	unsigned long size;
+	size = max(sizeof(struct local1),

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#153: FILE: init/main.c:579:
+		printk("test_local_variants: failed to allocate %lu bytes\n",

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#165: FILE: init/main.c:591:
+	printk("%s=%lli/%lli ",

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#166: FILE: init/main.c:592:
+	       str, diff, diff/NUM_LOCAL_RUNS);
 	                      ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#172: FILE: init/main.c:598:
+	unsigned int i, total = 0;
+	for (i = 0; i < len; i++)

ERROR:MULTISTATEMENT_MACRO_USE_DO_WHILE: Macros with multiple statements should be enclosed in a do - while loop
#177: FILE: init/main.c:603:
+#define TEST_LOOP(expr)				\
+	n = 0;					\
+	getnstimeofday(&start);			\
+	for (i = 0; i < NUM_LOCAL_RUNS; i++) {	\
+		expr;				\
+		n += STRIDE;			\
+		n %= NUM_LOCAL_TEST;		\
+	}					\
+	getnstimeofday(&end);

Macros with multiple statements should be enclosed in a
do - while block.  Same should also be the case for macros
starting with `if` to avoid logic defects::

  #define macrofun(a, b, c)                 \
    do {                                    \
            if (a == 5)                     \
                    do_this(b, c);          \
    } while (0)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#macros-enums-and-rtl

WARNING:TRAILING_SEMICOLON: macros should not use a trailing semicolon
#177: FILE: init/main.c:603:
+#define TEST_LOOP(expr)				\
+	n = 0;					\
+	getnstimeofday(&start);			\
+	for (i = 0; i < NUM_LOCAL_RUNS; i++) {	\
+		expr;				\
+		n += STRIDE;			\
+		n %= NUM_LOCAL_TEST;		\
+	}					\
+	getnstimeofday(&end);

Macro definition should not end with a semicolon. The macro
invocation style should be consistent with function calls.
This can prevent any unexpected code paths::

  #define MAC do_something;

If this macro is used within a if else statement, like::

  if (some_condition)
          MAC;

  else
          do_something;

Then there would be a compilation error, because when the macro is
expanded there are two trailing semicolons, so the else branch gets
orphaned.

See: https://lore.kernel.org/lkml/1399671106.2912.21.camel@joe-AO725/

ERROR:TRAILING_WHITESPACE: trailing whitespace
#206: FILE: init/main.c:632:
+^I^I$

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#207: FILE: init/main.c:633:
+	printk("Running local_t variant benchmarks\n");

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#213: FILE: init/main.c:639:
+	printk("atomic_long: ");

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#214: FILE: init/main.c:640:
+	memset(l1, 0, sizeof(*l1)*NUM_LOCAL_TEST);
 	                         ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#218: FILE: init/main.c:644:
+	warm_total += warm_local_test_cache(l1, sizeof(*l1)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#222: FILE: init/main.c:648:
+	warm_total += warm_local_test_cache(l1, sizeof(*l1)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:SPACING: spaces preferred around that '%' (ctx:VxV)
#223: FILE: init/main.c:649:
+	TEST_LOOP(atomic_long_inc(&__get_cpu_var(local1_test)[n%NUM_PERCPU_VARS].v));
 	                                                       ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#226: FILE: init/main.c:652:
+	warm_total += warm_local_test_cache(l1, sizeof(*l1)*NUM_LOCAL_TEST);
 	                                                   ^

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#231: FILE: init/main.c:657:
+	printk("(total was %lu)\n", total);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#233: FILE: init/main.c:659:
+	printk("irqsave/restore: ");

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#234: FILE: init/main.c:660:
+	memset(l2, 0, sizeof(*l2)*NUM_LOCAL_TEST);
 	                         ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#241: FILE: init/main.c:667:
+	warm_total += warm_local_test_cache(l2, sizeof(*l2)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#248: FILE: init/main.c:674:
+	warm_total += warm_local_test_cache(l2, sizeof(*l2)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:SPACING: spaces preferred around that '%' (ctx:VxV)
#251: FILE: init/main.c:677:
+		  __get_cpu_var(local2_test)[n%NUM_PERCPU_VARS].v++;
 		                              ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#255: FILE: init/main.c:681:
+	warm_total += warm_local_test_cache(l2, sizeof(*l2)*NUM_LOCAL_TEST);
 	                                                   ^

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#259: FILE: init/main.c:685:
+	printk("(total was %lu)\n", total);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#261: FILE: init/main.c:687:
+	printk("trivalue: ");

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#262: FILE: init/main.c:688:
+	memset(l3, 0, sizeof(*l3)*NUM_LOCAL_TEST);
 	                         ^

CHECK:ASSIGNMENT_CONTINUATIONS: Assignment operator '=' should be on the previous line
#264: FILE: init/main.c:690:
+	TEST_LOOP(unsigned int idx
+			= !(preempt_count() & (HARDIRQ_MASK | SOFTIRQ_MASK)) +

Assignment operators should not be written at the start of a
line but should follow the operand at the previous line.

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#269: FILE: init/main.c:695:
+	warm_total += warm_local_test_cache(l3, sizeof(*l3)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:ASSIGNMENT_CONTINUATIONS: Assignment operator '=' should be on the previous line
#271: FILE: init/main.c:697:
+	TEST_LOOP(unsigned int idx
+			= !(preempt_count() & (HARDIRQ_MASK | SOFTIRQ_MASK)) +

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#276: FILE: init/main.c:702:
+	warm_total += warm_local_test_cache(l3, sizeof(*l3)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:ASSIGNMENT_CONTINUATIONS: Assignment operator '=' should be on the previous line
#278: FILE: init/main.c:704:
+	TEST_LOOP(unsigned int idx
+			= !(preempt_count() & (HARDIRQ_MASK | SOFTIRQ_MASK)) +

CHECK:SPACING: spaces preferred around that '%' (ctx:VxV)
#280: FILE: init/main.c:706:
+		  get_cpu_var(local3_test)[n%NUM_PERCPU_VARS].v[idx]++;
 		                            ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#284: FILE: init/main.c:710:
+	warm_total += warm_local_test_cache(l3, sizeof(*l3)*NUM_LOCAL_TEST);
 	                                                   ^

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#288: FILE: init/main.c:714:
+	printk("(total was %lu)\n", total);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#290: FILE: init/main.c:716:
+	printk("local_t: ");

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#291: FILE: init/main.c:717:
+	memset(l4, 0, sizeof(*l4)*NUM_LOCAL_TEST);
 	                         ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#295: FILE: init/main.c:721:
+	warm_total += warm_local_test_cache(l4, sizeof(*l4)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#299: FILE: init/main.c:725:
+	warm_total += warm_local_test_cache(l4, sizeof(*l4)*NUM_LOCAL_TEST);
 	                                                   ^

CHECK:SPACING: spaces preferred around that '%' (ctx:VxV)
#300: FILE: init/main.c:726:
+	TEST_LOOP(cpu_local_inc(local4_test[n%NUM_PERCPU_VARS]));
 	                                     ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#303: FILE: init/main.c:729:
+	warm_total += warm_local_test_cache(l4, sizeof(*l4)*NUM_LOCAL_TEST);
 	                                                   ^

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#307: FILE: init/main.c:733:
+	printk("(total was %lu, warm_total %lu)\n", total, warm_total);

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000192484.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 2 errors, 15 warnings, 28 checks, 242 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000192484.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
