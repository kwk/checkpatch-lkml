WARNING:TYPO_SPELLING: 'madatory' may be misspelled - perhaps 'mandatory'?
#72: FILE: security/smack/Kconfig:8:
+          of other madatory security schemes.
                    ^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#97: FILE: security/smack/smack_access.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "sp"
#120: FILE: security/smack/smack_access.c:24:
+	for (; sp != NULL; sp = sp->smk_next)

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

ERROR:TRAILING_WHITESPACE: trailing whitespace
#183: FILE: security/smack/smack_access.c:87:
+^I$

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:SPACING: space required after that ',' (ctx:OxV)
#200: FILE: security/smack/smack_access.c:104:
+	for (cp = (char *)&smack, i = 0; i < sizeof(smack_t); str++,cp++,i++) {
 	                                                           ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:SPACING: space required after that ',' (ctx:OxV)
#200: FILE: security/smack/smack_access.c:104:
+	for (cp = (char *)&smack, i = 0; i < sizeof(smack_t); str++,cp++,i++) {
 	                                                                ^

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#217: FILE: security/smack/smackfs.c:1:
+/*

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#221: FILE: security/smack/smackfs.c:5:
+ *  ^Iit under the terms of the GNU General Public License as published by$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#225: FILE: security/smack/smackfs.c:9:
+ * ^ICasey Schaufler <casey@schaufler-ca.com>$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#226: FILE: security/smack/smackfs.c:10:
+ * $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#228: FILE: security/smack/smackfs.c:12:
+ * $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#247: FILE: security/smack/smackfs.c:31:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#251: FILE: security/smack/smackfs.c:35:
+^ISMK_LINKS = ^I4,^I/* symlinks */$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#252: FILE: security/smack/smackfs.c:36:
+^ISMK_CIPSO = ^I5,^I/* load label -> CIPSO mapping */$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#253: FILE: security/smack/smackfs.c:37:
+^ISMK_DOI = ^I6,^I/* CIPSO DOI */$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#254: FILE: security/smack/smackfs.c:38:
+^ISMK_DIRECT = ^I7,^I/* CIPSO level indicating direct label */$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#255: FILE: security/smack/smackfs.c:39:
+^ISMK_AMBIENT = ^I8,^I/* internet ambient label */$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#256: FILE: security/smack/smackfs.c:40:
+^ISMK_NLTYPE = ^I9,^I/* label scheme to use by default */$

ERROR:CODE_INDENT: code indent should use tabs where possible
#282: FILE: security/smack/smackfs.c:66:
+        .smk_next = NULL,$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#282: FILE: security/smack/smackfs.c:66:
+        .smk_next = NULL,$

ERROR:CODE_INDENT: code indent should use tabs where possible
#283: FILE: security/smack/smackfs.c:67:
+        .smk_smack = SMK_FLOOR,$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#283: FILE: security/smack/smackfs.c:67:
+        .smk_smack = SMK_FLOOR,$

ERROR:CODE_INDENT: code indent should use tabs where possible
#284: FILE: security/smack/smackfs.c:68:
+        .smk_level = 0,$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#284: FILE: security/smack/smackfs.c:68:
+        .smk_level = 0,$

ERROR:CODE_INDENT: code indent should use tabs where possible
#285: FILE: security/smack/smackfs.c:69:
+        .smk_catset = 0LL,$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#285: FILE: security/smack/smackfs.c:69:
+        .smk_catset = 0LL,$

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#287: FILE: security/smack/smackfs.c:71:
+};
+struct smk_cipso_entry *smack_cipso = &smack_cipso_floor;

ERROR:TRAILING_WHITESPACE: trailing whitespace
#295: FILE: security/smack/smackfs.c:79:
+ * 'ssssssss oooooooo mmmm\n\0' $

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#299: FILE: security/smack/smackfs.c:83:
+static ssize_t smk_read_load(struct file *filp, char __user *buf,
                                           ^^^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#308: FILE: security/smack/smackfs.c:92:
+^I$

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!result"
#314: FILE: security/smack/smackfs.c:98:
+	if (result == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "slp"
#317: FILE: security/smack/smackfs.c:101:
+	for (cp = result; slp != NULL; slp = slp->smk_next) {

ERROR:TRAILING_WHITESPACE: trailing whitespace
#322: FILE: security/smack/smackfs.c:106:
+^I^Iif (srp->smk_access != 0) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#338: FILE: security/smack/smackfs.c:122:
+^I$

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "sp"
#358: FILE: security/smack/smackfs.c:142:
+	for (sp = smack_list; sp != NULL; sp = sp->smk_next)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!sp"
#365: FILE: security/smack/smackfs.c:149:
+	if (sp == NULL) {

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*newp)...) over kzalloc(sizeof(struct smk_list_entry)...)
#366: FILE: security/smack/smackfs.c:150:
+		newp = kzalloc(sizeof(struct smk_list_entry), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

WARNING:RETURN_VOID: void function return statements are not generally useful
#376: FILE: security/smack/smackfs.c:160:
+	return;
+}

CHECK:LINE_SPACING: Please don't use multiple blank lines
#378: FILE: security/smack/smackfs.c:162:
+
+

CHECK:LINE_SPACING: Please don't use multiple blank lines
#388: FILE: security/smack/smackfs.c:172:
+
+

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!data"
#404: FILE: security/smack/smackfs.c:188:
+	if (data == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "cp"
#414: FILE: security/smack/smackfs.c:198:
+	for (cp = data - 1; cp != NULL; cp = strchr(cp + 1, '\n')) {

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#420: FILE: security/smack/smackfs.c:204:
+			printk("%s:%d bad scan\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#421: FILE: security/smack/smackfs.c:205:
+			printk("%s:%d bad scan\n",
+				__FUNCTION__, __LINE__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#421: FILE: security/smack/smackfs.c:205:
+				__FUNCTION__, __LINE__);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#442: FILE: security/smack/smackfs.c:226:
+		printk("%s:%d rule %s %s 0x%x\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#443: FILE: security/smack/smackfs.c:227:
+		printk("%s:%d rule %s %s 0x%x\n",
+			__FUNCTION__, __LINE__,

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#443: FILE: security/smack/smackfs.c:227:
+			__FUNCTION__, __LINE__,

WARNING:CONST_STRUCT: struct file_operations should normally be const
#453: FILE: security/smack/smackfs.c:237:
+static struct file_operations smk_load_ops = {

Using const is generally a good idea.  Checkpatch reads
a list of frequently used structs that are always or
almost always constant.

The existing structs list can be viewed from
`scripts/const_structs.checkpatch`.

See: https://lore.kernel.org/lkml/alpine.DEB.2.10.1608281509480.3321@hadrien/

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*doip)...) over kmalloc(sizeof(struct cipso_v4_doi)...)
#488: FILE: security/smack/smackfs.c:272:
+	doip = kmalloc(sizeof(struct cipso_v4_doi), GFP_KERNEL);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!doip"
#489: FILE: security/smack/smackfs.c:273:
+	if (doip == NULL)

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#490: FILE: security/smack/smackfs.c:274:
+	if (doip == NULL)
+		panic("smack:  Failed to initialize cipso DOI.\n");

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*ndmp)...) over kmalloc(sizeof(struct netlbl_dom_map)...)
#493: FILE: security/smack/smackfs.c:277:
+	ndmp = kmalloc(sizeof(struct netlbl_dom_map), GFP_KERNEL);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ndmp"
#494: FILE: security/smack/smackfs.c:278:
+	if (ndmp == NULL)

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#495: FILE: security/smack/smackfs.c:279:
+	if (ndmp == NULL)
+		panic("smack:  Failed to initialize cipso ndmp.\n");

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#505: FILE: security/smack/smackfs.c:289:
+		printk("%s:%d add doi rc = %d\n", __FUNCTION__, __LINE__, rc);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#505: FILE: security/smack/smackfs.c:289:
+		printk("%s:%d add doi rc = %d\n", __FUNCTION__, __LINE__, rc);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#513: FILE: security/smack/smackfs.c:297:
+		printk("%s:%d remove rc = %d\n", __FUNCTION__, __LINE__, rc);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#513: FILE: security/smack/smackfs.c:297:
+		printk("%s:%d remove rc = %d\n", __FUNCTION__, __LINE__, rc);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#517: FILE: security/smack/smackfs.c:301:
+		printk("%s:%d add rc = %d\n", __FUNCTION__, __LINE__, rc);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#517: FILE: security/smack/smackfs.c:301:
+		printk("%s:%d add rc = %d\n", __FUNCTION__, __LINE__, rc);

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#523: FILE: security/smack/smackfs.c:307:
+static ssize_t smk_read_cipso(struct file *filp, char __user *buf,
                                            ^^^^

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!result"
#539: FILE: security/smack/smackfs.c:323:
+	if (result == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "slp"
#543: FILE: security/smack/smackfs.c:327:
+	for (slp = smack_cipso; slp != NULL; slp = slp->smk_next) {

ERROR:SPACING: space required after that ',' (ctx:VxV)
#544: FILE: security/smack/smackfs.c:328:
+		sprintf(cp, "%-8s %3d", (char *)&slp->smk_smack,slp->smk_level);
 		                                               ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#564: FILE: security/smack/smackfs.c:348:
+^I$

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!data"
#601: FILE: security/smack/smackfs.c:385:
+	if (data == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "eolp"
#613: FILE: security/smack/smackfs.c:397:
+		eolp != NULL && rc >= 0;

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#615: FILE: security/smack/smackfs.c:399:
+		linep = eolp + 1, eolp = strchr(linep, '\n')) {
+

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!cp"
#627: FILE: security/smack/smackfs.c:411:
+		if (cp == NULL)

WARNING:SSCANF_TO_KSTRTO: Prefer kstrto<type> to single variable sscanf
#630: FILE: security/smack/smackfs.c:414:
+		i = sscanf(cp, "%d", &maplevel);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "cp"
#635: FILE: security/smack/smackfs.c:419:
+		if (cp != NULL) {

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!cp"
#637: FILE: security/smack/smackfs.c:421:
+			if (cp == NULL)

WARNING:SSCANF_TO_KSTRTO: Prefer kstrto<type> to single variable sscanf
#641: FILE: security/smack/smackfs.c:425:
+				i = sscanf(cp, "%d", &cat);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "cp"
#651: FILE: security/smack/smackfs.c:435:
+				if (cp != NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "cp"
#653: FILE: security/smack/smackfs.c:437:
+			} while (cp != NULL);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "scp"
#661: FILE: security/smack/smackfs.c:445:
+		for (scp = smack_cipso; scp != NULL; scp = scp->smk_next)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!scp"
#665: FILE: security/smack/smackfs.c:449:
+		if (scp == NULL) {

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*scp)...) over kzalloc(sizeof(struct smk_cipso_entry)...)
#666: FILE: security/smack/smackfs.c:450:
+			scp = kzalloc(sizeof(struct smk_cipso_entry),

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#667: FILE: security/smack/smackfs.c:451:
+			scp = kzalloc(sizeof(struct smk_cipso_entry),
+				GFP_KERNEL);

CHECK:BRACES: braces {} should be used on all arms of this statement
#668: FILE: security/smack/smackfs.c:452:
+			if (scp == NULL)
[...]
+			else {
[...]

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!scp"
#668: FILE: security/smack/smackfs.c:452:
+			if (scp == NULL)

CHECK:BRACES: Unbalanced braces around else statement
#670: FILE: security/smack/smackfs.c:454:
+			else {

WARNING:CONST_STRUCT: struct file_operations should normally be const
#691: FILE: security/smack/smackfs.c:475:
+static struct file_operations smk_cipso_ops = {

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#696: FILE: security/smack/smackfs.c:480:
+static ssize_t smk_read_doi(struct file *filp, char __user *buf,
                                          ^^^^

ERROR:CODE_INDENT: code indent should use tabs where possible
#697: FILE: security/smack/smackfs.c:481:
+^I^I^I        size_t count, loff_t *ppos)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#697: FILE: security/smack/smackfs.c:481:
+static ssize_t smk_read_doi(struct file *filp, char __user *buf,
+			        size_t count, loff_t *ppos)

ERROR:CODE_INDENT: code indent should use tabs where possible
#712: FILE: security/smack/smackfs.c:496:
+^I^I^I         size_t count, loff_t *ppos)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#712: FILE: security/smack/smackfs.c:496:
+static ssize_t smk_write_doi(struct file *file, const char __user *buf,
+			         size_t count, loff_t *ppos)

WARNING:SSCANF_TO_KSTRTO: Prefer kstrto<type> to single variable sscanf
#726: FILE: security/smack/smackfs.c:510:
+	if (sscanf(temp, "%d", &i) != 1)
+		return -EINVAL;

WARNING:CONST_STRUCT: struct file_operations should normally be const
#734: FILE: security/smack/smackfs.c:518:
+static struct file_operations smk_doi_ops = {

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#739: FILE: security/smack/smackfs.c:523:
+static ssize_t smk_read_direct(struct file *filp, char __user *buf,
                                             ^^^^

ERROR:CODE_INDENT: code indent should use tabs where possible
#740: FILE: security/smack/smackfs.c:524:
+^I^I^I        size_t count, loff_t *ppos)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#740: FILE: security/smack/smackfs.c:524:
+static ssize_t smk_read_direct(struct file *filp, char __user *buf,
+			        size_t count, loff_t *ppos)

ERROR:CODE_INDENT: code indent should use tabs where possible
#755: FILE: security/smack/smackfs.c:539:
+^I^I^I         size_t count, loff_t *ppos)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#755: FILE: security/smack/smackfs.c:539:
+static ssize_t smk_write_direct(struct file *file, const char __user *buf,
+			         size_t count, loff_t *ppos)

WARNING:SSCANF_TO_KSTRTO: Prefer kstrto<type> to single variable sscanf
#769: FILE: security/smack/smackfs.c:553:
+	if (sscanf(temp, "%d", &i) != 1)
+		return -EINVAL;

WARNING:CONST_STRUCT: struct file_operations should normally be const
#777: FILE: security/smack/smackfs.c:561:
+static struct file_operations smk_direct_ops = {

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#782: FILE: security/smack/smackfs.c:566:
+static ssize_t smk_read_ambient(struct file *filp, char __user *buf,
                                              ^^^^

ERROR:CODE_INDENT: code indent should use tabs where possible
#783: FILE: security/smack/smackfs.c:567:
+^I^I^I        size_t count, loff_t *ppos)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#783: FILE: security/smack/smackfs.c:567:
+static ssize_t smk_read_ambient(struct file *filp, char __user *buf,
+			        size_t count, loff_t *ppos)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#794: FILE: security/smack/smackfs.c:578:
+	rc = simple_read_from_buffer(buf, count, ppos, &smack_net_ambient,
+		sizeof(smack_t));

ERROR:CODE_INDENT: code indent should use tabs where possible
#800: FILE: security/smack/smackfs.c:584:
+^I^I^I         size_t count, loff_t *ppos)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#800: FILE: security/smack/smackfs.c:584:
+static ssize_t smk_write_ambient(struct file *file, const char __user *buf,
+			         size_t count, loff_t *ppos)

WARNING:CONST_STRUCT: struct file_operations should normally be const
#824: FILE: security/smack/smackfs.c:608:
+static struct file_operations smk_ambient_ops = {

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#847: FILE: security/smack/smackfs.c:631:
+};
+#define NCHOICES (sizeof(netlbl_choices) / sizeof(struct option_names))

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#849: FILE: security/smack/smackfs.c:633:
+static ssize_t smk_read_nltype(struct file *filp, char __user *buf,
                                             ^^^^

ERROR:CODE_INDENT: code indent should use tabs where possible
#876: FILE: security/smack/smackfs.c:660:
+^I^I^I        size_t count, loff_t *ppos)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#876: FILE: security/smack/smackfs.c:660:
+static ssize_t smk_write_nltype(struct file *file, const char __user *buf,
+			        size_t count, loff_t *ppos)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "cp"
#893: FILE: security/smack/smackfs.c:677:
+	if (cp != NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "cp"
#896: FILE: security/smack/smackfs.c:680:
+	if (cp != NULL)

WARNING:CONST_STRUCT: struct file_operations should normally be const
#911: FILE: security/smack/smackfs.c:695:
+static struct file_operations smk_nltype_ops = {

ERROR:INITIALISED_STATIC: do not initialise statics to NULL
#929: FILE: security/smack/smackfs.c:713:
+static struct super_block *smk_sb = NULL;

Static variables should not be initialized explicitly to zero.
Your compiler (or rather your loader) automatically does
it for you.

ERROR:INITIALISED_STATIC: do not initialise statics to NULL
#930: FILE: security/smack/smackfs.c:714:
+static struct smk_link *smk_links = NULL;

ERROR:INITIALISED_STATIC: do not initialise statics to 0
#931: FILE: security/smack/smackfs.c:715:
+static int smk_links_count = 0;

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#933: FILE: security/smack/smackfs.c:717:
+static void *smackfs_follow_link(struct dentry *dentry, struct nameidata *nd)
                                                                           ^^

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "slp"
#941: FILE: security/smack/smackfs.c:725:
+	for (slp = smk_links; slp != NULL; slp = slp->sl_next)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!slp"
#945: FILE: security/smack/smackfs.c:729:
+	if (slp == NULL) {

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#946: FILE: security/smack/smackfs.c:730:
+		printk("%s:%d failed\n", __FUNCTION__, __LINE__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#946: FILE: security/smack/smackfs.c:730:
+		printk("%s:%d failed\n", __FUNCTION__, __LINE__);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!cp"
#950: FILE: security/smack/smackfs.c:734:
+	if (cp == NULL)

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#955: FILE: security/smack/smackfs.c:739:
+	nd_set_link(nd, cp);
 	            ^^

ERROR:CORRUPTED_PATCH: patch seems to be corrupt (line wrapped?)
#964: FILE: security/smack/smackfs.c:747:
buflen)

The patch seems to be corrupted or lines are wrapped.
Please regenerate the patch file before sending it to the maintainer.

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "slp"
#972: FILE: security/smack/smackfs.c:755:
+	for (slp = smk_links; slp != NULL; slp = slp->sl_next)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!slp"
#976: FILE: security/smack/smackfs.c:759:
+	if (slp == NULL) {

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#977: FILE: security/smack/smackfs.c:760:
+		printk("%s:%d failed\n", __FUNCTION__, __LINE__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#977: FILE: security/smack/smackfs.c:760:
+		printk("%s:%d failed\n", __FUNCTION__, __LINE__);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!cp"
#982: FILE: security/smack/smackfs.c:765:
+	if (cp == NULL)

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#997: FILE: security/smack/smackfs.c:780:
+static void smackfs_put_link(struct dentry *dentry, struct nameidata *nd, void
                                                                       ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1000: FILE: security/smack/smackfs.c:782:
+	kfree(nd_get_link(nd));
 	                  ^^

WARNING:CONST_STRUCT: struct inode_operations should normally be const
#1003: FILE: security/smack/smackfs.c:785:
+static struct inode_operations smackfs_symlink_inode_operations = {

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "slp"
#1016: FILE: security/smack/smackfs.c:798:
+	for (slp = smk_links; slp != NULL; slp = slp->sl_next) {

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*slp)...) over kzalloc(sizeof(struct smk_link)...)
#1023: FILE: security/smack/smackfs.c:805:
+	slp = kzalloc(sizeof(struct smk_link), GFP_KERNEL);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!slp"
#1024: FILE: security/smack/smackfs.c:806:
+	if (slp == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!dentry"
#1028: FILE: security/smack/smackfs.c:810:
+	if (dentry == NULL) {

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#1029: FILE: security/smack/smackfs.c:811:
+		printk("%s:%d link dentry failed\n", __FUNCTION__, __LINE__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#1029: FILE: security/smack/smackfs.c:811:
+		printk("%s:%d link dentry failed\n", __FUNCTION__, __LINE__);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!inode"
#1034: FILE: security/smack/smackfs.c:816:
+	if (inode == NULL) {

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#1035: FILE: security/smack/smackfs.c:817:
+		printk("%s:%d link inode failed\n", __FUNCTION__, __LINE__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#1035: FILE: security/smack/smackfs.c:817:
+		printk("%s:%d link inode failed\n", __FUNCTION__, __LINE__);

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRWXUGO' are not preferred. Consider using octal permissions '0777'.
#1039: FILE: security/smack/smackfs.c:821:
+	inode->i_mode = S_IFLNK | S_IRWXUGO;

Permission bits in the octal form are more readable and easier to
understand than their symbolic counterparts because many command-line
tools use this notation. Experienced kernel developers have been using
these traditional Unix permission bits for decades and so they find it
easier to understand the octal notation than the symbolic macros.
For example, it is harder to read S_IWUSR|S_IRUGO than 0644, which
obscures the developer's intent rather than clarifying it.

See: https://lore.kernel.org/lkml/CA+55aFw5v23T-zvDZp-MmD_EYxF8WbafwwB59934FV7g21uMGQ@mail.gmail.com/

WARNING:RETURN_VOID: void function return statements are not generally useful
#1058: FILE: security/smack/smackfs.c:840:
+	return;
+}

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#1060: FILE: security/smack/smackfs.c:842:
+static ssize_t smk_read_links(struct file *filp, char __user *buf,
                                            ^^^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1061: FILE: security/smack/smackfs.c:843:
+static ssize_t smk_read_links(struct file *filp, char __user *buf,
+			     size_t count, loff_t *ppos)

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1067: FILE: security/smack/smackfs.c:849:
+^I$

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1068: FILE: security/smack/smackfs.c:850:
+	
+

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!result"
#1070: FILE: security/smack/smackfs.c:852:
+	if (result == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "slp"
#1074: FILE: security/smack/smackfs.c:856:
+	for (slp = smk_links, cp = result; slp != NULL; slp = slp->sl_next) {

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1079: FILE: security/smack/smackfs.c:861:
+	bytes = simple_read_from_buffer(buf,count,ppos,result,strlen(result));
 	                                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1079: FILE: security/smack/smackfs.c:861:
+	bytes = simple_read_from_buffer(buf,count,ppos,result,strlen(result));
 	                                         ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1079: FILE: security/smack/smackfs.c:861:
+	bytes = simple_read_from_buffer(buf,count,ppos,result,strlen(result));
 	                                              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1079: FILE: security/smack/smackfs.c:861:
+	bytes = simple_read_from_buffer(buf,count,ppos,result,strlen(result));
 	                                                     ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1080: FILE: security/smack/smackfs.c:862:
+^I$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1087: FILE: security/smack/smackfs.c:869:
+static ssize_t smk_write_links(struct file *file, const char __user *buf,
+			      size_t count, loff_t *ppos)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!data"
#1107: FILE: security/smack/smackfs.c:889:
+	if (data == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "cp"
#1117: FILE: security/smack/smackfs.c:899:
+	for (cp = data - 1; cp != NULL; cp = strchr(cp + 1, '\n')) {

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#1121: FILE: security/smack/smackfs.c:903:
+			printk("%s:%d bad scan\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1122: FILE: security/smack/smackfs.c:904:
+			printk("%s:%d bad scan\n",
+				__FUNCTION__, __LINE__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#1122: FILE: security/smack/smackfs.c:904:
+				__FUNCTION__, __LINE__);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#1126: FILE: security/smack/smackfs.c:908:
+		printk("%s:%d add %s -> %s\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1127: FILE: security/smack/smackfs.c:909:
+		printk("%s:%d add %s -> %s\n",
+			__FUNCTION__, __LINE__, name, target);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#1127: FILE: security/smack/smackfs.c:909:
+			__FUNCTION__, __LINE__, name, target);

WARNING:CONST_STRUCT: struct file_operations should normally be const
#1134: FILE: security/smack/smackfs.c:916:
+static struct file_operations smk_links_ops = {

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#1139: FILE: security/smack/smackfs.c:921:
+static int smk_fill_super(struct super_block *sb, void * data, int silent)

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1145: FILE: security/smack/smackfs.c:927:
+		[SMK_LOAD] = {"load", &smk_load_ops, S_IRUGO|S_IWUSR},
 		                                            ^

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO|S_IWUSR' are not preferred. Consider using octal permissions '0644'.
#1145: FILE: security/smack/smackfs.c:927:
+		[SMK_LOAD] = {"load", &smk_load_ops, S_IRUGO|S_IWUSR},

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1146: FILE: security/smack/smackfs.c:928:
+		[SMK_LINKS] = {"links", &smk_links_ops, S_IRUGO|S_IWUSR},
 		                                               ^

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO|S_IWUSR' are not preferred. Consider using octal permissions '0644'.
#1146: FILE: security/smack/smackfs.c:928:
+		[SMK_LINKS] = {"links", &smk_links_ops, S_IRUGO|S_IWUSR},

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1147: FILE: security/smack/smackfs.c:929:
+		[SMK_CIPSO] = {"cipso", &smk_cipso_ops, S_IRUGO|S_IWUSR},
 		                                               ^

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO|S_IWUSR' are not preferred. Consider using octal permissions '0644'.
#1147: FILE: security/smack/smackfs.c:929:
+		[SMK_CIPSO] = {"cipso", &smk_cipso_ops, S_IRUGO|S_IWUSR},

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1148: FILE: security/smack/smackfs.c:930:
+		[SMK_DOI] = {"doi", &smk_doi_ops, S_IRUGO|S_IWUSR},
 		                                         ^

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO|S_IWUSR' are not preferred. Consider using octal permissions '0644'.
#1148: FILE: security/smack/smackfs.c:930:
+		[SMK_DOI] = {"doi", &smk_doi_ops, S_IRUGO|S_IWUSR},

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1149: FILE: security/smack/smackfs.c:931:
+		[SMK_DIRECT] = {"direct", &smk_direct_ops, S_IRUGO|S_IWUSR},
 		                                                  ^

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO|S_IWUSR' are not preferred. Consider using octal permissions '0644'.
#1149: FILE: security/smack/smackfs.c:931:
+		[SMK_DIRECT] = {"direct", &smk_direct_ops, S_IRUGO|S_IWUSR},

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1150: FILE: security/smack/smackfs.c:932:
+		[SMK_AMBIENT] = {"ambient", &smk_ambient_ops, S_IRUGO|S_IWUSR},
 		                                                     ^

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO|S_IWUSR' are not preferred. Consider using octal permissions '0644'.
#1150: FILE: security/smack/smackfs.c:932:
+		[SMK_AMBIENT] = {"ambient", &smk_ambient_ops, S_IRUGO|S_IWUSR},

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1151: FILE: security/smack/smackfs.c:933:
+		[SMK_NLTYPE] = {"nltype", &smk_nltype_ops, S_IRUGO|S_IWUSR},
 		                                                  ^

WARNING:SYMBOLIC_PERMS: Symbolic permissions 'S_IRUGO|S_IWUSR' are not preferred. Consider using octal permissions '0644'.
#1151: FILE: security/smack/smackfs.c:933:
+		[SMK_NLTYPE] = {"nltype", &smk_nltype_ops, S_IRUGO|S_IWUSR},

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1162: FILE: security/smack/smackfs.c:944:
+		printk(KERN_ERR "%s failed %d while creating inodes\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1163: FILE: security/smack/smackfs.c:945:
+		printk(KERN_ERR "%s failed %d while creating inodes\n",
+			__FUNCTION__, rc);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#1163: FILE: security/smack/smackfs.c:945:
+			__FUNCTION__, rc);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1201: FILE: security/smack/smackfs.c:983:
+			printk(KERN_ERR "smackfs:  could not mount!\n");

WARNING:USE_DEVICE_INITCALL: please use device_initcall() or more appropriate function instead of __initcall() (see include/linux/init.h)
#1212: FILE: security/smack/smackfs.c:994:
+__initcall(init_smk_fs);

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#1219: FILE: security/smack/smack.h:1:
+/*

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1241: FILE: security/smack/smack.h:23:
+ * $

ERROR:COMPLEX_MACRO: Macros with complex values should be enclosed in parentheses
#1327: FILE: security/smack/smack.h:109:
+#define XATTR_NAME_SMACK	XATTR_SECURITY_PREFIX XATTR_SMACK_SUFFIX

WARNING:FUNCTION_ARGUMENTS: function definition argument 'smack_t' should also have an identifier name
#1383: FILE: security/smack/smack.h:165:
+struct inode_smack *new_inode_smack(smack_t);

This warning is emitted due to any of the following reasons:

  1. Arguments for the function declaration do not follow
     the identifier name.  Example::

       void foo
       (int bar, int baz)

     This should be corrected to::

       void foo(int bar, int baz)

  2. Some arguments for the function definition do not
     have an identifier name.  Example::

       void foo(int)

     All arguments should have identifier names.

WARNING:FUNCTION_ARGUMENTS: function definition argument 'smack_t *' should also have an identifier name
#1388: FILE: security/smack/smack.h:170:
+int smk_access(smack_t *, smack_t *, int);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'smack_t *' should also have an identifier name
#1388: FILE: security/smack/smack.h:170:
+int smk_access(smack_t *, smack_t *, int);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'int' should also have an identifier name
#1388: FILE: security/smack/smack.h:170:
+int smk_access(smack_t *, smack_t *, int);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'smack_t *' should also have an identifier name
#1389: FILE: security/smack/smack.h:171:
+int smk_curacc(smack_t *, u32);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'u32' should also have an identifier name
#1389: FILE: security/smack/smack.h:171:
+int smk_curacc(smack_t *, u32);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'char *' should also have an identifier name
#1390: FILE: security/smack/smack.h:172:
+smack_t smk_from_string(char *);

WARNING:TYPO_SPELLING: 'Stricly' may be misspelled - perhaps 'Strictly'?
#1393: FILE: security/smack/smack.h:175:
+ * Stricly for CIPSO level manipulation.
    ^^^^^^^

ERROR:CODE_INDENT: code indent should use tabs where possible
#1398: FILE: security/smack/smack.h:180:
+        char *cp = (char *)catsetp;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#1398: FILE: security/smack/smack.h:180:
+        char *cp = (char *)catsetp;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#1400: FILE: security/smack/smack.h:182:
+        if (cat > sizeof(smack_t) * 8)$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#1400: FILE: security/smack/smack.h:182:
+        if (cat > sizeof(smack_t) * 8)$

ERROR:CODE_INDENT: code indent should use tabs where possible
#1401: FILE: security/smack/smack.h:183:
+                return;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#1401: FILE: security/smack/smack.h:183:
+                return;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#1403: FILE: security/smack/smack.h:185:
+        cp[(cat - 1) / 8] |= 0x80 >> ((cat - 1) % 8);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#1403: FILE: security/smack/smack.h:185:
+        cp[(cat - 1) / 8] |= 0x80 >> ((cat - 1) % 8);$

WARNING:LINE_SPACING: Missing a blank line after declarations
#1412: FILE: security/smack/smack.h:194:
+	struct task_smack *stp = tsp->security;
+	return &stp->smk_task;

WARNING:LINE_SPACING: Missing a blank line after declarations
#1421: FILE: security/smack/smack.h:203:
+	struct inode_smack *sip = isp->i_security;
+	return &sip->smk_inode;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "bp"
#1432: FILE: security/smack/smack.h:214:
+	if (bp != NULL)

CHECK:BRACES: braces {} should be used on all arms of this statement
#1452: FILE: security/smack/smack.h:234:
+		if (found)
[...]
+		else if (i >= size || *from > '~' || *from <= ' ') {
[...]
+		else
[...]

ERROR:ELSE_AFTER_BRACE: else should follow close brace '}'
#1458: FILE: security/smack/smack.h:240:
+		}
+		else

`else {` should follow the closing block `}` on the same line.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000397626.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 40 errors, 91 warnings, 76 checks, 1393 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000397626.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
