WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#78: FILE: security/apparmor/apparmor.h:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#156: FILE: security/apparmor/apparmor.h:79:
+ * via /sys/kernel/security/apparmor/control */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

CHECK:MACRO_ARG_REUSE: Macro argument reuse '_profile' - possible side-effects?
#163: FILE: security/apparmor/apparmor.h:86:
+#define PROFILE_COMPLAIN(_profile) \
+	(apparmor_complain == 1 || ((_profile) && (_profile)->flags.complain))

CHECK:MACRO_ARG_REUSE: Macro argument reuse '_cxt' - possible side-effects?
#166: FILE: security/apparmor/apparmor.h:89:
+#define APPARMOR_COMPLAIN(_cxt) \
+	(apparmor_complain == 1 || \
+	 ((_cxt) && (_cxt)->profile && (_cxt)->profile->flags.complain))

CHECK:MACRO_ARG_REUSE: Macro argument reuse '_profile' - possible side-effects?
#170: FILE: security/apparmor/apparmor.h:93:
+#define PROFILE_AUDIT(_profile) \
+	(apparmor_audit == 1 || ((_profile) && (_profile)->flags.audit))

CHECK:MACRO_ARG_REUSE: Macro argument reuse '_cxt' - possible side-effects?
#173: FILE: security/apparmor/apparmor.h:96:
+#define APPARMOR_AUDIT(_cxt) \
+	(apparmor_audit == 1 || \
+	 ((_cxt) && (_cxt)->profile && (_cxt)->profile->flags.audit))

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#185: FILE: security/apparmor/apparmor.h:108:
+			printk(KERN_DEBUG "AppArmor: " fmt, ##args);	\

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#188: FILE: security/apparmor/apparmor.h:111:
+#define AA_ERROR(fmt, args...)	printk(KERN_ERR "AppArmor: " fmt, ##args)

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#247: FILE: security/apparmor/apparmor.h:170:
+	spinlock_t lock;

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#310: FILE: security/apparmor/apparmor.h:233:
+extern int alloc_default_namespace(void);

Function prototypes don't need to be declared extern in .h
files.  It's assumed by the compiler and is unnecessary.

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#311: FILE: security/apparmor/apparmor.h:234:
+extern void free_default_namespace(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#312: FILE: security/apparmor/apparmor.h:235:
+extern int aa_audit_message(struct aa_profile *profile, struct aa_audit *sa,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#317: FILE: security/apparmor/apparmor.h:240:
+extern int aa_audit_syscallreject(struct aa_profile *profile, gfp_t gfp,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'const char *' should also have an identifier name
#317: FILE: security/apparmor/apparmor.h:240:
+extern int aa_audit_syscallreject(struct aa_profile *profile, gfp_t gfp,

This warning is emitted due to any of the following reasons:

  1. Arguments for the function declaration do not follow
     the identifier name.  Example::

       void foo
       (int bar, int baz)

     This should be corrected to::

       void foo(int bar, int baz)

  2. Some arguments for the function definition do not
     have an identifier name.  Example::

       void foo(int)

     All arguments should have identifier names.

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#319: FILE: security/apparmor/apparmor.h:242:
+extern int aa_audit(struct aa_profile *profile, struct aa_audit *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct aa_audit *' should also have an identifier name
#319: FILE: security/apparmor/apparmor.h:242:
+extern int aa_audit(struct aa_profile *profile, struct aa_audit *);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#321: FILE: security/apparmor/apparmor.h:244:
+extern int aa_attr(struct aa_profile *profile, struct dentry *dentry,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#323: FILE: security/apparmor/apparmor.h:246:
+extern int aa_perm_xattr(struct aa_profile *profile, const char *operation,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#326: FILE: security/apparmor/apparmor.h:249:
+extern int aa_capability(struct aa_task_context *cxt, int cap);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#327: FILE: security/apparmor/apparmor.h:250:
+extern int aa_perm(struct aa_profile *profile, const char *operation,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#330: FILE: security/apparmor/apparmor.h:253:
+extern int aa_perm_dir(struct aa_profile *profile, const char *operation,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#333: FILE: security/apparmor/apparmor.h:256:
+extern int aa_perm_path(struct aa_profile *, const char *operation,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct aa_profile *' should also have an identifier name
#333: FILE: security/apparmor/apparmor.h:256:
+extern int aa_perm_path(struct aa_profile *, const char *operation,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#335: FILE: security/apparmor/apparmor.h:258:
+extern int aa_link(struct aa_profile *profile,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#338: FILE: security/apparmor/apparmor.h:261:
+extern int aa_clone(struct task_struct *task);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#339: FILE: security/apparmor/apparmor.h:262:
+extern int aa_register(struct linux_binprm *bprm);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#340: FILE: security/apparmor/apparmor.h:263:
+extern void aa_release(struct task_struct *task);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#341: FILE: security/apparmor/apparmor.h:264:
+extern int aa_change_hat(const char *id, u64 hat_magic);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#342: FILE: security/apparmor/apparmor.h:265:
+extern int aa_change_profile(const char *ns_name, const char *name);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#343: FILE: security/apparmor/apparmor.h:266:
+extern struct aa_profile *__aa_replace_profile(struct task_struct *task,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#345: FILE: security/apparmor/apparmor.h:268:
+extern struct aa_task_context *lock_task_and_profiles(struct task_struct *task,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#347: FILE: security/apparmor/apparmor.h:270:
+extern void unlock_task_and_profiles(struct task_struct *task,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#350: FILE: security/apparmor/apparmor.h:273:
+extern void aa_change_task_context(struct task_struct *task,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#354: FILE: security/apparmor/apparmor.h:277:
+extern int aa_may_ptrace(struct aa_task_context *cxt,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#358: FILE: security/apparmor/apparmor.h:281:
+extern struct aa_namespace *__aa_find_namespace(const char *name,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#360: FILE: security/apparmor/apparmor.h:283:
+extern struct aa_profile *__aa_find_profile(const char *name,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#362: FILE: security/apparmor/apparmor.h:285:
+extern void aa_profile_ns_list_release(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#365: FILE: security/apparmor/apparmor.h:288:
+extern ssize_t aa_add_profile(void *, size_t);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'void *' should also have an identifier name
#365: FILE: security/apparmor/apparmor.h:288:
+extern ssize_t aa_add_profile(void *, size_t);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'size_t' should also have an identifier name
#365: FILE: security/apparmor/apparmor.h:288:
+extern ssize_t aa_add_profile(void *, size_t);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#366: FILE: security/apparmor/apparmor.h:289:
+extern ssize_t aa_replace_profile(void *, size_t);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'void *' should also have an identifier name
#366: FILE: security/apparmor/apparmor.h:289:
+extern ssize_t aa_replace_profile(void *, size_t);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'size_t' should also have an identifier name
#366: FILE: security/apparmor/apparmor.h:289:
+extern ssize_t aa_replace_profile(void *, size_t);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#367: FILE: security/apparmor/apparmor.h:290:
+extern ssize_t aa_remove_profile(char *, size_t);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'char *' should also have an identifier name
#367: FILE: security/apparmor/apparmor.h:290:
+extern ssize_t aa_remove_profile(char *, size_t);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'size_t' should also have an identifier name
#367: FILE: security/apparmor/apparmor.h:290:
+extern ssize_t aa_remove_profile(char *, size_t);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#368: FILE: security/apparmor/apparmor.h:291:
+extern struct aa_namespace *alloc_aa_namespace(char *name);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#369: FILE: security/apparmor/apparmor.h:292:
+extern void free_aa_namespace(struct aa_namespace *ns);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#370: FILE: security/apparmor/apparmor.h:293:
+extern void free_aa_namespace_kref(struct kref *kref);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#371: FILE: security/apparmor/apparmor.h:294:
+extern struct aa_profile *alloc_aa_profile(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#372: FILE: security/apparmor/apparmor.h:295:
+extern void free_aa_profile(struct aa_profile *profile);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#373: FILE: security/apparmor/apparmor.h:296:
+extern void free_aa_profile_kref(struct kref *kref);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#374: FILE: security/apparmor/apparmor.h:297:
+extern void aa_unconfine_tasks(struct aa_profile *profile);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#377: FILE: security/apparmor/apparmor.h:300:
+extern int aa_getprocattr(struct aa_profile *profile, char **string,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int *' to bare use of 'unsigned *'
#378: FILE: security/apparmor/apparmor.h:301:
+			  unsigned *len);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#379: FILE: security/apparmor/apparmor.h:302:
+extern int aa_setprocattr_changehat(char *args);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#380: FILE: security/apparmor/apparmor.h:303:
+extern int aa_setprocattr_changeprofile(char *args);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#381: FILE: security/apparmor/apparmor.h:304:
+extern int aa_setprocattr_setprofile(struct task_struct *task, char *args);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#384: FILE: security/apparmor/apparmor.h:307:
+extern int create_apparmorfs(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#385: FILE: security/apparmor/apparmor.h:308:
+extern void destroy_apparmorfs(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#388: FILE: security/apparmor/apparmor.h:311:
+extern struct aa_dfa *aa_match_alloc(void);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#389: FILE: security/apparmor/apparmor.h:312:
+extern void aa_match_free(struct aa_dfa *dfa);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#390: FILE: security/apparmor/apparmor.h:313:
+extern int unpack_dfa(struct aa_dfa *dfa, void *blob, size_t size);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#391: FILE: security/apparmor/apparmor.h:314:
+extern int verify_dfa(struct aa_dfa *dfa);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#392: FILE: security/apparmor/apparmor.h:315:
+extern unsigned int aa_dfa_match(struct aa_dfa *dfa, const char *str);

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#393: FILE: security/apparmor/apparmor.h:316:
+extern unsigned int aa_dfa_next_state(struct aa_dfa *dfa, unsigned int start,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#395: FILE: security/apparmor/apparmor.h:318:
+extern unsigned int aa_match_state(struct aa_dfa *dfa, unsigned int start,

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#397: FILE: security/apparmor/apparmor.h:320:
+extern unsigned int aa_dfa_null_transition(struct aa_dfa *dfa,

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#404: FILE: security/apparmor/apparmorfs.c:1:
+/*

WARNING:INCLUDE_LINUX: Use #include <linux/uaccess.h> instead of <asm/uaccess.h>
#419: FILE: security/apparmor/apparmorfs.c:16:
+#include <asm/uaccess.h>

WARNING:LINE_SPACING: Missing a blank line after declarations
#445: FILE: security/apparmor/apparmorfs.c:42:
+		struct aa_audit sa;
+		memset(&sa, 0, sizeof(sa));

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!data"
#455: FILE: security/apparmor/apparmorfs.c:52:
+	if (data == NULL) {

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

WARNING:CONST_STRUCT: struct seq_operations should normally be const
#471: FILE: security/apparmor/apparmorfs.c:68:
+extern struct seq_operations apparmorfs_profiles_op;

Using const is generally a good idea.  Checkpatch reads
a list of frequently used structs that are always or
almost always constant.

The existing structs list can be viewed from
`scripts/const_structs.checkpatch`.

See: https://lore.kernel.org/lkml/alpine.DEB.2.10.1608281509480.3321@hadrien/

CHECK:LINE_SPACING: Please don't use multiple blank lines
#478: FILE: security/apparmor/apparmorfs.c:75:
+
+

WARNING:CONST_STRUCT: struct file_operations should normally be const
#484: FILE: security/apparmor/apparmorfs.c:81:
+static struct file_operations apparmorfs_profiles_fops = {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#493: FILE: security/apparmor/apparmorfs.c:90:
+static ssize_t aa_matching_read(struct file *file, char __user *buf,
+			       size_t size, loff_t *ppos)

WARNING:CONST_STRUCT: struct file_operations should normally be const
#501: FILE: security/apparmor/apparmorfs.c:98:
+static struct file_operations apparmorfs_matching_fops = {

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#502: FILE: security/apparmor/apparmorfs.c:99:
+^I.read = ^Iaa_matching_read,$

CHECK:LINE_SPACING: Please don't use multiple blank lines
#523: FILE: security/apparmor/apparmorfs.c:120:
+
+

WARNING:CONST_STRUCT: struct file_operations should normally be const
#524: FILE: security/apparmor/apparmorfs.c:121:
+static struct file_operations apparmorfs_profile_load = {

CHECK:LINE_SPACING: Please don't use multiple blank lines
#547: FILE: security/apparmor/apparmorfs.c:144:
+
+

WARNING:CONST_STRUCT: struct file_operations should normally be const
#548: FILE: security/apparmor/apparmorfs.c:145:
+static struct file_operations apparmorfs_profile_replace = {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#554: FILE: security/apparmor/apparmorfs.c:151:
+static ssize_t aa_profile_remove(struct file *f, const char __user *buf,
+				  size_t size, loff_t *pos)

WARNING:CONST_STRUCT: struct file_operations should normally be const
#576: FILE: security/apparmor/apparmorfs.c:173:
+static struct file_operations apparmorfs_profile_remove = {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#622: FILE: security/apparmor/apparmorfs.c:219:
+		AA_ERROR("%s: AppArmor securityfs already exists\n",
+			__FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#622: FILE: security/apparmor/apparmorfs.c:219:
+			__FUNCTION__);

ERROR:CODE_INDENT: code indent should use tabs where possible
#630: FILE: security/apparmor/apparmorfs.c:227:
+ ^I^Igoto error;$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#630: FILE: security/apparmor/apparmorfs.c:227:
+ ^I^Igoto error;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#630: FILE: security/apparmor/apparmorfs.c:227:
+ ^I^Igoto error;$

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#659: FILE: security/apparmor/inline.h:1:
+/*

CHECK:SPACING: No space is necessary after a cast
#682: FILE: security/apparmor/inline.h:24:
+	return (struct aa_task_context *) rcu_dereference(task->security);

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around ns->count
#688: FILE: security/apparmor/inline.h:30:
+		kref_get(&(ns->count));

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

CHECK:LINE_SPACING: Please don't use multiple blank lines
#699: FILE: security/apparmor/inline.h:41:
+
+

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around p->count
#718: FILE: security/apparmor/inline.h:60:
+		kref_get(&(p->count));

ERROR:CODE_INDENT: code indent should use tabs where possible
#874: FILE: security/apparmor/inline.h:216:
+^I^I^I^I        struct aa_profile *profile2)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#874: FILE: security/apparmor/inline.h:216:
+static inline void unlock_both_profiles(struct aa_profile *profile1,
+				        struct aa_profile *profile2)

ERROR:CODE_INDENT: code indent should use tabs where possible
#895: FILE: security/apparmor/inline.h:237:
+^I        return dfa ? aa_dfa_match(dfa, pathname) : 0;$

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#902: FILE: security/apparmor/list.c:1:
+/*

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#930: FILE: security/apparmor/list.c:29:
+struct aa_namespace *__aa_find_namespace(const char *name,
+				       struct list_head *head)

WARNING:LINE_SPACING: Missing a blank line after declarations
#965: FILE: security/apparmor/list.c:64:
+	struct aa_profile *profile, *tmp;
+	list_for_each_entry_safe(profile, tmp, head, list) {

WARNING:LINE_SPACING: Missing a blank line after declarations
#1000: FILE: security/apparmor/list.c:99:
+	loff_t l = *pos;
+	read_lock(&profile_ns_list_lock);

CHECK:SPACING: No space is necessary after a cast
#1014: FILE: security/apparmor/list.c:113:
+	struct aa_profile *profile = (struct aa_profile *) p;

WARNING:LINE_SPACING: Missing a blank line after declarations
#1042: FILE: security/apparmor/list.c:141:
+	struct aa_profile *profile = (struct aa_profile *)v;
+	if (profile->ns == default_namespace)

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 12)
#1042: FILE: security/apparmor/list.c:141:
+	if (profile->ns == default_namespace)
+	    seq_printf(f, "%s (%s)\n", profile->name,

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 12)
#1045: FILE: security/apparmor/list.c:144:
+	else
+	    seq_printf(f, "%s:%s (%s)\n", profile->ns->name, profile->name,

WARNING:CONST_STRUCT: struct seq_operations should normally be const
#1052: FILE: security/apparmor/list.c:151:
+struct seq_operations apparmorfs_profiles_op = {

WARNING:TYPO_SPELLING: 'guarenteed' may be misspelled - perhaps 'guaranteed'?
#1100: FILE: security/apparmor/locking.txt:40:
+references is only guarenteed to exist for the rcu cycle.  Where
                    ^^^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#1132: FILE: security/apparmor/procattr.c:1:
+/*

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int *' to bare use of 'unsigned *'
#1146: FILE: security/apparmor/procattr.c:15:
+int aa_getprocattr(struct aa_profile *profile, char **string, unsigned *len)

WARNING:CONSIDER_KSTRTO: simple_strtoull is obsolete, use kstrtoull instead
#1194: FILE: security/apparmor/procattr.c:63:
+	*cookie = simple_strtoull(args, &name, 16);

The simple_strtol(), simple_strtoll(), simple_strtoul(), and
simple_strtoull() functions explicitly ignore overflows, which
may lead to unexpected results in callers.  The respective kstrtol(),
kstrtoll(), kstrtoul(), and kstrtoull() functions tend to be the
correct replacements.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#simple-strtol-simple-strtoll-simple-strtoul-simple-strtoull

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around 'name == args'
#1195: FILE: security/apparmor/procattr.c:64:
+	if ((name == args) || *name != '^') {

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#1221: FILE: security/apparmor/procattr.c:90:
+		 __FUNCTION__, cookie, hat ? hat : NULL);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1232: FILE: security/apparmor/procattr.c:101:
+		char *split = strchr(name, ':');
+		if (split) {

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#1255: FILE: security/apparmor/procattr.c:124:
+		 __FUNCTION__, current->pid);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1260: FILE: security/apparmor/procattr.c:129:
+		char *split = strchr(args, ':');
+		if (split) {

CHECK:BRACES: braces {} should be used on all arms of this statement
#1279: FILE: security/apparmor/procattr.c:148:
+	if (strcmp(name, "unconfined") == 0)
[...]
+	else {
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:BRACES: Unbalanced braces around else statement
#1281: FILE: security/apparmor/procattr.c:150:
+	else {

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000344753.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 3 errors, 43 warnings, 71 checks, 1255 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000344753.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
