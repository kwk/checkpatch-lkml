WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#138: FILE: drivers/vhost/Kconfig:1:
+config VHOST_NET
+	tristate "Host kernel accelerator for virtio net"
+	depends on NET && EVENTFD
+	---help---
+	  This kernel module can be loaded in host kernel to accelerate
+	  guest networking with virtio_net. Not to be confused with virtio_net
+	  module itself which needs to be loaded in guest kernel.
+
+	  To compile this driver as a module, choose M here: the module will
+	  be called vhost_net.
+

Kconfig symbols should have a help text which fully describes
it.

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#163: FILE: drivers/vhost/net.c:1:
+/* Copyright (C) 2009 Red Hat, Inc.

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#193: FILE: drivers/vhost/net.c:31:
+ * Using this limit prevents one virtqueue from starving others. */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#214: FILE: drivers/vhost/net.c:52:
+	 * Protected by tx vq lock. */

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#222: FILE: drivers/vhost/net.c:60:
+       int seg = 0;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#223: FILE: drivers/vhost/net.c:61:
+       size_t size;$

WARNING:LINE_SPACING: Missing a blank line after declarations
#224: FILE: drivers/vhost/net.c:62:
+       size_t size;
+       while (len && seg < iov_count) {

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#224: FILE: drivers/vhost/net.c:62:
+       while (len && seg < iov_count) {$

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (7, 15)
#224: FILE: drivers/vhost/net.c:62:
+       while (len && seg < iov_count) {
+               size = min(from->iov_len, len);

ERROR:CODE_INDENT: code indent should use tabs where possible
#225: FILE: drivers/vhost/net.c:63:
+               size = min(from->iov_len, len);$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#225: FILE: drivers/vhost/net.c:63:
+               size = min(from->iov_len, len);$

ERROR:CODE_INDENT: code indent should use tabs where possible
#226: FILE: drivers/vhost/net.c:64:
+               to->iov_base = from->iov_base;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#226: FILE: drivers/vhost/net.c:64:
+               to->iov_base = from->iov_base;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#227: FILE: drivers/vhost/net.c:65:
+               to->iov_len = size;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#227: FILE: drivers/vhost/net.c:65:
+               to->iov_len = size;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#228: FILE: drivers/vhost/net.c:66:
+               from->iov_len -= size;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#228: FILE: drivers/vhost/net.c:66:
+               from->iov_len -= size;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#229: FILE: drivers/vhost/net.c:67:
+               from->iov_base += size;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#229: FILE: drivers/vhost/net.c:67:
+               from->iov_base += size;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#230: FILE: drivers/vhost/net.c:68:
+               len -= size;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#230: FILE: drivers/vhost/net.c:68:
+               len -= size;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#231: FILE: drivers/vhost/net.c:69:
+               ++from;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#231: FILE: drivers/vhost/net.c:69:
+               ++from;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#232: FILE: drivers/vhost/net.c:70:
+               ++to;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#232: FILE: drivers/vhost/net.c:70:
+               ++to;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#233: FILE: drivers/vhost/net.c:71:
+               ++seg;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#233: FILE: drivers/vhost/net.c:71:
+               ++seg;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#234: FILE: drivers/vhost/net.c:72:
+       }$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#235: FILE: drivers/vhost/net.c:73:
+       return seg;$

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#257: FILE: drivers/vhost/net.c:95:
+ * read-size critical section for our kind of RCU. */

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#261: FILE: drivers/vhost/net.c:99:
+	unsigned head, out, in, s;

WARNING:LINE_SPACING: Missing a blank line after declarations
#274: FILE: drivers/vhost/net.c:112:
+	struct socket *sock = rcu_dereference(vq->private_data);
+	if (!sock)

WARNING:BRACES: braces {} are not necessary for single statement blocks
#300: FILE: drivers/vhost/net.c:138:
+			if (vhost_notify(vq)) {
+				continue;
+			}

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:SPLIT_STRING: quoted string split across lines
#307: FILE: drivers/vhost/net.c:145:
+			vq_err(vq, "Unexpected descriptor format for TX: "
+			       "out %d, int %d\n", out, in);

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

WARNING:SPLIT_STRING: quoted string split across lines
#317: FILE: drivers/vhost/net.c:155:
+			vq_err(vq, "Unexpected header len for TX: "
+			       "%ld expected %zd\n",

WARNING:SPLIT_STRING: quoted string split across lines
#330: FILE: drivers/vhost/net.c:168:
+			pr_err("Truncated TX packet: "
+			       " len %d != %zd\n", err, len);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#344: FILE: drivers/vhost/net.c:182:
+ * read-size critical section for our kind of RCU. */

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#348: FILE: drivers/vhost/net.c:186:
+	unsigned head, out, in, log, s;

WARNING:LINE_SPACING: Missing a blank line after declarations
#368: FILE: drivers/vhost/net.c:206:
+	struct socket *sock = rcu_dereference(vq->private_data);
+	if (!sock || skb_queue_empty(&sock->sk->sk_receive_queue))

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#385: FILE: drivers/vhost/net.c:223:
+			 * check again. */

WARNING:SPLIT_STRING: quoted string split across lines
#394: FILE: drivers/vhost/net.c:232:
+			vq_err(vq, "Unexpected descriptor format for RX: "
+			       "out %d, int %d\n",

WARNING:SPLIT_STRING: quoted string split across lines
#405: FILE: drivers/vhost/net.c:243:
+			vq_err(vq, "Unexpected header len for RX: "
+			       "%zd expected %zd\n",

WARNING:SPLIT_STRING: quoted string split across lines
#419: FILE: drivers/vhost/net.c:257:
+			pr_err("Discarded truncated rx packet: "
+			       " len %d > %zd\n", err, len);

WARNING:LINE_SPACING: Missing a blank line after declarations
#449: FILE: drivers/vhost/net.c:287:
+	struct vhost_net *net;
+	vq = container_of(work, struct vhost_virtqueue, poll.work);

WARNING:LINE_SPACING: Missing a blank line after declarations
#458: FILE: drivers/vhost/net.c:296:
+	struct vhost_net *net;
+	vq = container_of(work, struct vhost_virtqueue, poll.work);

WARNING:LINE_SPACING: Missing a blank line after declarations
#466: FILE: drivers/vhost/net.c:304:
+	struct vhost_net *net;
+	net = container_of(work, struct vhost_net, poll[VHOST_NET_VQ_TX].work);

WARNING:LINE_SPACING: Missing a blank line after declarations
#473: FILE: drivers/vhost/net.c:311:
+	struct vhost_net *net;
+	net = container_of(work, struct vhost_net, poll[VHOST_NET_VQ_RX].work);

WARNING:SIZEOF_PARENTHESIS: sizeof *n should be sizeof(*n)
#479: FILE: drivers/vhost/net.c:317:
+	struct vhost_net *n = kzalloc(sizeof *n, GFP_KERNEL);

WARNING:LINE_SPACING: Missing a blank line after declarations
#481: FILE: drivers/vhost/net.c:319:
+	int r;
+	if (!n)

CHECK:BRACES: braces {} should be used on all arms of this statement
#502: FILE: drivers/vhost/net.c:340:
+	if (index == VHOST_NET_VQ_TX) {
[...]
+	} else
[...]

CHECK:BRACES: Unbalanced braces around else statement
#505: FILE: drivers/vhost/net.c:343:
+	} else

WARNING:LINE_SPACING: Missing a blank line after declarations
#512: FILE: drivers/vhost/net.c:350:
+	struct socket *sock = n->vqs[index].private_data;
+	if (!sock)

CHECK:BRACES: braces {} should be used on all arms of this statement
#514: FILE: drivers/vhost/net.c:352:
+	if (index == VHOST_NET_VQ_TX) {
[...]
+	} else
[...]

CHECK:BRACES: Unbalanced braces around else statement
#517: FILE: drivers/vhost/net.c:355:
+	} else

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#566: FILE: drivers/vhost/net.c:404:
+	 * since jobs can re-queue themselves. */

WARNING:SIZEOF_PARENTHESIS: sizeof uaddr should be sizeof(uaddr)
#578: FILE: drivers/vhost/net.c:416:
+	int uaddr_len = sizeof uaddr, r;

WARNING:LINE_SPACING: Missing a blank line after declarations
#580: FILE: drivers/vhost/net.c:418:
+	struct socket *sock = sockfd_lookup(fd, &r);
+	if (!sock)

WARNING:LINE_SPACING: Missing a blank line after declarations
#608: FILE: drivers/vhost/net.c:446:
+	struct socket *sock;
+	if (!file)

WARNING:LINE_SPACING: Missing a blank line after declarations
#619: FILE: drivers/vhost/net.c:457:
+	struct socket *sock;
+	if (fd == -1)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#630: FILE: drivers/vhost/net.c:468:
+static long vhost_net_set_backend(struct vhost_net *n, unsigned index, int fd)

WARNING:LINE_SPACING: Missing a blank line after declarations
#676: FILE: drivers/vhost/net.c:514:
+	long r;
+	mutex_lock(&n->dev.mutex);

WARNING:LINE_SPACING: Missing a blank line after declarations
#697: FILE: drivers/vhost/net.c:535:
+	int i;
+	mutex_unlock(&n->dev.mutex);

WARNING:MEMORY_BARRIER: memory barrier without comment
#699: FILE: drivers/vhost/net.c:537:
+	smp_wmb();

WARNING:LINE_SPACING: Missing a blank line after declarations
#718: FILE: drivers/vhost/net.c:556:
+	int r;
+	switch (ioctl) {

WARNING:SIZEOF_PARENTHESIS: sizeof backend should be sizeof(backend)
#720: FILE: drivers/vhost/net.c:558:
+		r = copy_from_user(&backend, argp, sizeof backend);

WARNING:STATIC_CONST: Move const after static - use 'static const struct file_operations '
#753: FILE: drivers/vhost/net.c:591:
+const static struct file_operations vhost_net_fops = {

WARNING:LINE_SPACING: Missing a blank line after declarations
#772: FILE: drivers/vhost/net.c:610:
+	int r = vhost_init();
+	if (r)

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#783: FILE: drivers/vhost/net.c:621:
+
+}

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#803: FILE: drivers/vhost/vhost.c:1:
+/* Copyright (C) 2009 Red Hat, Inc.

WARNING:LINE_SPACING: Missing a blank line after declarations
#847: FILE: drivers/vhost/vhost.c:45:
+	struct vhost_poll *poll;
+	poll = container_of(pt, struct vhost_poll, table);

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#853: FILE: drivers/vhost/vhost.c:51:
+static int vhost_poll_wakeup(wait_queue_t *wait, unsigned mode, int sync,

WARNING:LINE_SPACING: Missing a blank line after declarations
#857: FILE: drivers/vhost/vhost.c:55:
+	struct vhost_poll *poll;
+	poll = container_of(wait, struct vhost_poll, wait);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#876: FILE: drivers/vhost/vhost.c:74:
+ * keep a reference to a file until after vhost_poll_stop is called. */

WARNING:LINE_SPACING: Missing a blank line after declarations
#880: FILE: drivers/vhost/vhost.c:78:
+	unsigned long mask;
+	mask = file->f_op->poll(file, &poll->table);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#886: FILE: drivers/vhost/vhost.c:84:
+ * file reference. You must also flush afterwards. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#893: FILE: drivers/vhost/vhost.c:91:
+ * locks that are also used by the callback. */

WARNING:LINE_SPACING: Missing a blank line after declarations
#908: FILE: drivers/vhost/vhost.c:106:
+	int i;
+	dev->vqs = vqs;

WARNING:SIZEOF_PARENTHESIS: sizeof *memory->regions should be sizeof(*memory->regions)
#948: FILE: drivers/vhost/vhost.c:146:
+			 2 * sizeof *memory->regions, GFP_KERNEL);

WARNING:LINE_SPACING: Missing a blank line after declarations
#969: FILE: drivers/vhost/vhost.c:167:
+	int i;
+	for (i = 0; i < dev->nvqs; ++i) {

WARNING:LINE_SPACING: Missing a blank line after declarations
#1009: FILE: drivers/vhost/vhost.c:207:
+	long r;
+	r = copy_from_user(&mem, m, size);

WARNING:SIZEOF_PARENTHESIS: sizeof *m->regions should be sizeof(*m->regions)
#1016: FILE: drivers/vhost/vhost.c:214:
+	newmem = kmalloc(size + mem.nregions * sizeof *m->regions, GFP_KERNEL);

WARNING:SIZEOF_PARENTHESIS: sizeof *m->regions should be sizeof(*m->regions)
#1022: FILE: drivers/vhost/vhost.c:220:
+			   mem.nregions * sizeof *m->regions);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1037: FILE: drivers/vhost/vhost.c:235:
+	int r = put_user(vq->used_flags, &vq->used->flags);
+	if (r)

WARNING:SIZEOF_PARENTHESIS: sizeof s should be sizeof(s)
#1067: FILE: drivers/vhost/vhost.c:265:
+		r = copy_from_user(&s, argp, sizeof s);

WARNING:SIZEOF_PARENTHESIS: sizeof s should be sizeof(s)
#1077: FILE: drivers/vhost/vhost.c:275:
+		r = copy_from_user(&s, argp, sizeof s);

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#1084: FILE: drivers/vhost/vhost.c:282:
+		vq->avail_idx = vq->last_avail_idx = s.num;

Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.

WARNING:SIZEOF_PARENTHESIS: sizeof s should be sizeof(s)
#1089: FILE: drivers/vhost/vhost.c:287:
+		r = copy_to_user(argp, &s, sizeof s);

WARNING:SIZEOF_PARENTHESIS: sizeof a should be sizeof(a)
#1092: FILE: drivers/vhost/vhost.c:290:
+		r = copy_from_user(&a, argp, sizeof a);

WARNING:SIZEOF_PARENTHESIS: sizeof a should be sizeof(a)
#1106: FILE: drivers/vhost/vhost.c:304:
+		r = copy_from_user(&a, argp, sizeof a);

WARNING:SIZEOF_PARENTHESIS: sizeof *vq->avail->ring should be sizeof(*vq->avail->ring)
#1117: FILE: drivers/vhost/vhost.c:315:
+		if (a.user_addr & (sizeof *vq->avail->ring - 1)) {

WARNING:SIZEOF_PARENTHESIS: sizeof a should be sizeof(a)
#1126: FILE: drivers/vhost/vhost.c:324:
+		r = copy_from_user(&a, argp, sizeof a);

WARNING:SIZEOF_PARENTHESIS: sizeof *vq->used->ring should be sizeof(*vq->used->ring)
#1137: FILE: drivers/vhost/vhost.c:335:
+		if (a.user_addr & (sizeof *vq->used->ring - 1)) {

WARNING:SIZEOF_PARENTHESIS: sizeof a should be sizeof(a)
#1147: FILE: drivers/vhost/vhost.c:345:
+		r = copy_from_user(&a, argp, sizeof a);

WARNING:SIZEOF_PARENTHESIS: sizeof *vq->used->ring should be sizeof(*vq->used->ring)
#1158: FILE: drivers/vhost/vhost.c:356:
+		if (a.user_addr & (sizeof *vq->used->ring - 1)) {

WARNING:SIZEOF_PARENTHESIS: sizeof f should be sizeof(f)
#1166: FILE: drivers/vhost/vhost.c:364:
+		r = copy_from_user(&f, argp, sizeof f);

CHECK:BRACES: braces {} should be used on all arms of this statement
#1172: FILE: drivers/vhost/vhost.c:370:
+		if (eventfp != vq->kick) {
[...]
+		} else
[...]

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#1173: FILE: drivers/vhost/vhost.c:371:
+			pollstop = filep = vq->kick;

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#1174: FILE: drivers/vhost/vhost.c:372:
+			pollstart = vq->kick = eventfp;

CHECK:BRACES: Unbalanced braces around else statement
#1175: FILE: drivers/vhost/vhost.c:373:
+		} else

WARNING:SIZEOF_PARENTHESIS: sizeof f should be sizeof(f)
#1179: FILE: drivers/vhost/vhost.c:377:
+		r = copy_from_user(&f, argp, sizeof f);

CHECK:BRACES: braces {} should be used on all arms of this statement
#1185: FILE: drivers/vhost/vhost.c:383:
+		if (eventfp != vq->call) {
[...]
+		} else
[...]

CHECK:BRACES: Unbalanced braces around else statement
#1191: FILE: drivers/vhost/vhost.c:389:
+		} else

WARNING:SIZEOF_PARENTHESIS: sizeof f should be sizeof(f)
#1195: FILE: drivers/vhost/vhost.c:393:
+		r = copy_from_user(&f, argp, sizeof f);

CHECK:BRACES: braces {} should be used on all arms of this statement
#1201: FILE: drivers/vhost/vhost.c:399:
+		if (eventfp != vq->error) {
[...]
+		} else
[...]

CHECK:BRACES: Unbalanced braces around else statement
#1207: FILE: drivers/vhost/vhost.c:405:
+		} else

CHECK:BRACES: braces {} should be used on all arms of this statement
#1280: FILE: drivers/vhost/vhost.c:478:
+		if (eventfp != d->log_file) {
[...]
+		} else
[...]

CHECK:BRACES: Unbalanced braces around else statement
#1285: FILE: drivers/vhost/vhost.c:483:
+		} else

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1312: FILE: drivers/vhost/vhost.c:510:
+	 * regions in practice */

WARNING:LINE_SPACING: Missing a blank line after declarations
#1333: FILE: drivers/vhost/vhost.c:531:
+	int r;
+	r = get_user_pages_fast(log, 1, 1, &page);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1348: FILE: drivers/vhost/vhost.c:546:
+	int r;
+	if (!write_length)

WARNING:LINE_SPACING: Missing a blank line after declarations
#1355: FILE: drivers/vhost/vhost.c:553:
+		int bit = write_address % 8;
+		if ((u64)(unsigned long)log != log)

WARNING:LINE_SPACING: Missing a blank line after declarations
#1377: FILE: drivers/vhost/vhost.c:575:
+		u64 l = min(log[i].len, len);
+		r = log_write(vq->log_base, log[i].addr, l);

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1387: FILE: drivers/vhost/vhost.c:585:
+	BUG();

BUG() or BUG_ON() should be avoided totally.
Use WARN() and WARN_ON() instead, and handle the "impossible"
error condition as gracefully as possible.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on

WARNING:LINE_SPACING: Missing a blank line after declarations
#1405: FILE: drivers/vhost/vhost.c:603:
+		u64 size;
+		if (ret >= iov_size) {

WARNING:MINMAX: min() should probably be min_t(u64, len, size)
#1416: FILE: drivers/vhost/vhost.c:614:
+		_iov->iov_len = min((u64)len, size);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1430: FILE: drivers/vhost/vhost.c:628:
+ * or -1 if we're at the end. */

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1431: FILE: drivers/vhost/vhost.c:629:
+static unsigned next_desc(struct vring_desc *desc)

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1443: FILE: drivers/vhost/vhost.c:641:
+	 * architectures only need a compiler barrier here. */

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1449: FILE: drivers/vhost/vhost.c:647:
+static unsigned get_indirect(struct vhost_dev *dev, struct vhost_virtqueue *vq,

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 12)
#1460: FILE: drivers/vhost/vhost.c:658:
+	if (indirect->len % sizeof desc) {
+	    vq_err(vq, "Invalid length in indirect descriptor: "

WARNING:SIZEOF_PARENTHESIS: sizeof desc should be sizeof(desc)
#1460: FILE: drivers/vhost/vhost.c:658:
+	if (indirect->len % sizeof desc) {

WARNING:SPLIT_STRING: quoted string split across lines
#1462: FILE: drivers/vhost/vhost.c:660:
+	    vq_err(vq, "Invalid length in indirect descriptor: "
+			"len 0x%llx not multiple of 0x%zx\n",

WARNING:SIZEOF_PARENTHESIS: sizeof desc should be sizeof(desc)
#1464: FILE: drivers/vhost/vhost.c:662:
+			sizeof desc);

WARNING:TABSTOP: Statements should start on a tabstop
#1465: FILE: drivers/vhost/vhost.c:663:
+	    return -EINVAL;

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1476: FILE: drivers/vhost/vhost.c:674:
+	 * architectures only need a compiler barrier here. */

WARNING:SIZEOF_PARENTHESIS: sizeof desc should be sizeof(desc)
#1479: FILE: drivers/vhost/vhost.c:677:
+	count = indirect->len / sizeof desc;

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1481: FILE: drivers/vhost/vhost.c:679:
+	 * we can have at most 2^16 of these. */

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1489: FILE: drivers/vhost/vhost.c:687:
+		unsigned iov_count = *in_num + *out_num;

WARNING:LINE_SPACING: Missing a blank line after declarations
#1490: FILE: drivers/vhost/vhost.c:688:
+		unsigned iov_count = *in_num + *out_num;
+		if (++found > count) {

WARNING:SPLIT_STRING: quoted string split across lines
#1492: FILE: drivers/vhost/vhost.c:690:
+			vq_err(vq, "Loop detected: last one at %u "
+			       "indirect size %u\n",

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#1496: FILE: drivers/vhost/vhost.c:694:
+		if (memcpy_fromiovec((unsigned char *)&desc, vq->indirect,
+				     sizeof desc)) {;

Trailing statements (for example after any conditional) should be
on the next line.
Statements, such as::

  if (x == y) break;

should be::

  if (x == y)
          break;

WARNING:SIZEOF_PARENTHESIS: sizeof desc should be sizeof(desc)
#1497: FILE: drivers/vhost/vhost.c:695:
+				     sizeof desc)) {;

WARNING:SIZEOF_PARENTHESIS: sizeof desc should be sizeof(desc)
#1499: FILE: drivers/vhost/vhost.c:697:
+			       i, (size_t)indirect->addr + i * sizeof desc);

WARNING:SIZEOF_PARENTHESIS: sizeof desc should be sizeof(desc)
#1504: FILE: drivers/vhost/vhost.c:702:
+			       i, (size_t)indirect->addr + i * sizeof desc);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1525: FILE: drivers/vhost/vhost.c:723:
+			 * to come before any input descriptors. */

WARNING:SPLIT_STRING: quoted string split across lines
#1528: FILE: drivers/vhost/vhost.c:726:
+				vq_err(vq, "Indirect descriptor "
+				       "has out after in: idx %d\n", i);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1543: FILE: drivers/vhost/vhost.c:741:
+ * is never a valid descriptor number) if none was found. */

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1544: FILE: drivers/vhost/vhost.c:742:
+unsigned vhost_get_vq_desc(struct vhost_dev *dev, struct vhost_virtqueue *vq,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1576: FILE: drivers/vhost/vhost.c:774:
+	 * the index we've seen. */

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1598: FILE: drivers/vhost/vhost.c:796:
+		unsigned iov_count = *in_num + *out_num;

WARNING:LINE_SPACING: Missing a blank line after declarations
#1599: FILE: drivers/vhost/vhost.c:797:
+		unsigned iov_count = *in_num + *out_num;
+		if (i >= vq->num) {

WARNING:SPLIT_STRING: quoted string split across lines
#1606: FILE: drivers/vhost/vhost.c:804:
+			vq_err(vq, "Loop detected: last one at %u "
+			       "vq size %u head %u\n",

WARNING:SIZEOF_PARENTHESIS: sizeof desc should be sizeof(desc)
#1610: FILE: drivers/vhost/vhost.c:808:
+		ret = copy_from_user(&desc, vq->desc + i, sizeof desc);

WARNING:SPLIT_STRING: quoted string split across lines
#1621: FILE: drivers/vhost/vhost.c:819:
+				vq_err(vq, "Failure detected "
+				       "in indirect descriptor at idx %d\n", i);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1644: FILE: drivers/vhost/vhost.c:842:
+			 * to come before any input descriptors. */

WARNING:SPLIT_STRING: quoted string split across lines
#1647: FILE: drivers/vhost/vhost.c:845:
+				vq_err(vq, "Descriptor has out after in: "
+				       "idx %d\n", i);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1666: FILE: drivers/vhost/vhost.c:864:
+ * want to send them an interrupt, using vq->call. */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1668: FILE: drivers/vhost/vhost.c:866:
+int vhost_add_used(struct vhost_virtqueue *vq,
+			  unsigned int head, int len)

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1673: FILE: drivers/vhost/vhost.c:871:
+	 * next entry in that used ring. */

WARNING:SIZEOF_PARENTHESIS: sizeof *vq->used->ring should be sizeof(*vq->used->ring)
#1692: FILE: drivers/vhost/vhost.c:890:
+		log_write(vq->log_base, vq->log_addr + sizeof *vq->used->ring

WARNING:SIZEOF_PARENTHESIS: sizeof *vq->used->ring should be sizeof(*vq->used->ring)
#1693: FILE: drivers/vhost/vhost.c:891:
+			  * (vq->last_used_idx % vq->num), sizeof *vq->used->ring);

WARNING:SIZEOF_PARENTHESIS: sizeof *vq->used->ring should be sizeof(*vq->used->ring)
#1694: FILE: drivers/vhost/vhost.c:892:
+		log_write(vq->log_base, vq->log_addr, sizeof *vq->used->ring);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1706: FILE: drivers/vhost/vhost.c:904:
+	__u16 flags = 0;
+	if (get_user(flags, &vq->avail->flags)) {

WARNING:LINE_SPACING: Missing a blank line after declarations
#1735: FILE: drivers/vhost/vhost.c:933:
+	int r;
+	if (!(vq->used_flags & VRING_USED_F_NO_NOTIFY))

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1742: FILE: drivers/vhost/vhost.c:940:
+	 * sure it's written, tell caller it needs to check again. */

WARNING:LINE_SPACING: Missing a blank line after declarations
#1751: FILE: drivers/vhost/vhost.c:949:
+	int r;
+	if (vq->used_flags & VRING_USED_F_NO_NOTIFY)

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#1777: FILE: drivers/vhost/vhost.h:1:
+#ifndef _VHOST_H

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1869: FILE: drivers/vhost/vhost.h:93:
+	 * Writers use virtqueue mutex. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1879: FILE: drivers/vhost/vhost.h:103:
+	 * Writers use mutex below.*/

CHECK:UNCOMMENTED_DEFINITION: struct mutex definition without comment
#1882: FILE: drivers/vhost/vhost.h:106:
+	struct mutex mutex;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1883: FILE: drivers/vhost/vhost.h:107:
+	unsigned acked_features;

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1890: FILE: drivers/vhost/vhost.h:114:
+long vhost_dev_init(struct vhost_dev *, struct vhost_virtqueue *vqs, int nvqs);

This warning is emitted due to any of the following reasons:

  1. Arguments for the function declaration do not follow
     the identifier name.  Example::

       void foo
       (int bar, int baz)

     This should be corrected to::

       void foo(int bar, int baz)

  2. Some arguments for the function definition do not
     have an identifier name.  Example::

       void foo(int)

     All arguments should have identifier names.

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1891: FILE: drivers/vhost/vhost.h:115:
+long vhost_dev_check_owner(struct vhost_dev *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1892: FILE: drivers/vhost/vhost.h:116:
+long vhost_dev_reset_owner(struct vhost_dev *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1893: FILE: drivers/vhost/vhost.h:117:
+void vhost_dev_cleanup(struct vhost_dev *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1894: FILE: drivers/vhost/vhost.h:118:
+long vhost_dev_ioctl(struct vhost_dev *, unsigned int ioctl, unsigned long arg);

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1896: FILE: drivers/vhost/vhost.h:120:
+unsigned vhost_get_vq_desc(struct vhost_dev *, struct vhost_virtqueue *,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1896: FILE: drivers/vhost/vhost.h:120:
+unsigned vhost_get_vq_desc(struct vhost_dev *, struct vhost_virtqueue *,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_virtqueue *' should also have an identifier name
#1896: FILE: drivers/vhost/vhost.h:120:
+unsigned vhost_get_vq_desc(struct vhost_dev *, struct vhost_virtqueue *,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_virtqueue *' should also have an identifier name
#1900: FILE: drivers/vhost/vhost.h:124:
+void vhost_discard_vq_desc(struct vhost_virtqueue *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_virtqueue *' should also have an identifier name
#1902: FILE: drivers/vhost/vhost.h:126:
+int vhost_add_used(struct vhost_virtqueue *, unsigned int head, int len);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1903: FILE: drivers/vhost/vhost.h:127:
+void vhost_trigger_irq(struct vhost_dev *, struct vhost_virtqueue *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_virtqueue *' should also have an identifier name
#1903: FILE: drivers/vhost/vhost.h:127:
+void vhost_trigger_irq(struct vhost_dev *, struct vhost_virtqueue *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_dev *' should also have an identifier name
#1904: FILE: drivers/vhost/vhost.h:128:
+void vhost_add_used_and_trigger(struct vhost_dev *, struct vhost_virtqueue *,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_virtqueue *' should also have an identifier name
#1904: FILE: drivers/vhost/vhost.h:128:
+void vhost_add_used_and_trigger(struct vhost_dev *, struct vhost_virtqueue *,

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_virtqueue *' should also have an identifier name
#1906: FILE: drivers/vhost/vhost.h:130:
+void vhost_no_notify(struct vhost_virtqueue *);

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct vhost_virtqueue *' should also have an identifier name
#1907: FILE: drivers/vhost/vhost.h:131:
+bool vhost_notify(struct vhost_virtqueue *);

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'vq' - possible side-effects?
#1915: FILE: drivers/vhost/vhost.h:139:
+#define vq_err(vq, fmt, ...) do {                                  \
+		pr_debug(pr_fmt(fmt), ##__VA_ARGS__);       \
+		if ((vq)->error_ctx)                               \
+				eventfd_signal((vq)->error_ctx, 1);\
+	} while (0)

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (16, 32)
#1917: FILE: drivers/vhost/vhost.h:141:
+		if ((vq)->error_ctx)                               \
+				eventfd_signal((vq)->error_ctx, 1);\

ERROR:CODE_INDENT: code indent should use tabs where possible
#1923: FILE: drivers/vhost/vhost.h:147:
+^I                 (1 << VIRTIO_RING_F_INDIRECT_DESC) |$

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1930: FILE: drivers/vhost/vhost.h:154:
+	unsigned acked_features = rcu_dereference(dev->acked_features);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1931: FILE: drivers/vhost/vhost.h:155:
+	unsigned acked_features = rcu_dereference(dev->acked_features);
+	return acked_features & (1 << bit);

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#1965: FILE: include/linux/vhost.h:1:
+#ifndef _LINUX_VHOST_H

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2021: FILE: include/linux/vhost.h:57:
+ * vhost specific features. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2027: FILE: include/linux/vhost.h:63:
+ * VHOST_OWNER_SET fail until VHOST_OWNER_RESET is called. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2030: FILE: include/linux/vhost.h:66:
+ * Allows subsequent call to VHOST_OWNER_SET to succeed. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2039: FILE: include/linux/vhost.h:75:
+ * The bit is set using an atomic 32 bit operation. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2046: FILE: include/linux/vhost.h:82:
+ * (bound to a device). */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2062: FILE: include/linux/vhost.h:98:
+ * Address must be 32 bit aligned. Pass 0x1 to disable logging. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2067: FILE: include/linux/vhost.h:103:
+ * for events. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2081: FILE: include/linux/vhost.h:117:
+ * device.  This can be used to stop the ring (e.g. for migration). */

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000053170.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 11 errors, 161 warnings, 19 checks, 1942 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000053170.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
