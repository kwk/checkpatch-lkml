ERROR:TRAILING_WHITESPACE: trailing whitespace
#55: FILE: Documentation/networking/ipn.txt:14:
+policies can be defined.  $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:TYPO_SPELLING: 'receipients' may be misspelled - perhaps 'recipients'?
#78: FILE: Documentation/networking/ipn.txt:37:
+(1) is the basic policy: a packet is sent to all the receipients but the sender
                                                      ^^^^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:REPEATED_WORD: Possible repeated word: 'with'
#113: FILE: Documentation/networking/ipn.txt:72:
+messages by design. It is the case of networks used with with exactly one

ERROR:TRAILING_WHITESPACE: trailing whitespace
#138: FILE: Documentation/networking/ipn.txt:97:
+must be set prior to connect.  $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#149: FILE: Documentation/networking/ipn.txt:108:
+behavior. $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#165: FILE: Documentation/networking/ipn.txt:124:
+way. The created socket permission are (mode & ~umask).  $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#169: FILE: Documentation/networking/ipn.txt:128:
+IPN_SO_CHANGE_NUMNODES: (runtime) change of the number of ipn network ports. $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#180: FILE: Documentation/networking/ipn.txt:139:
+maxlength IPN_DESCRLEN. It is just used by debugging tools.  $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#185: FILE: Documentation/networking/ipn.txt:144:
+of #writers #readers (requires IPN_SO_HANDLE_OOB) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#222: FILE: Documentation/networking/ipn.txt:181:
+or GRAB). $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#228: FILE: Documentation/networking/ipn.txt:187:
+closed. $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#233: FILE: Documentation/networking/ipn.txt:192:
+the interface this call fails (EADDRNOTAVAIL). $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#240: FILE: Documentation/networking/ipn.txt:199:
+(ifr_name) or by index (ifr_index). $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#247: FILE: Documentation/networking/ipn.txt:206:
+is terminated, too. $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#250: FILE: Documentation/networking/ipn.txt:209:
+are cleared.  $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#256: FILE: Documentation/networking/ipn.txt:215:
+opportunities for applications. $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#261: FILE: Documentation/networking/ipn.txt:220:
+    considerable speedup.  $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#264: FILE: Documentation/networking/ipn.txt:223:
+    * All the applications which need multicasting of data streams, like tee $

WARNING:TYPO_SPELLING: 'receipients' may be misspelled - perhaps 'recipients'?
#330: FILE: Documentation/networking/ipn.txt:289:
+ /* compute the set of receipients */
                        ^^^^^^^^^^^

WARNING:TYPO_SPELLING: 'receipient' may be misspelled - perhaps 'recipient'?
#331: FILE: Documentation/networking/ipn.txt:290:
+ for (/*each receipient "to"*/)
              ^^^^^^^^^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#364: FILE: Documentation/networking/ipn.txt:323:
+ipn_p_ioctl protocols can implement also specific ioctl services. $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#367: FILE: Documentation/networking/ipn.txt:326:
+web site: wiki.virtualsquare.org $

WARNING:MAINTAINERS_STYLE: Misordered MAINTAINERS entry - list 'M:' before 'P:'
#377: FILE: MAINTAINERS:2099:
+P:	Renzo Davoli
+M:	renzo@cs.unibo.it

WARNING:MAINTAINERS_STYLE: Misordered MAINTAINERS entry - list 'M:' before 'P:'
#379: FILE: MAINTAINERS:2101:
+P:	Ludovico Gardenghi
+M:	garden@cs.unibo.it

WARNING:MAINTAINERS_STYLE: Misordered MAINTAINERS entry - list 'S:' before 'W:'
#382: FILE: MAINTAINERS:2104:
+W:	http://wiki.virtualsquare.org
+S:	Maintained

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#419: FILE: include/linux/socket.h:192:
+#define AF_IPN^I^I34^I/* IPN sockets  ^I^I*/$

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#436: FILE: include/net/af_ipn.h:1:
+#ifndef __LINUX_NET_AFIPN_H

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

ERROR:TRAILING_WHITESPACE: trailing whitespace
#465: FILE: include/net/af_ipn.h:30:
+#define IPN_SETPERSIST_NETDEV  ^I_IOW('I', 200, int) $

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#465: FILE: include/net/af_ipn.h:30:
+#define IPN_SETPERSIST_NETDEV  ^I_IOW('I', 200, int) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#466: FILE: include/net/af_ipn.h:31:
+#define IPN_CLRPERSIST_NETDEV  ^I_IOW('I', 201, int) $

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#466: FILE: include/net/af_ipn.h:31:
+#define IPN_CLRPERSIST_NETDEV  ^I_IOW('I', 201, int) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#467: FILE: include/net/af_ipn.h:32:
+#define IPN_CONN_NETDEV          _IOW('I', 202, int) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#468: FILE: include/net/af_ipn.h:33:
+#define IPN_JOIN_NETDEV          _IOW('I', 203, int) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#469: FILE: include/net/af_ipn.h:34:
+#define IPN_SETPERSIST           _IOW('I', 204, int) $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#480: FILE: include/net/af_ipn.h:45:
+ * */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

ERROR:TRAILING_WHITESPACE: trailing whitespace
#502: FILE: include/net/af_ipn.h:67:
+/* $

WARNING:TYPO_SPELLING: 'netowrk' may be misspelled - perhaps 'network'?
#510: FILE: include/net/af_ipn.h:75:
+ * @portno=when connected: port of the netowrk (<0 means unconnected)
                                        ^^^^^^^

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#520: FILE: include/net/af_ipn.h:85:
+ * @pbp=temporary storage for parms that must be set prior to bind
                               ^^^^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#526: FILE: include/net/af_ipn.h:91:
+^Ivolatile unsigned char flags; $

WARNING:VOLATILE: Use of volatile is usually wrong: see Documentation/process/volatile-considered-harmful.rst
#526: FILE: include/net/af_ipn.h:91:
+	volatile unsigned char flags; 

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#530: FILE: include/net/af_ipn.h:95:
+	spinlock_t msglock;

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#542: FILE: include/net/af_ipn.h:107:
+};
+#define IPN_NODEFLAG_BOUND 0x1     /* bind succeeded */

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#552: FILE: include/net/af_ipn.h:117:
+ * $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#563: FILE: include/net/af_ipn.h:128:
+/* $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#590: FILE: include/net/af_ipn.h:155:
+  struct vfsmount^I^I*mnt;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#608: FILE: include/net/af_ipn.h:173:
+/* struct msgpool_item $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#623: FILE: include/net/af_ipn.h:188:
+/* $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#627: FILE: include/net/af_ipn.h:192:
+ * @newport=upcall for reporting a new port. returns the portno, -1=error  $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#643: FILE: include/net/af_ipn.h:208:
+	int (*ipn_p_handlemsg)(struct ipn_node *from,struct msgpool_item *msgitem);
 	                                            ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:SPACING: space required after that ',' (ctx:VxV)
#648: FILE: include/net/af_ipn.h:213:
+	int (*ipn_p_resizenet)(struct ipn_network *net,int oldsize,int newsize);
 	                                              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#648: FILE: include/net/af_ipn.h:213:
+	int (*ipn_p_resizenet)(struct ipn_network *net,int oldsize,int newsize);
 	                                                          ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#650: FILE: include/net/af_ipn.h:215:
+	int (*ipn_p_setsockopt)(struct ipn_node *port,int optname,
 	                                             ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#651: FILE: include/net/af_ipn.h:216:
+	int (*ipn_p_setsockopt)(struct ipn_node *port,int optname,
+			char __user *optval, int optlen);

ERROR:SPACING: space required after that ',' (ctx:VxV)
#652: FILE: include/net/af_ipn.h:217:
+	int (*ipn_p_getsockopt)(struct ipn_node *port,int optname,
 	                                             ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#653: FILE: include/net/af_ipn.h:218:
+	int (*ipn_p_getsockopt)(struct ipn_node *port,int optname,
+			char __user *optval, int *optlen);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#654: FILE: include/net/af_ipn.h:219:
+^Iint (*ipn_p_ioctl)(struct ipn_node *port,unsigned int request, $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#654: FILE: include/net/af_ipn.h:219:
+	int (*ipn_p_ioctl)(struct ipn_node *port,unsigned int request, 
 	                                        ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#655: FILE: include/net/af_ipn.h:220:
+	int (*ipn_p_ioctl)(struct ipn_node *port,unsigned int request, 
+			unsigned long arg);

ERROR:SPACING: space required after that ',' (ctx:VxV)
#658: FILE: include/net/af_ipn.h:223:
+int ipn_proto_register(int protocol,struct ipn_protocol *ipn_service);
                                    ^

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!skb->dev->macvlan_port"
#699: FILE: net/core/dev.c:1928:
+	if (!skb || skb->dev->macvlan_port == NULL)

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

WARNING:PREFER_IS_ENABLED: Prefer IS_ENABLED(<FOO>) to CONFIG_<FOO> || CONFIG_<FOO>_MODULE
#707: FILE: net/core/dev.c:1941:
+#if defined(CONFIG_IPN) || defined(CONFIG_IPN_MODULE)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#709: FILE: net/core/dev.c:1943:
+struct sk_buff *(*ipn_handle_frame_hook)(struct ipn_node *port,
+					struct sk_buff *skb) __read_mostly;

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#710: FILE: net/core/dev.c:1944:
+EXPORT_SYMBOL_GPL(ipn_handle_frame_hook);

EXPORT_SYMBOL should immediately follow the symbol to be exported.

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#713: FILE: net/core/dev.c:1947:
+static inline struct sk_buff *handle_ipn(struct sk_buff *skb,
+					     struct packet_type **pt_prev,

WARNING:TABSTOP: Statements should start on a tabstop
#717: FILE: net/core/dev.c:1951:
+	 struct ipn_node *port;

WARNING:TABSTOP: Statements should start on a tabstop
#719: FILE: net/core/dev.c:1953:
+	 if (!skb || skb->pkt_type == PACKET_LOOPBACK ||

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (9, 17)
#719: FILE: net/core/dev.c:1953:
+	 if (!skb || skb->pkt_type == PACKET_LOOPBACK ||
[...]
+		 return skb;

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#719: FILE: net/core/dev.c:1953:
+	 if (!skb || skb->pkt_type == PACKET_LOOPBACK ||

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#720: FILE: net/core/dev.c:1954:
+	 if (!skb || skb->pkt_type == PACKET_LOOPBACK ||
+			 (port = rcu_dereference(skb->dev->ipn_port)) == NULL)

WARNING:TABSTOP: Statements should start on a tabstop
#721: FILE: net/core/dev.c:1955:
+		 return skb;

WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#755: FILE: net/ipn/Kconfig:5:
+config IPN
+	tristate "IPN domain sockets (EXPERIMENTAL)"
+	depends on EXPERIMENTAL
+	---help---
+	  If you say Y here, you will include support for IPN domain sockets.
+	  Inter Process Networking socket are similar to Unix sockets but
+	  they support peer-to-peer, one-to-many and many-to-many communication
+	  among processes. 
+	  Sub-Modules can be loaded to provide dispatching protocols.
+	  This service include the IPN_BROADCST policy: all the messages get
+	  sent to all the receipients (but the sender itself).
+
+	  To compile this driver as a module, choose M here: the module will be
+	  called ipn.  
+
+	  If unsure, say 'N'.
+

Kconfig symbols should have a help text which fully describes
it.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#762: FILE: net/ipn/Kconfig:12:
+^I  among processes. $

WARNING:TYPO_SPELLING: 'receipients' may be misspelled - perhaps 'recipients'?
#765: FILE: net/ipn/Kconfig:15:
+	  sent to all the receipients (but the sender itself).
 	                  ^^^^^^^^^^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#768: FILE: net/ipn/Kconfig:18:
+^I  called ipn.  $

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#788: FILE: net/ipn/af_ipn.c:1:
+/*

ERROR:TRAILING_WHITESPACE: trailing whitespace
#790: FILE: net/ipn/af_ipn.c:3:
+ *  (part of the View-OS project: wiki.virtualsquare.org) $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#826: FILE: net/ipn/af_ipn.c:39:
+ * when the bit is set recv fails */

ERROR:TRAILING_WHITESPACE: trailing whitespace
#844: FILE: net/ipn/af_ipn.c:57:
+static int ipn_bcast_handlemsg(struct ipn_node *from, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#845: FILE: net/ipn/af_ipn.c:58:
+static int ipn_bcast_handlemsg(struct ipn_node *from, 
+		struct msgpool_item *msgitem);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#849: FILE: net/ipn/af_ipn.c:62:
+	.refcnt=0,
 	       ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#850: FILE: net/ipn/af_ipn.c:63:
+^I.ipn_p_newport=ipn_bcast_newport, $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#850: FILE: net/ipn/af_ipn.c:63:
+	.ipn_p_newport=ipn_bcast_newport, 
 	              ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#851: FILE: net/ipn/af_ipn.c:64:
+	.ipn_p_handlemsg=ipn_bcast_handlemsg};
 	                ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#853: FILE: net/ipn/af_ipn.c:66:
+static struct ipn_protocol *ipn_protocol_table[IPN_MAX_PROTO]={&ipn_bcast};
                                                              ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#859: FILE: net/ipn/af_ipn.c:72:
+static int ipn_connect(struct socket *, struct sockaddr *,
+		int addr_len, int flags);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#865: FILE: net/ipn/af_ipn.c:78:
+static int ipn_sendmsg(struct kiocb *, struct socket *,
+		struct msghdr *, size_t);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#867: FILE: net/ipn/af_ipn.c:80:
+static int ipn_recvmsg(struct kiocb *, struct socket *,
+		struct msghdr *, size_t, int);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#869: FILE: net/ipn/af_ipn.c:82:
+static int ipn_setsockopt(struct socket *sock, int level, int optname,
+		char __user *optval, int optlen);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#871: FILE: net/ipn/af_ipn.c:84:
+static int ipn_getsockopt(struct socket *sock, int level, int optname,
+		char __user *optval, int __user *optlen);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#873: FILE: net/ipn/af_ipn.c:86:
+/* Network table Management $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#874: FILE: net/ipn/af_ipn.c:87:
+ * inode->ipn_network hash table */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#896: FILE: net/ipn/af_ipn.c:109:
+	hlist_for_each_entry(ipnn, node,
+			&ipn_network_table[i->i_ino & (IPN_HASH_SIZE - 1)], hnode) {

ERROR:SPACING: space required before the open parenthesis '('
#899: FILE: net/ipn/af_ipn.c:112:
+		if(atomic_read(&ipnn->refcnt) > 0 && dentry && dentry->d_inode == i)

ERROR:TRAILING_WHITESPACE: trailing whitespace
#908: FILE: net/ipn/af_ipn.c:121:
+/* msgpool management $

WARNING:TYPO_SPELLING: 'receipient' may be misspelled - perhaps 'recipient'?
#911: FILE: net/ipn/af_ipn.c:124:
+ * one for each receipient. 
                 ^^^^^^^^^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#911: FILE: net/ipn/af_ipn.c:124:
+ * one for each receipient. $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#915: FILE: net/ipn/af_ipn.c:128:
+ * msgpool_item elements gets deleted automatically when count is 0*/

WARNING:TYPO_SPELLING: 'receipient' may be misspelled - perhaps 'recipient'?
#925: FILE: net/ipn/af_ipn.c:138:
+ *  for each receipient
              ^^^^^^^^^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#926: FILE: net/ipn/af_ipn.c:139:
+ *    enqueue messages to the process (using msgitem), ipn_msgpool_hold $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#930: FILE: net/ipn/af_ipn.c:143:
+ * receivers */

WARNING:LINE_SPACING: Missing a blank line after declarations
#934: FILE: net/ipn/af_ipn.c:147:
+	struct msgpool_item *new;
+	new=kmem_cache_alloc(ipnn->msgpool_cache,GFP_KERNEL);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#934: FILE: net/ipn/af_ipn.c:147:
+	new=kmem_cache_alloc(ipnn->msgpool_cache,GFP_KERNEL);
 	   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#934: FILE: net/ipn/af_ipn.c:147:
+	new=kmem_cache_alloc(ipnn->msgpool_cache,GFP_KERNEL);
 	                                        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#935: FILE: net/ipn/af_ipn.c:148:
+	atomic_set(&new->count,1);
 	                      ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#941: FILE: net/ipn/af_ipn.c:154:
+ * available msgpool item */

WARNING:LONG_LINE: line length of 104 exceeds 100 columns
#947: FILE: net/ipn/af_ipn.c:160:
+						atomic_read(&ipnn->msgpool_nelem) < ipnn->msgpool_size))

The line has exceeded the specified maximum length.
To use a different maximum line length, the --max-line-length=n option
may be added while invoking checkpatch.

Earlier, the default line length was 80 columns.  Commit bdc48fa11e46
("checkpatch/coding-style: deprecate 80-column warning") increased the
limit to 100 columns.  This is not a hard limit either and it's
preferable to stay within 80 columns whenever possible.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#947: FILE: net/ipn/af_ipn.c:160:
+			if (wait_event_interruptible_exclusive(ipnn->send_wait,
+						atomic_read(&ipnn->msgpool_nelem) < ipnn->msgpool_size))

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#961: FILE: net/ipn/af_ipn.c:174:
+void ipn_msgpool_put(struct msgpool_item *old,
+		struct ipn_network *ipnn)

ERROR:SPACING: space required after that ',' (ctx:VxV)
#964: FILE: net/ipn/af_ipn.c:177:
+		kmem_cache_free(ipnn->msgpool_cache,old);
 		                                   ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1001: FILE: net/ipn/af_ipn.c:214:
+ * when a node is "persistent", ipn_node survives while ipn_sock gets released*/

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1002: FILE: net/ipn/af_ipn.c:215:
+static int ipn_create(struct net *net,struct socket *sock, int protocol)
                                      ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1006: FILE: net/ipn/af_ipn.c:219:
+^I$

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1013: FILE: net/ipn/af_ipn.c:226:
+		protocol=protocol-1;
 		        ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1013: FILE: net/ipn/af_ipn.c:226:
+		protocol=protocol-1;
 		                 ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1015: FILE: net/ipn/af_ipn.c:228:
+		protocol=IPN_BROADCAST-1;
 		        ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1015: FILE: net/ipn/af_ipn.c:228:
+		protocol=IPN_BROADCAST-1;
 		                      ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1017: FILE: net/ipn/af_ipn.c:230:
+	if (protocol < 0 || protocol >= IPN_MAX_PROTO ||
+			ipn_protocol_table[protocol] == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ipn_protocol_table[protocol]"
#1017: FILE: net/ipn/af_ipn.c:230:
+			ipn_protocol_table[protocol] == NULL)

CHECK:SPACING: No space is necessary after a cast
#1019: FILE: net/ipn/af_ipn.c:232:
+	ipn_sk = (struct ipn_sock *) sk_alloc(net, PF_IPN, GFP_KERNEL, &ipn_proto);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1021: FILE: net/ipn/af_ipn.c:234:
+^Iif (!ipn_sk) $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1023: FILE: net/ipn/af_ipn.c:236:
+	ipn_sk->node=ipn_node=kmem_cache_alloc(ipn_node_cache,GFP_KERNEL);
 	            ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1023: FILE: net/ipn/af_ipn.c:236:
+	ipn_sk->node=ipn_node=kmem_cache_alloc(ipn_node_cache,GFP_KERNEL);
 	                     ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1023: FILE: net/ipn/af_ipn.c:236:
+	ipn_sk->node=ipn_node=kmem_cache_alloc(ipn_node_cache,GFP_KERNEL);
 	                                                     ^

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#1023: FILE: net/ipn/af_ipn.c:236:
+	ipn_sk->node=ipn_node=kmem_cache_alloc(ipn_node_cache,GFP_KERNEL);

Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.

CHECK:SPACING: No space is necessary after a cast
#1025: FILE: net/ipn/af_ipn.c:238:
+		sock_put((struct sock *) ipn_sk);

CHECK:SPACING: No space is necessary after a cast
#1028: FILE: net/ipn/af_ipn.c:241:
+	sock_init_data(sock,(struct sock *) ipn_sk);

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1028: FILE: net/ipn/af_ipn.c:241:
+	sock_init_data(sock,(struct sock *) ipn_sk);
 	                   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1031: FILE: net/ipn/af_ipn.c:244:
+	sock->sk=(struct sock *)ipn_sk;
 	        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1033: FILE: net/ipn/af_ipn.c:246:
+	ipn_node->protocol=protocol;
 	                  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1034: FILE: net/ipn/af_ipn.c:247:
+	ipn_node->flags=IPN_NODEFLAG_INUSE;
 	               ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1035: FILE: net/ipn/af_ipn.c:248:
+	ipn_node->shutdown=RCV_SHUTDOWN_NO_OOB;
 	                  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1036: FILE: net/ipn/af_ipn.c:249:
+	ipn_node->descr[0]=0;
 	                  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1037: FILE: net/ipn/af_ipn.c:250:
+	ipn_node->portno=IPN_PORTNO_ANY;
 	                ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1038: FILE: net/ipn/af_ipn.c:251:
+	ipn_node->net=net;
 	             ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1039: FILE: net/ipn/af_ipn.c:252:
+	ipn_node->dev=NULL;
 	             ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1040: FILE: net/ipn/af_ipn.c:253:
+	ipn_node->proto_private=NULL;
 	                       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1041: FILE: net/ipn/af_ipn.c:254:
+	ipn_node->totmsgcount=0;
 	                     ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1042: FILE: net/ipn/af_ipn.c:255:
+	ipn_node->oobmsgcount=0;
 	                     ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1046: FILE: net/ipn/af_ipn.c:259:
+	ipn_node->ipn=NULL;
 	             ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1048: FILE: net/ipn/af_ipn.c:261:
+	ipn_node->pbp=NULL;
 	             ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1053: FILE: net/ipn/af_ipn.c:266:
+ * This function sends oob messages to nodes requesting the service */

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1054: FILE: net/ipn/af_ipn.c:267:
+static void ipn_net_update_counters(struct ipn_network *ipnn,
+		int chg_readers, int chg_writers) {

The opening brace should be following the function definitions on the
next line.  For any non-functional block it should be on the same line
as the last construct.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1055: FILE: net/ipn/af_ipn.c:268:
+static void ipn_net_update_counters(struct ipn_network *ipnn,
+		int chg_readers, int chg_writers) {

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#1058: FILE: net/ipn/af_ipn.c:271:
+	if (ipnn->mtu >= sizeof(struct numnode_oob))
+	{

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1060: FILE: net/ipn/af_ipn.c:273:
+		struct msgpool_item *ipn_msg=ipn_msgpool_alloc(ipnn);
 		                            ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1061: FILE: net/ipn/af_ipn.c:274:
+		struct msgpool_item *ipn_msg=ipn_msgpool_alloc(ipnn);
+		if (ipn_msg) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1062: FILE: net/ipn/af_ipn.c:275:
+			struct numnode_oob *oob_msg=(struct numnode_oob *)(ipn_msg->data);
 			                           ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1064: FILE: net/ipn/af_ipn.c:277:
+			struct ipn_node *ipn_node;
+			ipn_msg->len=sizeof(struct numnode_oob);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1064: FILE: net/ipn/af_ipn.c:277:
+			ipn_msg->len=sizeof(struct numnode_oob);
 			            ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1065: FILE: net/ipn/af_ipn.c:278:
+			oob_msg->level=IPN_ANY;
 			              ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1066: FILE: net/ipn/af_ipn.c:279:
+			oob_msg->tag=IPN_OOB_NUMNODE_TAG;
 			            ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1067: FILE: net/ipn/af_ipn.c:280:
+			oob_msg->numreaders=ipnn->numreaders;
 			                   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1068: FILE: net/ipn/af_ipn.c:281:
+			oob_msg->numwriters=ipnn->numwriters;
 			                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1071: FILE: net/ipn/af_ipn.c:284:
+					ipn_proto_oobsendmsg(ipn_node,ipn_msg);
 					                             ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1073: FILE: net/ipn/af_ipn.c:286:
+			ipn_msgpool_put(ipn_msg,ipnn);
 			                       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1081: FILE: net/ipn/af_ipn.c:294:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1082: FILE: net/ipn/af_ipn.c:295:
+	struct ipn_network *ipnn=ipn_node->ipn;
+	spin_lock(&ipn_node->msglock);

ERROR:SPACING: spaces required around that '=' (ctx:VxE)
#1084: FILE: net/ipn/af_ipn.c:297:
+		struct msgitem *msgitem=
 		                       ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1088: FILE: net/ipn/af_ipn.c:301:
+		ipn_msgpool_put(msgitem->msg,ipnn);
 		                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1089: FILE: net/ipn/af_ipn.c:302:
+		kmem_cache_free(ipn_msgitem_cache,msgitem);
 		                                 ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1097: FILE: net/ipn/af_ipn.c:310:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1098: FILE: net/ipn/af_ipn.c:311:
+	struct ipn_network *ipnn=ipn_node->ipn;
+	spin_lock(&ipn_node->msglock);

ERROR:SPACING: spaces required around that '=' (ctx:VxE)
#1100: FILE: net/ipn/af_ipn.c:313:
+		struct msgitem *msgitem=
 		                       ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1105: FILE: net/ipn/af_ipn.c:318:
+		ipn_msgpool_put(msgitem->msg,ipnn);
 		                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1106: FILE: net/ipn/af_ipn.c:319:
+		kmem_cache_free(ipn_msgitem_cache,msgitem);
 		                                 ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1114: FILE: net/ipn/af_ipn.c:327:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1115: FILE: net/ipn/af_ipn.c:328:
+	struct ipn_network *ipnn=ipn_node->ipn;
+	if (ipnn) {

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1116: FILE: net/ipn/af_ipn.c:329:
+^I^Iif (down_interruptible(&ipnn->ipnn_mutex)) $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1120: FILE: net/ipn/af_ipn.c:333:
+			ipnn->connport[ipn_node->portno]=NULL;
 			                                ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1127: FILE: net/ipn/af_ipn.c:340:
+		ipn_node->ipn=NULL;
 		             ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1129: FILE: net/ipn/af_ipn.c:342:
+		ipn_net_update_counters(ipnn,
+				(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#1129: FILE: net/ipn/af_ipn.c:342:
+				(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,
 				                                   ^

ERROR:SPACING: spaces required around that ':' (ctx:VxO)
#1129: FILE: net/ipn/af_ipn.c:342:
+				(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,
 				                                     ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1129: FILE: net/ipn/af_ipn.c:342:
+				(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,
 				                                      ^

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#1130: FILE: net/ipn/af_ipn.c:343:
+				(ipn_node->shutdown & SEND_SHUTDOWN)?0:-1);
 				                                    ^

ERROR:SPACING: spaces required around that ':' (ctx:VxO)
#1130: FILE: net/ipn/af_ipn.c:343:
+				(ipn_node->shutdown & SEND_SHUTDOWN)?0:-1);
 				                                      ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1130: FILE: net/ipn/af_ipn.c:343:
+				(ipn_node->shutdown & SEND_SHUTDOWN)?0:-1);
 				                                       ^

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#1136: FILE: net/ipn/af_ipn.c:349:
+		if (atomic_dec_and_test(&ipnn->refcnt))
+		{

WARNING:NEEDLESS_IF: kmem_cache_destroy(NULL) is safe and this check is probably not required
#1147: FILE: net/ipn/af_ipn.c:360:
+			if (ipnn->msgpool_cache)
+				kmem_cache_destroy(ipnn->msgpool_cache);

WARNING:NEEDLESS_IF: kfree(NULL) is safe and this check is probably not required
#1149: FILE: net/ipn/af_ipn.c:362:
+			if (ipnn->connport)
+				kfree(ipnn->connport);

WARNING:NEEDLESS_IF: kfree(NULL) is safe and this check is probably not required
#1154: FILE: net/ipn/af_ipn.c:367:
+	if (ipn_node->pbp) {
+		kfree(ipn_node->pbp);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1155: FILE: net/ipn/af_ipn.c:368:
+		ipn_node->pbp=NULL;
 		             ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1156: FILE: net/ipn/af_ipn.c:369:
+^I} $

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1162: FILE: net/ipn/af_ipn.c:375:
+static int ipn_release (struct socket *sock)

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1164: FILE: net/ipn/af_ipn.c:377:
+	struct ipn_sock *ipn_sk=(struct ipn_sock *)sock->sk;
 	                       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1165: FILE: net/ipn/af_ipn.c:378:
+	struct ipn_node *ipn_node=ipn_sk->node;
 	                         ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1167: FILE: net/ipn/af_ipn.c:380:
+	int rv;
+	if (down_interruptible(&ipn_glob_mutex))

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1171: FILE: net/ipn/af_ipn.c:384:
+		rv=0;
 		  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1173: FILE: net/ipn/af_ipn.c:386:
+		rv=ipn_terminate_node(ipn_node);
 		  ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1174: FILE: net/ipn/af_ipn.c:387:
+^I^Iif (rv==0) $

ERROR:SPACING: spaces required around that '==' (ctx:VxV)
#1174: FILE: net/ipn/af_ipn.c:387:
+		if (rv==0) 
 		      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1175: FILE: net/ipn/af_ipn.c:388:
+			kmem_cache_free(ipn_node_cache,ipn_node);
 			                              ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1177: FILE: net/ipn/af_ipn.c:390:
+^Iif (rv==0) $

ERROR:SPACING: spaces required around that '==' (ctx:VxV)
#1177: FILE: net/ipn/af_ipn.c:390:
+	if (rv==0) 
 	      ^

CHECK:SPACING: No space is necessary after a cast
#1178: FILE: net/ipn/af_ipn.c:391:
+		sock_put((struct sock *) ipn_sk);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1186: FILE: net/ipn/af_ipn.c:399:
+ * ipn_glob_mutex must be locked */

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1189: FILE: net/ipn/af_ipn.c:402:
+	int rv=0;
 	      ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1190: FILE: net/ipn/af_ipn.c:403:
+	int rv=0;
+	if (persist)

CHECK:BRACES: braces {} should be used on all arms of this statement
#1190: FILE: net/ipn/af_ipn.c:403:
+	if (persist)
[...]
+	else {
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:BRACES: Unbalanced braces around else statement
#1192: FILE: net/ipn/af_ipn.c:405:
+	else {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1195: FILE: net/ipn/af_ipn.c:408:
+			rv=ipn_terminate_node(ipn_node);
 			  ^

ERROR:SPACING: spaces required around that '==' (ctx:VxV)
#1196: FILE: net/ipn/af_ipn.c:409:
+			if (rv==0)
 			      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1197: FILE: net/ipn/af_ipn.c:410:
+				kmem_cache_free(ipn_node_cache,ipn_node);
 				                              ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1203: FILE: net/ipn/af_ipn.c:416:
+/* ipn_setpersist $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1204: FILE: net/ipn/af_ipn.c:417:
+ * lock ipn_glob_mutex and call __ipn_setpersist above */

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1207: FILE: net/ipn/af_ipn.c:420:
+	int rv=0;
 	      ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1208: FILE: net/ipn/af_ipn.c:421:
+	int rv=0;
+	if (ipn_node->dev == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ipn_node->dev"
#1208: FILE: net/ipn/af_ipn.c:421:
+	if (ipn_node->dev == NULL)

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1212: FILE: net/ipn/af_ipn.c:425:
+	rv=_ipn_setpersist(ipn_node,persist);
 	  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1212: FILE: net/ipn/af_ipn.c:425:
+	rv=_ipn_setpersist(ipn_node,persist);
 	                           ^

WARNING:TYPO_SPELLING: 'stucture' may be misspelled - perhaps 'structure'?
#1218: FILE: net/ipn/af_ipn.c:431:
+/* struct pre_bind_parms is a temporary stucture connected to ipn_node->pbp
                                         ^^^^^^^^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1219: FILE: net/ipn/af_ipn.c:432:
+ * to keep the parameter values. */

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1228: FILE: net/ipn/af_ipn.c:441:
+/* STD_PARMS:  BITS_PER_LONG nodes, no flags, BITS_PER_BYTE pending msgs, $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1229: FILE: net/ipn/af_ipn.c:442:
+ * Ethernet + VLAN MTU*/

WARNING:TRAILING_SEMICOLON: macros should not use a trailing semicolon
#1230: FILE: net/ipn/af_ipn.c:443:
+#define STD_BIND_PARMS {BITS_PER_LONG, 0, BITS_PER_BYTE, 1514, 0x777};

Macro definition should not end with a semicolon. The macro
invocation style should be consistent with function calls.
This can prevent any unexpected code paths::

  #define MAC do_something;

If this macro is used within a if else statement, like::

  if (some_condition)
          MAC;

  else
          do_something;

Then there would be a compilation error, because when the macro is
expanded there are two trailing semicolons, so the else branch gets
orphaned.

See: https://lore.kernel.org/lkml/1399671106.2912.21.camel@joe-AO725/

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#1232: FILE: net/ipn/af_ipn.c:445:
+static int ipn_mkname(struct sockaddr_un * sunaddr, int len)

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:NETWORKING_BLOCK_COMMENT_STYLE: networking block comments don't use an empty /* line, use /* Comment...
#1239: FILE: net/ipn/af_ipn.c:452:
+	/*
+	 * This may look like an off by one error but it is a bit more

WARNING:TYPO_SPELLING: 'doesnt' may be misspelled - perhaps 'doesn't'?
#1241: FILE: net/ipn/af_ipn.c:454:
+	 * sun_path[108] doesnt as such exist.  However in kernel space
 	                 ^^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1245: FILE: net/ipn/af_ipn.c:458:
+	((char *)sunaddr)[len]=0;
 	                      ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#1246: FILE: net/ipn/af_ipn.c:459:
+	len = strlen(sunaddr->sun_path)+1+sizeof(short);
 	                               ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#1246: FILE: net/ipn/af_ipn.c:459:
+	len = strlen(sunaddr->sun_path)+1+sizeof(short);
 	                                 ^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1250: FILE: net/ipn/af_ipn.c:463:
+
+

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1254: FILE: net/ipn/af_ipn.c:467:
+	struct sockaddr_un *sunaddr=(struct sockaddr_un *)uaddr;
 	                           ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1255: FILE: net/ipn/af_ipn.c:468:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1256: FILE: net/ipn/af_ipn.c:469:
+	struct nameidata nd;
 	                 ^^

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#1258: FILE: net/ipn/af_ipn.c:471:
+	struct dentry * dentry = NULL;

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#1260: FILE: net/ipn/af_ipn.c:473:
+	struct pre_bind_parms parms=STD_BIND_PARMS;
 	                      ^^^^^

WARNING:SPACING: missing space after struct definition
#1260: FILE: net/ipn/af_ipn.c:473:
+	struct pre_bind_parms parms=STD_BIND_PARMS;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1260: FILE: net/ipn/af_ipn.c:473:
+	struct pre_bind_parms parms=STD_BIND_PARMS;
 	                           ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1266: FILE: net/ipn/af_ipn.c:479:
+^Iif (sock->state != SS_UNCONNECTED || $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1267: FILE: net/ipn/af_ipn.c:480:
+	if (sock->state != SS_UNCONNECTED || 
+			ipn_node->ipn != NULL) {

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "ipn_node->ipn"
#1267: FILE: net/ipn/af_ipn.c:480:
+			ipn_node->ipn != NULL) {

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#1268: FILE: net/ipn/af_ipn.c:481:
+		err= -EISCONN;
 		   ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1272: FILE: net/ipn/af_ipn.c:485:
+^Iif (ipn_node->protocol >= 0 && $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1273: FILE: net/ipn/af_ipn.c:486:
+	if (ipn_node->protocol >= 0 && 
+			(ipn_node->protocol >= IPN_MAX_PROTO ||

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ipn_protocol_table[ipn_node->protocol]"
#1274: FILE: net/ipn/af_ipn.c:487:
+			 ipn_protocol_table[ipn_node->protocol] == NULL)) {

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#1275: FILE: net/ipn/af_ipn.c:488:
+		err= -EPROTONOSUPPORT;
 		   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1281: FILE: net/ipn/af_ipn.c:494:
+		err=addr_len;
 		   ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1286: FILE: net/ipn/af_ipn.c:499:
+	err = path_lookup(sunaddr->sun_path, LOOKUP_FOLLOW, &nd);
 	                                                     ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1290: FILE: net/ipn/af_ipn.c:503:
+		err = path_lookup(sunaddr->sun_path, LOOKUP_PARENT, &nd);
 		                                                     ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1294: FILE: net/ipn/af_ipn.c:507:
+		dentry = lookup_create(&nd, 0);
 		                        ^^

WARNING:NETWORKING_BLOCK_COMMENT_STYLE: networking block comments don't use an empty /* line, use /* Comment...
#1299: FILE: net/ipn/af_ipn.c:512:
+		/*
+		 * All right, let's create it.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1301: FILE: net/ipn/af_ipn.c:514:
+^I^Iif (ipn_node->pbp) $

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1306: FILE: net/ipn/af_ipn.c:519:
+		err = vfs_mknod(nd.dentry->d_inode, dentry, mode, 0);
 		                ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1309: FILE: net/ipn/af_ipn.c:522:
+		mutex_unlock(&nd.dentry->d_inode->i_mutex);
 		              ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1310: FILE: net/ipn/af_ipn.c:523:
+		dput(nd.dentry);
 		     ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1311: FILE: net/ipn/af_ipn.c:524:
+		nd.dentry = dentry;
 		^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1313: FILE: net/ipn/af_ipn.c:526:
+^I^Iif (ipn_node->pbp) $

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#1314: FILE: net/ipn/af_ipn.c:527:
+			parms=*ipn_node->pbp;
 			^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1314: FILE: net/ipn/af_ipn.c:527:
+			parms=*ipn_node->pbp;
 			     ^

ERROR:SPACING: space required before that '*' (ctx:OxV)
#1314: FILE: net/ipn/af_ipn.c:527:
+			parms=*ipn_node->pbp;
 			      ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1315: FILE: net/ipn/af_ipn.c:528:
+^I^Iipnn=kmem_cache_zalloc(ipn_network_cache,GFP_KERNEL); $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1315: FILE: net/ipn/af_ipn.c:528:
+		ipnn=kmem_cache_zalloc(ipn_network_cache,GFP_KERNEL); 
 		    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1315: FILE: net/ipn/af_ipn.c:528:
+		ipnn=kmem_cache_zalloc(ipn_network_cache,GFP_KERNEL); 
 		                                        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1317: FILE: net/ipn/af_ipn.c:530:
+			err=-ENOMEM;
 			   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1317: FILE: net/ipn/af_ipn.c:530:
+			err=-ENOMEM;
 			    ^

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#1320: FILE: net/ipn/af_ipn.c:533:
+		ipnn->connport=kzalloc(parms.maxports * sizeof(struct ipn_node *),GFP_KERNEL);
 		                       ^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1320: FILE: net/ipn/af_ipn.c:533:
+		ipnn->connport=kzalloc(parms.maxports * sizeof(struct ipn_node *),GFP_KERNEL);
 		              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1320: FILE: net/ipn/af_ipn.c:533:
+		ipnn->connport=kzalloc(parms.maxports * sizeof(struct ipn_node *),GFP_KERNEL);
 		                                                                 ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1322: FILE: net/ipn/af_ipn.c:535:
+			err=-ENOMEM;
 			   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1322: FILE: net/ipn/af_ipn.c:535:
+			err=-ENOMEM;
 			    ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1327: FILE: net/ipn/af_ipn.c:540:
+		 * rmmod is forbidden if there are persistent node */

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1332: FILE: net/ipn/af_ipn.c:545:
+		memcpy(&ipnn->sunaddr,sunaddr,addr_len);
 		                     ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1332: FILE: net/ipn/af_ipn.c:545:
+		memcpy(&ipnn->sunaddr,sunaddr,addr_len);
 		                             ^

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#1333: FILE: net/ipn/af_ipn.c:546:
+		ipnn->mtu=parms.mtu;
 		          ^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1333: FILE: net/ipn/af_ipn.c:546:
+		ipnn->mtu=parms.mtu;
 		         ^

WARNING:LONG_LINE: line length of 125 exceeds 100 columns
#1334: FILE: net/ipn/af_ipn.c:547:
+		ipnn->msgpool_cache=kmem_cache_create(ipnn->sunaddr.sun_path,sizeof(struct msgpool_item)+ipnn->mtu,0,0,NULL);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1334: FILE: net/ipn/af_ipn.c:547:
+		ipnn->msgpool_cache=kmem_cache_create(ipnn->sunaddr.sun_path,sizeof(struct msgpool_item)+ipnn->mtu,0,0,NULL);
 		                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1334: FILE: net/ipn/af_ipn.c:547:
+		ipnn->msgpool_cache=kmem_cache_create(ipnn->sunaddr.sun_path,sizeof(struct msgpool_item)+ipnn->mtu,0,0,NULL);
 		                                                            ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#1334: FILE: net/ipn/af_ipn.c:547:
+		ipnn->msgpool_cache=kmem_cache_create(ipnn->sunaddr.sun_path,sizeof(struct msgpool_item)+ipnn->mtu,0,0,NULL);
 		                                                                                        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1334: FILE: net/ipn/af_ipn.c:547:
+		ipnn->msgpool_cache=kmem_cache_create(ipnn->sunaddr.sun_path,sizeof(struct msgpool_item)+ipnn->mtu,0,0,NULL);
 		                                                                                                  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1334: FILE: net/ipn/af_ipn.c:547:
+		ipnn->msgpool_cache=kmem_cache_create(ipnn->sunaddr.sun_path,sizeof(struct msgpool_item)+ipnn->mtu,0,0,NULL);
 		                                                                                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1334: FILE: net/ipn/af_ipn.c:547:
+		ipnn->msgpool_cache=kmem_cache_create(ipnn->sunaddr.sun_path,sizeof(struct msgpool_item)+ipnn->mtu,0,0,NULL);
 		                                                                                                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1336: FILE: net/ipn/af_ipn.c:549:
+			err=-ENOMEM;
 			   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1336: FILE: net/ipn/af_ipn.c:549:
+			err=-ENOMEM;
 			    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1341: FILE: net/ipn/af_ipn.c:554:
+		atomic_set(&ipnn->refcnt,1);
 		                        ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1342: FILE: net/ipn/af_ipn.c:555:
+		ipnn->dentry=nd.dentry;
 		             ^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1342: FILE: net/ipn/af_ipn.c:555:
+		ipnn->dentry=nd.dentry;
 		            ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1343: FILE: net/ipn/af_ipn.c:556:
+		ipnn->mnt=nd.mnt;
 		          ^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1343: FILE: net/ipn/af_ipn.c:556:
+		ipnn->mnt=nd.mnt;
 		         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1345: FILE: net/ipn/af_ipn.c:558:
+		ipnn->sunaddr_len=addr_len;
 		                 ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1346: FILE: net/ipn/af_ipn.c:559:
+		ipnn->protocol=ipn_node->protocol;
 		              ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#1347: FILE: net/ipn/af_ipn.c:560:
+		if (ipnn->protocol < 0) ipnn->protocol = 0;

Trailing statements (for example after any conditional) should be
on the next line.
Statements, such as::

  if (x == y) break;

should be::

  if (x == y)
          break;

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#1349: FILE: net/ipn/af_ipn.c:562:
+		ipnn->flags=parms.flags;
 		            ^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1349: FILE: net/ipn/af_ipn.c:562:
+		ipnn->flags=parms.flags;
 		           ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1350: FILE: net/ipn/af_ipn.c:563:
+		ipnn->numreaders=0;
 		                ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1351: FILE: net/ipn/af_ipn.c:564:
+		ipnn->numwriters=0;
 		                ^

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#1352: FILE: net/ipn/af_ipn.c:565:
+		ipnn->maxports=parms.maxports;
 		               ^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1352: FILE: net/ipn/af_ipn.c:565:
+		ipnn->maxports=parms.maxports;
 		              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1353: FILE: net/ipn/af_ipn.c:566:
+		atomic_set(&ipnn->msgpool_nelem,0);
 		                               ^

WARNING:TYPO_SPELLING: 'parms' may be misspelled - perhaps 'params'?
#1354: FILE: net/ipn/af_ipn.c:567:
+		ipnn->msgpool_size=parms.msgpoolsize;
 		                   ^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1354: FILE: net/ipn/af_ipn.c:567:
+		ipnn->msgpool_size=parms.msgpoolsize;
 		                  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1355: FILE: net/ipn/af_ipn.c:568:
+		ipnn->proto_private=NULL;
 		                   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1357: FILE: net/ipn/af_ipn.c:570:
+		err=ipn_protocol_table[ipnn->protocol]->ipn_p_newnet(ipnn);
 		   ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1360: FILE: net/ipn/af_ipn.c:573:
+		ipn_insert_network(&ipn_network_table[nd.dentry->d_inode->i_ino & (IPN_HASH_SIZE-1)],ipnn);
 		                                      ^^

WARNING:LONG_LINE: line length of 107 exceeds 100 columns
#1360: FILE: net/ipn/af_ipn.c:573:
+		ipn_insert_network(&ipn_network_table[nd.dentry->d_inode->i_ino & (IPN_HASH_SIZE-1)],ipnn);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1360: FILE: net/ipn/af_ipn.c:573:
+		ipn_insert_network(&ipn_network_table[nd.dentry->d_inode->i_ino & (IPN_HASH_SIZE-1)],ipnn);
 		                                                                                ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1360: FILE: net/ipn/af_ipn.c:573:
+		ipn_insert_network(&ipn_network_table[nd.dentry->d_inode->i_ino & (IPN_HASH_SIZE-1)],ipnn);
 		                                                                                    ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1363: FILE: net/ipn/af_ipn.c:576:
+		err = vfs_permission(&nd, MAY_EXEC);
 		                      ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1367: FILE: net/ipn/af_ipn.c:580:
+		if (!S_ISSOCK(nd.dentry->d_inode->i_mode))
 		              ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1369: FILE: net/ipn/af_ipn.c:582:
+		ipnn=ipn_find_network_byinode(nd.dentry->d_inode);
 		                              ^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1369: FILE: net/ipn/af_ipn.c:582:
+		ipnn=ipn_find_network_byinode(nd.dentry->d_inode);
 		    ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1372: FILE: net/ipn/af_ipn.c:585:
+		list_add_tail(&ipn_node->nodelist,&ipnn->unconnectqueue);
 		                                 ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1372: FILE: net/ipn/af_ipn.c:585:
+		list_add_tail(&ipn_node->nodelist,&ipnn->unconnectqueue);
 		                                  ^

WARNING:NEEDLESS_IF: kfree(NULL) is safe and this check is probably not required
#1376: FILE: net/ipn/af_ipn.c:589:
+	if (ipn_node->pbp) {
+		kfree(ipn_node->pbp);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1377: FILE: net/ipn/af_ipn.c:590:
+		ipn_node->pbp=NULL;
 		             ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1378: FILE: net/ipn/af_ipn.c:591:
+^I} $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1379: FILE: net/ipn/af_ipn.c:592:
+	ipn_node->ipn=ipnn;
 	             ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1385: FILE: net/ipn/af_ipn.c:598:
+	path_release(&nd);
 	              ^^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1395: FILE: net/ipn/af_ipn.c:608:
+	kmem_cache_free(ipn_network_cache,ipnn);
 	                                 ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1399: FILE: net/ipn/af_ipn.c:612:
+	mutex_unlock(&nd.dentry->d_inode->i_mutex);
 	              ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1400: FILE: net/ipn/af_ipn.c:613:
+	path_release(&nd);
 	              ^^

ERROR:SPACING: spaces required around that '==' (ctx:VxO)
#1402: FILE: net/ipn/af_ipn.c:615:
+	if (err==-EEXIST)
 	       ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1402: FILE: net/ipn/af_ipn.c:615:
+	if (err==-EEXIST)
 	         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1403: FILE: net/ipn/af_ipn.c:616:
+		err=-EADDRINUSE;
 		   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1403: FILE: net/ipn/af_ipn.c:616:
+		err=-EADDRINUSE;
 		    ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1409: FILE: net/ipn/af_ipn.c:622:
+static int ipn_connect(struct socket *sock, struct sockaddr *addr,
+		int addr_len, int flags){

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1410: FILE: net/ipn/af_ipn.c:623:
+static int ipn_connect(struct socket *sock, struct sockaddr *addr,
+		int addr_len, int flags){

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#1411: FILE: net/ipn/af_ipn.c:624:
+	struct sockaddr_un *sunaddr=(struct sockaddr_un*)addr;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1411: FILE: net/ipn/af_ipn.c:624:
+	struct sockaddr_un *sunaddr=(struct sockaddr_un*)addr;
 	                           ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1412: FILE: net/ipn/af_ipn.c:625:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1413: FILE: net/ipn/af_ipn.c:626:
+	struct nameidata nd;
 	                 ^^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1414: FILE: net/ipn/af_ipn.c:627:
+	struct ipn_network *ipnn,*previousipnn;
 	                        ^

ERROR:SPACING: space required before that '*' (ctx:OxV)
#1414: FILE: net/ipn/af_ipn.c:627:
+	struct ipn_network *ipnn,*previousipnn;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1415: FILE: net/ipn/af_ipn.c:628:
+	int err=0;
 	       ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1419: FILE: net/ipn/af_ipn.c:632:
+^Iif (sock->state != SS_UNCONNECTED) $

WARNING:USE_NEGATIVE_ERRNO: return of an errno should typically be negative (ie: return -EISCONN)
#1420: FILE: net/ipn/af_ipn.c:633:
+		return EISCONN;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1425: FILE: net/ipn/af_ipn.c:638:
+	if ((previousipnn=ipn_node->ipn) == NULL) { /* unbound */
 	                 ^

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1425: FILE: net/ipn/af_ipn.c:638:
+	if ((previousipnn=ipn_node->ipn) == NULL) { /* unbound */

CHECK:BRACES: braces {} should be used on all arms of this statement
#1425: FILE: net/ipn/af_ipn.c:638:
+	if ((previousipnn=ipn_node->ipn) == NULL) { /* unbound */
[...]
+	} else
[...]

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1426: FILE: net/ipn/af_ipn.c:639:
+		unsigned char mustshutdown=0;
 		                          ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1427: FILE: net/ipn/af_ipn.c:640:
+		unsigned char mustshutdown=0;
+		err = ipn_mkname(sunaddr, addr_len);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1430: FILE: net/ipn/af_ipn.c:643:
+		addr_len=err;
 		        ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1431: FILE: net/ipn/af_ipn.c:644:
+		err = path_lookup(sunaddr->sun_path, LOOKUP_FOLLOW, &nd);
 		                                                     ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1434: FILE: net/ipn/af_ipn.c:647:
+		err = vfs_permission(&nd, MAY_READ);
 		                      ^^

ERROR:SPACING: spaces required around that '|=' (ctx:VxV)
#1437: FILE: net/ipn/af_ipn.c:650:
+				mustshutdown|=RCV_SHUTDOWN;
 				            ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1441: FILE: net/ipn/af_ipn.c:654:
+		err = vfs_permission(&nd, MAY_WRITE);
 		                      ^^

ERROR:SPACING: spaces required around that '|=' (ctx:VxV)
#1444: FILE: net/ipn/af_ipn.c:657:
+				mustshutdown|=SEND_SHUTDOWN;
 				            ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1450: FILE: net/ipn/af_ipn.c:663:
+		 * no abilities, connect returns EACCES */

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1452: FILE: net/ipn/af_ipn.c:665:
+			err=-EACCES;
 			   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1452: FILE: net/ipn/af_ipn.c:665:
+			err=-EACCES;
 			    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1455: FILE: net/ipn/af_ipn.c:668:
+			err=0;
 			   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1456: FILE: net/ipn/af_ipn.c:669:
+			ipn_node->shutdown=mustshutdown;
 			                  ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1458: FILE: net/ipn/af_ipn.c:671:
+		if (!S_ISSOCK(nd.dentry->d_inode->i_mode)) {
 		              ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1462: FILE: net/ipn/af_ipn.c:675:
+		ipnn=ipn_find_network_byinode(nd.dentry->d_inode);
 		                              ^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1462: FILE: net/ipn/af_ipn.c:675:
+		ipnn=ipn_find_network_byinode(nd.dentry->d_inode);
 		    ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#1467: FILE: net/ipn/af_ipn.c:680:
+		if (ipn_node->protocol == IPN_ANY)
[...]
+		else if (ipnn->protocol != ipn_node->protocol) {
[...]

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1468: FILE: net/ipn/af_ipn.c:681:
+			ipn_node->protocol=ipnn->protocol;
 			                  ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1473: FILE: net/ipn/af_ipn.c:686:
+		path_release(&nd);
 		              ^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1474: FILE: net/ipn/af_ipn.c:687:
+		ipn_node->ipn=ipnn;
 		             ^

CHECK:BRACES: Unbalanced braces around else statement
#1475: FILE: net/ipn/af_ipn.c:688:
+	} else

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1476: FILE: net/ipn/af_ipn.c:689:
+		ipnn=ipn_node->ipn;
 		    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1479: FILE: net/ipn/af_ipn.c:692:
+		err=-ERESTARTSYS;
 		   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1479: FILE: net/ipn/af_ipn.c:692:
+		err=-ERESTARTSYS;
 		    ^

ERROR:SPACING: spaces required around that '<' (ctx:VxV)
#1483: FILE: net/ipn/af_ipn.c:696:
+	if (portno >= 0 && portno<ipnn->maxports) {
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1485: FILE: net/ipn/af_ipn.c:698:
+		ipn_node->portno=portno;
 		                ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1486: FILE: net/ipn/af_ipn.c:699:
+		ipnn->connport[portno]=ipn_node;
 		                      ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1491: FILE: net/ipn/af_ipn.c:704:
+		list_add_tail(&ipn_node->nodelist,&ipnn->connectqueue);
 		                                 ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1491: FILE: net/ipn/af_ipn.c:704:
+		list_add_tail(&ipn_node->nodelist,&ipnn->connectqueue);
 		                                  ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1493: FILE: net/ipn/af_ipn.c:706:
+		ipn_net_update_counters(ipnn,
+				(ipn_node->shutdown & RCV_SHUTDOWN)?0:1,

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#1493: FILE: net/ipn/af_ipn.c:706:
+				(ipn_node->shutdown & RCV_SHUTDOWN)?0:1,
 				                                   ^

CHECK:SPACING: spaces required around that ':' (ctx:VxV)
#1493: FILE: net/ipn/af_ipn.c:706:
+				(ipn_node->shutdown & RCV_SHUTDOWN)?0:1,
 				                                     ^

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#1494: FILE: net/ipn/af_ipn.c:707:
+				(ipn_node->shutdown & SEND_SHUTDOWN)?0:1);
 				                                    ^

CHECK:SPACING: spaces required around that ':' (ctx:VxV)
#1494: FILE: net/ipn/af_ipn.c:707:
+				(ipn_node->shutdown & SEND_SHUTDOWN)?0:1);
 				                                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1496: FILE: net/ipn/af_ipn.c:709:
+		ipn_node->ipn=previousipnn; /* undo changes on ipn_node->ipn */
 		             ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1497: FILE: net/ipn/af_ipn.c:710:
+		err=-EADDRNOTAVAIL;
 		   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1497: FILE: net/ipn/af_ipn.c:710:
+		err=-EADDRNOTAVAIL;
 		    ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1504: FILE: net/ipn/af_ipn.c:717:
+	path_release(&nd);
 	              ^^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1510: FILE: net/ipn/af_ipn.c:723:
+static int ipn_getname(struct socket *sock, struct sockaddr *uaddr, $

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1510: FILE: net/ipn/af_ipn.c:723:
+static int ipn_getname(struct socket *sock, struct sockaddr *uaddr, 
+		int *uaddr_len, int peer) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1511: FILE: net/ipn/af_ipn.c:724:
+static int ipn_getname(struct socket *sock, struct sockaddr *uaddr, 
+		int *uaddr_len, int peer) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1512: FILE: net/ipn/af_ipn.c:725:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1513: FILE: net/ipn/af_ipn.c:726:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1514: FILE: net/ipn/af_ipn.c:727:
+	struct sockaddr_un *sunaddr=(struct sockaddr_un *)uaddr;
 	                           ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1515: FILE: net/ipn/af_ipn.c:728:
+	int err=0;
 	       ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#1519: FILE: net/ipn/af_ipn.c:732:
+	if (ipnn) {
[...]
+	} else
[...]

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1521: FILE: net/ipn/af_ipn.c:734:
+		memcpy(sunaddr,&ipnn->sunaddr,*uaddr_len);
 		              ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1521: FILE: net/ipn/af_ipn.c:734:
+		memcpy(sunaddr,&ipnn->sunaddr,*uaddr_len);
 		               ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1521: FILE: net/ipn/af_ipn.c:734:
+		memcpy(sunaddr,&ipnn->sunaddr,*uaddr_len);
 		                             ^

ERROR:SPACING: space required before that '*' (ctx:OxV)
#1521: FILE: net/ipn/af_ipn.c:734:
+		memcpy(sunaddr,&ipnn->sunaddr,*uaddr_len);
 		                              ^

CHECK:BRACES: Unbalanced braces around else statement
#1522: FILE: net/ipn/af_ipn.c:735:
+	} else

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1529: FILE: net/ipn/af_ipn.c:742:
+static unsigned int ipn_poll(struct file *file, struct socket *sock, $

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1529: FILE: net/ipn/af_ipn.c:742:
+static unsigned int ipn_poll(struct file *file, struct socket *sock, 
+		poll_table *wait) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1530: FILE: net/ipn/af_ipn.c:743:
+static unsigned int ipn_poll(struct file *file, struct socket *sock, 
+		poll_table *wait) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1531: FILE: net/ipn/af_ipn.c:744:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1532: FILE: net/ipn/af_ipn.c:745:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1533: FILE: net/ipn/af_ipn.c:746:
+	unsigned int mask=0;
 	                 ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1536: FILE: net/ipn/af_ipn.c:749:
+		poll_wait(file,&ipn_node->read_wait,wait);
 		              ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1536: FILE: net/ipn/af_ipn.c:749:
+		poll_wait(file,&ipn_node->read_wait,wait);
 		               ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1536: FILE: net/ipn/af_ipn.c:749:
+		poll_wait(file,&ipn_node->read_wait,wait);
 		                                   ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1538: FILE: net/ipn/af_ipn.c:751:
+			poll_wait(file,&ipnn->send_wait,wait);
 			              ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1538: FILE: net/ipn/af_ipn.c:751:
+			poll_wait(file,&ipnn->send_wait,wait);
 			               ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1538: FILE: net/ipn/af_ipn.c:751:
+			poll_wait(file,&ipnn->send_wait,wait);
 			                               ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1539: FILE: net/ipn/af_ipn.c:752:
+^I^I/* POLLIN if recv succeeds, $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1540: FILE: net/ipn/af_ipn.c:753:
+		 * POLL{PRI,RDNORM} if there are {oob,non-oob} messages */

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#1541: FILE: net/ipn/af_ipn.c:754:
+		if (ipn_node->totmsgcount > 0) mask |= POLLIN;

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#1542: FILE: net/ipn/af_ipn.c:755:
+		if (!(list_empty(&ipn_node->msgqueue))) mask |= POLLRDNORM;

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#1543: FILE: net/ipn/af_ipn.c:756:
+		if (!(list_empty(&ipn_node->oobmsgqueue))) mask |= POLLPRI;

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1547: FILE: net/ipn/af_ipn.c:760:
+^I} $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1551: FILE: net/ipn/af_ipn.c:764:
+/* connect netdev (from ioctl). connect a bound socket to a $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1552: FILE: net/ipn/af_ipn.c:765:
+ * network device TAP or GRAB */

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1553: FILE: net/ipn/af_ipn.c:766:
+static int ipn_connect_netdev(struct socket *sock,struct ifreq *ifr)
                                                  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1555: FILE: net/ipn/af_ipn.c:768:
+	int err=0;
 	       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1556: FILE: net/ipn/af_ipn.c:769:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1557: FILE: net/ipn/af_ipn.c:770:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1558: FILE: net/ipn/af_ipn.c:771:
+	struct ipn_network *ipnn=ipn_node->ipn;
+	if (!capable(CAP_NET_ADMIN))

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1560: FILE: net/ipn/af_ipn.c:773:
+^Iif (sock->state != SS_UNCONNECTED) $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1570: FILE: net/ipn/af_ipn.c:783:
+	ipn_node->dev=ipn_netdev_alloc(ipn_node->net,ifr->ifr_flags,ifr->ifr_name,&err);
 	             ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1570: FILE: net/ipn/af_ipn.c:783:
+	ipn_node->dev=ipn_netdev_alloc(ipn_node->net,ifr->ifr_flags,ifr->ifr_name,&err);
 	                                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1570: FILE: net/ipn/af_ipn.c:783:
+	ipn_node->dev=ipn_netdev_alloc(ipn_node->net,ifr->ifr_flags,ifr->ifr_name,&err);
 	                                                           ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1570: FILE: net/ipn/af_ipn.c:783:
+	ipn_node->dev=ipn_netdev_alloc(ipn_node->net,ifr->ifr_flags,ifr->ifr_name,&err);
 	                                                                         ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1570: FILE: net/ipn/af_ipn.c:783:
+	ipn_node->dev=ipn_netdev_alloc(ipn_node->net,ifr->ifr_flags,ifr->ifr_name,&err);
 	                                                                          ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#1571: FILE: net/ipn/af_ipn.c:784:
+	if (ipn_node->dev) {
[...]
+	} else 
[...]

WARNING:LINE_SPACING: Missing a blank line after declarations
#1573: FILE: net/ipn/af_ipn.c:786:
+		int portno;
+		portno = ipn_protocol_table[ipnn->protocol]->ipn_p_newport(ipn_node);

ERROR:SPACING: spaces required around that '<' (ctx:VxV)
#1574: FILE: net/ipn/af_ipn.c:787:
+		if (portno >= 0 && portno<ipnn->maxports) {
 		                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1576: FILE: net/ipn/af_ipn.c:789:
+			ipn_node->portno=portno;
 			                ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1578: FILE: net/ipn/af_ipn.c:791:
+			ipnn->connport[portno]=ipn_node;
 			                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1579: FILE: net/ipn/af_ipn.c:792:
+			err=ipn_netdev_activate(ipn_node);
 			   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1583: FILE: net/ipn/af_ipn.c:796:
+				ipn_node->dev=NULL;
 				             ^

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#1584: FILE: net/ipn/af_ipn.c:797:
+				ipn_node->portno= -1;
 				                ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1586: FILE: net/ipn/af_ipn.c:799:
+				ipnn->connport[portno]=NULL;
 				                      ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1590: FILE: net/ipn/af_ipn.c:803:
+				list_add_tail(&ipn_node->nodelist,&ipnn->connectqueue);
 				                                 ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1590: FILE: net/ipn/af_ipn.c:803:
+				list_add_tail(&ipn_node->nodelist,&ipnn->connectqueue);
 				                                  ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1593: FILE: net/ipn/af_ipn.c:806:
+^I^I^Iipn_netdev_close(ipn_node); $

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1594: FILE: net/ipn/af_ipn.c:807:
+			err=-EADDRNOTAVAIL;
 			   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1594: FILE: net/ipn/af_ipn.c:807:
+			err=-EADDRNOTAVAIL;
 			    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1595: FILE: net/ipn/af_ipn.c:808:
+			ipn_node->dev=NULL;
 			             ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1597: FILE: net/ipn/af_ipn.c:810:
+^I} else $

CHECK:BRACES: Unbalanced braces around else statement
#1597: FILE: net/ipn/af_ipn.c:810:
+	} else 

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1598: FILE: net/ipn/af_ipn.c:811:
+		err=-EINVAL;
 		   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1598: FILE: net/ipn/af_ipn.c:811:
+		err=-EINVAL;
 		    ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1605: FILE: net/ipn/af_ipn.c:818:
+ * not connected to another socket */

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1606: FILE: net/ipn/af_ipn.c:819:
+static int ipn_join_netdev(struct socket *sock,struct ifreq *ifr)
                                               ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1608: FILE: net/ipn/af_ipn.c:821:
+	int err=0;
 	       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1610: FILE: net/ipn/af_ipn.c:823:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1612: FILE: net/ipn/af_ipn.c:825:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1613: FILE: net/ipn/af_ipn.c:826:
+	struct ipn_network *ipnn=ipn_node->ipn;
+	if (sock->state != SS_UNCONNECTED)

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1621: FILE: net/ipn/af_ipn.c:834:
+	dev=__dev_get_by_name(ipn_node->net,ifr->ifr_name);
 	   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1621: FILE: net/ipn/af_ipn.c:834:
+	dev=__dev_get_by_name(ipn_node->net,ifr->ifr_name);
 	                                   ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1622: FILE: net/ipn/af_ipn.c:835:
+^Iif (!dev) $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1623: FILE: net/ipn/af_ipn.c:836:
+		dev=__dev_get_by_index(ipn_node->net,ifr->ifr_ifindex);
 		   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1623: FILE: net/ipn/af_ipn.c:836:
+		dev=__dev_get_by_index(ipn_node->net,ifr->ifr_ifindex);
 		                                    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1624: FILE: net/ipn/af_ipn.c:837:
+	if (dev && (ipn_joined=ipn_netdev2node(dev)) != NULL) { /* the interface does exist */
 	                      ^

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1624: FILE: net/ipn/af_ipn.c:837:
+	if (dev && (ipn_joined=ipn_netdev2node(dev)) != NULL) { /* the interface does exist */

CHECK:BRACES: braces {} should be used on all arms of this statement
#1624: FILE: net/ipn/af_ipn.c:837:
+	if (dev && (ipn_joined=ipn_netdev2node(dev)) != NULL) { /* the interface does exist */
[...]
+	} else
[...]

WARNING:LINE_SPACING: Missing a blank line after declarations
#1626: FILE: net/ipn/af_ipn.c:839:
+		int i;
+		for (i=0;i<ipnn->maxports && ipn_joined != ipnn->connport[i] ;i++)

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1626: FILE: net/ipn/af_ipn.c:839:
+		for (i=0;i<ipnn->maxports && ipn_joined != ipnn->connport[i] ;i++)
 		      ^

ERROR:SPACING: space required after that ';' (ctx:VxV)
#1626: FILE: net/ipn/af_ipn.c:839:
+		for (i=0;i<ipnn->maxports && ipn_joined != ipnn->connport[i] ;i++)
 		        ^

ERROR:SPACING: spaces required around that '<' (ctx:VxV)
#1626: FILE: net/ipn/af_ipn.c:839:
+		for (i=0;i<ipnn->maxports && ipn_joined != ipnn->connport[i] ;i++)
 		          ^

ERROR:SPACING: space required after that ';' (ctx:WxV)
#1626: FILE: net/ipn/af_ipn.c:839:
+		for (i=0;i<ipnn->maxports && ipn_joined != ipnn->connport[i] ;i++)
 		                                                             ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#1628: FILE: net/ipn/af_ipn.c:841:
+		if (i < ipnn->maxports) { /* found */
[...]
+		} else
[...]

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1630: FILE: net/ipn/af_ipn.c:843:
+			((struct ipn_sock *)sock->sk)->node=ipn_joined;
 			                                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1633: FILE: net/ipn/af_ipn.c:846:
+			kmem_cache_free(ipn_node_cache,ipn_node);
 			                              ^

CHECK:BRACES: Unbalanced braces around else statement
#1634: FILE: net/ipn/af_ipn.c:847:
+		} else

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1635: FILE: net/ipn/af_ipn.c:848:
+			err=-EPERM;
 			   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1635: FILE: net/ipn/af_ipn.c:848:
+			err=-EPERM;
 			    ^

CHECK:BRACES: Unbalanced braces around else statement
#1636: FILE: net/ipn/af_ipn.c:849:
+	} else

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1637: FILE: net/ipn/af_ipn.c:850:
+		err=-EADDRNOTAVAIL;
 		   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1637: FILE: net/ipn/af_ipn.c:850:
+		err=-EADDRNOTAVAIL;
 		    ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1644: FILE: net/ipn/af_ipn.c:857:
+ * (it is for sysadm, to close network interfaces)*/

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1649: FILE: net/ipn/af_ipn.c:862:
+	int err=0;
 	       ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1650: FILE: net/ipn/af_ipn.c:863:
+	int err=0;
+	if (!capable(CAP_NET_ADMIN))

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1654: FILE: net/ipn/af_ipn.c:867:
+	dev=__dev_get_by_name(&init_net,ifr->ifr_name);
 	   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1654: FILE: net/ipn/af_ipn.c:867:
+	dev=__dev_get_by_name(&init_net,ifr->ifr_name);
 	                               ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1656: FILE: net/ipn/af_ipn.c:869:
+		dev=__dev_get_by_index(&init_net,ifr->ifr_ifindex);
 		   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1656: FILE: net/ipn/af_ipn.c:869:
+		dev=__dev_get_by_index(&init_net,ifr->ifr_ifindex);
 		                                ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1657: FILE: net/ipn/af_ipn.c:870:
+^Iif (dev && (ipn_node=ipn_netdev2node(dev)) != NULL) $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1657: FILE: net/ipn/af_ipn.c:870:
+	if (dev && (ipn_node=ipn_netdev2node(dev)) != NULL) 
 	                    ^

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1657: FILE: net/ipn/af_ipn.c:870:
+	if (dev && (ipn_node=ipn_netdev2node(dev)) != NULL) 

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1658: FILE: net/ipn/af_ipn.c:871:
+		_ipn_setpersist(ipn_node,value);
 		                        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1660: FILE: net/ipn/af_ipn.c:873:
+		err=-EADDRNOTAVAIL;
 		   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1660: FILE: net/ipn/af_ipn.c:873:
+		err=-EADDRNOTAVAIL;
 		    ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1666: FILE: net/ipn/af_ipn.c:879:
+static int ipn_ioctl(struct socket *sock, unsigned int cmd, unsigned long arg) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1667: FILE: net/ipn/af_ipn.c:880:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1668: FILE: net/ipn/af_ipn.c:881:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#1669: FILE: net/ipn/af_ipn.c:882:
+	void __user* argp = (void __user*)arg;

ERROR:POINTER_LOCATION: "foo* bar" should be "foo *bar"
#1669: FILE: net/ipn/af_ipn.c:882:
+	void __user* argp = (void __user*)arg;

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#1676: FILE: net/ipn/af_ipn.c:889:
+	switch (cmd) {
+		case IPN_SETPERSIST_NETDEV:
+		case IPN_CLRPERSIST_NETDEV:
+		case IPN_CONN_NETDEV:
+		case IPN_JOIN_NETDEV:
+		case SIOCSIFHWADDR:

switch should be at the same indent as case.
Example::

  switch (suffix) {
  case 'G':
  case 'g':
          mem <<= 30;
          break;
  case 'M':
  case 'm':
          mem <<= 20;
          break;
  case 'K':
  case 'k':
          mem <<= 10;
          fallthrough;
  default:
          break;
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:SIZEOF_PARENTHESIS: sizeof ifr should be sizeof(ifr)
#1682: FILE: net/ipn/af_ipn.c:895:
+			if (copy_from_user(&ifr, argp, sizeof ifr))

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1684: FILE: net/ipn/af_ipn.c:897:
+			ifr.ifr_name[IFNAMSIZ-1] = '\0';
 			                     ^

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#1688: FILE: net/ipn/af_ipn.c:901:
+	switch (cmd) {
+		case IPN_SETPERSIST_NETDEV:
[...]
+		case IPN_CLRPERSIST_NETDEV:
[...]
+		case SIOCSIFHWADDR:

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1690: FILE: net/ipn/af_ipn.c:903:
+			return ipn_setpersist_netdev(&ifr,1);
 			                                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1692: FILE: net/ipn/af_ipn.c:905:
+			return ipn_setpersist_netdev(&ifr,0);
 			                                 ^

CHECK:SPACING: spaces preferred around that '&' (ctx:WxV)
#1696: FILE: net/ipn/af_ipn.c:909:
+			if (ipn_node->dev && (ipn_node->flags &IPN_NODEFLAG_TAP))
 			                                      ^

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ipnn"
#1701: FILE: net/ipn/af_ipn.c:914:
+	if (ipnn == NULL || (ipnn->flags & IPN_FLAG_TERMINATED))

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#1704: FILE: net/ipn/af_ipn.c:917:
+	switch (cmd) {
+		case IPN_CONN_NETDEV:
[...]
+		case IPN_JOIN_NETDEV:
[...]
+		case IPN_SETPERSIST:
[...]
+		default:

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1706: FILE: net/ipn/af_ipn.c:919:
+			return ipn_connect_netdev(sock,&ifr);
 			                              ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1706: FILE: net/ipn/af_ipn.c:919:
+			return ipn_connect_netdev(sock,&ifr);
 			                               ^

ERROR:SPACING: space required after that ',' (ctx:VxO)
#1708: FILE: net/ipn/af_ipn.c:921:
+			return ipn_join_netdev(sock,&ifr);
 			                           ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#1708: FILE: net/ipn/af_ipn.c:921:
+			return ipn_join_netdev(sock,&ifr);
 			                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1710: FILE: net/ipn/af_ipn.c:923:
+			return ipn_setpersist(ipn_node,arg);
 			                              ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#1712: FILE: net/ipn/af_ipn.c:925:
+			if (ipnn) {
[...]
+			} else
[...]

WARNING:LINE_SPACING: Missing a blank line after declarations
#1714: FILE: net/ipn/af_ipn.c:927:
+				int rv;
+				if (down_interruptible(&ipnn->ipnn_mutex))

WARNING:LONG_LINE: line length of 105 exceeds 100 columns
#1716: FILE: net/ipn/af_ipn.c:929:
+				rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_ioctl(ipn_node,cmd,arg);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1716: FILE: net/ipn/af_ipn.c:929:
+				rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_ioctl(ipn_node,cmd,arg);
 				  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1716: FILE: net/ipn/af_ipn.c:929:
+				rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_ioctl(ipn_node,cmd,arg);
 				                                                               ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1716: FILE: net/ipn/af_ipn.c:929:
+				rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_ioctl(ipn_node,cmd,arg);
 				                                                                   ^

CHECK:BRACES: Unbalanced braces around else statement
#1719: FILE: net/ipn/af_ipn.c:932:
+			} else

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1725: FILE: net/ipn/af_ipn.c:938:
+ * shutdown can be called prior to connect and it is not reversible */

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1726: FILE: net/ipn/af_ipn.c:939:
+static int ipn_shutdown(struct socket *sock, int mode) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1727: FILE: net/ipn/af_ipn.c:940:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1728: FILE: net/ipn/af_ipn.c:941:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1729: FILE: net/ipn/af_ipn.c:942:
+	int oldshutdown=ipn_node->shutdown;
 	               ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1730: FILE: net/ipn/af_ipn.c:943:
+	int oldshutdown=ipn_node->shutdown;
+	mode = (mode+1)&(RCV_SHUTDOWN|SEND_SHUTDOWN);

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#1730: FILE: net/ipn/af_ipn.c:943:
+	mode = (mode+1)&(RCV_SHUTDOWN|SEND_SHUTDOWN);
 	            ^

CHECK:SPACING: spaces preferred around that '&' (ctx:VxV)
#1730: FILE: net/ipn/af_ipn.c:943:
+	mode = (mode+1)&(RCV_SHUTDOWN|SEND_SHUTDOWN);
 	               ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#1730: FILE: net/ipn/af_ipn.c:943:
+	mode = (mode+1)&(RCV_SHUTDOWN|SEND_SHUTDOWN);
 	                             ^

ERROR:SPACING: space required before the open parenthesis '('
#1734: FILE: net/ipn/af_ipn.c:947:
+	if(ipnn) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1739: FILE: net/ipn/af_ipn.c:952:
+		oldshutdown=ipn_node->shutdown-oldshutdown;
 		           ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1739: FILE: net/ipn/af_ipn.c:952:
+		oldshutdown=ipn_node->shutdown-oldshutdown;
 		                              ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1742: FILE: net/ipn/af_ipn.c:955:
+			ipn_net_update_counters(ipnn,
+					(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#1742: FILE: net/ipn/af_ipn.c:955:
+					(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,
 					                                   ^

ERROR:SPACING: spaces required around that ':' (ctx:VxO)
#1742: FILE: net/ipn/af_ipn.c:955:
+					(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,
 					                                     ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1742: FILE: net/ipn/af_ipn.c:955:
+					(ipn_node->shutdown & RCV_SHUTDOWN)?0:-1,
 					                                      ^

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#1743: FILE: net/ipn/af_ipn.c:956:
+					(ipn_node->shutdown & SEND_SHUTDOWN)?0:-1);
 					                                    ^

ERROR:SPACING: spaces required around that ':' (ctx:VxO)
#1743: FILE: net/ipn/af_ipn.c:956:
+					(ipn_node->shutdown & SEND_SHUTDOWN)?0:-1);
 					                                      ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1743: FILE: net/ipn/af_ipn.c:956:
+					(ipn_node->shutdown & SEND_SHUTDOWN)?0:-1);
 					                                       ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1755: FILE: net/ipn/af_ipn.c:968:
+ * injectmsg gets called by send and by the grab/tap node */

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1758: FILE: net/ipn/af_ipn.c:971:
+	struct ipn_network *ipnn=from->ipn;
 	                        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1759: FILE: net/ipn/af_ipn.c:972:
+	int err=0;
 	       ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1760: FILE: net/ipn/af_ipn.c:973:
+	int err=0;
+	if (down_interruptible(&ipnn->ipnn_mutex))

CHECK:BRACES: braces {} should be used on all arms of this statement
#1760: FILE: net/ipn/af_ipn.c:973:
+	if (down_interruptible(&ipnn->ipnn_mutex))
[...]
+	else {
[...]

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#1761: FILE: net/ipn/af_ipn.c:974:
+		err=-ERESTARTSYS;
 		   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#1761: FILE: net/ipn/af_ipn.c:974:
+		err=-ERESTARTSYS;
 		    ^

CHECK:BRACES: Unbalanced braces around else statement
#1762: FILE: net/ipn/af_ipn.c:975:
+	else {

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1770: FILE: net/ipn/af_ipn.c:983:
+static int ipn_sendmsg(struct kiocb *kiocb, struct socket *sock,
+		struct msghdr *msg, size_t len) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1771: FILE: net/ipn/af_ipn.c:984:
+static int ipn_sendmsg(struct kiocb *kiocb, struct socket *sock,
+		struct msghdr *msg, size_t len) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1772: FILE: net/ipn/af_ipn.c:985:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1773: FILE: net/ipn/af_ipn.c:986:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1775: FILE: net/ipn/af_ipn.c:988:
+	int err=0;
 	       ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1777: FILE: net/ipn/af_ipn.c:990:
+^Iif (unlikely(sock->state != SS_CONNECTED)) $

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 24)
#1777: FILE: net/ipn/af_ipn.c:990:
+	if (unlikely(sock->state != SS_CONNECTED)) 
+			return -ENOTCONN;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1787: FILE: net/ipn/af_ipn.c:1000:
+	newmsg=ipn_msgpool_alloc_locking(ipnn);
 	      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1790: FILE: net/ipn/af_ipn.c:1003:
+	newmsg->len=len;
 	           ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1791: FILE: net/ipn/af_ipn.c:1004:
+	err=memcpy_fromiovec(newmsg->data, msg->msg_iov, len);
 	   ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1792: FILE: net/ipn/af_ipn.c:1005:
+^Iif (!err) $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1794: FILE: net/ipn/af_ipn.c:1007:
+	ipn_msgpool_put(newmsg,ipnn);
 	                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1804: FILE: net/ipn/af_ipn.c:1017:
+			struct ipn_network *ipnn=to->ipn;
 			                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1805: FILE: net/ipn/af_ipn.c:1018:
+			struct ipn_network *ipnn=to->ipn;
+			spin_lock(&to->msglock);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1806: FILE: net/ipn/af_ipn.c:1019:
+^I^I^Iif ((to->shutdown & RCV_SHUTDOWN_NO_OOB) == 0 && $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1807: FILE: net/ipn/af_ipn.c:1020:
+			if ((to->shutdown & RCV_SHUTDOWN_NO_OOB) == 0 && 
+					(ipnn->flags & IPN_FLAG_LOSSLESS ||

WARNING:LONG_LINE: line length of 101 exceeds 100 columns
#1809: FILE: net/ipn/af_ipn.c:1022:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1809: FILE: net/ipn/af_ipn.c:1022:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {
 				            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1809: FILE: net/ipn/af_ipn.c:1022:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {
 				                                               ^

ERROR:SPACING: spaces required around that '!=' (ctx:VxV)
#1809: FILE: net/ipn/af_ipn.c:1022:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {
 				                                                            ^

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1809: FILE: net/ipn/af_ipn.c:1022:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1810: FILE: net/ipn/af_ipn.c:1023:
+					msgitem->msg=msg;
 					            ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1823: FILE: net/ipn/af_ipn.c:1036:
+/* ipn_proto_sendmsg is called by protocol implementation to enqueue a $

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1824: FILE: net/ipn/af_ipn.c:1037:
+ * for a destination (to).*/

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1829: FILE: net/ipn/af_ipn.c:1042:
+			ipn_netdev_sendmsg(to,msg);
 			                     ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1833: FILE: net/ipn/af_ipn.c:1046:
+			struct ipn_network *ipnn=to->ipn;
 			                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1834: FILE: net/ipn/af_ipn.c:1047:
+			struct ipn_network *ipnn=to->ipn;
+			spin_lock(&to->msglock);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1836: FILE: net/ipn/af_ipn.c:1049:
+			if ((ipnn->flags & IPN_FLAG_LOSSLESS ||
+					to->totmsgcount < ipnn->msgpool_size) &&

ERROR:SPACING: spaces required around that '==' (ctx:VxV)
#1837: FILE: net/ipn/af_ipn.c:1050:
+					(to->shutdown & RCV_SHUTDOWN)==0) {
 					                             ^

WARNING:LONG_LINE: line length of 101 exceeds 100 columns
#1838: FILE: net/ipn/af_ipn.c:1051:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1838: FILE: net/ipn/af_ipn.c:1051:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {
 				            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1838: FILE: net/ipn/af_ipn.c:1051:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {
 				                                               ^

ERROR:SPACING: spaces required around that '!=' (ctx:VxV)
#1838: FILE: net/ipn/af_ipn.c:1051:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {
 				                                                            ^

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1838: FILE: net/ipn/af_ipn.c:1051:
+				if ((msgitem=kmem_cache_alloc(ipn_msgitem_cache,GFP_KERNEL))!=NULL) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1839: FILE: net/ipn/af_ipn.c:1052:
+					msgitem->msg=msg;
 					            ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1852: FILE: net/ipn/af_ipn.c:1065:
+static int ipn_recvmsg(struct kiocb *kiocb, struct socket *sock,
+		struct msghdr *msg, size_t len, int flags) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1853: FILE: net/ipn/af_ipn.c:1066:
+static int ipn_recvmsg(struct kiocb *kiocb, struct socket *sock,
+		struct msghdr *msg, size_t len, int flags) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1854: FILE: net/ipn/af_ipn.c:1067:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1855: FILE: net/ipn/af_ipn.c:1068:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1859: FILE: net/ipn/af_ipn.c:1072:
+^Iif (unlikely(sock->state != SS_CONNECTED)) $

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 24)
#1859: FILE: net/ipn/af_ipn.c:1072:
+	if (unlikely(sock->state != SS_CONNECTED)) 
+			return -ENOTCONN;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1874: FILE: net/ipn/af_ipn.c:1087:
+		if (wait_event_interruptible(ipn_node->read_wait,
+					!(ipn_node->totmsgcount == 0)))

CHECK:BRACES: braces {} should be used on all arms of this statement
#1879: FILE: net/ipn/af_ipn.c:1092:
+	if (likely(list_empty(&ipn_node->oobmsgqueue)))
[...]
+	else {
[...]

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1880: FILE: net/ipn/af_ipn.c:1093:
+		msgitem=list_first_entry(&ipn_node->msgqueue, struct msgitem, list);
 		       ^

CHECK:BRACES: Unbalanced braces around else statement
#1881: FILE: net/ipn/af_ipn.c:1094:
+	else {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1882: FILE: net/ipn/af_ipn.c:1095:
+		msgitem=list_first_entry(&ipn_node->oobmsgqueue, struct msgitem, list);
 		       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1889: FILE: net/ipn/af_ipn.c:1102:
+	currmsg=msgitem->msg;
 	       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1891: FILE: net/ipn/af_ipn.c:1104:
+		len=currmsg->len;
 		   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1893: FILE: net/ipn/af_ipn.c:1106:
+	ipn_msgpool_put(currmsg,ipnn);
 	                       ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1894: FILE: net/ipn/af_ipn.c:1107:
+	kmem_cache_free(ipn_msgitem_cache,msgitem);
 	                                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1900: FILE: net/ipn/af_ipn.c:1113:
+static int ipn_netresize(struct ipn_network *ipnn,int newsize)
                                                  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1902: FILE: net/ipn/af_ipn.c:1115:
+	int oldsize,min;
 	           ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#1906: FILE: net/ipn/af_ipn.c:1119:
+	int err;
+	if (down_interruptible(&ipnn->ipnn_mutex))

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 24)
#1906: FILE: net/ipn/af_ipn.c:1119:
+	if (down_interruptible(&ipnn->ipnn_mutex))
+		        return -ERESTARTSYS;

ERROR:CODE_INDENT: code indent should use tabs where possible
#1907: FILE: net/ipn/af_ipn.c:1120:
+^I^I        return -ERESTARTSYS;$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1908: FILE: net/ipn/af_ipn.c:1121:
+	oldsize=ipnn->maxports;
 	       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1913: FILE: net/ipn/af_ipn.c:1126:
+	min=oldsize;
 	   ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1915: FILE: net/ipn/af_ipn.c:1128:
+	 * must be unused! */

WARNING:LINE_SPACING: Missing a blank line after declarations
#1918: FILE: net/ipn/af_ipn.c:1131:
+		int i;
+		for (i=newsize; i<oldsize; i++)

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1918: FILE: net/ipn/af_ipn.c:1131:
+		for (i=newsize; i<oldsize; i++)
 		      ^

ERROR:SPACING: spaces required around that '<' (ctx:VxV)
#1918: FILE: net/ipn/af_ipn.c:1131:
+		for (i=newsize; i<oldsize; i++)
 		                 ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1923: FILE: net/ipn/af_ipn.c:1136:
+		min=newsize;
 		   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1925: FILE: net/ipn/af_ipn.c:1138:
+	oldconnport=ipnn->connport;
 	           ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1927: FILE: net/ipn/af_ipn.c:1140:
+	newconnport=kzalloc(newsize * sizeof(struct ipn_node *),GFP_KERNEL);
 	           ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1927: FILE: net/ipn/af_ipn.c:1140:
+	newconnport=kzalloc(newsize * sizeof(struct ipn_node *),GFP_KERNEL);
 	                                                       ^

WARNING:ALLOC_WITH_MULTIPLY: Prefer kcalloc over kzalloc with multiply
#1927: FILE: net/ipn/af_ipn.c:1140:
+	newconnport=kzalloc(newsize * sizeof(struct ipn_node *),GFP_KERNEL);

Prefer kmalloc_array/kcalloc over kmalloc/kzalloc with a
sizeof multiply.

See: https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1932: FILE: net/ipn/af_ipn.c:1145:
+	memcpy(newconnport,oldconnport,min * sizeof(struct ipn_node *));
 	                  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1932: FILE: net/ipn/af_ipn.c:1145:
+	memcpy(newconnport,oldconnport,min * sizeof(struct ipn_node *));
 	                              ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1933: FILE: net/ipn/af_ipn.c:1146:
+	ipnn->connport=newconnport;
 	              ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1934: FILE: net/ipn/af_ipn.c:1147:
+	ipnn->maxports=newsize;
 	              ^

WARNING:TYPO_SPELLING: 'netowrk' may be misspelled - perhaps 'network'?
#1935: FILE: net/ipn/af_ipn.c:1148:
+	/* notify the protocol that the netowrk has been resized */
 	                                ^^^^^^^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1936: FILE: net/ipn/af_ipn.c:1149:
+	err=ipn_protocol_table[ipnn->protocol]->ipn_p_resizenet(ipnn,oldsize,newsize);
 	   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1936: FILE: net/ipn/af_ipn.c:1149:
+	err=ipn_protocol_table[ipnn->protocol]->ipn_p_resizenet(ipnn,oldsize,newsize);
 	                                                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1936: FILE: net/ipn/af_ipn.c:1149:
+	err=ipn_protocol_table[ipnn->protocol]->ipn_p_resizenet(ipnn,oldsize,newsize);
 	                                                                    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1939: FILE: net/ipn/af_ipn.c:1152:
+		ipnn->connport=oldconnport;
 		              ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1940: FILE: net/ipn/af_ipn.c:1153:
+		ipnn->maxports=oldsize;
 		              ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1942: FILE: net/ipn/af_ipn.c:1155:
+^I} else $

CHECK:BRACES: Unbalanced braces around else statement
#1942: FILE: net/ipn/af_ipn.c:1155:
+	} else 

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#1950: FILE: net/ipn/af_ipn.c:1163:
+static int ipn_setsockopt(struct socket *sock, int level, int optname,
+		char __user *optval, int optlen) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1951: FILE: net/ipn/af_ipn.c:1164:
+static int ipn_setsockopt(struct socket *sock, int level, int optname,
+		char __user *optval, int optlen) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1952: FILE: net/ipn/af_ipn.c:1165:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1953: FILE: net/ipn/af_ipn.c:1166:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#1957: FILE: net/ipn/af_ipn.c:1170:
+	if (level != 0 && level != ipn_node->protocol+1)
 	                                             ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#1961: FILE: net/ipn/af_ipn.c:1174:
+		if (ipnn) {
[...]
+		} else
[...]

WARNING:LINE_SPACING: Missing a blank line after declarations
#1963: FILE: net/ipn/af_ipn.c:1176:
+			int rv;
+			if (down_interruptible(&ipnn->ipnn_mutex))

WARNING:LONG_LINE: line length of 116 exceeds 100 columns
#1965: FILE: net/ipn/af_ipn.c:1178:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_setsockopt(ipn_node,optname,optval,optlen);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1965: FILE: net/ipn/af_ipn.c:1178:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_setsockopt(ipn_node,optname,optval,optlen);
 			  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1965: FILE: net/ipn/af_ipn.c:1178:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_setsockopt(ipn_node,optname,optval,optlen);
 			                                                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1965: FILE: net/ipn/af_ipn.c:1178:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_setsockopt(ipn_node,optname,optval,optlen);
 			                                                                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1965: FILE: net/ipn/af_ipn.c:1178:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_setsockopt(ipn_node,optname,optval,optlen);
 			                                                                                   ^

CHECK:BRACES: Unbalanced braces around else statement
#1968: FILE: net/ipn/af_ipn.c:1181:
+		} else

CHECK:BRACES: braces {} should be used on all arms of this statement
#1972: FILE: net/ipn/af_ipn.c:1185:
+			if (optlen > IPN_DESCRLEN)
[...]
+			else {
[...]

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#1974: FILE: net/ipn/af_ipn.c:1187:
+				return -EINVAL;
+			else {

CHECK:BRACES: Unbalanced braces around else statement
#1974: FILE: net/ipn/af_ipn.c:1187:
+			else {

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1975: FILE: net/ipn/af_ipn.c:1188:
+				memset(ipn_node->descr,0,IPN_DESCRLEN);
 				                      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1975: FILE: net/ipn/af_ipn.c:1188:
+				memset(ipn_node->descr,0,IPN_DESCRLEN);
 				                        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1976: FILE: net/ipn/af_ipn.c:1189:
+				copy_from_user(ipn_node->descr,optval,optlen);
 				                              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1976: FILE: net/ipn/af_ipn.c:1189:
+				copy_from_user(ipn_node->descr,optval,optlen);
 				                                     ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1977: FILE: net/ipn/af_ipn.c:1190:
+				ipn_node->descr[optlen-1]=0;
 				                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1977: FILE: net/ipn/af_ipn.c:1190:
+				ipn_node->descr[optlen-1]=0;
 				                         ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#1981: FILE: net/ipn/af_ipn.c:1194:
+			if (optlen < sizeof(int))
[...]
+			else if ((optname & IPN_SO_PREBIND) && (ipnn != NULL))
[...]
+			else {
[...]

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "ipnn"
#1983: FILE: net/ipn/af_ipn.c:1196:
+			else if ((optname & IPN_SO_PREBIND) && (ipnn != NULL))

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#1985: FILE: net/ipn/af_ipn.c:1198:
+				return -EISCONN;
+			else {

CHECK:BRACES: Unbalanced braces around else statement
#1985: FILE: net/ipn/af_ipn.c:1198:
+			else {

CHECK:SPACING: No space is necessary after a cast
#1987: FILE: net/ipn/af_ipn.c:1200:
+				get_user(val, (int __user *) optval);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1987: FILE: net/ipn/af_ipn.c:1200:
+				int val;
+				get_user(val, (int __user *) optval);

WARNING:SPACING: missing space after struct definition
#1989: FILE: net/ipn/af_ipn.c:1202:
+					struct pre_bind_parms std=STD_BIND_PARMS;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1989: FILE: net/ipn/af_ipn.c:1202:
+					struct pre_bind_parms std=STD_BIND_PARMS;
 					                         ^

WARNING:LONG_LINE: line length of 104 exceeds 100 columns
#1990: FILE: net/ipn/af_ipn.c:1203:
+					ipn_node->pbp=kzalloc(sizeof(struct pre_bind_parms),GFP_KERNEL);

WARNING:LINE_SPACING: Missing a blank line after declarations
#1990: FILE: net/ipn/af_ipn.c:1203:
+					struct pre_bind_parms std=STD_BIND_PARMS;
+					ipn_node->pbp=kzalloc(sizeof(struct pre_bind_parms),GFP_KERNEL);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1990: FILE: net/ipn/af_ipn.c:1203:
+					ipn_node->pbp=kzalloc(sizeof(struct pre_bind_parms),GFP_KERNEL);
 					             ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#1990: FILE: net/ipn/af_ipn.c:1203:
+					ipn_node->pbp=kzalloc(sizeof(struct pre_bind_parms),GFP_KERNEL);
 					                                                   ^

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*ipn_node->pbp)...) over kzalloc(sizeof(struct pre_bind_parms)...)
#1990: FILE: net/ipn/af_ipn.c:1203:
+					ipn_node->pbp=kzalloc(sizeof(struct pre_bind_parms),GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1993: FILE: net/ipn/af_ipn.c:1206:
+					*(ipn_node->pbp)=std;
 					                ^

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around ipn_node->pbp
#1993: FILE: net/ipn/af_ipn.c:1206:
+					*(ipn_node->pbp)=std;

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#1995: FILE: net/ipn/af_ipn.c:1208:
+				switch (optname) {
+					case IPN_SO_PORT:
[...]
+					case IPN_SO_CHANGE_NUMNODES:
[...]
+					case IPN_SO_WANT_OOB_NUMNODES:
[...]
+					case IPN_SO_HANDLE_OOB:
[...]
+					case IPN_SO_MTU:
[...]
+					case IPN_SO_NUMNODES:
[...]
+					case IPN_SO_MSGPOOLSIZE:
[...]
+					case IPN_SO_FLAGS:
[...]
+					case IPN_SO_MODE:

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#1997: FILE: net/ipn/af_ipn.c:1210:
+						if (sock->state == SS_UNCONNECTED)

Indentation with 6 or more tabs usually indicate overly indented
code.

It is suggested to refactor excessive indentation of
if/else/for/do/while/switch statements.

See: https://lore.kernel.org/lkml/1328311239.21255.24.camel@joe2Laptop/

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#1998: FILE: net/ipn/af_ipn.c:1211:
+							ipn_node->portno=val;
 							                ^

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#1999: FILE: net/ipn/af_ipn.c:1212:
+						else

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2003: FILE: net/ipn/af_ipn.c:1216:
+						if ((ipn_node->flags & IPN_NODEFLAG_BOUND)!=0) {

ERROR:SPACING: spaces required around that '!=' (ctx:VxV)
#2003: FILE: net/ipn/af_ipn.c:1216:
+						if ((ipn_node->flags & IPN_NODEFLAG_BOUND)!=0) {
 						                                          ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#2003: FILE: net/ipn/af_ipn.c:1216:
+						if ((ipn_node->flags & IPN_NODEFLAG_BOUND)!=0) {
[...]
+						} else
[...]

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2004: FILE: net/ipn/af_ipn.c:1217:
+							if (val <= 0)

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2006: FILE: net/ipn/af_ipn.c:1219:
+							else

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2007: FILE: net/ipn/af_ipn.c:1220:
+								return ipn_netresize(ipnn,val);
 								                         ^

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2008: FILE: net/ipn/af_ipn.c:1221:
+						} else

CHECK:BRACES: Unbalanced braces around else statement
#2008: FILE: net/ipn/af_ipn.c:1221:
+						} else

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2009: FILE: net/ipn/af_ipn.c:1222:
+							val=-ENOTCONN;
 							   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2009: FILE: net/ipn/af_ipn.c:1222:
+							val=-ENOTCONN;
 							    ^

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2012: FILE: net/ipn/af_ipn.c:1225:
+						if (val)

WARNING:LONG_LINE: line length of 101 exceeds 100 columns
#2013: FILE: net/ipn/af_ipn.c:1226:
+							ipn_node->flags |= IPN_NODEFLAG_OOB_NUMNODES;

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2014: FILE: net/ipn/af_ipn.c:1227:
+						else

WARNING:LONG_LINE: line length of 102 exceeds 100 columns
#2015: FILE: net/ipn/af_ipn.c:1228:
+							ipn_node->flags &= ~IPN_NODEFLAG_OOB_NUMNODES;

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2018: FILE: net/ipn/af_ipn.c:1231:
+						if (val)

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2020: FILE: net/ipn/af_ipn.c:1233:
+						else

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2024: FILE: net/ipn/af_ipn.c:1237:
+						if (val <= 0)

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#2026: FILE: net/ipn/af_ipn.c:1239:
+							return -EINVAL;
+						else

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2026: FILE: net/ipn/af_ipn.c:1239:
+						else

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2027: FILE: net/ipn/af_ipn.c:1240:
+							ipn_node->pbp->mtu=val;
 							                  ^

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2030: FILE: net/ipn/af_ipn.c:1243:
+						if (val <= 0)

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#2032: FILE: net/ipn/af_ipn.c:1245:
+							return -EINVAL;
+						else

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2032: FILE: net/ipn/af_ipn.c:1245:
+						else

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2033: FILE: net/ipn/af_ipn.c:1246:
+							ipn_node->pbp->maxports=val;
 							                       ^

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2036: FILE: net/ipn/af_ipn.c:1249:
+						if (val <= 0)

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#2038: FILE: net/ipn/af_ipn.c:1251:
+							return -EINVAL;
+						else

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#2038: FILE: net/ipn/af_ipn.c:1251:
+						else

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2039: FILE: net/ipn/af_ipn.c:1252:
+							ipn_node->pbp->msgpoolsize=val;
 							                          ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2042: FILE: net/ipn/af_ipn.c:1255:
+						ipn_node->pbp->flags=val;
 						                    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2045: FILE: net/ipn/af_ipn.c:1258:
+						ipn_node->pbp->mode=val;
 						                   ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#2055: FILE: net/ipn/af_ipn.c:1268:
+static int ipn_getsockopt(struct socket *sock, int level, int optname,
+		char __user *optval, int __user *optlen) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2056: FILE: net/ipn/af_ipn.c:1269:
+static int ipn_getsockopt(struct socket *sock, int level, int optname,
+		char __user *optval, int __user *optlen) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2057: FILE: net/ipn/af_ipn.c:1270:
+	struct ipn_node *ipn_node=((struct ipn_sock *)sock->sk)->node;
 	                         ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2058: FILE: net/ipn/af_ipn.c:1271:
+	struct ipn_network *ipnn=ipn_node->ipn;
 	                        ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#2063: FILE: net/ipn/af_ipn.c:1276:
+	if (level != 0 && level != ipn_node->protocol+1)
 	                                             ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#2066: FILE: net/ipn/af_ipn.c:1279:
+		if (ipnn) {
[...]
+		} else
[...]

WARNING:LONG_LINE: line length of 116 exceeds 100 columns
#2071: FILE: net/ipn/af_ipn.c:1284:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_getsockopt(ipn_node,optname,optval,optlen);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2071: FILE: net/ipn/af_ipn.c:1284:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_getsockopt(ipn_node,optname,optval,optlen);
 			  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2071: FILE: net/ipn/af_ipn.c:1284:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_getsockopt(ipn_node,optname,optval,optlen);
 			                                                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2071: FILE: net/ipn/af_ipn.c:1284:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_getsockopt(ipn_node,optname,optval,optlen);
 			                                                                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2071: FILE: net/ipn/af_ipn.c:1284:
+			rv=ipn_protocol_table[ipn_node->protocol]->ipn_p_getsockopt(ipn_node,optname,optval,optlen);
 			                                                                                   ^

CHECK:BRACES: Unbalanced braces around else statement
#2074: FILE: net/ipn/af_ipn.c:1287:
+		} else

CHECK:BRACES: braces {} should be used on all arms of this statement
#2080: FILE: net/ipn/af_ipn.c:1293:
+			if (len < IPN_DESCRLEN)
[...]
+			else {
[...]

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#2082: FILE: net/ipn/af_ipn.c:1295:
+				return -EINVAL;
+			else {

CHECK:BRACES: Unbalanced braces around else statement
#2082: FILE: net/ipn/af_ipn.c:1295:
+			else {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2084: FILE: net/ipn/af_ipn.c:1297:
+					len=IPN_DESCRLEN;
 					   ^

ERROR:SPACING: space required before the open parenthesis '('
#2085: FILE: net/ipn/af_ipn.c:1298:
+				if(put_user(len, optlen))

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2087: FILE: net/ipn/af_ipn.c:1300:
+				if(copy_to_user(optval,ipn_node->descr,len))
 				                      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2087: FILE: net/ipn/af_ipn.c:1300:
+				if(copy_to_user(optval,ipn_node->descr,len))
 				                                      ^

ERROR:SPACING: space required before the open parenthesis '('
#2087: FILE: net/ipn/af_ipn.c:1300:
+				if(copy_to_user(optval,ipn_node->descr,len))

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2092: FILE: net/ipn/af_ipn.c:1305:
+			int val=-2;
 			       ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2092: FILE: net/ipn/af_ipn.c:1305:
+			int val=-2;
 			        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2093: FILE: net/ipn/af_ipn.c:1306:
+			int val=-2;
+			switch (optname) {

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#2093: FILE: net/ipn/af_ipn.c:1306:
+			switch (optname) {
+				case IPN_SO_PORT:
[...]
+				case IPN_SO_MTU:
[...]
+				case IPN_SO_NUMNODES:
[...]
+				case IPN_SO_MSGPOOLSIZE:
[...]
+				case IPN_SO_FLAGS:
[...]
+				case IPN_SO_MODE:

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2095: FILE: net/ipn/af_ipn.c:1308:
+					val=ipn_node->portno;
 					   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2099: FILE: net/ipn/af_ipn.c:1312:
+						val=ipnn->mtu;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2101: FILE: net/ipn/af_ipn.c:1314:
+						val=ipn_node->pbp->mtu;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2105: FILE: net/ipn/af_ipn.c:1318:
+						val=ipnn->maxports;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2107: FILE: net/ipn/af_ipn.c:1320:
+						val=ipn_node->pbp->maxports;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2111: FILE: net/ipn/af_ipn.c:1324:
+						val=ipnn->msgpool_size;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2113: FILE: net/ipn/af_ipn.c:1326:
+						val=ipn_node->pbp->msgpoolsize;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2117: FILE: net/ipn/af_ipn.c:1330:
+						val=ipnn->flags;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2119: FILE: net/ipn/af_ipn.c:1332:
+						val=ipn_node->pbp->flags;
 						   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2123: FILE: net/ipn/af_ipn.c:1336:
+						val=-1;
 						   ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2123: FILE: net/ipn/af_ipn.c:1336:
+						val=-1;
 						    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2125: FILE: net/ipn/af_ipn.c:1338:
+						val=ipn_node->pbp->mode;
 						   ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#2128: FILE: net/ipn/af_ipn.c:1341:
+			if (val < -1)
[...]
+			else {
[...]

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#2130: FILE: net/ipn/af_ipn.c:1343:
+				return -EINVAL;
+			else {

CHECK:BRACES: Unbalanced braces around else statement
#2130: FILE: net/ipn/af_ipn.c:1343:
+			else {

CHECK:BRACES: braces {} should be used on all arms of this statement
#2131: FILE: net/ipn/af_ipn.c:1344:
+				if (len < sizeof(int))
[...]
+				else {
[...]

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#2133: FILE: net/ipn/af_ipn.c:1346:
+					return -EOVERFLOW;
+				else {

CHECK:BRACES: Unbalanced braces around else statement
#2133: FILE: net/ipn/af_ipn.c:1346:
+				else {

ERROR:SPACING: space required before the open parenthesis '('
#2135: FILE: net/ipn/af_ipn.c:1348:
+					if(put_user(len, optlen))

ERROR:SPACING: space required after that ',' (ctx:VxO)
#2137: FILE: net/ipn/af_ipn.c:1350:
+					if(copy_to_user(optval,&val,len))
 					                      ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#2137: FILE: net/ipn/af_ipn.c:1350:
+					if(copy_to_user(optval,&val,len))
 					                       ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2137: FILE: net/ipn/af_ipn.c:1350:
+					if(copy_to_user(optval,&val,len))
 					                           ^

ERROR:SPACING: space required before the open parenthesis '('
#2137: FILE: net/ipn/af_ipn.c:1350:
+					if(copy_to_user(optval,&val,len))

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#2148: FILE: net/ipn/af_ipn.c:1361:
+static int ipn_bcast_newport(struct ipn_node *newport) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2149: FILE: net/ipn/af_ipn.c:1362:
+	struct ipn_network *ipnn=newport->ipn;
 	                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2151: FILE: net/ipn/af_ipn.c:1364:
+	int i;
+	for (i=0;i<ipnn->maxports;i++) {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2151: FILE: net/ipn/af_ipn.c:1364:
+	for (i=0;i<ipnn->maxports;i++) {
 	      ^

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2151: FILE: net/ipn/af_ipn.c:1364:
+	for (i=0;i<ipnn->maxports;i++) {
 	        ^

ERROR:SPACING: spaces required around that '<' (ctx:VxV)
#2151: FILE: net/ipn/af_ipn.c:1364:
+	for (i=0;i<ipnn->maxports;i++) {
 	          ^

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2151: FILE: net/ipn/af_ipn.c:1364:
+	for (i=0;i<ipnn->maxports;i++) {
 	                         ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2152: FILE: net/ipn/af_ipn.c:1365:
+^I^Iif (ipnn->connport[i] == NULL) $

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ipnn->connport[i]"
#2152: FILE: net/ipn/af_ipn.c:1365:
+		if (ipnn->connport[i] == NULL) 

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2158: FILE: net/ipn/af_ipn.c:1371:
+static int ipn_bcast_handlemsg(struct ipn_node *from, $

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#2158: FILE: net/ipn/af_ipn.c:1371:
+static int ipn_bcast_handlemsg(struct ipn_node *from, 
+		struct msgpool_item *msgitem){

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2159: FILE: net/ipn/af_ipn.c:1372:
+static int ipn_bcast_handlemsg(struct ipn_node *from, 
+		struct msgpool_item *msgitem){

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2160: FILE: net/ipn/af_ipn.c:1373:
+	struct ipn_network *ipnn=from->ipn;
 	                        ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2163: FILE: net/ipn/af_ipn.c:1376:
+	struct ipn_node *ipn_node;
+	list_for_each_entry(ipn_node, &ipnn->connectqueue, nodelist) {

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2165: FILE: net/ipn/af_ipn.c:1378:
+			ipn_proto_sendmsg(ipn_node,msgitem);
 			                          ^

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2173: FILE: net/ipn/af_ipn.c:1386:
+static int ipn_null_newnet(struct ipn_network *newnet) {return 0;}
                                                                 ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#2174: FILE: net/ipn/af_ipn.c:1387:
+static int ipn_null_resizenet(struct ipn_network *net,int oldsize,int newsize) {

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2174: FILE: net/ipn/af_ipn.c:1387:
+static int ipn_null_resizenet(struct ipn_network *net,int oldsize,int newsize) {
                                                      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2174: FILE: net/ipn/af_ipn.c:1387:
+static int ipn_null_resizenet(struct ipn_network *net,int oldsize,int newsize) {
                                                                  ^

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2175: FILE: net/ipn/af_ipn.c:1388:
+	return 0;}
 	        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2177: FILE: net/ipn/af_ipn.c:1390:
+static int ipn_null_setsockopt(struct ipn_node *port,int optname,
                                                     ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#2177: FILE: net/ipn/af_ipn.c:1390:
+static int ipn_null_setsockopt(struct ipn_node *port,int optname,
+		char __user *optval, int optlen) {return -EOPNOTSUPP;}

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2178: FILE: net/ipn/af_ipn.c:1391:
+static int ipn_null_setsockopt(struct ipn_node *port,int optname,
+		char __user *optval, int optlen) {return -EOPNOTSUPP;}

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2178: FILE: net/ipn/af_ipn.c:1391:
+		char __user *optval, int optlen) {return -EOPNOTSUPP;}
 		                                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2179: FILE: net/ipn/af_ipn.c:1392:
+static int ipn_null_getsockopt(struct ipn_node *port,int optname,
                                                     ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#2179: FILE: net/ipn/af_ipn.c:1392:
+static int ipn_null_getsockopt(struct ipn_node *port,int optname,
+		char __user *optval, int *optlen) {return -EOPNOTSUPP;}

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2180: FILE: net/ipn/af_ipn.c:1393:
+static int ipn_null_getsockopt(struct ipn_node *port,int optname,
+		char __user *optval, int *optlen) {return -EOPNOTSUPP;}

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2180: FILE: net/ipn/af_ipn.c:1393:
+		char __user *optval, int *optlen) {return -EOPNOTSUPP;}
 		                                                     ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2181: FILE: net/ipn/af_ipn.c:1394:
+static int ipn_null_ioctl(struct ipn_node *port,unsigned int request,
                                                ^

ERROR:OPEN_BRACE: open brace '{' following function definitions go on the next line
#2181: FILE: net/ipn/af_ipn.c:1394:
+static int ipn_null_ioctl(struct ipn_node *port,unsigned int request,
+		unsigned long arg) {return -EOPNOTSUPP;}

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2182: FILE: net/ipn/af_ipn.c:1395:
+static int ipn_null_ioctl(struct ipn_node *port,unsigned int request,
+		unsigned long arg) {return -EOPNOTSUPP;}

ERROR:SPACING: space required after that ';' (ctx:VxV)
#2182: FILE: net/ipn/af_ipn.c:1395:
+		unsigned long arg) {return -EOPNOTSUPP;}
 		                                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2188: FILE: net/ipn/af_ipn.c:1401:
+	if (p->ipn_p_delport == NULL) p->ipn_p_delport=ipn_null_delport;
 	                                              ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2188: FILE: net/ipn/af_ipn.c:1401:
+	if (p->ipn_p_delport == NULL) p->ipn_p_delport=ipn_null_delport;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_delport"
#2188: FILE: net/ipn/af_ipn.c:1401:
+	if (p->ipn_p_delport == NULL) p->ipn_p_delport=ipn_null_delport;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2189: FILE: net/ipn/af_ipn.c:1402:
+	if (p->ipn_p_postnewport == NULL) p->ipn_p_postnewport=ipn_null_postnewport;
 	                                                      ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2189: FILE: net/ipn/af_ipn.c:1402:
+	if (p->ipn_p_postnewport == NULL) p->ipn_p_postnewport=ipn_null_postnewport;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_postnewport"
#2189: FILE: net/ipn/af_ipn.c:1402:
+	if (p->ipn_p_postnewport == NULL) p->ipn_p_postnewport=ipn_null_postnewport;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2190: FILE: net/ipn/af_ipn.c:1403:
+	if (p->ipn_p_predelport == NULL) p->ipn_p_predelport=ipn_null_predelport;
 	                                                    ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2190: FILE: net/ipn/af_ipn.c:1403:
+	if (p->ipn_p_predelport == NULL) p->ipn_p_predelport=ipn_null_predelport;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_predelport"
#2190: FILE: net/ipn/af_ipn.c:1403:
+	if (p->ipn_p_predelport == NULL) p->ipn_p_predelport=ipn_null_predelport;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2191: FILE: net/ipn/af_ipn.c:1404:
+	if (p->ipn_p_newnet == NULL) p->ipn_p_newnet=ipn_null_newnet;
 	                                            ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2191: FILE: net/ipn/af_ipn.c:1404:
+	if (p->ipn_p_newnet == NULL) p->ipn_p_newnet=ipn_null_newnet;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_newnet"
#2191: FILE: net/ipn/af_ipn.c:1404:
+	if (p->ipn_p_newnet == NULL) p->ipn_p_newnet=ipn_null_newnet;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2192: FILE: net/ipn/af_ipn.c:1405:
+	if (p->ipn_p_resizenet == NULL) p->ipn_p_resizenet=ipn_null_resizenet;
 	                                                  ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2192: FILE: net/ipn/af_ipn.c:1405:
+	if (p->ipn_p_resizenet == NULL) p->ipn_p_resizenet=ipn_null_resizenet;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_resizenet"
#2192: FILE: net/ipn/af_ipn.c:1405:
+	if (p->ipn_p_resizenet == NULL) p->ipn_p_resizenet=ipn_null_resizenet;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2193: FILE: net/ipn/af_ipn.c:1406:
+	if (p->ipn_p_delnet == NULL) p->ipn_p_delnet=ipn_null_delnet;
 	                                            ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2193: FILE: net/ipn/af_ipn.c:1406:
+	if (p->ipn_p_delnet == NULL) p->ipn_p_delnet=ipn_null_delnet;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_delnet"
#2193: FILE: net/ipn/af_ipn.c:1406:
+	if (p->ipn_p_delnet == NULL) p->ipn_p_delnet=ipn_null_delnet;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2194: FILE: net/ipn/af_ipn.c:1407:
+	if (p->ipn_p_setsockopt == NULL) p->ipn_p_setsockopt=ipn_null_setsockopt;
 	                                                    ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2194: FILE: net/ipn/af_ipn.c:1407:
+	if (p->ipn_p_setsockopt == NULL) p->ipn_p_setsockopt=ipn_null_setsockopt;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_setsockopt"
#2194: FILE: net/ipn/af_ipn.c:1407:
+	if (p->ipn_p_setsockopt == NULL) p->ipn_p_setsockopt=ipn_null_setsockopt;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2195: FILE: net/ipn/af_ipn.c:1408:
+	if (p->ipn_p_getsockopt == NULL) p->ipn_p_getsockopt=ipn_null_getsockopt;
 	                                                    ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2195: FILE: net/ipn/af_ipn.c:1408:
+	if (p->ipn_p_getsockopt == NULL) p->ipn_p_getsockopt=ipn_null_getsockopt;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_getsockopt"
#2195: FILE: net/ipn/af_ipn.c:1408:
+	if (p->ipn_p_getsockopt == NULL) p->ipn_p_getsockopt=ipn_null_getsockopt;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2196: FILE: net/ipn/af_ipn.c:1409:
+	if (p->ipn_p_ioctl == NULL) p->ipn_p_ioctl=ipn_null_ioctl;
 	                                          ^

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#2196: FILE: net/ipn/af_ipn.c:1409:
+	if (p->ipn_p_ioctl == NULL) p->ipn_p_ioctl=ipn_null_ioctl;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!p->ipn_p_ioctl"
#2196: FILE: net/ipn/af_ipn.c:1409:
+	if (p->ipn_p_ioctl == NULL) p->ipn_p_ioctl=ipn_null_ioctl;

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2199: FILE: net/ipn/af_ipn.c:1412:
+int ipn_proto_register(int protocol,struct ipn_protocol *ipn_service)
                                    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2201: FILE: net/ipn/af_ipn.c:1414:
+	int rv=0;
 	      ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2202: FILE: net/ipn/af_ipn.c:1415:
+	int rv=0;
+	if (ipn_service->ipn_p_newport == NULL ||

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ipn_service->ipn_p_newport"
#2202: FILE: net/ipn/af_ipn.c:1415:
+	if (ipn_service->ipn_p_newport == NULL ||

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2203: FILE: net/ipn/af_ipn.c:1416:
+	if (ipn_service->ipn_p_newport == NULL ||
+			ipn_service->ipn_p_handlemsg == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ipn_service->ipn_p_handlemsg"
#2203: FILE: net/ipn/af_ipn.c:1416:
+			ipn_service->ipn_p_handlemsg == NULL)

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2206: FILE: net/ipn/af_ipn.c:1419:
+^Iif (down_interruptible(&ipn_glob_mutex)) $

CHECK:BRACES: braces {} should be used on all arms of this statement
#2208: FILE: net/ipn/af_ipn.c:1421:
+	if (protocol > 1 && protocol <= IPN_MAX_PROTO) {
[...]
+	} else
[...]

CHECK:BRACES: braces {} should be used on all arms of this statement
#2210: FILE: net/ipn/af_ipn.c:1423:
+		if (ipn_protocol_table[protocol])
[...]
+		else {
[...]

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#2211: FILE: net/ipn/af_ipn.c:1424:
+			rv= -EEXIST;
 			  ^

CHECK:BRACES: Unbalanced braces around else statement
#2212: FILE: net/ipn/af_ipn.c:1425:
+		else {

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2213: FILE: net/ipn/af_ipn.c:1426:
+			ipn_service->refcnt=0;
 			                   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2214: FILE: net/ipn/af_ipn.c:1427:
+			ipn_protocol_table[protocol]=ipn_service;
 			                            ^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#2215: FILE: net/ipn/af_ipn.c:1428:
+			printk(KERN_INFO "IPN: Registered protocol %d\n",protocol+1);

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2215: FILE: net/ipn/af_ipn.c:1428:
+			printk(KERN_INFO "IPN: Registered protocol %d\n",protocol+1);
 			                                                ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#2215: FILE: net/ipn/af_ipn.c:1428:
+			printk(KERN_INFO "IPN: Registered protocol %d\n",protocol+1);
 			                                                         ^

CHECK:BRACES: Unbalanced braces around else statement
#2217: FILE: net/ipn/af_ipn.c:1430:
+	} else

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#2218: FILE: net/ipn/af_ipn.c:1431:
+		rv= -EINVAL;
 		  ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2223: FILE: net/ipn/af_ipn.c:1436:
+int ipn_proto_deregister(int protocol) $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2225: FILE: net/ipn/af_ipn.c:1438:
+	int rv=0;
 	      ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2226: FILE: net/ipn/af_ipn.c:1439:
+^Iif (down_interruptible(&ipn_glob_mutex)) $

WARNING:LINE_SPACING: Missing a blank line after declarations
#2226: FILE: net/ipn/af_ipn.c:1439:
+	int rv=0;
+	if (down_interruptible(&ipn_glob_mutex)) 

CHECK:BRACES: braces {} should be used on all arms of this statement
#2228: FILE: net/ipn/af_ipn.c:1441:
+	if (protocol > 1 && protocol <= IPN_MAX_PROTO) {
[...]
+	} else
[...]

CHECK:BRACES: braces {} should be used on all arms of this statement
#2230: FILE: net/ipn/af_ipn.c:1443:
+		if (ipn_protocol_table[protocol]) {
[...]
+		} else 
[...]

CHECK:BRACES: braces {} should be used on all arms of this statement
#2231: FILE: net/ipn/af_ipn.c:1444:
+			if (ipn_protocol_table[protocol]->refcnt == 0) {
[...]
+			} else
[...]

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2232: FILE: net/ipn/af_ipn.c:1445:
+				ipn_protocol_table[protocol]=NULL;
 				                            ^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#2233: FILE: net/ipn/af_ipn.c:1446:
+				printk(KERN_INFO "IPN: Unregistered protocol %d\n",protocol+1);

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2233: FILE: net/ipn/af_ipn.c:1446:
+				printk(KERN_INFO "IPN: Unregistered protocol %d\n",protocol+1);
 				                                                  ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#2233: FILE: net/ipn/af_ipn.c:1446:
+				printk(KERN_INFO "IPN: Unregistered protocol %d\n",protocol+1);
 				                                                           ^

CHECK:BRACES: Unbalanced braces around else statement
#2234: FILE: net/ipn/af_ipn.c:1447:
+			} else

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2235: FILE: net/ipn/af_ipn.c:1448:
+				rv=-EADDRINUSE;
 				  ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2235: FILE: net/ipn/af_ipn.c:1448:
+				rv=-EADDRINUSE;
 				   ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2236: FILE: net/ipn/af_ipn.c:1449:
+^I^I} else $

CHECK:BRACES: Unbalanced braces around else statement
#2236: FILE: net/ipn/af_ipn.c:1449:
+		} else 

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#2237: FILE: net/ipn/af_ipn.c:1450:
+			rv= -ENOENT;
 			  ^

CHECK:BRACES: Unbalanced braces around else statement
#2238: FILE: net/ipn/af_ipn.c:1451:
+	} else

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#2239: FILE: net/ipn/af_ipn.c:1452:
+		rv= -EINVAL;
 		  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2258: FILE: net/ipn/af_ipn.c:1471:
+	ipn_network_cache=kmem_cache_create("ipn_network",sizeof(struct ipn_network),0,0,NULL);
 	                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2258: FILE: net/ipn/af_ipn.c:1471:
+	ipn_network_cache=kmem_cache_create("ipn_network",sizeof(struct ipn_network),0,0,NULL);
 	                                                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2258: FILE: net/ipn/af_ipn.c:1471:
+	ipn_network_cache=kmem_cache_create("ipn_network",sizeof(struct ipn_network),0,0,NULL);
 	                                                                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2258: FILE: net/ipn/af_ipn.c:1471:
+	ipn_network_cache=kmem_cache_create("ipn_network",sizeof(struct ipn_network),0,0,NULL);
 	                                                                              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2258: FILE: net/ipn/af_ipn.c:1471:
+	ipn_network_cache=kmem_cache_create("ipn_network",sizeof(struct ipn_network),0,0,NULL);
 	                                                                                ^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_crit([subsystem]dev, ... then dev_crit(dev, ... then pr_crit(...  to printk(KERN_CRIT ...
#2260: FILE: net/ipn/af_ipn.c:1473:
+		printk(KERN_CRIT "%s: Cannot create ipn_network SLAB cache!\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2261: FILE: net/ipn/af_ipn.c:1474:
+		printk(KERN_CRIT "%s: Cannot create ipn_network SLAB cache!\n",
+				__FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#2261: FILE: net/ipn/af_ipn.c:1474:
+				__FUNCTION__);

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2262: FILE: net/ipn/af_ipn.c:1475:
+		rc=-ENOMEM;
 		  ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2262: FILE: net/ipn/af_ipn.c:1475:
+		rc=-ENOMEM;
 		   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2266: FILE: net/ipn/af_ipn.c:1479:
+	ipn_node_cache=kmem_cache_create("ipn_node",sizeof(struct ipn_node),0,0,NULL);
 	              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2266: FILE: net/ipn/af_ipn.c:1479:
+	ipn_node_cache=kmem_cache_create("ipn_node",sizeof(struct ipn_node),0,0,NULL);
 	                                           ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2266: FILE: net/ipn/af_ipn.c:1479:
+	ipn_node_cache=kmem_cache_create("ipn_node",sizeof(struct ipn_node),0,0,NULL);
 	                                                                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2266: FILE: net/ipn/af_ipn.c:1479:
+	ipn_node_cache=kmem_cache_create("ipn_node",sizeof(struct ipn_node),0,0,NULL);
 	                                                                     ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2266: FILE: net/ipn/af_ipn.c:1479:
+	ipn_node_cache=kmem_cache_create("ipn_node",sizeof(struct ipn_node),0,0,NULL);
 	                                                                       ^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_crit([subsystem]dev, ... then dev_crit(dev, ... then pr_crit(...  to printk(KERN_CRIT ...
#2268: FILE: net/ipn/af_ipn.c:1481:
+		printk(KERN_CRIT "%s: Cannot create ipn_node SLAB cache!\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2269: FILE: net/ipn/af_ipn.c:1482:
+		printk(KERN_CRIT "%s: Cannot create ipn_node SLAB cache!\n",
+				__FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#2269: FILE: net/ipn/af_ipn.c:1482:
+				__FUNCTION__);

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2270: FILE: net/ipn/af_ipn.c:1483:
+		rc=-ENOMEM;
 		  ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2270: FILE: net/ipn/af_ipn.c:1483:
+		rc=-ENOMEM;
 		   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2274: FILE: net/ipn/af_ipn.c:1487:
+	ipn_msgitem_cache=kmem_cache_create("ipn_msgitem",sizeof(struct msgitem),0,0,NULL);
 	                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2274: FILE: net/ipn/af_ipn.c:1487:
+	ipn_msgitem_cache=kmem_cache_create("ipn_msgitem",sizeof(struct msgitem),0,0,NULL);
 	                                                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2274: FILE: net/ipn/af_ipn.c:1487:
+	ipn_msgitem_cache=kmem_cache_create("ipn_msgitem",sizeof(struct msgitem),0,0,NULL);
 	                                                                        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2274: FILE: net/ipn/af_ipn.c:1487:
+	ipn_msgitem_cache=kmem_cache_create("ipn_msgitem",sizeof(struct msgitem),0,0,NULL);
 	                                                                          ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2274: FILE: net/ipn/af_ipn.c:1487:
+	ipn_msgitem_cache=kmem_cache_create("ipn_msgitem",sizeof(struct msgitem),0,0,NULL);
 	                                                                            ^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_crit([subsystem]dev, ... then dev_crit(dev, ... then pr_crit(...  to printk(KERN_CRIT ...
#2276: FILE: net/ipn/af_ipn.c:1489:
+		printk(KERN_CRIT "%s: Cannot create ipn_msgitem SLAB cache!\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2277: FILE: net/ipn/af_ipn.c:1490:
+		printk(KERN_CRIT "%s: Cannot create ipn_msgitem SLAB cache!\n",
+				__FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#2277: FILE: net/ipn/af_ipn.c:1490:
+				__FUNCTION__);

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2278: FILE: net/ipn/af_ipn.c:1491:
+		rc=-ENOMEM;
 		  ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2278: FILE: net/ipn/af_ipn.c:1491:
+		rc=-ENOMEM;
 		   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2282: FILE: net/ipn/af_ipn.c:1495:
+	rc=proto_register(&ipn_proto,1);
 	  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2282: FILE: net/ipn/af_ipn.c:1495:
+	rc=proto_register(&ipn_proto,1);
 	                            ^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_crit([subsystem]dev, ... then dev_crit(dev, ... then pr_crit(...  to printk(KERN_CRIT ...
#2284: FILE: net/ipn/af_ipn.c:1497:
+		printk(KERN_CRIT "%s: Cannot register the protocol!\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2285: FILE: net/ipn/af_ipn.c:1498:
+		printk(KERN_CRIT "%s: Cannot register the protocol!\n",
+				__FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#2285: FILE: net/ipn/af_ipn.c:1498:
+				__FUNCTION__);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#2291: FILE: net/ipn/af_ipn.c:1504:
+	printk(KERN_INFO "IPN: Virtual Square Project, University of Bologna 2007\n");

WARNING:NEEDLESS_IF: kmem_cache_destroy(NULL) is safe and this check is probably not required
#2309: FILE: net/ipn/af_ipn.c:1522:
+	if (ipn_msgitem_cache)
+		kmem_cache_destroy(ipn_msgitem_cache);

WARNING:NEEDLESS_IF: kmem_cache_destroy(NULL) is safe and this check is probably not required
#2311: FILE: net/ipn/af_ipn.c:1524:
+	if (ipn_node_cache)
+		kmem_cache_destroy(ipn_node_cache);

WARNING:NEEDLESS_IF: kmem_cache_destroy(NULL) is safe and this check is probably not required
#2313: FILE: net/ipn/af_ipn.c:1526:
+	if (ipn_network_cache)
+		kmem_cache_destroy(ipn_network_cache);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#2316: FILE: net/ipn/af_ipn.c:1529:
+	printk(KERN_INFO "IPN removed\n");

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#2322: FILE: net/ipn/af_ipn.c:1535:
+EXPORT_SYMBOL_GPL(ipn_proto_register);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#2323: FILE: net/ipn/af_ipn.c:1536:
+EXPORT_SYMBOL_GPL(ipn_proto_deregister);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#2324: FILE: net/ipn/af_ipn.c:1537:
+EXPORT_SYMBOL_GPL(ipn_proto_sendmsg);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#2325: FILE: net/ipn/af_ipn.c:1538:
+EXPORT_SYMBOL_GPL(ipn_proto_oobsendmsg);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#2326: FILE: net/ipn/af_ipn.c:1539:
+EXPORT_SYMBOL_GPL(ipn_msgpool_alloc);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#2327: FILE: net/ipn/af_ipn.c:1540:
+EXPORT_SYMBOL_GPL(ipn_msgpool_put);

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#2332: FILE: net/ipn/ipn_netdev.c:1:
+/*

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2335: FILE: net/ipn/ipn_netdev.c:4:
+ *  (part of the View-OS project: wiki.virtualsquare.org) $

WARNING:TABSTOP: Statements should start on a tabstop
#2379: FILE: net/ipn/ipn_netdev.c:48:
+		  return 0;

WARNING:TABSTOP: Statements should start on a tabstop
#2386: FILE: net/ipn/ipn_netdev.c:55:
+		  return 0;

WARNING:LINE_SPACING: Missing a blank line after declarations
#2392: FILE: net/ipn/ipn_netdev.c:61:
+	struct ipntap *ipntap = netdev_priv(dev);
+	return &ipntap->stats;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2399: FILE: net/ipn/ipn_netdev.c:68:
+	struct ipn_node *ipn_node=ipntap->ipn_node;
 	                         ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2401: FILE: net/ipn/ipn_netdev.c:70:
+	struct msgpool_item *newmsg;
+	if (!ipn_node || !ipn_node->ipn || skb->len > ipn_node->ipn->mtu)

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2403: FILE: net/ipn/ipn_netdev.c:72:
+	newmsg=ipn_msgpool_alloc(ipn_node->ipn);
 	      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2406: FILE: net/ipn/ipn_netdev.c:75:
+	newmsg->len=skb->len;
 	           ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2407: FILE: net/ipn/ipn_netdev.c:76:
+	memcpy(newmsg->data,skb->data,skb->len);
 	                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2407: FILE: net/ipn/ipn_netdev.c:76:
+	memcpy(newmsg->data,skb->data,skb->len);
 	                             ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2408: FILE: net/ipn/ipn_netdev.c:77:
+	ipn_proto_injectmsg(ipntap->ipn_node,newmsg);
 	                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2409: FILE: net/ipn/ipn_netdev.c:78:
+	ipn_msgpool_put(newmsg,ipn_node->ipn);
 	                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2424: FILE: net/ipn/ipn_netdev.c:93:
+	char *data=(skb->data)-(skb->mac_len);
 	          ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#2424: FILE: net/ipn/ipn_netdev.c:93:
+	char *data=(skb->data)-(skb->mac_len);
 	                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2425: FILE: net/ipn/ipn_netdev.c:94:
+	int len=skb->len+skb->mac_len;
 	       ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#2425: FILE: net/ipn/ipn_netdev.c:94:
+	int len=skb->len+skb->mac_len;
 	                ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2427: FILE: net/ipn/ipn_netdev.c:96:
+^Iif (ipn_node && $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#2428: FILE: net/ipn/ipn_netdev.c:97:
+	if (ipn_node && 
+			((ipn_node->flags & IPN_NODEFLAG_DEVMASK) == IPN_NODEFLAG_GRAB) &&

ERROR:SPACING: spaces required around that '<=' (ctx:VxV)
#2429: FILE: net/ipn/ipn_netdev.c:98:
+			ipn_node->ipn && len<=ipn_node->ipn->mtu) {
 			                    ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2431: FILE: net/ipn/ipn_netdev.c:100:
+		struct msgpool_item *newmsg;
+		newmsg=ipn_msgpool_alloc(ipn_node->ipn);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2431: FILE: net/ipn/ipn_netdev.c:100:
+		newmsg=ipn_msgpool_alloc(ipn_node->ipn);
 		      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2433: FILE: net/ipn/ipn_netdev.c:102:
+			newmsg->len=len;
 			           ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2434: FILE: net/ipn/ipn_netdev.c:103:
+			memcpy(newmsg->data,data,len);
 			                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2434: FILE: net/ipn/ipn_netdev.c:103:
+			memcpy(newmsg->data,data,len);
 			                        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2435: FILE: net/ipn/ipn_netdev.c:104:
+			ipn_proto_injectmsg(ipn_node,newmsg);
 			                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2436: FILE: net/ipn/ipn_netdev.c:105:
+			ipn_msgpool_put(newmsg,ipn_node->ipn);
 			                      ^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#2452: FILE: net/ipn/ipn_netdev.c:121:
+
+

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2453: FILE: net/ipn/ipn_netdev.c:122:
+struct net_device *ipn_netdev_alloc(struct net *net,int type, char *name, int *err)
                                                    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2455: FILE: net/ipn/ipn_netdev.c:124:
+	struct net_device *dev=NULL;
 	                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2456: FILE: net/ipn/ipn_netdev.c:125:
+	*err=0;
 	    ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2457: FILE: net/ipn/ipn_netdev.c:126:
+^Iif (!name || *name==0) $

ERROR:SPACING: spaces required around that '==' (ctx:VxV)
#2457: FILE: net/ipn/ipn_netdev.c:126:
+	if (!name || *name==0) 
 	                  ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2458: FILE: net/ipn/ipn_netdev.c:127:
+		name="ipn%d";
 		    ^

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#2459: FILE: net/ipn/ipn_netdev.c:128:
+	switch (type) {
+		case IPN_NODEFLAG_TAP:
[...]
+		case IPN_NODEFLAG_GRAB:

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2461: FILE: net/ipn/ipn_netdev.c:130:
+			dev=alloc_netdev(sizeof(struct ipntap), name, ipntap_setup);
 			   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#2463: FILE: net/ipn/ipn_netdev.c:132:
+				*err= -ENOMEM;
 				    ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2466: FILE: net/ipn/ipn_netdev.c:135:
+^I^I^I * why tuntap does not use the random_ether_addr? $

WARNING:BLOCK_COMMENT_STYLE: Block comments should align the * on each line
#2467: FILE: net/ipn/ipn_netdev.c:136:
+			 * why tuntap does not use the random_ether_addr? 
+			*(u16 *)dev->dev_addr = htons(0x00FF);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2468: FILE: net/ipn/ipn_netdev.c:137:
+			get_random_bytes(dev->dev_addr + sizeof(u16), 4);*/

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2472: FILE: net/ipn/ipn_netdev.c:141:
+			dev=dev_get_by_name(net,name);
 			   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2472: FILE: net/ipn/ipn_netdev.c:141:
+			dev=dev_get_by_name(net,name);
 			                       ^

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#2475: FILE: net/ipn/ipn_netdev.c:144:
+					*err= -EINVAL;
 					    ^

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "rcu_dereference"
#2476: FILE: net/ipn/ipn_netdev.c:145:
+				else if (rcu_dereference(dev->ipn_port) != NULL)

ERROR:SPACING: spaces required around that '=' (ctx:VxW)
#2477: FILE: net/ipn/ipn_netdev.c:146:
+					*err= -EBUSY;
 					    ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2479: FILE: net/ipn/ipn_netdev.c:148:
+					dev=NULL;
 					   ^

ERROR:SPACING: spaces required around that '=' (ctx:VxO)
#2488: FILE: net/ipn/ipn_netdev.c:157:
+	int rv=-EINVAL;
 	      ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2488: FILE: net/ipn/ipn_netdev.c:157:
+	int rv=-EINVAL;
 	       ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2489: FILE: net/ipn/ipn_netdev.c:158:
+	int rv=-EINVAL;
+	switch (ipn_node->flags & IPN_NODEFLAG_DEVMASK) {

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#2489: FILE: net/ipn/ipn_netdev.c:158:
+	switch (ipn_node->flags & IPN_NODEFLAG_DEVMASK) {
+		case IPN_NODEFLAG_TAP:
[...]
+		case IPN_NODEFLAG_GRAB:

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2492: FILE: net/ipn/ipn_netdev.c:161:
+				struct ipntap *ipntap=netdev_priv(ipn_node->dev);
 				                     ^

WARNING:LINE_SPACING: Missing a blank line after declarations
#2493: FILE: net/ipn/ipn_netdev.c:162:
+				struct ipntap *ipntap=netdev_priv(ipn_node->dev);
+				ipntap->ipn_node=ipn_node;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2493: FILE: net/ipn/ipn_netdev.c:162:
+				ipntap->ipn_node=ipn_node;
 				                ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2494: FILE: net/ipn/ipn_netdev.c:163:
+^I^I^I^Irtnl_lock(); $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2495: FILE: net/ipn/ipn_netdev.c:164:
+				if ((rv=register_netdevice(ipn_node->dev)) == 0)
 				       ^

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#2495: FILE: net/ipn/ipn_netdev.c:164:
+				if ((rv=register_netdevice(ipn_node->dev)) == 0)

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2505: FILE: net/ipn/ipn_netdev.c:174:
+^I^I^Irtnl_lock(); $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2507: FILE: net/ipn/ipn_netdev.c:176:
+			dev_set_promiscuity(ipn_node->dev,1);
 			                                 ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2509: FILE: net/ipn/ipn_netdev.c:178:
+			rv=0;
 			  ^

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#2517: FILE: net/ipn/ipn_netdev.c:186:
+	switch (ipn_node->flags & IPN_NODEFLAG_DEVMASK) {
+		case IPN_NODEFLAG_TAP:
[...]
+		case IPN_NODEFLAG_GRAB:

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2520: FILE: net/ipn/ipn_netdev.c:189:
+^I^I^Irtnl_lock(); $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2527: FILE: net/ipn/ipn_netdev.c:196:
+^I^I^Irtnl_lock(); $

ERROR:SPACING: space required after that ',' (ctx:VxO)
#2529: FILE: net/ipn/ipn_netdev.c:198:
+			dev_set_promiscuity(ipn_node->dev,-1);
 			                                 ^

ERROR:SPACING: space required before that '-' (ctx:OxV)
#2529: FILE: net/ipn/ipn_netdev.c:198:
+			dev_set_promiscuity(ipn_node->dev,-1);
 			                                  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2535: FILE: net/ipn/ipn_netdev.c:204:
+void ipn_netdev_sendmsg(struct ipn_node *to,struct msgpool_item *msg)
                                            ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2538: FILE: net/ipn/ipn_netdev.c:207:
+	struct net_device *dev=to->dev;
 	                      ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2539: FILE: net/ipn/ipn_netdev.c:208:
+	struct ipntap *ipntap=netdev_priv(dev);
 	                     ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2540: FILE: net/ipn/ipn_netdev.c:209:
+^I$

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2543: FILE: net/ipn/ipn_netdev.c:212:
+	skb=alloc_skb(msg->len+NET_IP_ALIGN,GFP_KERNEL);
 	   ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#2543: FILE: net/ipn/ipn_netdev.c:212:
+	skb=alloc_skb(msg->len+NET_IP_ALIGN,GFP_KERNEL);
 	                      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2543: FILE: net/ipn/ipn_netdev.c:212:
+	skb=alloc_skb(msg->len+NET_IP_ALIGN,GFP_KERNEL);
 	                                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2548: FILE: net/ipn/ipn_netdev.c:217:
+	memcpy(skb_put(skb,msg->len),msg->data,msg->len);
 	                  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2548: FILE: net/ipn/ipn_netdev.c:217:
+	memcpy(skb_put(skb,msg->len),msg->data,msg->len);
 	                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2548: FILE: net/ipn/ipn_netdev.c:217:
+	memcpy(skb_put(skb,msg->len),msg->data,msg->len);
 	                                      ^

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#2549: FILE: net/ipn/ipn_netdev.c:218:
+	switch (to->flags & IPN_NODEFLAG_DEVMASK) {
+		case IPN_NODEFLAG_TAP:
[...]
+		case IPN_NODEFLAG_GRAB:

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#2591: FILE: net/ipn/ipn_netdev.c:260:
+	/* not implemented (yet?)
+	.get_msglevel = ipn_get_msglevel,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#2595: FILE: net/ipn/ipn_netdev.c:264:
+	.set_rx_csum  = ipn_set_rx_csum */

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2600: FILE: net/ipn/ipn_netdev.c:269:
+	ipn_handle_frame_hook=ipn_handle_hook;
 	                     ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#2606: FILE: net/ipn/ipn_netdev.c:275:
+	ipn_handle_frame_hook=NULL;
 	                     ^

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#2612: FILE: net/ipn/ipn_netdev.h:1:
+#ifndef _IPN_NETDEV_H

WARNING:NETWORKING_BLOCK_COMMENT_STYLE: networking block comments don't use an empty /* line, use /* Comment...
#2615: FILE: net/ipn/ipn_netdev.h:4:
+/*
+ * Inter process networking (virtual distributed ethernet) module

ERROR:TRAILING_WHITESPACE: trailing whitespace
#2617: FILE: net/ipn/ipn_netdev.h:6:
+ *  (part of the View-OS project: wiki.virtualsquare.org) $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2647: FILE: net/ipn/ipn_netdev.h:36:
+struct net_device *ipn_netdev_alloc(struct net *net,int type, char *name, int *err);
                                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#2650: FILE: net/ipn/ipn_netdev.h:39:
+void ipn_netdev_sendmsg(struct ipn_node *to,struct msgpool_item *msg);
                                            ^

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000346349.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 600 errors, 199 warnings, 148 checks, 2562 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000346349.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
