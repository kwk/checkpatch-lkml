WARNING:COMMIT_LOG_LONG_LINE: Possible unwrapped commit description (prefer a maximum 75 chars per line)
#45: 
I think reserving LSM hooks for other security modules (e.g. SELinux, SMACK)

WARNING:EMBEDDED_FILENAME: It's generally not useful to have the filename in the file
#256: FILE: fs/Kconfig:2199:
+source "fs/Kconfig.ccs"

Embedding the complete filename path inside the file isn't particularly
useful as often the path is moved around and becomes incorrect.

WARNING:EMBEDDED_FILENAME: It's generally not useful to have the filename in the file
#266: FILE: fs/Makefile:125:
+include $(srctree)/fs/Makefile-2.6.ccs

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#363: FILE: fs/exec.c:127:
+	error = ccs_check_open_permission(nd.path.dentry, nd.path.mnt, 01);
 	                                  ^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#363: FILE: fs/exec.c:127:
+	error = ccs_check_open_permission(nd.path.dentry, nd.path.mnt, 01);
 	                                                  ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#378: FILE: fs/exec.c:681:
+				err = ccs_check_open_permission(nd.path.dentry,
 				                                ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#379: FILE: fs/exec.c:682:
+								nd.path.mnt,
 								^^

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#412: FILE: fs/fcntl.c:225:
+	    ccs_check_rewrite_permission(filp))
 	                                 ^^^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#460: FILE: fs/namei.c:1603:
+	if (nd) {
 	    ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#516: FILE: fs/namei.c:2137:
+			error = pre_vfs_mknod(nd.path.dentry->d_inode, dentry,
 			                      ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#523: FILE: fs/namei.c:2144:
+						     dentry, nd.path.mnt);
 						             ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#532: FILE: fs/namei.c:2153:
+			error = pre_vfs_mknod(nd.path.dentry->d_inode, dentry,
 			                      ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#539: FILE: fs/namei.c:2160:
+						     dentry, nd.path.mnt);
 						             ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#551: FILE: fs/namei.c:2232:
+	error = pre_vfs_mkdir(nd.path.dentry->d_inode, dentry);
 	                      ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#554: FILE: fs/namei.c:2235:
+					     nd.path.mnt);
 					     ^^

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#555: FILE: fs/namei.c:2236:
+	if (!error)
[...]
 	error = vfs_mkdir(nd.path.dentry->d_inode, dentry, mode);

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#565: FILE: fs/namei.c:2351:
+	error = pre_vfs_rmdir(nd.path.dentry->d_inode, dentry);
 	                      ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#568: FILE: fs/namei.c:2354:
+					     nd.path.mnt);
 					     ^^

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#569: FILE: fs/namei.c:2355:
+	if (!error)
[...]
 	error = vfs_rmdir(nd.path.dentry->d_inode, dentry);

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#590: FILE: fs/namei.c:2448:
+		error = pre_vfs_unlink(nd.path.dentry->d_inode, dentry);
 		                       ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#593: FILE: fs/namei.c:2451:
+						     nd.path.mnt);
 						     ^^

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (16, 16)
#594: FILE: fs/namei.c:2452:
+		if (!error)
[...]
 		error = vfs_unlink(nd.path.dentry->d_inode, dentry);

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#615: FILE: fs/namei.c:2544:
+	error = pre_vfs_symlink(nd.path.dentry->d_inode, dentry);
 	                        ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#618: FILE: fs/namei.c:2547:
+					     nd.path.mnt);
 					     ^^

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#619: FILE: fs/namei.c:2548:
+	if (!error)
[...]
 	error = vfs_symlink(nd.path.dentry->d_inode, dentry, from, S_IALLUGO);

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#640: FILE: fs/namei.c:2655:
+	error = pre_vfs_link(old_nd.path.dentry, nd.path.dentry->d_inode,
 	                                         ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#645: FILE: fs/namei.c:2660:
+					     nd.path.mnt);
 					     ^^

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#646: FILE: fs/namei.c:2661:
+	if (!error)
[...]
 	error = vfs_link(old_nd.path.dentry, nd.path.dentry->d_inode, new_dentry);

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#662: FILE: fs/namei.c:2901:
+	if (!error)
[...]
 	error = vfs_rename(old_dir->d_inode, old_dentry,

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#722: FILE: fs/namespace.c:1486:
+	if (ccs_may_mount(nd) < 0)
 	                  ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#734: FILE: fs/namespace.c:1605:
+	if (ccs_may_umount(old_nd.path.mnt) < 0 || ccs_may_mount(nd) < 0)
 	                                                         ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#746: FILE: fs/namespace.c:1714:
+	if (ccs_may_mount(nd) < 0)
 	                  ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#812: FILE: fs/open.c:278:
+	error = ccs_check_1path_perm(TYPE_TRUNCATE_ACL, nd.path.dentry,
 	                                                ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#813: FILE: fs/open.c:279:
+				     nd.path.mnt);
 				     ^^

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#814: FILE: fs/open.c:280:
+	if (!error)
[...]
 	error = locks_verify_truncate(inode, NULL, length);

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 8)
#825: FILE: fs/open.c:340:
+	if (!error)
[...]
 	error = locks_verify_truncate(inode, file, length);

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#839: FILE: fs/open.c:574:
+	if (ccs_check_chroot_permission(&nd))
 	                                 ^^

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#873: FILE: fs/proc/proc_misc.c:1054:
+	printk(KERN_INFO "Hook version: 2.6.25-rc8-mm1 2008/04/02\n");

WARNING:LINE_SPACING: Missing a blank line after declarations
#1199: FILE: kernel/sysctl.c:1517:
+	char *buffer = kmalloc(PAGE_SIZE, GFP_KERNEL);
+	if (oldval)

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:LINE_SPACING: Missing a blank line after declarations
#1224: FILE: kernel/sysctl.c:1542:
+			const char *cp = table->procname;
+			error = -ENOMEM;

CHECK:SPACING: No space is necessary after a cast
#1231: FILE: kernel/sysctl.c:1549:
+						*(const unsigned char *) cp;

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#1233: FILE: kernel/sysctl.c:1551:
+						if (pos + 2 >= PAGE_SIZE - 1)

Indentation with 6 or more tabs usually indicate overly indented
code.

It is suggested to refactor excessive indentation of
if/else/for/do/while/switch statements.

See: https://lore.kernel.org/lkml/1328311239.21255.24.camel@joe2Laptop/

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#1238: FILE: kernel/sysctl.c:1556:
+						if (pos + 1 >= PAGE_SIZE - 1)

WARNING:DEEP_INDENTATION: Too many leading tabs - consider code refactoring
#1242: FILE: kernel/sysctl.c:1560:
+						if (pos + 4 >= PAGE_SIZE - 1)

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#1275: FILE: kernel/sysctl.c:1593:
+}
+/***** TOMOYO Linux end. *****/

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (16, 16)
#1287: FILE: kernel/sysctl.c:1614:
+		if (!error)
[...]
 		error = parse_table(name, nlen, oldval, oldlenp, 

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (24, 24)
#1450: FILE: net/ipv4/udp.c:209:
+			if (ccs_may_autobind(rover) == 0)
[...]
 			if (! __udp_lib_lport_inuse(net, rover, udptable))

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1501: FILE: net/socket.c:1373:
+				err = ccs_socket_bind_permission(sock,
+							 (struct sockaddr *)

CHECK:SPACING: No space is necessary after a cast
#1525: FILE: net/socket.c:1476:
+					 (struct sockaddr *) address)) {

CHECK:SPACING: No space is necessary after a cast
#1539: FILE: net/socket.c:1547:
+					    (struct sockaddr *) address,

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1576: FILE: net/unix/af_unix.c:834:
+		err = pre_vfs_mknod(nd.path.dentry->d_inode, dentry, mode);
 		                    ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1579: FILE: net/unix/af_unix.c:837:
+						   nd.path.mnt);
 						   ^^

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (16, 16)
#1580: FILE: net/unix/af_unix.c:838:
+		if (!err)
[...]
 		err = vfs_mknod(nd.path.dentry->d_inode, dentry, mode, 0);

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000299127.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 0 errors, 48 warnings, 5 checks, 1288 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000299127.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
