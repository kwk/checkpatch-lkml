WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#100: FILE: fs/ecryptfs/ecryptfs_kernel.h:211:
+					  * as dentry name */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#102: FILE: fs/ecryptfs/ecryptfs_kernel.h:213:
+					  * metadata */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#104: FILE: fs/ecryptfs/ecryptfs_kernel.h:215:
+					  * dentry name */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#106: FILE: fs/ecryptfs/ecryptfs_kernel.h:217:
+					  * metadata */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#108: FILE: fs/ecryptfs/ecryptfs_kernel.h:219:
+ * ECRYPTFS_MAX_IV_BYTES */

CHECK:OPEN_ENDED_LINE: Lines should not end with a '['
#136: FILE: fs/ecryptfs/ecryptfs_kernel.h:365:
+	unsigned char global_default_fn_cipher_name[

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#175: FILE: fs/ecryptfs/keystore.c:406:
+ecryptfs_find_global_auth_tok_for_sig(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#214: FILE: fs/ecryptfs/keystore.c:445:
+ecryptfs_find_auth_tok_for_sig(

CHECK:BRACES: braces {} should be used on all arms of this statement
#223: FILE: fs/ecryptfs/keystore.c:454:
+	if (ecryptfs_find_global_auth_tok_for_sig(&global_auth_tok,
[...]
+	} else
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:BRACES: Unbalanced braces around else statement
#229: FILE: fs/ecryptfs/keystore.c:460:
+	} else

CHECK:UNCOMMENTED_DEFINITION: struct mutex definition without comment
#248: FILE: fs/ecryptfs/keystore.c:479:
+	struct mutex *tfm_mutex;

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#282: FILE: fs/ecryptfs/keystore.c:513:
+		printk(KERN_ERR "%s: Out of memory whilst trying to kmalloc "

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#282: FILE: fs/ecryptfs/keystore.c:513:
+	if (!s) {
+		printk(KERN_ERR "%s: Out of memory whilst trying to kmalloc "

WARNING:SPLIT_STRING: quoted string split across lines
#283: FILE: fs/ecryptfs/keystore.c:514:
+		printk(KERN_ERR "%s: Out of memory whilst trying to kmalloc "
+		       "[%d] bytes of kernel memory\n", __func__, sizeof(*s));

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#288: FILE: fs/ecryptfs/keystore.c:519:
+	rc = ecryptfs_get_tfm_and_mutex_for_cipher_name(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#292: FILE: fs/ecryptfs/keystore.c:523:
+		printk(KERN_ERR "Internal error whilst attempting to get "

WARNING:SPLIT_STRING: quoted string split across lines
#293: FILE: fs/ecryptfs/keystore.c:524:
+		printk(KERN_ERR "Internal error whilst attempting to get "
+		       "tfm and mutex for cipher name [%s]; rc = [%d]\n",

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#300: FILE: fs/ecryptfs/keystore.c:531:
+	 * and the plaintext filename */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#317: FILE: fs/ecryptfs/keystore.c:548:
+	 *    separator, and then the filename */

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!dest"
#323: FILE: fs/ecryptfs/keystore.c:554:
+	if (dest == NULL) {

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#328: FILE: fs/ecryptfs/keystore.c:559:
+		printk(KERN_WARNING "%s: Require [%d] bytes to write; only "

WARNING:SPLIT_STRING: quoted string split across lines
#329: FILE: fs/ecryptfs/keystore.c:560:
+		printk(KERN_WARNING "%s: Require [%d] bytes to write; only "
+		       "[%d] available\n", __func__, s->max_packet_size,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#337: FILE: fs/ecryptfs/keystore.c:568:
+		printk(KERN_ERR "%s: Out of kernel memory whilst attempting to "

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#337: FILE: fs/ecryptfs/keystore.c:568:
+	if (!s->block_aligned_filename) {
+		printk(KERN_ERR "%s: Out of kernel memory whilst attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#338: FILE: fs/ecryptfs/keystore.c:569:
+		printk(KERN_ERR "%s: Out of kernel memory whilst attempting to "
+		       "kzalloc [%Zd] bytes\n", __func__,

WARNING:PRINTF_Z: %Zd is non-standard C, use %zd
#338: FILE: fs/ecryptfs/keystore.c:569:
+		       "kzalloc [%Zd] bytes\n", __func__,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#351: FILE: fs/ecryptfs/keystore.c:582:
+		printk(KERN_ERR "%s: Error generating tag 70 packet "

WARNING:SPLIT_STRING: quoted string split across lines
#352: FILE: fs/ecryptfs/keystore.c:583:
+		printk(KERN_ERR "%s: Error generating tag 70 packet "
+		       "header; cannot generate packet length; rc = [%d]\n",

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#361: FILE: fs/ecryptfs/keystore.c:592:
+	s->cipher_code = ecryptfs_code_for_cipher_string(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#365: FILE: fs/ecryptfs/keystore.c:596:
+		printk(KERN_WARNING "%s: Unable to generate code for "

WARNING:SPLIT_STRING: quoted string split across lines
#366: FILE: fs/ecryptfs/keystore.c:597:
+		printk(KERN_WARNING "%s: Unable to generate code for "
+		       "cipher [%s] with key bytes [%d]\n", __func__,

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#373: FILE: fs/ecryptfs/keystore.c:604:
+	rc = ecryptfs_find_auth_tok_for_sig(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#377: FILE: fs/ecryptfs/keystore.c:608:
+		printk(KERN_ERR "%s: Error attempting to find auth tok for "

WARNING:SPLIT_STRING: quoted string split across lines
#378: FILE: fs/ecryptfs/keystore.c:609:
+		printk(KERN_ERR "%s: Error attempting to find auth tok for "
+		       "fnek sig [%s]; rc = [%d]\n", __func__,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#383: FILE: fs/ecryptfs/keystore.c:614:
+	 * filename encryption */

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#384: FILE: fs/ecryptfs/keystore.c:615:
+	BUG_ON(s->auth_tok->token_type != ECRYPTFS_PASSWORD);

BUG() or BUG_ON() should be avoided totally.
Use WARN() and WARN_ON() instead, and handle the "impossible"
error condition as gracefully as possible.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#385: FILE: fs/ecryptfs/keystore.c:616:
+	sg_init_one(

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (8, 24)
#392: FILE: fs/ecryptfs/keystore.c:623:
+	if (IS_ERR(s->hash_desc.tfm)) {
+			rc = PTR_ERR(s->hash_desc.tfm);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#394: FILE: fs/ecryptfs/keystore.c:625:
+			printk(KERN_ERR "%s: Error attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#395: FILE: fs/ecryptfs/keystore.c:626:
+			printk(KERN_ERR "%s: Error attempting to "
+			       "allocate hash crypto context; rc = [%d]\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#401: FILE: fs/ecryptfs/keystore.c:632:
+		printk(KERN_ERR

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#406: FILE: fs/ecryptfs/keystore.c:637:
+	rc = crypto_hash_update(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#410: FILE: fs/ecryptfs/keystore.c:641:
+		printk(KERN_ERR

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#417: FILE: fs/ecryptfs/keystore.c:648:
+		printk(KERN_ERR

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#431: FILE: fs/ecryptfs/keystore.c:662:
+				printk(KERN_ERR

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#439: FILE: fs/ecryptfs/keystore.c:670:
+				printk(KERN_ERR

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#446: FILE: fs/ecryptfs/keystore.c:677:
+				printk(KERN_ERR

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#462: FILE: fs/ecryptfs/keystore.c:693:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#463: FILE: fs/ecryptfs/keystore.c:694:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "
+		       "convert filename memory to scatterlist; "

WARNING:SPLIT_STRING: quoted string split across lines
#465: FILE: fs/ecryptfs/keystore.c:696:
+		       "expected rc = 1; got rc = [%d]. "
+		       "block_aligned_filename_size = [%d]\n", __func__, rc,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#472: FILE: fs/ecryptfs/keystore.c:703:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#473: FILE: fs/ecryptfs/keystore.c:704:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "
+		       "convert encrypted filename memory to scatterlist; "

WARNING:SPLIT_STRING: quoted string split across lines
#475: FILE: fs/ecryptfs/keystore.c:706:
+		       "expected rc = 1; got rc = [%d]. "
+		       "block_aligned_filename_size = [%d]\n", __func__, rc,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#482: FILE: fs/ecryptfs/keystore.c:713:
+	 * >= ECRYPTFS_MAX_IV_BYTES. */

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#485: FILE: fs/ecryptfs/keystore.c:716:
+	rc = crypto_blkcipher_setkey(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#490: FILE: fs/ecryptfs/keystore.c:721:
+		printk(KERN_ERR "%s: Error setting key for crypto context; "

WARNING:SPLIT_STRING: quoted string split across lines
#492: FILE: fs/ecryptfs/keystore.c:723:
+		       "rc = [%d]. s->auth_tok->token.password.session_key_"
+		       "encryption_key = [0x%p]; mount_crypt_stat->"

WARNING:MISSING_SPACE: break quoted strings at a space character
#492: FILE: fs/ecryptfs/keystore.c:723:
+		       "rc = [%d]. s->auth_tok->token.password.session_key_"
+		       "encryption_key = [0x%p]; mount_crypt_stat->"

WARNING:SPLIT_STRING: quoted string split across lines
#493: FILE: fs/ecryptfs/keystore.c:724:
+		       "encryption_key = [0x%p]; mount_crypt_stat->"
+		       "global_default_fn_cipher_key_bytes = [%Zd]\n", __func__,

WARNING:PRINTF_Z: %Zd is non-standard C, use %zd
#493: FILE: fs/ecryptfs/keystore.c:724:
+		       "global_default_fn_cipher_key_bytes = [%Zd]\n", __func__,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#502: FILE: fs/ecryptfs/keystore.c:733:
+		printk(KERN_ERR "%s: Error attempting to encrypt filename; "

CHECK:UNCOMMENTED_DEFINITION: struct mutex definition without comment
#529: FILE: fs/ecryptfs/keystore.c:760:
+	struct mutex *tfm_mutex;

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#558: FILE: fs/ecryptfs/keystore.c:789:
+		printk(KERN_ERR "%s: Out of memory whilst trying to kmalloc "

WARNING:SPLIT_STRING: quoted string split across lines
#559: FILE: fs/ecryptfs/keystore.c:790:
+		printk(KERN_ERR "%s: Out of memory whilst trying to kmalloc "
+		       "[%d] bytes of kernel memory\n", __func__, sizeof(*s));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#564: FILE: fs/ecryptfs/keystore.c:795:
+		printk(KERN_WARNING "%s: max_packet_size is [%Zd]; it must be "

WARNING:PRINTF_Z: %Zd is non-standard C, use %zd
#564: FILE: fs/ecryptfs/keystore.c:795:
+		printk(KERN_WARNING "%s: max_packet_size is [%Zd]; it must be "

WARNING:SPLIT_STRING: quoted string split across lines
#565: FILE: fs/ecryptfs/keystore.c:796:
+		printk(KERN_WARNING "%s: max_packet_size is [%Zd]; it must be "
+		       "at least [%d]\n", __func__, max_packet_size,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#577: FILE: fs/ecryptfs/keystore.c:808:
+	 *    separator, and then the filename */

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#579: FILE: fs/ecryptfs/keystore.c:810:
+		printk(KERN_WARNING "%s: Invalid packet tag [0x%.2x]; must be "

WARNING:SPLIT_STRING: quoted string split across lines
#580: FILE: fs/ecryptfs/keystore.c:811:
+		printk(KERN_WARNING "%s: Invalid packet tag [0x%.2x]; must be "
+		       "tag [0x%.2x]\n", __func__,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#589: FILE: fs/ecryptfs/keystore.c:820:
+		printk(KERN_WARNING "%s: Error parsing packet length; "

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#597: FILE: fs/ecryptfs/keystore.c:828:
+		printk(KERN_WARNING "%s: max_packet_size is [%d]; real packet "

WARNING:SPLIT_STRING: quoted string split across lines
#598: FILE: fs/ecryptfs/keystore.c:829:
+		printk(KERN_WARNING "%s: max_packet_size is [%d]; real packet "
+		       "size is [%d]\n", __func__, max_packet_size,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#612: FILE: fs/ecryptfs/keystore.c:843:
+		printk(KERN_WARNING "%s: Cipher code [%d] is invalid\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#620: FILE: fs/ecryptfs/keystore.c:851:
+		printk(KERN_ERR "Internal error whilst attempting to get "

WARNING:SPLIT_STRING: quoted string split across lines
#621: FILE: fs/ecryptfs/keystore.c:852:
+		printk(KERN_ERR "Internal error whilst attempting to get "
+		       "tfm and mutex for cipher name [%s]; rc = [%d]\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#629: FILE: fs/ecryptfs/keystore.c:860:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#630: FILE: fs/ecryptfs/keystore.c:861:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "
+		       "convert encrypted filename memory to scatterlist; "

WARNING:SPLIT_STRING: quoted string split across lines
#632: FILE: fs/ecryptfs/keystore.c:863:
+		       "expected rc = 1; got rc = [%d]. "
+		       "block_aligned_filename_size = [%d]\n", __func__, rc,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#640: FILE: fs/ecryptfs/keystore.c:871:
+		printk(KERN_ERR "%s: Out of memory whilst attempting to "

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#640: FILE: fs/ecryptfs/keystore.c:871:
+	if (!s->decrypted_filename) {
+		printk(KERN_ERR "%s: Out of memory whilst attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#641: FILE: fs/ecryptfs/keystore.c:872:
+		printk(KERN_ERR "%s: Out of memory whilst attempting to "
+		       "kmalloc [%d] bytes\n", __func__,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#649: FILE: fs/ecryptfs/keystore.c:880:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#650: FILE: fs/ecryptfs/keystore.c:881:
+		printk(KERN_ERR "%s: Internal error whilst attempting to "
+		       "convert decrypted filename memory to scatterlist; "

WARNING:SPLIT_STRING: quoted string split across lines
#652: FILE: fs/ecryptfs/keystore.c:883:
+		       "expected rc = 1; got rc = [%d]. "
+		       "block_aligned_filename_size = [%d]\n", __func__, rc,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#659: FILE: fs/ecryptfs/keystore.c:890:
+	 * >= ECRYPTFS_MAX_IV_BYTES. */

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#665: FILE: fs/ecryptfs/keystore.c:896:
+		printk(KERN_ERR "%s: Error attempting to find auth tok for "

WARNING:SPLIT_STRING: quoted string split across lines
#666: FILE: fs/ecryptfs/keystore.c:897:
+		printk(KERN_ERR "%s: Error attempting to find auth tok for "
+		       "fnek sig [%s]; rc = [%d]\n", __func__, s->fnek_sig_hex,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#671: FILE: fs/ecryptfs/keystore.c:902:
+	 * filename encryption */

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#672: FILE: fs/ecryptfs/keystore.c:903:
+	BUG_ON(s->auth_tok->token_type != ECRYPTFS_PASSWORD);

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#673: FILE: fs/ecryptfs/keystore.c:904:
+	rc = crypto_blkcipher_setkey(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#678: FILE: fs/ecryptfs/keystore.c:909:
+		printk(KERN_ERR "%s: Error setting key for crypto context; "

WARNING:SPLIT_STRING: quoted string split across lines
#680: FILE: fs/ecryptfs/keystore.c:911:
+		       "rc = [%d]. s->auth_tok->token.password.session_key_"
+		       "encryption_key = [0x%p]; mount_crypt_stat->"

WARNING:MISSING_SPACE: break quoted strings at a space character
#680: FILE: fs/ecryptfs/keystore.c:911:
+		       "rc = [%d]. s->auth_tok->token.password.session_key_"
+		       "encryption_key = [0x%p]; mount_crypt_stat->"

WARNING:SPLIT_STRING: quoted string split across lines
#681: FILE: fs/ecryptfs/keystore.c:912:
+		       "encryption_key = [0x%p]; mount_crypt_stat->"
+		       "global_default_fn_cipher_key_bytes = [%Zd]\n", __func__,

WARNING:PRINTF_Z: %Zd is non-standard C, use %zd
#681: FILE: fs/ecryptfs/keystore.c:912:
+		       "global_default_fn_cipher_key_bytes = [%Zd]\n", __func__,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#690: FILE: fs/ecryptfs/keystore.c:921:
+		printk(KERN_ERR "%s: Error attempting to decrypt filename; "

CHECK:LOGICAL_CONTINUATIONS: Logical continuations should be on the previous line
#696: FILE: fs/ecryptfs/keystore.c:927:
+	while (s->decrypted_filename[s->i] != '\0'
+	       && s->i < s->block_aligned_filename_size)

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#699: FILE: fs/ecryptfs/keystore.c:930:
+		printk(KERN_WARNING "%s: Invalid tag 70 packet; could not "

WARNING:SPLIT_STRING: quoted string split across lines
#700: FILE: fs/ecryptfs/keystore.c:931:
+		printk(KERN_WARNING "%s: Invalid tag 70 packet; could not "
+		       "find valid separator between random characters and "

WARNING:SPLIT_STRING: quoted string split across lines
#701: FILE: fs/ecryptfs/keystore.c:932:
+		       "find valid separator between random characters and "
+		       "the filename\n", __func__);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#708: FILE: fs/ecryptfs/keystore.c:939:
+		printk(KERN_WARNING "%s: Filename size is [%Zd], which is "

WARNING:PRINTF_Z: %Zd is non-standard C, use %zd
#708: FILE: fs/ecryptfs/keystore.c:939:
+		printk(KERN_WARNING "%s: Filename size is [%Zd], which is "

WARNING:SPLIT_STRING: quoted string split across lines
#709: FILE: fs/ecryptfs/keystore.c:940:
+		printk(KERN_WARNING "%s: Filename size is [%Zd], which is "
+		       "invalid\n", __func__, (*filename_size));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#715: FILE: fs/ecryptfs/keystore.c:946:
+		printk(KERN_ERR "%s: Out of memory whilst attempting to "

WARNING:SPLIT_STRING: quoted string split across lines
#716: FILE: fs/ecryptfs/keystore.c:947:
+		printk(KERN_ERR "%s: Out of memory whilst attempting to "
+		       "kmalloc [%d] bytes\n", __func__,

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#831: FILE: fs/ecryptfs/keystore.c:1845:
+				 ecryptfs_code_for_cipher_string(

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000208310.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 0 errors, 90 warnings, 17 checks, 777 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000208310.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
