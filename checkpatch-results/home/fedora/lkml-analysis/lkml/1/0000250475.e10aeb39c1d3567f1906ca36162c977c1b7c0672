WARNING:COMMIT_LOG_LONG_LINE: Possible unwrapped commit description (prefer a maximum 75 chars per line)
#43: 
based on work from Eric, and add some timeout so don't dead loop when debug device

CHECK:ARCH_INCLUDE_LINUX: Consider using #include <linux/pgtable.h> instead of <asm/pgtable.h>
#91: FILE: arch/x86/kernel/early_printk.c:16:
+#include <asm/pgtable.h>

Whenever asm/file.h is included and linux/file.h exists, a
conversion can be made when linux/file.h includes asm/file.h.
However this is not always the case (See signal.h).
This message type is emitted only for includes from arch/.

CHECK:LINE_SPACING: Please don't use multiple blank lines
#102: FILE: arch/x86/kernel/early_printk.c:163:
 
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#106: FILE: arch/x86/kernel/early_printk.c:167:
+static unsigned dbgp_endpoint_out;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#162: FILE: arch/x86/kernel/early_printk.c:223:
+	unsigned ctrl;

WARNING:LINE_SPACING: Missing a blank line after declarations
#185: FILE: arch/x86/kernel/early_printk.c:246:
+	int i;
+	while (ms--) {

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#196: FILE: arch/x86/kernel/early_printk.c:257:
+static int dbgp_wait_until_done(unsigned ctrl)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#198: FILE: arch/x86/kernel/early_printk.c:259:
+	unsigned pids, lpid;

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around 'lpid == USB_PID_NAK'
#214: FILE: arch/x86/kernel/early_printk.c:275:
+	if ((lpid == USB_PID_NAK) || (lpid == USB_PID_NYET))

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around 'lpid == USB_PID_NYET'
#214: FILE: arch/x86/kernel/early_printk.c:275:
+	if ((lpid == USB_PID_NAK) || (lpid == USB_PID_NYET))

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#229: FILE: arch/x86/kernel/early_printk.c:290:
+	unsigned lo, hi;

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#232: FILE: arch/x86/kernel/early_printk.c:293:
+	lo = hi = 0;

Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#234: FILE: arch/x86/kernel/early_printk.c:295:
+		lo |= bytes[i] << (8*i);
 		                    ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#236: FILE: arch/x86/kernel/early_printk.c:297:
+		hi |= bytes[i] << (8*(i - 4));
 		                    ^

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#244: FILE: arch/x86/kernel/early_printk.c:305:
+	unsigned lo, hi;

WARNING:LINE_SPACING: Missing a blank line after declarations
#246: FILE: arch/x86/kernel/early_printk.c:307:
+	int i;
+	lo = readl(&ehci_debug->data03);

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#249: FILE: arch/x86/kernel/early_printk.c:310:
+		bytes[i] = (lo >> (8*i)) & 0xff;
 		                    ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#251: FILE: arch/x86/kernel/early_printk.c:312:
+		bytes[i] = (hi >> (8*(i - 4))) & 0xff;
 		                    ^

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#254: FILE: arch/x86/kernel/early_printk.c:315:
+static int dbgp_bulk_write(unsigned devnum, unsigned endpoint,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#254: FILE: arch/x86/kernel/early_printk.c:315:
+static int dbgp_bulk_write(unsigned devnum, unsigned endpoint,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#255: FILE: arch/x86/kernel/early_printk.c:316:
+static int dbgp_bulk_write(unsigned devnum, unsigned endpoint,
+			 const char *bytes, int size)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#257: FILE: arch/x86/kernel/early_printk.c:318:
+	unsigned pids, addr, ctrl;

WARNING:LINE_SPACING: Missing a blank line after declarations
#259: FILE: arch/x86/kernel/early_printk.c:320:
+	int ret;
+	if (size > DBGP_MAX_PACKET)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#283: FILE: arch/x86/kernel/early_printk.c:344:
+static int dbgp_bulk_read(unsigned devnum, unsigned endpoint, void *data,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#283: FILE: arch/x86/kernel/early_printk.c:344:
+static int dbgp_bulk_read(unsigned devnum, unsigned endpoint, void *data,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#284: FILE: arch/x86/kernel/early_printk.c:345:
+static int dbgp_bulk_read(unsigned devnum, unsigned endpoint, void *data,
+				 int size)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#286: FILE: arch/x86/kernel/early_printk.c:347:
+	unsigned pids, addr, ctrl;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#313: FILE: arch/x86/kernel/early_printk.c:374:
+static int dbgp_control_msg(unsigned devnum, int requesttype, int request,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#314: FILE: arch/x86/kernel/early_printk.c:375:
+static int dbgp_control_msg(unsigned devnum, int requesttype, int request,
+	int value, int index, void *data, int size)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#316: FILE: arch/x86/kernel/early_printk.c:377:
+	unsigned pids, addr, ctrl;

CHECK:SPACING: spaces required around that ':' (ctx:VxV)
#322: FILE: arch/x86/kernel/early_printk.c:383:
+	if (size > (read ? DBGP_MAX_PACKET:0))
 	                                  ^

CHECK:CAMELCASE: Avoid CamelCase: <bRequestType>
#326: FILE: arch/x86/kernel/early_printk.c:387:
+	req.bRequestType = requesttype;

Avoid CamelCase Identifiers.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#naming

CHECK:CAMELCASE: Avoid CamelCase: <bRequest>
#327: FILE: arch/x86/kernel/early_printk.c:388:
+	req.bRequest = request;

CHECK:CAMELCASE: Avoid CamelCase: <wValue>
#328: FILE: arch/x86/kernel/early_printk.c:389:
+	req.wValue = value;

CHECK:CAMELCASE: Avoid CamelCase: <wIndex>
#329: FILE: arch/x86/kernel/early_printk.c:390:
+	req.wIndex = index;

CHECK:CAMELCASE: Avoid CamelCase: <wLength>
#330: FILE: arch/x86/kernel/early_printk.c:391:
+	req.wLength = size;

CHECK:LINE_SPACING: Please don't use multiple blank lines
#353: FILE: arch/x86/kernel/early_printk.c:414:
+
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#359: FILE: arch/x86/kernel/early_printk.c:420:
+	int bytes;
+	if (!(read_pci_config_16(num, slot, func, PCI_STATUS) & PCI_STATUS_CAP_LIST))

WARNING:LINE_SPACING: Missing a blank line after declarations
#364: FILE: arch/x86/kernel/early_printk.c:425:
+		u8 id;
+		pos &= ~3;

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#365: FILE: arch/x86/kernel/early_printk.c:426:
+		id = read_pci_config_byte(num, slot, func, pos+PCI_CAP_LIST_ID);
 		                                              ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#370: FILE: arch/x86/kernel/early_printk.c:431:
+		pos = read_pci_config_byte(num, slot, func, pos+PCI_CAP_LIST_NEXT);
 		                                               ^

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int *' to bare use of 'unsigned *'
#375: FILE: arch/x86/kernel/early_printk.c:436:
+static __u32 __init find_dbgp(int ehci_num, unsigned *rbus, unsigned *rslot, unsigned *rfunc)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int *' to bare use of 'unsigned *'
#375: FILE: arch/x86/kernel/early_printk.c:436:
+static __u32 __init find_dbgp(int ehci_num, unsigned *rbus, unsigned *rslot, unsigned *rfunc)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int *' to bare use of 'unsigned *'
#375: FILE: arch/x86/kernel/early_printk.c:436:
+static __u32 __init find_dbgp(int ehci_num, unsigned *rbus, unsigned *rslot, unsigned *rfunc)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#377: FILE: arch/x86/kernel/early_printk.c:438:
+	unsigned bus, slot, func;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#383: FILE: arch/x86/kernel/early_printk.c:444:
+				unsigned cap;

WARNING:LINE_SPACING: Missing a blank line after declarations
#384: FILE: arch/x86/kernel/early_printk.c:445:
+				unsigned cap;
+				class = read_pci_config(bus, slot, func, PCI_CLASS_REVISION);

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#404: FILE: arch/x86/kernel/early_printk.c:465:
+	unsigned portsc;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#405: FILE: arch/x86/kernel/early_printk.c:466:
+	unsigned delay_time, delay;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#424: FILE: arch/x86/kernel/early_printk.c:485:
+			writel(portsc & ~(PORT_RWC_BITS | PORT_RESET),
+				&ehci_regs->port_status[port - 1]);

WARNING:TYPO_SPELLING: 'happend' may be misspelled - perhaps 'happened'?
#434: FILE: arch/x86/kernel/early_printk.c:495:
+		/* bomb out completely if something weird happend */
 		                                          ^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#447: FILE: arch/x86/kernel/early_printk.c:508:
+	unsigned status;

CHECK:LINE_SPACING: Please don't use multiple blank lines
#462: FILE: arch/x86/kernel/early_printk.c:523:
+
+

WARNING:AVOID_EXTERNS: externs should be avoided in .c files
#465: FILE: arch/x86/kernel/early_printk.c:526:
+void early_printk(const char *fmt, ...);

Function prototypes don't need to be declared extern in .h
files.  It's assumed by the compiler and is unnecessary.

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#473: FILE: arch/x86/kernel/early_printk.c:534:
+	unsigned cmd, ctrl, status, portsc, hcs_params, debug_port, n_ports;

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#531: FILE: arch/x86/kernel/early_printk.c:592:
+
+	}

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#545: FILE: arch/x86/kernel/early_printk.c:606:
+	unsigned ctrl, devnum;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#546: FILE: arch/x86/kernel/early_printk.c:607:
+	unsigned bus, slot, func, cap;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#547: FILE: arch/x86/kernel/early_printk.c:608:
+	unsigned debug_port, bar, offset;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#548: FILE: arch/x86/kernel/early_printk.c:609:
+	unsigned bar_val;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#551: FILE: arch/x86/kernel/early_printk.c:612:
+	unsigned dbgp_num;

WARNING:CONSIDER_KSTRTO: simple_strtoul is obsolete, use kstrtoul instead
#558: FILE: arch/x86/kernel/early_printk.c:619:
+		dbgp_num = simple_strtoul(s, &e, 10);

The simple_strtol(), simple_strtoll(), simple_strtoul(), and
simple_strtoull() functions explicitly ignore overflows, which
may lead to unexpected results in callers.  The respective kstrtol(),
kstrtoll(), kstrtoul(), and kstrtoull() functions tend to be the
correct replacements.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#simple-strtol-simple-strtoll-simple-strtoul-simple-strtoull

CHECK:LINE_SPACING: Please don't use multiple blank lines
#583: FILE: arch/x86/kernel/early_printk.c:644:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#607: FILE: arch/x86/kernel/early_printk.c:668:
+		ret = dbgp_control_msg(devnum,
+			USB_DIR_IN | USB_TYPE_STANDARD | USB_RECIP_DEVICE,

CHECK:CAMELCASE: Avoid CamelCase: <bDebugOutEndpoint>
#621: FILE: arch/x86/kernel/early_printk.c:682:
+	dbgp_endpoint_out = dbgp_desc.bDebugOutEndpoint;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#626: FILE: arch/x86/kernel/early_printk.c:687:
+		ret = dbgp_control_msg(devnum,
+			USB_DIR_OUT | USB_TYPE_STANDARD | USB_RECIP_DEVICE,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#630: FILE: arch/x86/kernel/early_printk.c:691:
+			dbgp_printk("Could not move attached device to %d\n",
+				USB_DEBUG_DEVNUM);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#638: FILE: arch/x86/kernel/early_printk.c:699:
+	ret = dbgp_control_msg(USB_DEBUG_DEVNUM,
+		USB_DIR_OUT | USB_TYPE_STANDARD | USB_RECIP_DEVICE,

CHECK:LINE_SPACING: Please don't use multiple blank lines
#653: FILE: arch/x86/kernel/early_printk.c:714:
+
+

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#665: FILE: arch/x86/kernel/early_printk.c:726:
+static void early_dbgp_write(struct console *con, const char *str, unsigned n)

WARNING:LINE_SPACING: Missing a blank line after declarations
#668: FILE: arch/x86/kernel/early_printk.c:729:
+	int chunk, ret;
+	if (!ehci_debug)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#675: FILE: arch/x86/kernel/early_printk.c:736:
+		ret = dbgp_bulk_write(USB_DEBUG_DEVNUM,
+			dbgp_endpoint_out, str, chunk);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "strstr"
#710: FILE: arch/x86/kernel/early_printk.c:818:
+	keep_early = (strstr(buf, "keep") != NULL);

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#719: FILE: arch/x86/kernel/early_printk.c:837:
+		if (early_dbgp_init(buf+4) < 0)
 		                       ^

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000250475.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 0 errors, 40 warnings, 34 checks, 773 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000250475.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
