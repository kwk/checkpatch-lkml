CHECK:LOGICAL_CONTINUATIONS: Logical continuations should be on the previous line
#107: FILE: fs/ecryptfs/crypto.c:253:
+		if (auth_tok->global_auth_tok_key
+		    && !(auth_tok->flags & ECRYPTFS_AUTH_TOK_INVALID))

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#119: FILE: fs/ecryptfs/crypto.c:957:
+static int ecryptfs_copy_mount_wide_sigs_to_inode_sigs(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#132: FILE: fs/ecryptfs/crypto.c:970:
+			printk(KERN_ERR "Error adding keysig; rc = [%d]\n", rc);

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#133: FILE: fs/ecryptfs/crypto.c:971:
+			mutex_unlock(

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#187: FILE: fs/ecryptfs/crypto.c:1033:
+	BUG_ON(mount_crypt_stat->num_global_auth_toks == 0);

BUG() or BUG_ON() should be avoided totally.
Use WARN() and WARN_ON() instead, and handle the "impossible"
error condition as gracefully as possible.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#bug-and-bug-on

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#196: FILE: fs/ecryptfs/crypto.c:1042:
+		printk(KERN_ERR "Error attempting to copy mount-wide key sigs "

WARNING:SPLIT_STRING: quoted string split across lines
#197: FILE: fs/ecryptfs/crypto.c:1043:
+		printk(KERN_ERR "Error attempting to copy mount-wide key sigs "
+		       "to the inode key sigs; rc = [%d]\n", rc);

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

CHECK:UNCOMMENTED_DEFINITION: struct mutex definition without comment
#245: FILE: fs/ecryptfs/crypto.c:1880:
+struct mutex key_tfm_list_mutex;

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "key_tfm"
#278: FILE: fs/ecryptfs/crypto.c:1913:
+	if (key_tfm != NULL)

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#282: FILE: fs/ecryptfs/crypto.c:1917:
+		printk(KERN_ERR "Error attempting to allocate from "

WARNING:SPLIT_STRING: quoted string split across lines
#283: FILE: fs/ecryptfs/crypto.c:1918:
+		printk(KERN_ERR "Error attempting to allocate from "
+		       "ecryptfs_key_tfm_cache\n");

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#290: FILE: fs/ecryptfs/crypto.c:1925:
+	if ((rc = ecryptfs_process_key_cipher(&tmp_tfm->key_tfm,

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#293: FILE: fs/ecryptfs/crypto.c:1928:
+		printk(KERN_ERR "Error attempting to initialize key TFM "

WARNING:SPLIT_STRING: quoted string split across lines
#294: FILE: fs/ecryptfs/crypto.c:1929:
+		printk(KERN_ERR "Error attempting to initialize key TFM "
+		       "cipher with name = [%s]; rc = [%d]\n",

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "key_tfm"
#297: FILE: fs/ecryptfs/crypto.c:1932:
+		if (key_tfm != NULL)

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#327: FILE: fs/ecryptfs/crypto.c:1962:
+	if ((rc = ecryptfs_add_new_key_tfm(&key_tfm, cipher_name, 0))) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#328: FILE: fs/ecryptfs/crypto.c:1963:
+		printk(KERN_ERR "Error adding new key_tfm to list; rc = [%d]\n",

CHECK:UNCOMMENTED_DEFINITION: struct mutex definition without comment
#405: FILE: fs/ecryptfs/ecryptfs_kernel.h:256:
+	struct mutex keysig_list_mutex;

CHECK:UNCOMMENTED_DEFINITION: struct mutex definition without comment
#425: FILE: fs/ecryptfs/ecryptfs_kernel.h:288:
+	struct mutex key_tfm_mutex;

CHECK:UNCOMMENTED_DEFINITION: struct mutex definition without comment
#445: FILE: fs/ecryptfs/ecryptfs_kernel.h:310:
+	struct mutex global_auth_tok_list_mutex;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#485: FILE: fs/ecryptfs/ecryptfs_kernel.h:615:
+ecryptfs_add_global_auth_tok(struct ecryptfs_mount_crypt_stat *mount_crypt_stat,
+			   char *sig);

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#486: FILE: fs/ecryptfs/ecryptfs_kernel.h:616:
+int ecryptfs_get_global_auth_tok_for_sig(

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#529: FILE: fs/ecryptfs/keystore.c:417:
+	if ((rc = ecryptfs_get_auth_tok_sig(&auth_tok_sig, auth_tok))) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#530: FILE: fs/ecryptfs/keystore.c:418:
+		printk(KERN_ERR "Unrecognized auth tok type: [%d]\n",

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around auth_tok->session_key
#534: FILE: fs/ecryptfs/keystore.c:422:
+	rc = write_tag_64_packet(auth_tok_sig, &(auth_tok->session_key),

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#543: FILE: fs/ecryptfs/keystore.c:929:
+ecryptfs_find_global_auth_tok_for_sig(

WARNING:SPLIT_STRING: quoted string split across lines
#583: FILE: fs/ecryptfs/keystore.c:968:
+		ecryptfs_printk(KERN_ERR, "Major version number mismatch. "
+				"Expected [%d]; got [%d]\n",

WARNING:SPLIT_STRING: quoted string split across lines
#590: FILE: fs/ecryptfs/keystore.c:975:
+		ecryptfs_printk(KERN_ERR, "Minor version number mismatch. "
+				"Expected [%d]; got [%d]\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#607: FILE: fs/ecryptfs/keystore.c:992:
+		printk(KERN_ERR "Could not find key with description: [%s]\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#615: FILE: fs/ecryptfs/keystore.c:1000:
+		printk(KERN_ERR

WARNING:SPLIT_STRING: quoted string split across lines
#617: FILE: fs/ecryptfs/keystore.c:1002:
+		       "Data structure version mismatch. "
+		       "Userspace tools must match eCryptfs "

WARNING:SPLIT_STRING: quoted string split across lines
#618: FILE: fs/ecryptfs/keystore.c:1003:
+		       "Userspace tools must match eCryptfs "
+		       "kernel module with major version [%d] "

WARNING:SPLIT_STRING: quoted string split across lines
#619: FILE: fs/ecryptfs/keystore.c:1004:
+		       "kernel module with major version [%d] "
+		       "and minor version [%d]\n",

CHECK:LOGICAL_CONTINUATIONS: Logical continuations should be on the previous line
#626: FILE: fs/ecryptfs/keystore.c:1011:
+	if ((*auth_tok)->token_type != ECRYPTFS_PASSWORD
+	    && (*auth_tok)->token_type != ECRYPTFS_PRIVATE_KEY) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#627: FILE: fs/ecryptfs/keystore.c:1012:
+		printk(KERN_ERR "Invalid auth_tok structure "

WARNING:SPLIT_STRING: quoted string split across lines
#628: FILE: fs/ecryptfs/keystore.c:1013:
+		printk(KERN_ERR "Invalid auth_tok structure "
+		       "returned from key query\n");

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#652: FILE: fs/ecryptfs/keystore.c:1037:
+ecryptfs_find_auth_tok_for_sig(

CHECK:BRACES: braces {} should be used on all arms of this statement
#662: FILE: fs/ecryptfs/keystore.c:1047:
+	if (ecryptfs_find_global_auth_tok_for_sig(&global_auth_tok,
[...]
+	} else
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:BRACES: Unbalanced braces around else statement
#668: FILE: fs/ecryptfs/keystore.c:1053:
+	} else

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#732: FILE: fs/ecryptfs/keystore.c:1077:
+		ecryptfs_printk(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#735: FILE: fs/ecryptfs/keystore.c:1080:
+		ecryptfs_dump_hex(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#742: FILE: fs/ecryptfs/keystore.c:1087:
+		printk(KERN_ERR "Internal error whilst attempting to get "

WARNING:SPLIT_STRING: quoted string split across lines
#743: FILE: fs/ecryptfs/keystore.c:1088:
+		printk(KERN_ERR "Internal error whilst attempting to get "
+		       "tfm and mutex for cipher name [%s]; rc = [%d]\n",

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#753: FILE: fs/ecryptfs/keystore.c:1092:
+	if ((rc = virt_to_scatterlist(auth_tok->session_key.encrypted_key,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#756: FILE: fs/ecryptfs/keystore.c:1095:
+		printk(KERN_ERR "Internal error whilst attempting to convert "

WARNING:SPLIT_STRING: quoted string split across lines
#757: FILE: fs/ecryptfs/keystore.c:1096:
+		printk(KERN_ERR "Internal error whilst attempting to convert "
+			"auth_tok->session_key.encrypted_key to scatterlist; "

WARNING:SPLIT_STRING: quoted string split across lines
#759: FILE: fs/ecryptfs/keystore.c:1098:
+			"expected rc = 1; got rc = [%d]. "
+		       "auth_tok->session_key.encrypted_key_size = [%d]\n", rc,

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#765: FILE: fs/ecryptfs/keystore.c:1104:
+	if ((rc = virt_to_scatterlist(auth_tok->session_key.decrypted_key,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#768: FILE: fs/ecryptfs/keystore.c:1107:
+		printk(KERN_ERR "Internal error whilst attempting to convert "

WARNING:SPLIT_STRING: quoted string split across lines
#769: FILE: fs/ecryptfs/keystore.c:1108:
+		printk(KERN_ERR "Internal error whilst attempting to convert "
+			"auth_tok->session_key.decrypted_key to scatterlist; "

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#774: FILE: fs/ecryptfs/keystore.c:1113:
+	rc = crypto_blkcipher_setkey(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#862: FILE: fs/ecryptfs/keystore.c:1156:
+		printk(KERN_ERR "Cannot get sig for auth_tok of type [%d]\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#909: FILE: fs/ecryptfs/keystore.c:1274:
+		printk(KERN_ERR "The lower file appears to be a non-encrypted "

WARNING:SPLIT_STRING: quoted string split across lines
#910: FILE: fs/ecryptfs/keystore.c:1275:
+		printk(KERN_ERR "The lower file appears to be a non-encrypted "
+		       "eCryptfs file; this is not supported in this version "

WARNING:SPLIT_STRING: quoted string split across lines
#911: FILE: fs/ecryptfs/keystore.c:1276:
+		       "eCryptfs file; this is not supported in this version "
+		       "of the eCryptfs kernel module\n");

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#935: FILE: fs/ecryptfs/keystore.c:1285:
+	 * just one will be sufficient to decrypt to get the FEK. */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#957: FILE: fs/ecryptfs/keystore.c:1295:
+		if ((rc = ecryptfs_get_auth_tok_sig(&candidate_auth_tok_sig,

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#959: FILE: fs/ecryptfs/keystore.c:1297:
+			printk(KERN_ERR

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#965: FILE: fs/ecryptfs/keystore.c:1303:
+		if ((rc = ecryptfs_find_auth_tok_for_sig(

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#965: FILE: fs/ecryptfs/keystore.c:1303:
+		if ((rc = ecryptfs_find_auth_tok_for_sig(

WARNING:SPLIT_STRING: quoted string split across lines
#980: FILE: fs/ecryptfs/keystore.c:1314:
+		ecryptfs_printk(KERN_ERR, "Could not find a usable "
+				"authentication token\n");

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around matching_auth_tok->token.private_key
#990: FILE: fs/ecryptfs/keystore.c:1321:
+		       &(matching_auth_tok->token.private_key),

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around matching_auth_tok->token.password
#999: FILE: fs/ecryptfs/keystore.c:1327:
+		       &(matching_auth_tok->token.password),

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1002: FILE: fs/ecryptfs/keystore.c:1329:
+		rc = decrypt_passphrase_encrypted_session_key(

WARNING:SPLIT_STRING: quoted string split across lines
#1012: FILE: fs/ecryptfs/keystore.c:1336:
+		ecryptfs_printk(KERN_WARNING, "Error decrypting the "
+				"session key for authentication token with sig "

WARNING:SPLIT_STRING: quoted string split across lines
#1013: FILE: fs/ecryptfs/keystore.c:1337:
+				"session key for authentication token with sig "
+				"[%.*s]; rc = [%d]. Removing auth tok "

WARNING:SPLIT_STRING: quoted string split across lines
#1014: FILE: fs/ecryptfs/keystore.c:1338:
+				"[%.*s]; rc = [%d]. Removing auth tok "
+				"candidate from the list and searching for "

WARNING:SPLIT_STRING: quoted string split across lines
#1015: FILE: fs/ecryptfs/keystore.c:1339:
+				"candidate from the list and searching for "
+				"the next match.\n", candidate_auth_tok_sig,

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1023: FILE: fs/ecryptfs/keystore.c:1347:
+				kmem_cache_free(

WARNING:AVOID_BUG: Avoid crashing the kernel - try using WARN_ON & recovery code rather than BUG() or BUG_ON()
#1029: FILE: fs/ecryptfs/keystore.c:1353:
+		BUG();

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1087: FILE: fs/ecryptfs/keystore.c:1463:
+	 * packet tag 1 */

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1095: FILE: fs/ecryptfs/keystore.c:1471:
+		printk(KERN_ERR "Packet length larger than maximum allowable; "

WARNING:SPLIT_STRING: quoted string split across lines
#1097: FILE: fs/ecryptfs/keystore.c:1473:
+		       "need up to [%d] bytes, but there are only [%d] "
+		       "available\n", max_packet_size, (*remaining_bytes));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1164: FILE: fs/ecryptfs/keystore.c:1597:
+		printk(KERN_ERR "Internal error whilst attempting to get "

WARNING:SPLIT_STRING: quoted string split across lines
#1165: FILE: fs/ecryptfs/keystore.c:1598:
+		printk(KERN_ERR "Internal error whilst attempting to get "
+		       "tfm and mutex for cipher name [%s]; rc = [%d]\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#1172: FILE: fs/ecryptfs/keystore.c:1605:
+		printk(KERN_WARNING "No key size specified at mount; "

CHECK:BRACES: Unbalanced braces around else statement
#1188: FILE: fs/ecryptfs/keystore.c:1620:
+	} else

WARNING:SPLIT_STRING: quoted string split across lines
#1199: FILE: fs/ecryptfs/keystore.c:1631:
+				"using auth_tok->session_key.encrypted_key, "
+				"where key_rec->enc_key_size = [%d]\n",

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1216: FILE: fs/ecryptfs/keystore.c:1656:
+	if ((rc = virt_to_scatterlist(crypt_stat->key,

WARNING:SPLIT_STRING: quoted string split across lines
#1221: FILE: fs/ecryptfs/keystore.c:1660:
 		ecryptfs_printk(KERN_ERR, "Error generating scatterlist "
+				"for crypt_stat session key; expected rc = 1; "

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1230: FILE: fs/ecryptfs/keystore.c:1666:
+	if ((rc = virt_to_scatterlist(key_rec->enc_key,

WARNING:SPLIT_STRING: quoted string split across lines
#1235: FILE: fs/ecryptfs/keystore.c:1670:
 		ecryptfs_printk(KERN_ERR, "Error generating scatterlist "
+				"for crypt_stat encrypted session key; "

WARNING:SPLIT_STRING: quoted string split across lines
#1237: FILE: fs/ecryptfs/keystore.c:1672:
+				"expected rc = 1; got rc = [%d]. "
+				"key_rec->enc_key_size = [%d]\n", rc,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1322: FILE: fs/ecryptfs/keystore.c:1705:
+	 * packet tag 3 */

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1333: FILE: fs/ecryptfs/keystore.c:1716:
+		printk(KERN_ERR "Packet too large; need up to [%d] bytes, but "

WARNING:SPLIT_STRING: quoted string split across lines
#1334: FILE: fs/ecryptfs/keystore.c:1717:
+		printk(KERN_ERR "Packet too large; need up to [%d] bytes, but "
+		       "there are only [%d] available\n", max_packet_size,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1347: FILE: fs/ecryptfs/keystore.c:1724:
+	 * to get the number of octets in the actual Tag 3 packet */

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1353: FILE: fs/ecryptfs/keystore.c:1728:
+		printk(KERN_ERR "Error generating tag 3 packet header; cannot "

WARNING:SPLIT_STRING: quoted string split across lines
#1354: FILE: fs/ecryptfs/keystore.c:1729:
+		printk(KERN_ERR "Error generating tag 3 packet header; cannot "
+		       "generate packet length. rc = [%d]\n", rc);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1360: FILE: fs/ecryptfs/keystore.c:1735:
+	 * specified with strings */

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1406: FILE: fs/ecryptfs/keystore.c:1808:
+			printk(KERN_ERR "Error attempting to get the global "

WARNING:SPLIT_STRING: quoted string split across lines
#1407: FILE: fs/ecryptfs/keystore.c:1809:
+			printk(KERN_ERR "Error attempting to get the global "
+			       "auth_tok; rc = [%d]\n", rc);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#1411: FILE: fs/ecryptfs/keystore.c:1813:
+			printk(KERN_WARNING

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1484: FILE: fs/ecryptfs/keystore.c:1882:
+		printk(KERN_ERR

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1509: FILE: fs/ecryptfs/keystore.c:1907:
+		printk(KERN_ERR "Error allocating from "

WARNING:SPLIT_STRING: quoted string split across lines
#1510: FILE: fs/ecryptfs/keystore.c:1908:
+		printk(KERN_ERR "Error allocating from "
+		       "ecryptfs_global_auth_tok_cache\n");

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1539: FILE: fs/ecryptfs/main.c:182:
+static int ecryptfs_init_global_auth_toks(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1566: FILE: fs/ecryptfs/main.c:191:
+		if ((rc = ecryptfs_keyring_auth_tok_for_sig(

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1566: FILE: fs/ecryptfs/main.c:191:
+		if ((rc = ecryptfs_keyring_auth_tok_for_sig(

CHECK:BRACES: braces {} should be used on all arms of this statement
#1566: FILE: fs/ecryptfs/main.c:191:
+		if ((rc = ecryptfs_keyring_auth_tok_for_sig(
[...]
+		} else
[...]

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1570: FILE: fs/ecryptfs/main.c:195:
+			printk(KERN_ERR "Could not find valid key in user "

WARNING:SPLIT_STRING: quoted string split across lines
#1571: FILE: fs/ecryptfs/main.c:196:
+			printk(KERN_ERR "Could not find valid key in user "
+			       "session keyring for sig specified in mount "

WARNING:SPLIT_STRING: quoted string split across lines
#1572: FILE: fs/ecryptfs/main.c:197:
+			       "session keyring for sig specified in mount "
+			       "option: [%s]\n", global_auth_tok->sig);

CHECK:BRACES: Unbalanced braces around else statement
#1575: FILE: fs/ecryptfs/main.c:200:
+		} else

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1582: FILE: fs/ecryptfs/main.c:206:
+static void ecryptfs_init_mount_crypt_stat(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1610: FILE: fs/ecryptfs/main.c:272:
+				printk(KERN_ERR "Error attempting to register "

WARNING:SPLIT_STRING: quoted string split across lines
#1611: FILE: fs/ecryptfs/main.c:273:
+				printk(KERN_ERR "Error attempting to register "
+				       "global sig; rc = [%d]\n", rc);

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1628: FILE: fs/ecryptfs/main.c:362:
+	if ((rc = ecryptfs_add_new_key_tfm(

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1628: FILE: fs/ecryptfs/main.c:362:
+	if ((rc = ecryptfs_add_new_key_tfm(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1631: FILE: fs/ecryptfs/main.c:365:
+		printk(KERN_ERR "Error attempting to initialize cipher with "

WARNING:SPLIT_STRING: quoted string split across lines
#1632: FILE: fs/ecryptfs/main.c:366:
+		printk(KERN_ERR "Error attempting to initialize cipher with "
+		       "name = [%s] and key size = [%d]; rc = [%d]\n",

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1672: FILE: fs/ecryptfs/main.c:372:
+	if ((rc = ecryptfs_init_global_auth_toks(mount_crypt_stat))) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#1673: FILE: fs/ecryptfs/main.c:373:
+		printk(KERN_WARNING "One or more global auth toks could not "

WARNING:SPLIT_STRING: quoted string split across lines
#1674: FILE: fs/ecryptfs/main.c:374:
+		printk(KERN_WARNING "One or more global auth toks could not "
+		       "properly register; rc = [%d]\n", rc);

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000403399.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 total: 12 errors, 70 warnings, 32 checks, 1570 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.JOzjvdpBcb//home/fedora/lkml-analysis/lkml/1/patch.offset.0000403399.commit.e10aeb39c1d3567f1906ca36162c977c1b7c0672 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
