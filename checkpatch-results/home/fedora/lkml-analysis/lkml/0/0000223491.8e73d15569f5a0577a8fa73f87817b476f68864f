WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#59: FILE: drivers/infiniband/hw/mthca/Kconfig:1:
+config INFINIBAND_MTHCA
+	tristate "Mellanox HCA support"
+	depends on PCI && INFINIBAND
+	---help---
+	  This is a low-level driver for Mellanox InfiniHost host
+	  channel adapters (HCAs), including the MT23108 PCI-X HCA
+	  ("Tavor") and the MT25208 PCI Express HCA ("Arbel").
+

Kconfig symbols should have a help text which fully describes
it.

WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#67: FILE: drivers/infiniband/hw/mthca/Kconfig:9:
+config INFINIBAND_MTHCA_DEBUG
+	bool "Verbose debugging output"
+	depends on INFINIBAND_MTHCA
+	default n
+	---help---
+	  This option causes the mthca driver produce a bunch of debug
+	  messages.  Select this is you are developing the driver or
+	  trying to diagnose a problem.
+

WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#76: FILE: drivers/infiniband/hw/mthca/Kconfig:18:
+config INFINIBAND_MTHCA_SSE_DOORBELL
+	bool "SSE doorbell code"
+	depends on INFINIBAND_MTHCA && X86 && !X86_64
+	default n
+	---help---
+	  This option will have the mthca driver use SSE instructions
+	  to ring hardware doorbell registers.  This may improve
+	  performance for some workloads, but the driver will not run
+	  on processors without SSE instructions.
+++ linux-bk/drivers/infiniband/hw/mthca/Makefile	2004-12-13 09:44:43.990244825 -0800
+++ linux-bk/drivers/infiniband/hw/mthca/Makefile	2004-12-13 09:44:43.990244825 -0800

WARNING:DEPRECATED_VARIABLE: Use of EXTRA_CFLAGS is deprecated, please use `ccflags-y instead.
#88: FILE: drivers/infiniband/hw/mthca/Makefile:1:
+EXTRA_CFLAGS += -Idrivers/infiniband/include

EXTRA_{A,C,CPP,LD}FLAGS are deprecated and should be replaced by the new
flags added via commit f77bf01425b1 ("kbuild: introduce ccflags-y,
asflags-y and ldflags-y").

The following conversion scheme maybe used::

  EXTRA_AFLAGS    ->  asflags-y
  EXTRA_CFLAGS    ->  ccflags-y
  EXTRA_CPPFLAGS  ->  cppflags-y
  EXTRA_LDFLAGS   ->  ldflags-y

See:

  1. https://lore.kernel.org/lkml/20070930191054.GA15876@uranus.ravnborg.org/
  2. https://lore.kernel.org/lkml/1313384834-24433-12-git-send-email-lacombar@gmail.com/
  3. https://www.kernel.org/doc/html/latest/kbuild/makefiles.html#compilation-flags

WARNING:DEPRECATED_VARIABLE: Use of EXTRA_CFLAGS is deprecated, please use `ccflags-y instead.
#91: FILE: drivers/infiniband/hw/mthca/Makefile:4:
+EXTRA_CFLAGS += -DDEBUG

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#103: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#123: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:21:
+ * $Id: mthca_allocator.c 1288 2004-11-24 01:12:39Z roland $

Since linux moved to git, the CVS markers are no longer used.
So, CVS style keywords ($Id$, $Revision$, $Log$) should not be
added.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#128: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:26:
+#include <linux/bitmap.h> $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:BRACES: braces {} should be used on all arms of this statement
#144: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:42:
+	if (obj < alloc->max) {
[...]
+	} else
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:BRACES: Unbalanced braces around else statement
#147: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:45:
+	} else

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#179: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:77:
+	alloc->table = kmalloc(BITS_TO_LONGS(num) * sizeof (long),

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:ALLOC_WITH_MULTIPLY: Prefer kmalloc_array over kmalloc with multiply
#179: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:77:
+	alloc->table = kmalloc(BITS_TO_LONGS(num) * sizeof (long),
+			       GFP_KERNEL);

Prefer kmalloc_array/kcalloc over kmalloc/kzalloc with a
sizeof multiply.

See: https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#204: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:102:
+	int p = (index * sizeof (void *)) >> PAGE_SHIFT;

CHECK:BRACES: braces {} should be used on all arms of this statement
#206: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:104:
+	if (array->page_list[p].page) {
[...]
+	} else
[...]

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#207: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:105:
+		int i = index & (PAGE_SIZE / sizeof (void *) - 1);

WARNING:LINE_SPACING: Missing a blank line after declarations
#208: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:106:
+		int i = index & (PAGE_SIZE / sizeof (void *) - 1);
+		return array->page_list[p].page[i];

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:BRACES: Unbalanced braces around else statement
#209: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:107:
+	} else

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#215: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:113:
+	int p = (index * sizeof (void *)) >> PAGE_SHIFT;

CHECK:SPACING: No space is necessary after a cast
#219: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:117:
+		array->page_list[p].page = (void **) get_zeroed_page(GFP_ATOMIC);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#224: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:122:
+	array->page_list[p].page[index & (PAGE_SIZE / sizeof (void *) - 1)] =

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#233: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:131:
+	int p = (index * sizeof (void *)) >> PAGE_SHIFT;

CHECK:SPACING: No space is necessary after a cast
#236: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:134:
+		free_page((unsigned long) array->page_list[p].page);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#247: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:145:
+	int npage = (nent * sizeof (void *) + PAGE_SIZE - 1) / PAGE_SIZE;

WARNING:SIZEOF_PARENTHESIS: sizeof *array->page_list should be sizeof(*array->page_list)
#250: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:148:
+	array->page_list = kmalloc(npage * sizeof *array->page_list, GFP_KERNEL);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#266: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:164:
+	for (i = 0; i < (nent * sizeof (void *) + PAGE_SIZE - 1) / PAGE_SIZE; ++i)

CHECK:SPACING: No space is necessary after a cast
#267: FILE: drivers/infiniband/hw/mthca/mthca_allocator.c:165:
+		free_page((unsigned long) array->page_list[i].page);

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#274: FILE: drivers/infiniband/hw/mthca/mthca_config_reg.h:1:
+/*

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#294: FILE: drivers/infiniband/hw/mthca/mthca_config_reg.h:21:
+ * $Id: mthca_config_reg.h 1288 2004-11-24 01:12:39Z roland $

ERROR:CODE_INDENT: code indent should use tabs where possible
#314: FILE: drivers/infiniband/hw/mthca/mthca_config_reg.h:41:
+^I^I^I        MTHCA_ECR_CLR_SIZE   - \$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

ERROR:CODE_INDENT: code indent should use tabs where possible
#315: FILE: drivers/infiniband/hw/mthca/mthca_config_reg.h:42:
+^I^I^I        MTHCA_HCR_BASE)$

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#321: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:1:
+/*

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#341: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:21:
+ * $Id: mthca_dev.h 1288 2004-11-24 01:12:39Z roland $

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#401: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:81:
+^Istruct semaphore ^I  poll_sem;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#402: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:82:
+^Istruct semaphore ^I  event_sem;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#403: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:83:
+^Iint              ^I  max_cmds;$

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#404: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:84:
+	spinlock_t                context_lock;

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#447: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:127:
+	spinlock_t     lock;

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#480: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:160:
+	spinlock_t         lock;

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#487: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:167:
+	spinlock_t         lock;

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#508: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:188:
+^Iint          ^I hca_type;$

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#554: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:234:
+	spinlock_t            sm_lock;

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'mdev' may be better as '(mdev)' to avoid precedence issues
#557: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:237:
+#define mthca_dbg(mdev, format, arg...) \
+	dev_dbg(&mdev->pdev->dev, format, ## arg)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'mdev' may be better as '(mdev)' to avoid precedence issues
#559: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:239:
+#define mthca_err(mdev, format, arg...) \
+	dev_err(&mdev->pdev->dev, format, ## arg)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'mdev' may be better as '(mdev)' to avoid precedence issues
#561: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:241:
+#define mthca_info(mdev, format, arg...) \
+	dev_info(&mdev->pdev->dev, format, ## arg)

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'mdev' may be better as '(mdev)' to avoid precedence issues
#563: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:243:
+#define mthca_warn(mdev, format, arg...) \
+	dev_warn(&mdev->pdev->dev, format, ## arg)

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#566: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:246:
+extern void __buggy_use_of_MTHCA_GET(void);

Function prototypes don't need to be declared extern in .h
files.  It's assumed by the compiler and is unnecessary.

CHECK:AVOID_EXTERNS: extern prototypes should be avoided in .h files
#567: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:247:
+extern void __buggy_use_of_MTHCA_PUT(void);

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'dest' - possible side-effects?
#569: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:249:
+#define MTHCA_GET(dest, source, offset)                               \
+	do {                                                          \
+		void *__p = (char *) (source) + (offset);             \
+		switch (sizeof (dest)) {                              \
+			case 1: (dest) = *(u8 *) __p;       break;    \
+			case 2: (dest) = be16_to_cpup(__p); break;    \
+			case 4: (dest) = be32_to_cpup(__p); break;    \
+			case 8: (dest) = be64_to_cpup(__p); break;    \
+			default: __buggy_use_of_MTHCA_GET();          \
+		}                                                     \
+	} while (0)

CHECK:SPACING: No space is necessary after a cast
#571: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:251:
+		void *__p = (char *) (source) + (offset);             \

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#572: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:252:
+		switch (sizeof (dest)) {                              \
+			case 1: (dest) = *(u8 *) __p;       break;    \
+			case 2: (dest) = be16_to_cpup(__p); break;    \
+			case 4: (dest) = be32_to_cpup(__p); break;    \
+			case 8: (dest) = be64_to_cpup(__p); break;    \
+			default: __buggy_use_of_MTHCA_GET();          \

switch should be at the same indent as case.
Example::

  switch (suffix) {
  case 'G':
  case 'g':
          mem <<= 30;
          break;
  case 'M':
  case 'm':
          mem <<= 20;
          break;
  case 'K':
  case 'k':
          mem <<= 10;
          fallthrough;
  default:
          break;
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#572: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:252:
+		switch (sizeof (dest)) {                              \

CHECK:SPACING: No space is necessary after a cast
#573: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:253:
+			case 1: (dest) = *(u8 *) __p;       break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#573: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:253:
+			case 1: (dest) = *(u8 *) __p;       break;    \

Trailing statements (for example after any conditional) should be
on the next line.
Statements, such as::

  if (x == y) break;

should be::

  if (x == y)
          break;

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#574: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:254:
+			case 2: (dest) = be16_to_cpup(__p); break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#575: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:255:
+			case 4: (dest) = be32_to_cpup(__p); break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#576: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:256:
+			case 8: (dest) = be64_to_cpup(__p); break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#577: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:257:
+			default: __buggy_use_of_MTHCA_GET();          \

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'source' - possible side-effects?
#581: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:261:
+#define MTHCA_PUT(dest, source, offset)                               \
+	do {                                                          \
+		__typeof__(source) *__p =                             \
+			(__typeof__(source) *) ((char *) (dest) + (offset)); \
+		switch (sizeof(source)) {                             \
+			case 1: *__p = (source);            break;    \
+			case 2: *__p = cpu_to_be16(source); break;    \
+			case 4: *__p = cpu_to_be32(source); break;    \
+			case 8: *__p = cpu_to_be64(source); break;    \
+			default: __buggy_use_of_MTHCA_PUT();          \
+		}                                                     \
+	} while (0)

CHECK:SPACING: No space is necessary after a cast
#584: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:264:
+			(__typeof__(source) *) ((char *) (dest) + (offset)); \

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#585: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:265:
+		switch (sizeof(source)) {                             \
+			case 1: *__p = (source);            break;    \
+			case 2: *__p = cpu_to_be16(source); break;    \
+			case 4: *__p = cpu_to_be32(source); break;    \
+			case 8: *__p = cpu_to_be64(source); break;    \
+			default: __buggy_use_of_MTHCA_PUT();          \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#586: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:266:
+			case 1: *__p = (source);            break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#587: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:267:
+			case 2: *__p = cpu_to_be16(source); break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#588: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:268:
+			case 4: *__p = cpu_to_be32(source); break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#589: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:269:
+			case 8: *__p = cpu_to_be64(source); break;    \

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#590: FILE: drivers/infiniband/hw/mthca/mthca_dev.h:270:
+			default: __buggy_use_of_MTHCA_PUT();          \

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#704: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:1:
+/*

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#724: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:21:
+ * $Id: mthca_doorbell.h 1288 2004-11-24 01:12:39Z roland $

CHECK:SPACING: No space is necessary after a cast
#751: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:48:
+	__raw_writeq(*(u64 *) val, dest);

WARNING:PREFER_DEFINED_ATTRIBUTE_MACRO: Prefer __aligned(8) over __attribute__((aligned(8)))
#780: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:77:
+	u8 xmmsave[8] __attribute__((aligned(8)));

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#785: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:82:
+	asm volatile (

WARNING:QUOTED_WHITESPACE_BEFORE_NEWLINE: unnecessary whitespace before a quoted newline
#786: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:83:
+		"movlps %%xmm0,(%0); \n\t"

WARNING:QUOTED_WHITESPACE_BEFORE_NEWLINE: unnecessary whitespace before a quoted newline
#787: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:84:
+		"movlps (%1),%%xmm0; \n\t"

WARNING:QUOTED_WHITESPACE_BEFORE_NEWLINE: unnecessary whitespace before a quoted newline
#788: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:85:
+		"movlps %%xmm0,(%2); \n\t"

WARNING:QUOTED_WHITESPACE_BEFORE_NEWLINE: unnecessary whitespace before a quoted newline
#789: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:86:
+		"movlps (%0),%%xmm0; \n\t"

ERROR:SPACING: space prohibited before that close parenthesis ')'
#792: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:89:
+		: "memory" );

WARNING:TRAILING_SEMICOLON: macros should not use a trailing semicolon
#800: FILE: drivers/infiniband/hw/mthca/mthca_doorbell.h:97:
+#define MTHCA_DECLARE_DOORBELL_LOCK(name) spinlock_t name;

Macro definition should not end with a semicolon. The macro
invocation style should be consistent with function calls.
This can prevent any unexpected code paths::

  #define MAC do_something;

If this macro is used within a if else statement, like::

  if (some_condition)
          MAC;

  else
          do_something;

Then there would be a compilation error, because when the macro is
expanded there are two trailing semicolons, so the else branch gets
orphaned.

See: https://lore.kernel.org/lkml/1399671106.2912.21.camel@joe-AO725/

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#819: FILE: drivers/infiniband/hw/mthca/mthca_main.c:1:
+/*

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#839: FILE: drivers/infiniband/hw/mthca/mthca_main.c:21:
+ * $Id: mthca_main.c 1288 2004-11-24 01:12:39Z roland $

WARNING:INCLUDE_LINUX: Use #include <linux/cpufeature.h> instead of <asm/cpufeature.h>
#851: FILE: drivers/infiniband/hw/mthca/mthca_main.c:33:
+#include <asm/cpufeature.h>

ERROR:INITIALISED_STATIC: do not initialise statics to 0
#866: FILE: drivers/infiniband/hw/mthca/mthca_main.c:48:
+static int msi_x = 0;

Static variables should not be initialized explicitly to zero.
Your compiler (or rather your loader) automatically does
it for you.

ERROR:INITIALISED_STATIC: do not initialise statics to 0
#870: FILE: drivers/infiniband/hw/mthca/mthca_main.c:52:
+static int msi = 0;

WARNING:HOTPLUG_SECTION: Using __devinitdata is unnecessary
#881: FILE: drivers/infiniband/hw/mthca/mthca_main.c:63:
+static const char mthca_version[] __devinitdata =

ERROR:INIT_ATTRIBUTE: Use of const init definition must use __devinitconst
#881: FILE: drivers/infiniband/hw/mthca/mthca_main.c:63:
+static const char mthca_version[] __devinitdata =

Const init definitions should use __initconst instead of
__initdata.

Similarly init definitions without const require a separate
use of const.

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#885: FILE: drivers/infiniband/hw/mthca/mthca_main.c:67:
+static int __devinit mthca_tune_pci(struct mthca_dev *mdev)

CHECK:BRACES: braces {} should be used on all arms of this statement
#892: FILE: drivers/infiniband/hw/mthca/mthca_main.c:74:
+	if (cap) {
[...]
+	} else if (mdev->hca_type == TAVOR)
[...]

WARNING:SPLIT_STRING: quoted string split across lines
#895: FILE: drivers/infiniband/hw/mthca/mthca_main.c:77:
+			mthca_err(mdev, "Couldn't read PCI-X command register, "
+				  "aborting.\n");

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

WARNING:SPLIT_STRING: quoted string split across lines
#901: FILE: drivers/infiniband/hw/mthca/mthca_main.c:83:
+			mthca_err(mdev, "Couldn't write PCI-X command register, "
+				  "aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#911: FILE: drivers/infiniband/hw/mthca/mthca_main.c:93:
+			mthca_err(mdev, "Couldn't read PCI Express device control "
+				  "register, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#917: FILE: drivers/infiniband/hw/mthca/mthca_main.c:99:
+			mthca_err(mdev, "Couldn't write PCI Express device control "
+				  "register, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#923: FILE: drivers/infiniband/hw/mthca/mthca_main.c:105:
+		mthca_info(mdev, "No PCI Express capability, "
+			   "not setting Max Read Request Size.\n");

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#928: FILE: drivers/infiniband/hw/mthca/mthca_main.c:110:
+static int __devinit mthca_dev_lim(struct mthca_dev *mdev, struct mthca_dev_lim *dev_lim)

WARNING:SPLIT_STRING: quoted string split across lines
#940: FILE: drivers/infiniband/hw/mthca/mthca_main.c:122:
+		mthca_err(mdev, "QUERY_DEV_LIM returned status 0x%02x, "
+			  "aborting.\n", status);

WARNING:SPLIT_STRING: quoted string split across lines
#945: FILE: drivers/infiniband/hw/mthca/mthca_main.c:127:
+		mthca_err(mdev, "HCA minimum page size of %d bigger than "
+			  "kernel PAGE_SIZE of %ld, aborting.\n",

WARNING:SPLIT_STRING: quoted string split across lines
#951: FILE: drivers/infiniband/hw/mthca/mthca_main.c:133:
+		mthca_err(mdev, "HCA has %d ports, but we only support %d, "
+			  "aborting.\n",

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#956: FILE: drivers/infiniband/hw/mthca/mthca_main.c:138:
+^Imdev->limits.num_ports      ^I= dev_lim->num_ports;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#959: FILE: drivers/infiniband/hw/mthca/mthca_main.c:141:
+^Imdev->limits.gid_table_len  ^I= dev_lim->max_gids;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#960: FILE: drivers/infiniband/hw/mthca/mthca_main.c:142:
+^Imdev->limits.pkey_table_len ^I= dev_lim->max_pkeys;$

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#979: FILE: drivers/infiniband/hw/mthca/mthca_main.c:161:
+static int __devinit mthca_init_tavor(struct mthca_dev *mdev)

WARNING:SPLIT_STRING: quoted string split across lines
#994: FILE: drivers/infiniband/hw/mthca/mthca_main.c:176:
+		mthca_err(mdev, "SYS_EN returned status 0x%02x, "
+			  "aborting.\n", status);

WARNING:SPLIT_STRING: quoted string split across lines
#1005: FILE: drivers/infiniband/hw/mthca/mthca_main.c:187:
+		mthca_err(mdev, "QUERY_FW returned status 0x%02x, "
+			  "aborting.\n", status);

WARNING:SPLIT_STRING: quoted string split across lines
#1016: FILE: drivers/infiniband/hw/mthca/mthca_main.c:198:
+		mthca_err(mdev, "QUERY_DDR returned status 0x%02x, "
+			  "aborting.\n", status);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1022: FILE: drivers/infiniband/hw/mthca/mthca_main.c:204:
+^I$

WARNING:SPLIT_STRING: quoted string split across lines
#1034: FILE: drivers/infiniband/hw/mthca/mthca_main.c:216:
+		mthca_err(mdev, "INIT_HCA returned status 0x%02x, "
+			  "aborting.\n", status);

WARNING:SPLIT_STRING: quoted string split across lines
#1046: FILE: drivers/infiniband/hw/mthca/mthca_main.c:228:
+		mthca_err(mdev, "QUERY_ADAPTER returned status 0x%02x, "
+			  "aborting.\n", status);

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#1065: FILE: drivers/infiniband/hw/mthca/mthca_main.c:247:
+static int __devinit mthca_load_fw(struct mthca_dev *mdev)

WARNING:SIZEOF_PARENTHESIS: sizeof *mdev->fw.arbel.mem should be sizeof(*mdev->fw.arbel.mem)
#1074: FILE: drivers/infiniband/hw/mthca/mthca_main.c:256:
+	mdev->fw.arbel.mem = kmalloc(sizeof *mdev->fw.arbel.mem *

WARNING:SIZEOF_PARENTHESIS: sizeof *mdev->fw.arbel.mem should be sizeof(*mdev->fw.arbel.mem)
#1083: FILE: drivers/infiniband/hw/mthca/mthca_main.c:265:
+	       sizeof *mdev->fw.arbel.mem * mdev->fw.arbel.fw_pages);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1154: FILE: drivers/infiniband/hw/mthca/mthca_main.c:336:
+	pci_unmap_sg(mdev->pdev, mdev->fw.arbel.mem,
+		   mdev->fw.arbel.fw_pages, PCI_DMA_BIDIRECTIONAL);

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#1164: FILE: drivers/infiniband/hw/mthca/mthca_main.c:346:
+static int __devinit mthca_init_arbel(struct mthca_dev *mdev)

WARNING:SPLIT_STRING: quoted string split across lines
#1177: FILE: drivers/infiniband/hw/mthca/mthca_main.c:359:
+		mthca_err(mdev, "QUERY_FW returned status 0x%02x, "
+			  "aborting.\n", status);

WARNING:SPLIT_STRING: quoted string split across lines
#1191: FILE: drivers/infiniband/hw/mthca/mthca_main.c:373:
+		mthca_err(mdev, "ENABLE_LAM returned status 0x%02x, "
+			  "aborting.\n", status);

WARNING:SPLIT_STRING: quoted string split across lines
#1208: FILE: drivers/infiniband/hw/mthca/mthca_main.c:390:
+	mthca_warn(mdev, "Sorry, native MT25208 mode support is not done, "
+		   "aborting.\n");

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#1217: FILE: drivers/infiniband/hw/mthca/mthca_main.c:399:
+static int __devinit mthca_init_hca(struct mthca_dev *mdev)

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#1225: FILE: drivers/infiniband/hw/mthca/mthca_main.c:407:
+static int __devinit mthca_setup_hca(struct mthca_dev *dev)

WARNING:SPLIT_STRING: quoted string split across lines
#1234: FILE: drivers/infiniband/hw/mthca/mthca_main.c:416:
+		mthca_err(dev, "Failed to initialize "
+			  "protection domain table, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1241: FILE: drivers/infiniband/hw/mthca/mthca_main.c:423:
+		mthca_err(dev, "Failed to initialize "
+			  "memory region table, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1248: FILE: drivers/infiniband/hw/mthca/mthca_main.c:430:
+		mthca_err(dev, "Failed to create driver PD, "
+			  "aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1255: FILE: drivers/infiniband/hw/mthca/mthca_main.c:437:
+		mthca_err(dev, "Failed to initialize "
+			  "event queue table, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1262: FILE: drivers/infiniband/hw/mthca/mthca_main.c:444:
+		mthca_err(dev, "Failed to switch to event-driven "
+			  "firmware commands, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1269: FILE: drivers/infiniband/hw/mthca/mthca_main.c:451:
+		mthca_err(dev, "Failed to initialize "
+			  "completion queue table, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1276: FILE: drivers/infiniband/hw/mthca/mthca_main.c:458:
+		mthca_err(dev, "Failed to initialize "
+			  "queue pair table, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1283: FILE: drivers/infiniband/hw/mthca/mthca_main.c:465:
+		mthca_err(dev, "Failed to initialize "
+			  "address vector table, aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1290: FILE: drivers/infiniband/hw/mthca/mthca_main.c:472:
+		mthca_err(dev, "Failed to initialize "
+			  "multicast group table, aborting.\n");

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#1322: FILE: drivers/infiniband/hw/mthca/mthca_main.c:504:
+static int __devinit mthca_request_regions(struct pci_dev *pdev,

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#1390: FILE: drivers/infiniband/hw/mthca/mthca_main.c:572:
+static int __devinit mthca_enable_msi_x(struct mthca_dev *mdev)

WARNING:SPLIT_STRING: quoted string split across lines
#1403: FILE: drivers/infiniband/hw/mthca/mthca_main.c:585:
+			mthca_info(mdev, "Only %d MSI-X vectors available, "
+				   "not using MSI-X\n", err);

ERROR:SPACING: space prohibited before that close square bracket ']'
#1407: FILE: drivers/infiniband/hw/mthca/mthca_main.c:589:
+	mdev->eq_table.eq[MTHCA_EQ_COMP ].msi_x_vector = entries[0].vector;

ERROR:SPACING: space prohibited before that close square bracket ']'
#1409: FILE: drivers/infiniband/hw/mthca/mthca_main.c:591:
+	mdev->eq_table.eq[MTHCA_EQ_CMD  ].msi_x_vector = entries[2].vector;

CHECK:BRACES: braces {} should be used on all arms of this statement
#1421: FILE: drivers/infiniband/hw/mthca/mthca_main.c:603:
+	if (mdev->hca_type == ARBEL_NATIVE) {
[...]
+	} else
[...]

CHECK:BRACES: Unbalanced braces around else statement
#1435: FILE: drivers/infiniband/hw/mthca/mthca_main.c:617:
+	} else

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#1439: FILE: drivers/infiniband/hw/mthca/mthca_main.c:621:
+static int __devinit mthca_init_one(struct pci_dev *pdev,

ERROR:INITIALISED_STATIC: do not initialise statics to 0
#1442: FILE: drivers/infiniband/hw/mthca/mthca_main.c:624:
+	static int mthca_version_printed = 0;

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1449: FILE: drivers/infiniband/hw/mthca/mthca_main.c:631:
+		printk(KERN_INFO "%s", mthca_version);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1453: FILE: drivers/infiniband/hw/mthca/mthca_main.c:635:
+	printk(KERN_INFO PFX "Initializing %s (%s)\n",

WARNING:SPLIT_STRING: quoted string split across lines
#1459: FILE: drivers/infiniband/hw/mthca/mthca_main.c:641:
+		dev_err(&pdev->dev, "Cannot enable PCI device, "
+			"aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1485: FILE: drivers/infiniband/hw/mthca/mthca_main.c:667:
+		dev_err(&pdev->dev, "Cannot obtain PCI resources, "
+			"aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1503: FILE: drivers/infiniband/hw/mthca/mthca_main.c:685:
+		dev_warn(&pdev->dev, "Warning: couldn't set 64-bit "
+			 "consistent PCI DMA mask.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1507: FILE: drivers/infiniband/hw/mthca/mthca_main.c:689:
+			dev_err(&pdev->dev, "Can't set consistent PCI DMA mask, "
+				"aborting.\n");

CHECK:SPACING: No space is necessary after a cast
#1512: FILE: drivers/infiniband/hw/mthca/mthca_main.c:694:
+	mdev = (struct mthca_dev *) ib_alloc_device(sizeof *mdev);

WARNING:SIZEOF_PARENTHESIS: sizeof *mdev should be sizeof(*mdev)
#1512: FILE: drivers/infiniband/hw/mthca/mthca_main.c:694:
+	mdev = (struct mthca_dev *) ib_alloc_device(sizeof *mdev);

WARNING:SPLIT_STRING: quoted string split across lines
#1515: FILE: drivers/infiniband/hw/mthca/mthca_main.c:697:
+		dev_err(&pdev->dev, "Device struct alloc failed, "
+			"aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1551: FILE: drivers/infiniband/hw/mthca/mthca_main.c:733:
+		mthca_err(mdev, "Couldn't map command register, "
+			  "aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1559: FILE: drivers/infiniband/hw/mthca/mthca_main.c:741:
+		mthca_err(mdev, "Couldn't map command register, "
+			  "aborting.\n");

WARNING:SPLIT_STRING: quoted string split across lines
#1568: FILE: drivers/infiniband/hw/mthca/mthca_main.c:750:
+		mthca_err(mdev, "Couldn't map kernel access region, "
+			  "aborting.\n");

WARNING:HOTPLUG_SECTION: Using __devexit is unnecessary
#1642: FILE: drivers/infiniband/hw/mthca/mthca_main.c:824:
+static void __devexit mthca_remove_one(struct pci_dev *pdev)

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1722: FILE: drivers/infiniband/hw/mthca/mthca_main.c:904:
+		printk(KERN_ERR PFX "mthca was compiled with SSE doorbell code, but\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1723: FILE: drivers/infiniband/hw/mthca/mthca_main.c:905:
+		printk(KERN_ERR PFX "the current CPU does not support SSE.\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1724: FILE: drivers/infiniband/hw/mthca/mthca_main.c:906:
+		printk(KERN_ERR PFX "Turn off CONFIG_INFINIBAND_MTHCA_SSE_DOORBELL "

WARNING:SPLIT_STRING: quoted string split across lines
#1725: FILE: drivers/infiniband/hw/mthca/mthca_main.c:907:
+		printk(KERN_ERR PFX "Turn off CONFIG_INFINIBAND_MTHCA_SSE_DOORBELL "
+		       "and recompile.\n");

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000223491.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 23 errors, 96 warnings, 30 checks, 1672 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000223491.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
