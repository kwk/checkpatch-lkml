WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#48: FILE: ltt/ltt-relay.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:INCLUDE_LINUX: Use #include <linux/atomic.h> instead of <asm/atomic.h>
#95: FILE: ltt/ltt-relay.c:48:
+#include <asm/atomic.h>

WARNING:CONST_STRUCT: struct file_operations should normally be const
#99: FILE: ltt/ltt-relay.c:52:
+static struct file_operations ltt_file_operations;

Using const is generally a good idea.  Checkpatch reads
a list of frequently used structs that are always or
almost always constant.

The existing structs list can be viewed from
`scripts/const_structs.checkpatch`.

See: https://lore.kernel.org/lkml/alpine.DEB.2.10.1608281509480.3321@hadrien/

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#109: FILE: ltt/ltt-relay.c:62:
+static int ltt_relay_create_buffer(struct ltt_trace_struct *trace,
+	struct ltt_channel_struct *ltt_chan,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#112: FILE: ltt/ltt-relay.c:65:
+	unsigned n_subbufs);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#115: FILE: ltt/ltt-relay.c:68:
+static void ltt_relay_destroy_buffer(struct ltt_channel_struct *ltt_chan,
+		unsigned int cpu);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#120: FILE: ltt/ltt-relay.c:73:
+static void ltt_buffer_begin_callback(struct rchan_buf *buf,
+			u64 tsc, unsigned int subbuf_idx)

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#123: FILE: ltt/ltt-relay.c:76:
+		(struct ltt_channel_struct*)buf->chan->private_data;

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#125: FILE: ltt/ltt-relay.c:78:
+		(struct ltt_block_start_header*)

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#126: FILE: ltt/ltt-relay.c:79:
+			(buf->start + (subbuf_idx*buf->chan->subbuf_size));
 			                         ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#136: FILE: ltt/ltt-relay.c:89:
+static void ltt_buffer_end_callback(struct rchan_buf *buf,
+			u64 tsc, unsigned int offset, unsigned int subbuf_idx)

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#139: FILE: ltt/ltt-relay.c:92:
+		(struct ltt_block_start_header*)

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#140: FILE: ltt/ltt-relay.c:93:
+			(buf->start + (subbuf_idx*buf->chan->subbuf_size));
 			                         ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#144: FILE: ltt/ltt-relay.c:97:
+	 * The lost size is between 0 and subbuf_size-1 */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#146: FILE: ltt/ltt-relay.c:99:
+	header->lost_size = SUBBUF_OFFSET((buf->chan->subbuf_size - offset),
+				buf->chan);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#152: FILE: ltt/ltt-relay.c:105:
+static int ltt_subbuf_start_callback(struct rchan_buf *buf,
+				void *subbuf,

CHECK:LINE_SPACING: Please don't use multiple blank lines
#159: FILE: ltt/ltt-relay.c:112:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#162: FILE: ltt/ltt-relay.c:115:
+static void ltt_deliver(struct rchan_buf *buf,
+		unsigned subbuf_idx,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#162: FILE: ltt/ltt-relay.c:115:
+		unsigned subbuf_idx,

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#166: FILE: ltt/ltt-relay.c:119:
+		(struct ltt_channel_struct*)buf->chan->private_data;

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#173: FILE: ltt/ltt-relay.c:126:
+		struct file *filp)
 		             ^^^^

Some words may have been misspelled.  Consider reviewing them.

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#173: FILE: ltt/ltt-relay.c:126:
+static void ltt_buf_mapped_callback(struct rchan_buf *buf,
+		struct file *filp)

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#178: FILE: ltt/ltt-relay.c:131:
+		struct file *filp)
 		             ^^^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#178: FILE: ltt/ltt-relay.c:131:
+static void ltt_buf_unmapped_callback(struct rchan_buf *buf,
+		struct file *filp)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#183: FILE: ltt/ltt-relay.c:136:
+static struct dentry *ltt_create_buf_file_callback(const char *filename,
+				  struct dentry *parent,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#194: FILE: ltt/ltt-relay.c:147:
+	err = ltt_relay_create_buffer(ltt_chan->trace, ltt_chan,
+					buf, buf->cpu,

ERROR:SPACING: space required before the open parenthesis '('
#196: FILE: ltt/ltt-relay.c:149:
+	if(err)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#200: FILE: ltt/ltt-relay.c:153:
+	dentry = debugfs_create_file(filename, mode, parent, buf,
+			&ltt_file_operations);

ERROR:SPACING: space required before the open parenthesis '('
#201: FILE: ltt/ltt-relay.c:154:
+	if(!dentry)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#222: FILE: ltt/ltt-relay.c:175:
+static void ltt_buf_unfull(struct rchan_buf *buf,
+		unsigned subbuf_idx,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#222: FILE: ltt/ltt-relay.c:175:
+		unsigned subbuf_idx,

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#226: FILE: ltt/ltt-relay.c:179:
+		(struct ltt_channel_struct*)buf->chan->private_data;

WARNING:LINE_SPACING: Missing a blank line after declarations
#228: FILE: ltt/ltt-relay.c:181:
+	struct ltt_channel_buf_struct *ltt_buf = &ltt_channel->buf[buf->cpu];
+	if (waitqueue_active(&ltt_buf->write_wait))

WARNING:WAITQUEUE_ACTIVE: waitqueue_active without comment
#228: FILE: ltt/ltt-relay.c:181:
+	if (waitqueue_active(&ltt_buf->write_wait))

CHECK:LINE_SPACING: Please don't use multiple blank lines
#232: FILE: ltt/ltt-relay.c:185:
+
+

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#235: FILE: ltt/ltt-relay.c:188:
+ *	@filp: the file
   	 ^^^^

WARNING:TYPO_SPELLING: 'implemention' may be misspelled - perhaps 'implementation'?
#238: FILE: ltt/ltt-relay.c:191:
+ *	Poll implemention.
   	     ^^^^^^^^^^^^

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#240: FILE: ltt/ltt-relay.c:193:
+static unsigned int ltt_poll(struct file *filp, poll_table *wait)
                                           ^^^^

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#246: FILE: ltt/ltt-relay.c:199:
+		(struct ltt_channel_struct*)buf->chan->private_data;

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#249: FILE: ltt/ltt-relay.c:202:
+	//printk(KERN_DEBUG "DEBUG : in LTT poll %p\n", filp);
 	                                                ^^^^

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#251: FILE: ltt/ltt-relay.c:204:
+		poll_wait(filp, &buf->read_wait, wait);
 		          ^^^^

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#255: FILE: ltt/ltt-relay.c:208:
+			return 0;
+		} else {

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#256: FILE: ltt/ltt-relay.c:209:
+			if (SUBBUF_TRUNC(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#258: FILE: ltt/ltt-relay.c:211:
+			- SUBBUF_TRUNC(

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#261: FILE: ltt/ltt-relay.c:214:
+				if (buf->finalized) return POLLHUP;

Trailing statements (for example after any conditional) should be
on the next line.
Statements, such as::

  if (x == y) break;

should be::

  if (x == y)
          break;

ERROR:TRAILING_STATEMENTS: trailing statements should be on next line
#262: FILE: ltt/ltt-relay.c:215:
+				else return 0;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#267: FILE: ltt/ltt-relay.c:220:
+				if (SUBBUF_TRUNC(atomic_read(&ltt_buf->offset),
+						buf->chan)

CHECK:LINE_SPACING: Please don't use multiple blank lines
#280: FILE: ltt/ltt-relay.c:233:
+
+

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#285: FILE: ltt/ltt-relay.c:238:
+ *	@filp: the file
   	 ^^^^

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#302: FILE: ltt/ltt-relay.c:255:
+static int ltt_ioctl(struct inode *inode, struct file *filp,
                                                        ^^^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#303: FILE: ltt/ltt-relay.c:256:
+static int ltt_ioctl(struct inode *inode, struct file *filp,
+		unsigned int cmd, unsigned long arg)

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#307: FILE: ltt/ltt-relay.c:260:
+		(struct ltt_channel_struct*)buf->chan->private_data;

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#311: FILE: ltt/ltt-relay.c:264:
+	switch (cmd) {
+		case RELAY_GET_SUBBUF:
[...]
+		case RELAY_PUT_SUBBUF:
[...]
+		case RELAY_GET_N_SUBBUFS:
[...]
+		case RELAY_GET_SUBBUF_SIZE:
[...]
+		default:

switch should be at the same indent as case.
Example::

  switch (suffix) {
  case 'G':
  case 'g':
          mem <<= 30;
          break;
  case 'M':
  case 'm':
          mem <<= 20;
          break;
  case 'K':
  case 'k':
          mem <<= 10;
          fallthrough;
  default:
          break;
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:LINE_SPACING: Missing a blank line after declarations
#315: FILE: ltt/ltt-relay.c:268:
+			unsigned int consumed_old, consumed_idx;
+			atomic_inc(&ltt_buf->active_readers);

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#318: FILE: ltt/ltt-relay.c:271:
+			if (SUBBUF_OFFSET(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#319: FILE: ltt/ltt-relay.c:272:
+				atomic_read(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#325: FILE: ltt/ltt-relay.c:278:
+			if ((SUBBUF_TRUNC(

WARNING:UNNECESSARY_BREAK: break is not useful after a return
#336: FILE: ltt/ltt-relay.c:289:
+			return put_user((u32)consumed_old, argp);
+			break;

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#352: FILE: ltt/ltt-relay.c:305:
+			if (atomic_cmpxchg(

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#357: FILE: ltt/ltt-relay.c:310:
+				 * happen if this is a buffer we never got. */

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#361: FILE: ltt/ltt-relay.c:314:
+				return -EIO;
+			} else {

WARNING:LINE_SPACING: Missing a blank line after declarations
#365: FILE: ltt/ltt-relay.c:318:
+				void *data;
+				index = SUBBUF_INDEX(consumed_old, buf->chan);

WARNING:UNNECESSARY_BREAK: break is not useful after a return
#377: FILE: ltt/ltt-relay.c:330:
+			return put_user((u32)buf->chan->n_subbufs, argp);
+			break;

WARNING:UNNECESSARY_BREAK: break is not useful after a return
#381: FILE: ltt/ltt-relay.c:334:
+			return put_user((u32)buf->chan->subbuf_size, argp);
+			break;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#390: FILE: ltt/ltt-relay.c:343:
+static long ltt_compat_ioctl(struct file *file, unsigned cmd, unsigned long arg)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#404: FILE: ltt/ltt-relay.c:357:
+static void ltt_relay_print_subbuffer_errors(struct ltt_channel_struct *ltt_chan,
+		int cons_off, unsigned int i)

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#409: FILE: ltt/ltt-relay.c:362:
+	printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#411: FILE: ltt/ltt-relay.c:364:
+		"LTT : unread channel %s offset is %d "
+		"and cons_off : %d (cpu %u)\n",

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#417: FILE: ltt/ltt-relay.c:370:
+	if (SUBBUF_OFFSET(atomic_read(&ltt_chan->buf[i].commit_count[cons_idx]),
+				rchan))

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_alert([subsystem]dev, ... then dev_alert(dev, ... then pr_alert(...  to printk(KERN_ALERT ...
#418: FILE: ltt/ltt-relay.c:371:
+		printk(KERN_ALERT

WARNING:SPLIT_STRING: quoted string split across lines
#420: FILE: ltt/ltt-relay.c:373:
+			"LTT : %s : subbuffer %u has non zero "
+			"commit count.\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_alert([subsystem]dev, ... then dev_alert(dev, ... then pr_alert(...  to printk(KERN_ALERT ...
#422: FILE: ltt/ltt-relay.c:375:
+	printk(KERN_ALERT "LTT : %s : commit count : %u, subbuf size %zd\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#423: FILE: ltt/ltt-relay.c:376:
+	printk(KERN_ALERT "LTT : %s : commit count : %u, subbuf size %zd\n",
+			ltt_chan->channel_name,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#429: FILE: ltt/ltt-relay.c:382:
+static void ltt_relay_print_errors(struct ltt_trace_struct *trace,
+		struct ltt_channel_struct *ltt_chan, int cpu)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#444: FILE: ltt/ltt-relay.c:397:
+static void ltt_relay_print_buffer_errors(struct ltt_channel_struct *ltt_chan,
+			unsigned int cpu)

ERROR:TRAILING_WHITESPACE: trailing whitespace
#447: FILE: ltt/ltt-relay.c:400:
+^I$

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#449: FILE: ltt/ltt-relay.c:402:
+^I^Iprintk(KERN_ALERT $

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_alert([subsystem]dev, ... then dev_alert(dev, ... then pr_alert(...  to printk(KERN_ALERT ...
#449: FILE: ltt/ltt-relay.c:402:
+		printk(KERN_ALERT 

WARNING:SPLIT_STRING: quoted string split across lines
#451: FILE: ltt/ltt-relay.c:404:
+			"LTT : %s : %d events lost "
+			"in %s channel (cpu %u).\n",

ERROR:TRAILING_WHITESPACE: trailing whitespace
#456: FILE: ltt/ltt-relay.c:409:
+^I^Iprintk(KERN_ALERT $

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_alert([subsystem]dev, ... then dev_alert(dev, ... then pr_alert(...  to printk(KERN_ALERT ...
#456: FILE: ltt/ltt-relay.c:409:
+		printk(KERN_ALERT 

WARNING:SPLIT_STRING: quoted string split across lines
#458: FILE: ltt/ltt-relay.c:411:
+			"LTT : %s : %d corrupted subbuffers "
+			"in %s channel (cpu %u).\n",

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#460: FILE: ltt/ltt-relay.c:413:
+			atomic_read(

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#483: FILE: ltt/ltt-relay.c:436:
+static int ltt_relay_create_buffer(struct ltt_trace_struct *trace,
+	struct ltt_channel_struct *ltt_chan,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#486: FILE: ltt/ltt-relay.c:439:
+	unsigned n_subbufs)

WARNING:ALLOC_WITH_MULTIPLY: Prefer kmalloc_array over kmalloc with multiply
#490: FILE: ltt/ltt-relay.c:443:
+	ltt_chan->buf[cpu].commit_count =
+		kmalloc(sizeof(atomic_t) * n_subbufs, GFP_KERNEL);

Prefer kmalloc_array/kcalloc over kmalloc/kzalloc with a
sizeof multiply.

See: https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#498: FILE: ltt/ltt-relay.c:451:
+	atomic_set(&ltt_chan->buf[cpu].offset,
+		ltt_subbuf_header_len());

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#506: FILE: ltt/ltt-relay.c:459:
+	INIT_WORK(&ltt_chan->buf[cpu].wake_writers,
+			ltt_wakeup_writers, &ltt_chan->buf[cpu]);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#508: FILE: ltt/ltt-relay.c:461:
+^I$

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#511: FILE: ltt/ltt-relay.c:464:
+	 * various CPUs : ok because tracing not started (for this cpu). */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#513: FILE: ltt/ltt-relay.c:466:
+	atomic_add(ltt_subbuf_header_len(),
+		&ltt_chan->buf[cpu].commit_count[0]);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#522: FILE: ltt/ltt-relay.c:475:
+static void ltt_relay_destroy_buffer(struct ltt_channel_struct *ltt_chan,
+					unsigned int cpu)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#527: FILE: ltt/ltt-relay.c:480:
+	kref_put(&ltt_chan->trace->ltt_transport_kref,
+		ltt_release_transport);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#538: FILE: ltt/ltt-relay.c:491:
+static int ltt_relay_create_channel(char *trace_name,
+		struct ltt_trace_struct *trace,

WARNING:USE_NEGATIVE_ERRNO: return of an errno should typically be negative (ie: return -EPERM)
#550: FILE: ltt/ltt-relay.c:503:
+		return EPERM;

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#552: FILE: ltt/ltt-relay.c:505:
+		strncpy(tmpname, LTT_FLIGHT_PREFIX, PATH_MAX-1);
 		                                            ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#554: FILE: ltt/ltt-relay.c:507:
+			PATH_MAX-1-sizeof(LTT_FLIGHT_PREFIX));
 			        ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#554: FILE: ltt/ltt-relay.c:507:
+			PATH_MAX-1-sizeof(LTT_FLIGHT_PREFIX));
 			          ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#556: FILE: ltt/ltt-relay.c:509:
+		strncpy(tmpname, channel_name, PATH_MAX-1);
 		                                       ^

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*ltt_chan)...) over kzalloc(sizeof(struct ltt_channel_struct)...)
#559: FILE: ltt/ltt-relay.c:512:
+	*ltt_chan = kzalloc(sizeof(struct ltt_channel_struct), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

ERROR:TRAILING_WHITESPACE: trailing whitespace
#574: FILE: ltt/ltt-relay.c:527:
+^I$

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!trans_channel_data"
#575: FILE: ltt/ltt-relay.c:528:
+	if ((*ltt_chan)->trans_channel_data == NULL) {

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#576: FILE: ltt/ltt-relay.c:529:
+		printk(KERN_ERR "LTT : Can't open %s channel for trace %s\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#577: FILE: ltt/ltt-relay.c:530:
+		printk(KERN_ERR "LTT : Can't open %s channel for trace %s\n",
+				tmpname, trace_name);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#581: FILE: ltt/ltt-relay.c:534:
+	strncpy((*ltt_chan)->channel_name, tmpname, PATH_MAX-1);
 	                                                    ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#599: FILE: ltt/ltt-relay.c:552:
+	new_trace->dentry.trace_root = debugfs_create_dir(new_trace->trace_name,
+			ltt_root_dentry);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!new_trace->dentry.trace_root"
#600: FILE: ltt/ltt-relay.c:553:
+	if (new_trace->dentry.trace_root == NULL) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#601: FILE: ltt/ltt-relay.c:554:
+		printk(KERN_ERR "LTT : Trace directory name %s already taken\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#602: FILE: ltt/ltt-relay.c:555:
+		printk(KERN_ERR "LTT : Trace directory name %s already taken\n",
+				new_trace->trace_name);

WARNING:USE_NEGATIVE_ERRNO: return of an errno should typically be negative (ie: return -EEXIST)
#603: FILE: ltt/ltt-relay.c:556:
+		return EEXIST;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#607: FILE: ltt/ltt-relay.c:560:
+	new_trace->dentry.control_root = debugfs_create_dir(LTT_CONTROL_ROOT,
+			new_trace->dentry.trace_root);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!new_trace->dentry.control_root"
#608: FILE: ltt/ltt-relay.c:561:
+	if (new_trace->dentry.control_root == NULL) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#609: FILE: ltt/ltt-relay.c:562:
+		printk(KERN_ERR "LTT : Trace control subdirectory name "\

WARNING:LINE_CONTINUATIONS: Avoid unnecessary line continuations
#609: FILE: ltt/ltt-relay.c:562:
+		printk(KERN_ERR "LTT : Trace control subdirectory name "\

WARNING:USE_NEGATIVE_ERRNO: return of an errno should typically be negative (ie: return -EEXIST)
#613: FILE: ltt/ltt-relay.c:566:
+		return EEXIST;

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#636: FILE: ltt/ltt-relay.c:589:
+			(struct ltt_channel_struct*)buf->chan->private_data;

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#663: FILE: ltt/ltt-relay.c:616:
+		reserve_commit_diff = SUBBUF_OFFSET(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#665: FILE: ltt/ltt-relay.c:618:
+			- atomic_read(

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#671: FILE: ltt/ltt-relay.c:624:
+			if (mode == FORCE_ACTIVE && !ltt_channel->overwrite &&
+				(offset_begin - atomic_read(&ltt_buf->consumed))

ERROR:CODE_INDENT: code indent should use tabs where possible
#673: FILE: ltt/ltt-relay.c:626:
+^I  ^I^I^I/* We do not overwrite non consumed buffers$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#673: FILE: ltt/ltt-relay.c:626:
+^I  ^I^I^I/* We do not overwrite non consumed buffers$

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#675: FILE: ltt/ltt-relay.c:628:
+				 * ignore switch while tracing is active. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#680: FILE: ltt/ltt-relay.c:633:
+			 * in normal mode */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#688: FILE: ltt/ltt-relay.c:641:
+			 * write seqlock on xtime. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#707: FILE: ltt/ltt-relay.c:660:
+			 * reader only happen if a sub-buffer is corrupted */

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#708: FILE: ltt/ltt-relay.c:661:
+			if ((SUBBUF_TRUNC(offset_end-1, buf->chan)
 			                            ^

CHECK:BRACES: Unbalanced braces around else statement
#714: FILE: ltt/ltt-relay.c:667:
+			else {

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#732: FILE: ltt/ltt-relay.c:685:
+			 * and the commit. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#735: FILE: ltt/ltt-relay.c:688:
+				 * count : a sub-buffer is corrupted */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#737: FILE: ltt/ltt-relay.c:690:
+				atomic_up_add(reserve_commit_diff,
+					&ltt_buf->commit_count[SUBBUF_INDEX(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#737: FILE: ltt/ltt-relay.c:690:
+					&ltt_buf->commit_count[SUBBUF_INDEX(

WARNING:TYPO_SPELLING: 'uncommited' may be misspelled - perhaps 'uncommitted'?
#760: FILE: ltt/ltt-relay.c:713:
+		 * old (uncommited) subbuffer will be declared corrupted, and
 		        ^^^^^^^^^^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#763: FILE: ltt/ltt-relay.c:716:
+		 * Offset old should never be 0. */

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#765: FILE: ltt/ltt-relay.c:718:
+				SUBBUF_INDEX((offset_old-1), buf->chan));
 				                        ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#770: FILE: ltt/ltt-relay.c:723:
+				- (SUBBUF_OFFSET(offset_old-1, buf->chan) + 1),
 				                           ^

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#771: FILE: ltt/ltt-relay.c:724:
+				&ltt_buf->commit_count[SUBBUF_INDEX(

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#772: FILE: ltt/ltt-relay.c:725:
+						offset_old-1, buf->chan)]);
 						          ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#775: FILE: ltt/ltt-relay.c:728:
+			ltt_deliver(buf,
+				SUBBUF_INDEX((offset_old-1), buf->chan), NULL);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#775: FILE: ltt/ltt-relay.c:728:
+				SUBBUF_INDEX((offset_old-1), buf->chan), NULL);
 				                        ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#783: FILE: ltt/ltt-relay.c:736:
+		 * executed, caution. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#785: FILE: ltt/ltt-relay.c:738:
+		 * deliver of this sub-buffer */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#792: FILE: ltt/ltt-relay.c:745:
+			atomic_up_add_return(ltt_subbuf_header_len(),
+			 &ltt_buf->commit_count[SUBBUF_INDEX(offset_begin,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#797: FILE: ltt/ltt-relay.c:750:
+			ltt_deliver(buf,
+				SUBBUF_INDEX(offset_begin, buf->chan), NULL);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#805: FILE: ltt/ltt-relay.c:758:
+ * accesses across CPUs. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#828: FILE: ltt/ltt-relay.c:781:
+ * are no stalled writers. */

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#831: FILE: ltt/ltt-relay.c:784:
+{
+

WARNING:WAITQUEUE_ACTIVE: waitqueue_active without comment
#832: FILE: ltt/ltt-relay.c:785:
+	if (waitqueue_active(&ltt_buf->write_wait))

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#837: FILE: ltt/ltt-relay.c:790:
+static void ltt_relay_finish_buffer(struct ltt_channel_struct *ltt_channel,
+	unsigned int cpu)

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#842: FILE: ltt/ltt-relay.c:795:
+	printk("finish for cpu %d , %p\n", cpu, rchan->buf[cpu]);

WARNING:ONE_SEMICOLON: Statements terminations use 1 semicolon
#844: FILE: ltt/ltt-relay.c:797:
+		ltt_buf = &ltt_channel->buf[cpu];;

CHECK:LINE_SPACING: Please don't use multiple blank lines
#850: FILE: ltt/ltt-relay.c:803:
+
+

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#884: FILE: ltt/ltt-relay.c:837:
+ * ^I^I^I^I^Ito the beginning of the reserved slot. */$

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#884: FILE: ltt/ltt-relay.c:837:
+ * 					to the beginning of the reserved slot. */

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#885: FILE: ltt/ltt-relay.c:838:
+static void *ltt_relay_reserve_slot(

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#922: FILE: ltt/ltt-relay.c:875:
+			size = ltt_get_header_size(trace,
+					buf->start + offset_begin,

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#925: FILE: ltt/ltt-relay.c:878:
+			if ((SUBBUF_OFFSET(offset_begin, buf->chan)+size)
 			                                           ^

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#939: FILE: ltt/ltt-relay.c:892:
+			reserve_commit_diff = SUBBUF_OFFSET(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#940: FILE: ltt/ltt-relay.c:893:
+				buf->chan->subbuf_size - atomic_read(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '['
#941: FILE: ltt/ltt-relay.c:894:
+				&ltt_buf->commit_count[

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#943: FILE: ltt/ltt-relay.c:896:
+						SUBBUF_INDEX(offset_begin,
+						buf->chan)]), buf->chan);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#947: FILE: ltt/ltt-relay.c:900:
+				if (!ltt_channel->overwrite &&
+					(SUBBUF_TRUNC(offset_begin, buf->chan)

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#948: FILE: ltt/ltt-relay.c:901:
+					- SUBBUF_TRUNC(

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#954: FILE: ltt/ltt-relay.c:907:
+					 * is lost. */

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#957: FILE: ltt/ltt-relay.c:910:
+					return NULL;
+				} else {

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#961: FILE: ltt/ltt-relay.c:914:
+					 * write in this new subbuffer.*/

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#966: FILE: ltt/ltt-relay.c:919:
+				 * write in this new subbuffer. */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#969: FILE: ltt/ltt-relay.c:922:
+			size = ltt_get_header_size(trace,
+					buf->start + offset_begin,

ERROR:SPACING: space required after that ',' (ctx:VxV)
#972: FILE: ltt/ltt-relay.c:925:
+			if ((SUBBUF_OFFSET(offset_begin,buf->chan) + size)
 			                               ^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#975: FILE: ltt/ltt-relay.c:928:
+				 * don't complete the sub-buffer switch. */

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#978: FILE: ltt/ltt-relay.c:931:
+				return NULL;
+			} else {

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#981: FILE: ltt/ltt-relay.c:934:
+				 * write. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#985: FILE: ltt/ltt-relay.c:938:
+			 * switch boundary. It's safe to write */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#991: FILE: ltt/ltt-relay.c:944:
+			 * the next subbuffer. */

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1011: FILE: ltt/ltt-relay.c:964:
+
+

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1021: FILE: ltt/ltt-relay.c:974:
+		 * which will win this loop. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1023: FILE: ltt/ltt-relay.c:976:
+		 * only happen if a sub-buffer is corrupted */

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1024: FILE: ltt/ltt-relay.c:977:
+		if ((SUBBUF_TRUNC(offset_end-1, buf->chan)
 		                            ^

CHECK:BRACES: Unbalanced braces around else statement
#1028: FILE: ltt/ltt-relay.c:981:
+		else {

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1044: FILE: ltt/ltt-relay.c:997:
+		 * who died between the reserve and the commit. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1047: FILE: ltt/ltt-relay.c:1000:
+			 * sub-buffer is corrupted. We do not deliver it. */

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1048: FILE: ltt/ltt-relay.c:1001:
+			atomic_up_add(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '['
#1050: FILE: ltt/ltt-relay.c:1003:
+				&ltt_buf->commit_count[

WARNING:TYPO_SPELLING: 'uncommited' may be misspelled - perhaps 'uncommitted'?
#1071: FILE: ltt/ltt-relay.c:1024:
+		 * The result will be than the old (uncommited) subbuffer will
 		                                    ^^^^^^^^^^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1075: FILE: ltt/ltt-relay.c:1028:
+		 * Note : offset_old should never be 0 here.*/

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1077: FILE: ltt/ltt-relay.c:1030:
+			SUBBUF_INDEX((offset_old-1), buf->chan));
 			                        ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1082: FILE: ltt/ltt-relay.c:1035:
+				- (SUBBUF_OFFSET(offset_old-1, buf->chan)+1),
 				                           ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#1082: FILE: ltt/ltt-relay.c:1035:
+				- (SUBBUF_OFFSET(offset_old-1, buf->chan)+1),
 				                                         ^

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1083: FILE: ltt/ltt-relay.c:1036:
+				&ltt_buf->commit_count[SUBBUF_INDEX(

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1084: FILE: ltt/ltt-relay.c:1037:
+						offset_old-1, buf->chan)]);
 						          ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1086: FILE: ltt/ltt-relay.c:1039:
+			ltt_deliver(buf, SUBBUF_INDEX((offset_old-1),
 			                                         ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1087: FILE: ltt/ltt-relay.c:1040:
+			ltt_deliver(buf, SUBBUF_INDEX((offset_old-1),
+						buf->chan), NULL);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1095: FILE: ltt/ltt-relay.c:1048:
+		 * executed, caution. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1097: FILE: ltt/ltt-relay.c:1050:
+		 * deliver of this sub-buffer */

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1100: FILE: ltt/ltt-relay.c:1053:
+		commit_count = atomic_up_add_return(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '['
#1102: FILE: ltt/ltt-relay.c:1055:
+				&ltt_buf->commit_count[

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1107: FILE: ltt/ltt-relay.c:1060:
+			ltt_deliver(buf,
+				SUBBUF_INDEX(offset_begin, buf->chan), NULL);

WARNING:TYPO_SPELLING: 'uncommited' may be misspelled - perhaps 'uncommitted'?
#1126: FILE: ltt/ltt-relay.c:1079:
+		 * The result will be than the old (uncommited) subbuffer will
 		                                    ^^^^^^^^^^

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1129: FILE: ltt/ltt-relay.c:1082:
+		 * adjustment. */

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1131: FILE: ltt/ltt-relay.c:1084:
+			SUBBUF_INDEX((offset_end-1), buf->chan));
 			                        ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1136: FILE: ltt/ltt-relay.c:1089:
+				- (SUBBUF_OFFSET(offset_end-1, buf->chan)+1),
 				                           ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#1136: FILE: ltt/ltt-relay.c:1089:
+				- (SUBBUF_OFFSET(offset_end-1, buf->chan)+1),
 				                                         ^

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1137: FILE: ltt/ltt-relay.c:1090:
+				&ltt_buf->commit_count[SUBBUF_INDEX(

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1138: FILE: ltt/ltt-relay.c:1091:
+						offset_end-1, buf->chan)]);
 						          ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1141: FILE: ltt/ltt-relay.c:1094:
+			ltt_deliver(buf,
+				SUBBUF_INDEX((offset_end-1), buf->chan), NULL);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1141: FILE: ltt/ltt-relay.c:1094:
+				SUBBUF_INDEX((offset_end-1), buf->chan), NULL);
 				                        ^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#1153: FILE: ltt/ltt-relay.c:1106:
+
+

WARNING:TYPO_SPELLING: 'beginnig' may be misspelled - perhaps 'beginning'?
#1162: FILE: ltt/ltt-relay.c:1115:
+ * @reserved : address of the beginnig of the reserved slot.
                               ^^^^^^^^

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1166: FILE: ltt/ltt-relay.c:1119:
+static void ltt_relay_commit_slot(

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1180: FILE: ltt/ltt-relay.c:1133:
+	commit_count = atomic_up_add_return(slot_size,
+		&ltt_buf->commit_count[SUBBUF_INDEX(offset_begin, buf->chan)]);

WARNING:TYPO_SPELLING: 'reenable' may be misspelled - perhaps 're-enable'?
#1188: FILE: ltt/ltt-relay.c:1141:
+ * specific threshold value, we reenable preemption and block.
                                 ^^^^^^^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1191: FILE: ltt/ltt-relay.c:1144:
+static int ltt_relay_user_blocking(struct ltt_trace_struct *trace,
+		unsigned int index, size_t data_size, struct user_dbg_data *dbg)

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#1204: FILE: ltt/ltt-relay.c:1157:
+	 * block for it */

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#1213: FILE: ltt/ltt-relay.c:1166:
+	if (!channel->overwrite &&

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1214: FILE: ltt/ltt-relay.c:1167:
+	if (!channel->overwrite &&
+		(dbg->avail_size = (dbg->write = atomic_read(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1214: FILE: ltt/ltt-relay.c:1167:
+		(dbg->avail_size = (dbg->write = atomic_read(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1217: FILE: ltt/ltt-relay.c:1170:
+		 - SUBBUF_TRUNC((dbg->read = atomic_read(

ERROR:CODE_INDENT: code indent should use tabs where possible
#1219: FILE: ltt/ltt-relay.c:1172:
+^I^I^I ^I^Irelay_buf->chan))$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#1219: FILE: ltt/ltt-relay.c:1172:
+^I^I^I ^I^Irelay_buf->chan))$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1238: FILE: ltt/ltt-relay.c:1191:
+static void ltt_relay_print_user_errors(struct ltt_trace_struct *trace,
+		unsigned int index, size_t data_size, struct user_dbg_data *dbg)

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1249: FILE: ltt/ltt-relay.c:1202:
+	printk(KERN_ERR "Error in LTT usertrace : "

WARNING:SPLIT_STRING: quoted string split across lines
#1250: FILE: ltt/ltt-relay.c:1203:
+	printk(KERN_ERR "Error in LTT usertrace : "
+	"buffer full : event lost in blocking "

WARNING:SPLIT_STRING: quoted string split across lines
#1251: FILE: ltt/ltt-relay.c:1204:
+	"buffer full : event lost in blocking "
+	"mode. Increase LTT_RESERVE_CRITICAL.\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1252: FILE: ltt/ltt-relay.c:1205:
+	printk(KERN_ERR "LTT nesting level is %u.\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1253: FILE: ltt/ltt-relay.c:1206:
+	printk(KERN_ERR "LTT nesting level is %u.\n",
+		ltt_nesting[smp_processor_id()]);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1254: FILE: ltt/ltt-relay.c:1207:
+	printk(KERN_ERR "LTT avail size %lu.\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1255: FILE: ltt/ltt-relay.c:1208:
+	printk(KERN_ERR "LTT avail size %lu.\n",
+		dbg->avail_size);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1256: FILE: ltt/ltt-relay.c:1209:
+	printk(KERN_ERR "avai write : %lu, read : %lu\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1257: FILE: ltt/ltt-relay.c:1210:
+	printk(KERN_ERR "avai write : %lu, read : %lu\n",
+			dbg->write, dbg->read);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1258: FILE: ltt/ltt-relay.c:1211:
+	printk(KERN_ERR "LTT cur size %lu.\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1259: FILE: ltt/ltt-relay.c:1212:
+	printk(KERN_ERR "LTT cur size %lu.\n",
+		(dbg->write = atomic_read(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1259: FILE: ltt/ltt-relay.c:1212:
+		(dbg->write = atomic_read(

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#1262: FILE: ltt/ltt-relay.c:1215:
+	 - SUBBUF_TRUNC((dbg->read = atomic_read(

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#1265: FILE: ltt/ltt-relay.c:1218:
+	printk(KERN_ERR "cur write : %lu, read : %lu\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1266: FILE: ltt/ltt-relay.c:1219:
+	printk(KERN_ERR "cur write : %lu, read : %lu\n",
+			dbg->write, dbg->read);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1288: FILE: ltt/ltt-relay.c:1241:
+	printk(KERN_INFO "LTT : ltt-relay init\n");

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ltt_root_dentry"
#1290: FILE: ltt/ltt-relay.c:1243:
+	if (ltt_root_dentry == NULL)

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1308: FILE: ltt/ltt-relay.c:1261:
+	printk(KERN_INFO "LTT : ltt-relay exit\n");

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000015324.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 22 errors, 97 warnings, 118 checks, 1280 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000015324.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
