ERROR:TRAILING_WHITESPACE: trailing whitespace
#41: FILE: drivers/infiniband/core/user_mad.c:3:
+ * Copyright (c) 2005 Voltaire, Inc. All rights reserved. $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#51: FILE: drivers/infiniband/core/user_mad.c:34:
+ * $Id: user_mad.c 2814 2005-07-06 19:14:09Z halr $

Since linux moved to git, the CVS markers are no longer used.
So, CVS style keywords ($Id$, $Revision$, $Log$) should not be
added.

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#102: FILE: drivers/infiniband/core/user_mad.c:149:
+		timeout = kmalloc(sizeof *timeout + sizeof (struct ib_mad_hdr),

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:SIZEOF_PARENTHESIS: sizeof *timeout should be sizeof(*timeout)
#102: FILE: drivers/infiniband/core/user_mad.c:149:
+		timeout = kmalloc(sizeof *timeout + sizeof (struct ib_mad_hdr),

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#107: FILE: drivers/infiniband/core/user_mad.c:154:
+		memset(timeout, 0, sizeof *timeout + sizeof (struct ib_mad_hdr));

WARNING:SIZEOF_PARENTHESIS: sizeof *timeout should be sizeof(*timeout)
#107: FILE: drivers/infiniband/core/user_mad.c:154:
+		memset(timeout, 0, sizeof *timeout + sizeof (struct ib_mad_hdr));

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#109: FILE: drivers/infiniband/core/user_mad.c:156:
+		timeout->length = sizeof (struct ib_mad_hdr);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#113: FILE: drivers/infiniband/core/user_mad.c:160:
+		       sizeof (struct ib_mad_hdr));

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (16, 32)
#117: FILE: drivers/infiniband/core/user_mad.c:162:
+		if (!queue_packet(file, agent, timeout))
+				return;

ERROR:TRAILING_WHITESPACE: trailing whitespace
#135: FILE: drivers/infiniband/core/user_mad.c:179:
+^Ilength = mad_recv_wc->mad_len; $

WARNING:SIZEOF_PARENTHESIS: sizeof *packet should be sizeof(*packet)
#136: FILE: drivers/infiniband/core/user_mad.c:180:
+	packet = kmalloc(sizeof *packet + length, GFP_KERNEL);

WARNING:SIZEOF_PARENTHESIS: sizeof *packet should be sizeof(*packet)
#141: FILE: drivers/infiniband/core/user_mad.c:184:
+	memset(packet, 0, sizeof *packet + length);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#155: FILE: drivers/infiniband/core/user_mad.c:190:
+	packet->mad.hdr.length    = length + sizeof (struct ib_user_mad);

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#156: FILE: drivers/infiniband/core/user_mad.c:191:
+^Ipacket->mad.hdr.qpn ^I  = cpu_to_be32(mad_recv_wc->wc->src_qp);$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#157: FILE: drivers/infiniband/core/user_mad.c:192:
+^Ipacket->mad.hdr.lid ^I  = cpu_to_be16(mad_recv_wc->wc->slid);$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#158: FILE: drivers/infiniband/core/user_mad.c:193:
+^Ipacket->mad.hdr.sl  ^I  = mad_recv_wc->wc->sl;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#168: FILE: drivers/infiniband/core/user_mad.c:198:
+^I^Ipacket->mad.hdr.gid_index ^I= 0;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#169: FILE: drivers/infiniband/core/user_mad.c:199:
+^I^Ipacket->mad.hdr.hop_limit ^I= 0;$

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#181: FILE: drivers/infiniband/core/user_mad.c:219:
+	if (count < sizeof (struct ib_user_mad) + sizeof (struct ib_mad))

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#181: FILE: drivers/infiniband/core/user_mad.c:219:
+	if (count < sizeof (struct ib_user_mad) + sizeof (struct ib_mad))

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#190: FILE: drivers/infiniband/core/user_mad.c:242:
+	if (count < packet->length + sizeof (struct ib_user_mad)) {

CHECK:BRACES: braces {} should be used on all arms of this statement
#190: FILE: drivers/infiniband/core/user_mad.c:242:
+	if (count < packet->length + sizeof (struct ib_user_mad)) {
[...]
+	} else if (copy_to_user(buf, &packet->mad,
[...]
 	else
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#193: FILE: drivers/infiniband/core/user_mad.c:245:
+				 sizeof (struct ib_user_mad) + sizeof (struct ib_mad)))

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#193: FILE: drivers/infiniband/core/user_mad.c:245:
+				 sizeof (struct ib_user_mad) + sizeof (struct ib_mad)))

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#198: FILE: drivers/infiniband/core/user_mad.c:250:
+			      packet->length + sizeof (struct ib_user_mad)))

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#204: FILE: drivers/infiniband/core/user_mad.c:253:
+		ret = packet->length + sizeof (struct ib_user_mad);

CHECK:BRACES: braces {} should be used on all arms of this statement
#205: FILE: drivers/infiniband/core/user_mad.c:254:
+	if (ret < 0) {
[...]
+	} else
[...]

CHECK:BRACES: Unbalanced braces around else statement
#210: FILE: drivers/infiniband/core/user_mad.c:259:
+	} else

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#238: FILE: drivers/infiniband/core/user_mad.c:281:
+	length = count - sizeof (struct ib_user_mad);

WARNING:SIZEOF_PARENTHESIS: sizeof *packet should be sizeof(*packet)
#239: FILE: drivers/infiniband/core/user_mad.c:282:
+	packet = kmalloc(sizeof *packet + sizeof(struct ib_mad_hdr) +

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#248: FILE: drivers/infiniband/core/user_mad.c:288:
+	if (copy_from_user(&packet->mad, buf,
+			    sizeof (struct ib_user_mad) +

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#248: FILE: drivers/infiniband/core/user_mad.c:288:
+			    sizeof (struct ib_user_mad) +

WARNING:SIZEOF_PARENTHESIS: sizeof ah_attr should be sizeof(ah_attr)
#273: FILE: drivers/infiniband/core/user_mad.c:311:
+	memset(&ah_attr, 0, sizeof ah_attr);

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#281: FILE: drivers/infiniband/core/user_mad.c:319:
+^I^Iah_attr.grh.flow_label ^I   = packet->mad.hdr.flow_label;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#282: FILE: drivers/infiniband/core/user_mad.c:320:
+^I^Iah_attr.grh.hop_limit  ^I   = packet->mad.hdr.hop_limit;$

CHECK:SPACING: No space is necessary after a cast
#292: FILE: drivers/infiniband/core/user_mad.c:330:
+	rmpp_mad = (struct ib_rmpp_mad *) packet->mad.data;

WARNING:SUSPECT_CODE_INDENT: suspect code indent for conditional statements (16, 32)
#303: FILE: drivers/infiniband/core/user_mad.c:341:
+		} else if ((rmpp_mad->mad_hdr.mgmt_class >= IB_MGMT_CLASS_VENDOR_RANGE2_START) &&
[...]
+				hdr_len = offsetof(struct ib_vendor_mad, data);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#320: FILE: drivers/infiniband/core/user_mad.c:358:
+^I$

CHECK:SPACING: No space is necessary after a cast
#335: FILE: drivers/infiniband/core/user_mad.c:373:
+	packet->msg->send_wr.wr_id = (unsigned long) packet;

CHECK:SPACING: No space is necessary after a cast
#353: FILE: drivers/infiniband/core/user_mad.c:391:
+		if (copy_from_user(((struct ib_rmpp_mad *) packet->msg->mad)->data,

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#354: FILE: drivers/infiniband/core/user_mad.c:392:
+				   buf + sizeof (struct ib_user_mad) + rmpp_hdr_size,

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#427: FILE: drivers/infiniband/core/user_mad.c:421:
+	return sizeof (struct ib_user_mad_hdr) + packet->length;

WARNING:TYPO_SPELLING: 'filp' may be misspelled - perhaps 'flip'?
#455: FILE: drivers/infiniband/core/user_mad.c:552:
+static long ib_umad_ioctl(struct file *filp, unsigned int cmd,
                                        ^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#468: FILE: drivers/infiniband/core/user_mad.c:609:
+^I.owner ^I ^I= THIS_MODULE,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#469: FILE: drivers/infiniband/core/user_mad.c:610:
+^I.read ^I ^I= ib_umad_read,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#470: FILE: drivers/infiniband/core/user_mad.c:611:
+^I.write ^I ^I= ib_umad_write,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#471: FILE: drivers/infiniband/core/user_mad.c:612:
+^I.poll ^I ^I= ib_umad_poll,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#476: FILE: drivers/infiniband/core/user_mad.c:614:
+^I.compat_ioctl ^I= ib_umad_ioctl,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#477: FILE: drivers/infiniband/core/user_mad.c:615:
+^I.open ^I ^I= ib_umad_open,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#478: FILE: drivers/infiniband/core/user_mad.c:616:
+^I.release ^I= ib_umad_close$

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000168646.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 3 errors, 40 warnings, 7 checks, 432 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000168646.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
