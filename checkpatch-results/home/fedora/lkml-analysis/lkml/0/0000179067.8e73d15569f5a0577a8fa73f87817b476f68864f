WARNING:TYPO_SPELLING: 'improvments' may be misspelled - perhaps 'improvements'?
#21: 
Subject: Re: Fwd: [PATCH] tuner-core.c improvments and Ymec Tvision TVF8533MF
                                       ^^^^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:TYPO_SPELLING: 'dettach' may be misspelled - perhaps 'detach'?
#50: 
>        - Tuner I2C dettach now generates a warning on syslog if failed.
                     ^^^^^^^

WARNING:COMMIT_LOG_LONG_LINE: Possible unwrapped commit description (prefer a maximum 75 chars per line)
#69: 
diff -ur linux-2.6.12-rc5-mm.org/drivers/media/video/Kconfig linux-2.6.12-rc5-mm/drivers/media/video/Kconfig

WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#76: FILE: drivers/media/video/Kconfig:10:
+config CONFIG_TUNER_MULTI_I2C
+	bool "Enable support for multiple I2C devices on Video Adapters (EXPERIMENTAL)"
+	depends on VIDEO_DEV && EXPERIMENTAL
+	---help---
+	  Some video adapters have more than one tuner inside. This patch 
+	  enables support for using more than one tuner. This is required
+	  for some cards to allow tunning  both video and radio.
+	  It also improves I2C autodetection for these cards.
+
+	  Only few tuners currently is supporting this. More to come.
+
+	  It is safe to say 'Y' here even if your card has only one I2C tuner.
+

Kconfig symbols should have a help text which fully describes
it.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#80: FILE: drivers/media/video/Kconfig:14:
+^I  Some video adapters have more than one tuner inside. This patch $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:TYPO_SPELLING: 'tunning' may be misspelled - perhaps 'tuning'?
#82: FILE: drivers/media/video/Kconfig:16:
+	  for some cards to allow tunning  both video and radio.
 	                          ^^^^^^^

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#98: FILE: drivers/media/video/tuner-core.c:2:
+ * $Id: tuner-core.c,v 1.7 2005/05/30 02:02:47 mchehab Exp $

Since linux moved to git, the CVS markers are no longer used.
So, CVS style keywords ($Id$, $Revision$, $Log$) should not be
added.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#132: FILE: drivers/media/video/tuner-core.c:140:
+^I$

ERROR:CODE_INDENT: code indent should use tabs where possible
#135: FILE: drivers/media/video/tuner-core.c:143:
+ ^I^Iradio_tuner=tun_addr->addr;$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#135: FILE: drivers/media/video/tuner-core.c:143:
+ ^I^Iradio_tuner=tun_addr->addr;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#135: FILE: drivers/media/video/tuner-core.c:143:
+ ^I^Iradio_tuner=tun_addr->addr;$

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#135: FILE: drivers/media/video/tuner-core.c:143:
+ 		radio_tuner=tun_addr->addr;
  		           ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:SPACING: space required after that ',' (ctx:VxV)
#136: FILE: drivers/media/video/tuner-core.c:144:
+		tuner_dbg("radio tuner set to I2C address 0x%02x\n",radio_tuner<<1);
 		                                                   ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#136: FILE: drivers/media/video/tuner-core.c:144:
+		tuner_dbg("radio tuner set to I2C address 0x%02x\n",radio_tuner<<1);
 		                                                               ^

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#140: FILE: drivers/media/video/tuner-core.c:148:
+		tv_tuner=tun_addr->addr;
 		        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#141: FILE: drivers/media/video/tuner-core.c:149:
+		tuner_dbg("TV tuner set to I2C address 0x%02x\n",tv_tuner<<1);
 		                                                ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#141: FILE: drivers/media/video/tuner-core.c:149:
+		tuner_dbg("TV tuner set to I2C address 0x%02x\n",tv_tuner<<1);
 		                                                         ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#146: FILE: drivers/media/video/tuner-core.c:154:
+#define set_addr(c,tun_addr) \
                   ^

WARNING:TRAILING_SEMICOLON: macros should not use a trailing semicolon
#146: FILE: drivers/media/video/tuner-core.c:154:
+#define set_addr(c,tun_addr) \
+		tuner_warn("It is recommended to enable CONFIG_TUNER_MULTI_I2C for this card.\n");

Macro definition should not end with a semicolon. The macro
invocation style should be consistent with function calls.
This can prevent any unexpected code paths::

  #define MAC do_something;

If this macro is used within a if else statement, like::

  if (some_condition)
          MAC;

  else
          do_something;

Then there would be a compilation error, because when the macro is
expanded there are two trailing semicolons, so the else branch gets
orphaned.

See: https://lore.kernel.org/lkml/1399671106.2912.21.camel@joe-AO725/

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#189: FILE: drivers/media/video/tuner-core.c:284:
+	err=i2c_detach_client(&t->i2c);
 	   ^

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#191: FILE: drivers/media/video/tuner-core.c:286:
+		tuner_warn ("Client deregistration failed, client not detached.\n");

ERROR:TRAILING_WHITESPACE: trailing whitespace
#194: FILE: drivers/media/video/tuner-core.c:289:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#203: FILE: drivers/media/video/tuner-core.c:300:
+^I^I^I  $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#205: FILE: drivers/media/video/tuner-core.c:302:
+#define CHECK_ADDR(tp,cmd)	if (client->addr!=tp) { \
                      ^

ERROR:SPACING: spaces required around that '!=' (ctx:VxV)
#205: FILE: drivers/media/video/tuner-core.c:302:
+#define CHECK_ADDR(tp,cmd)	if (client->addr!=tp) { \
                           	                ^

ERROR:MULTISTATEMENT_MACRO_USE_DO_WHILE: Macros starting with if should be enclosed by a do - while loop to avoid possible if/else logic defects
#205: FILE: drivers/media/video/tuner-core.c:302:
+#define CHECK_ADDR(tp,cmd)	if (client->addr!=tp) { \
+			  tuner_info ("Cmd %s to addr 0x%02x rejected.\n",cmd,client->addr<<1); \
+			  return 0; }

Macros with multiple statements should be enclosed in a
do - while block.  Same should also be the case for macros
starting with `if` to avoid logic defects::

  #define macrofun(a, b, c)                 \
    do {                                    \
            if (a == 5)                     \
                    do_this(b, c);          \
    } while (0)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#macros-enums-and-rtl

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'tp' may be better as '(tp)' to avoid precedence issues
#205: FILE: drivers/media/video/tuner-core.c:302:
+#define CHECK_ADDR(tp,cmd)	if (client->addr!=tp) { \
+			  tuner_info ("Cmd %s to addr 0x%02x rejected.\n",cmd,client->addr<<1); \
+			  return 0; }

WARNING:MACRO_WITH_FLOW_CONTROL: Macros with flow control statements should be avoided
#205: FILE: drivers/media/video/tuner-core.c:302:
+#define CHECK_ADDR(tp,cmd)	if (client->addr!=tp) { \
+			  tuner_info ("Cmd %s to addr 0x%02x rejected.\n",cmd,client->addr<<1); \
+			  return 0; }

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#206: FILE: drivers/media/video/tuner-core.c:303:
+			  tuner_info ("Cmd %s to addr 0x%02x rejected.\n",cmd,client->addr<<1); \

ERROR:SPACING: space required after that ',' (ctx:VxV)
#206: FILE: drivers/media/video/tuner-core.c:303:
+			  tuner_info ("Cmd %s to addr 0x%02x rejected.\n",cmd,client->addr<<1); \
 			                                                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#206: FILE: drivers/media/video/tuner-core.c:303:
+			  tuner_info ("Cmd %s to addr 0x%02x rejected.\n",cmd,client->addr<<1); \
 			                                                     ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#206: FILE: drivers/media/video/tuner-core.c:303:
+			  tuner_info ("Cmd %s to addr 0x%02x rejected.\n",cmd,client->addr<<1); \
 			                                                                  ^

WARNING:TABSTOP: Statements should start on a tabstop
#207: FILE: drivers/media/video/tuner-core.c:304:
+			  return 0; }

ERROR:MULTISTATEMENT_MACRO_USE_DO_WHILE: Macros starting with if should be enclosed by a do - while loop to avoid possible if/else logic defects
#208: FILE: drivers/media/video/tuner-core.c:305:
+#define CHECK_MODE(cmd)	if (t->mode == V4L2_TUNER_RADIO) { \
+			  CHECK_ADDR(radio_tuner,cmd) } else { CHECK_ADDR(tv_tuner,cmd); }

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'cmd' - possible side-effects?
#208: FILE: drivers/media/video/tuner-core.c:305:
+#define CHECK_MODE(cmd)	if (t->mode == V4L2_TUNER_RADIO) { \
+			  CHECK_ADDR(radio_tuner,cmd) } else { CHECK_ADDR(tv_tuner,cmd); }

ERROR:SPACING: space required after that ',' (ctx:VxV)
#209: FILE: drivers/media/video/tuner-core.c:306:
+			  CHECK_ADDR(radio_tuner,cmd) } else { CHECK_ADDR(tv_tuner,cmd); }
 			                        ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#209: FILE: drivers/media/video/tuner-core.c:306:
+			  CHECK_ADDR(radio_tuner,cmd) } else { CHECK_ADDR(tv_tuner,cmd); }
 			                                                          ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#211: FILE: drivers/media/video/tuner-core.c:308:
+#define CHECK_ADDR(tp,cmd)
                      ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#214: FILE: drivers/media/video/tuner-core.c:311:
+^I^I^I  $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#228: FILE: drivers/media/video/tuner-core.c:324:
+		set_addr(client,(struct tuner_addr *)arg);
 		               ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#231: FILE: drivers/media/video/tuner-core.c:327:
+		CHECK_ADDR(radio_tuner,"AUDC_SET_RADIO");
 		                      ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#232: FILE: drivers/media/video/tuner-core.c:328:
+^I^I$

ERROR:SPACING: space required after that ',' (ctx:VxV)
#239: FILE: drivers/media/video/tuner-core.c:335:
+		CHECK_ADDR(tv_tuner,"AUDC_CONFIG_PINNACLE");
 		                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#247: FILE: drivers/media/video/tuner-core.c:363:
+		CHECK_ADDR(tv_tuner,"VIDIOCSCHAN");
 		                   ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#263: FILE: drivers/media/video/tuner-core.c:386:
+		CHECK_ADDR(radio_tuner,"VIDIOCGTUNER:");
 		                      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#271: FILE: drivers/media/video/tuner-core.c:396:
+		CHECK_ADDR(radio_tuner,"VIDIOCGAUDIO");
 		                      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#279: FILE: drivers/media/video/tuner-core.c:409:
+		CHECK_ADDR(tv_tuner,"VIDIOC_S_STD");
 		                   ^

WARNING:CVS_KEYWORD: CVS style keyword markers, these will _not_ be updated
#313: FILE: drivers/media/video/tuner-simple.c:2:
+ * $Id: tuner-simple.c,v 1.14 2005/05/30 02:02:47 mchehab Exp $

CHECK:CAMELCASE: Avoid CamelCase: <Philips>
#322: FILE: drivers/media/video/tuner-simple.c:216:
+	{ "Ymec TVision TVF-8531MF", Philips, NTSC,

Avoid CamelCase Identifiers.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#naming

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	           ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	                     ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	                          ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	                               ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#323: FILE: drivers/media/video/tuner-simple.c:217:
+	  16*160.00,16*454.00,0xa0,0x90,0x30,0x8e,732},
 	                                         ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	           ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	                     ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	                          ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	                               ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	                                    ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#325: FILE: drivers/media/video/tuner-simple.c:219:
+	  16*160.00,16*454.00,0x01,0x02,0x04,0x8e,732},
 	                                         ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#334: FILE: drivers/media/video/tuner-simple.c:433:
+^I^I$

WARNING:TYPO_SPELLING: 'determinated' may be misspelled - perhaps 'determined'?
#335: FILE: drivers/media/video/tuner-simple.c:434:
+		/*These values are empirically determinated */
 		                               ^^^^^^^^^^^^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#336: FILE: drivers/media/video/tuner-simple.c:435:
+		div = (freq*122)/16 - 20;
 		           ^

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#336: FILE: drivers/media/video/tuner-simple.c:435:
+		div = (freq*122)/16 - 20;
 		                ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#348: FILE: drivers/media/video/tuner-simple.c:472:
+^I$

CHECK:SPACING: spaces preferred around that '>>' (ctx:VxV)
#352: FILE: drivers/media/video/tuner-simple.c:476:
+			struct tuner_addr tun_addr = { V4L2_TUNER_ANALOG_TV, 0xc2>>1 };
 			                                                         ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#353: FILE: drivers/media/video/tuner-simple.c:477:
+^I^I^I$

WARNING:BRACES: braces {} are not necessary for any arm of this statement
#354: FILE: drivers/media/video/tuner-simple.c:478:
+			if (c->driver->command) {
[...]
+			} else {
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:LONG_LINE: line length of 109 exceeds 100 columns
#357: FILE: drivers/media/video/tuner-simple.c:481:
+				tuner_warn("Couldn't set TV tuner I2C address to 0x%02x\n",tun_addr.addr<<1);

The line has exceeded the specified maximum length.
To use a different maximum line length, the --max-line-length=n option
may be added while invoking checkpatch.

Earlier, the default line length was 80 columns.  Commit bdc48fa11e46
("checkpatch/coding-style: deprecate 80-column warning") increased the
limit to 100 columns.  This is not a hard limit either and it's
preferable to stay within 80 columns whenever possible.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings

ERROR:SPACING: space required after that ',' (ctx:VxV)
#357: FILE: drivers/media/video/tuner-simple.c:481:
+				tuner_warn("Couldn't set TV tuner I2C address to 0x%02x\n",tun_addr.addr<<1);
 				                                                          ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#357: FILE: drivers/media/video/tuner-simple.c:481:
+				tuner_warn("Couldn't set TV tuner I2C address to 0x%02x\n",tun_addr.addr<<1);
 				                                                                        ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#362: FILE: drivers/media/video/tuner-simple.c:486:
+^I$

ERROR:SPACING: space required after that ',' (ctx:VxV)
#383: FILE: include/media/tuner.h:127:
+#define TUNER_SET_ADDR               _IOW('T',3,int)	/* Chooses tuner I2C address */
                                              ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#383: FILE: include/media/tuner.h:127:
+#define TUNER_SET_ADDR               _IOW('T',3,int)	/* Chooses tuner I2C address */
                                                ^

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000179067.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 48 errors, 17 warnings, 14 checks, 296 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000179067.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
