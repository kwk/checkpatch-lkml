WARNING:COMMIT_LOG_LONG_LINE: Possible unwrapped commit description (prefer a maximum 75 chars per line)
#25: 
Subject: [patch 14/28] drivers/input/keyboard: convert to dynamic input_dev allocation

WARNING:LONG_LINE: line length of 110 exceeds 100 columns
#112: FILE: drivers/input/keyboard/atkbd.c:393:
+				(1 + (!atkbd->softrepeat && test_bit(atkbd->keycode[code], atkbd->dev->key)));

The line has exceeded the specified maximum length.
To use a different maximum line length, the --max-line-length=n option
may be added while invoking checkpatch.

Earlier, the default line length was 80 columns.  Commit bdc48fa11e46
("checkpatch/coding-style: deprecate 80-column warning") increased the
limit to 100 columns.  This is not a hard limit either and it's
preferable to stay within 80 columns whenever possible.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#breaking-long-lines-and-strings

WARNING:LONG_LINE: line length of 113 exceeds 100 columns
#121: FILE: drivers/input/keyboard/atkbd.c:401:
+					atkbd->time = jiffies + msecs_to_jiffies(atkbd->dev->rep[REP_DELAY]) / 2;

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*atkbd)...) over kzalloc(sizeof(struct atkbd)...)
#270: FILE: drivers/input/keyboard/atkbd.c:806:
+	atkbd = kzalloc(sizeof(struct atkbd), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

ERROR:CODE_INDENT: code indent should use tabs where possible
#347: FILE: drivers/input/keyboard/atkbd.c:897:
+^I^I         | (test_bit(LED_NUML,    atkbd->dev->led) ? 2 : 0)$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

ERROR:CODE_INDENT: code indent should use tabs where possible
#348: FILE: drivers/input/keyboard/atkbd.c:898:
+^I^I         | (test_bit(LED_CAPSL,   atkbd->dev->led) ? 4 : 0);$

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#371: FILE: drivers/input/keyboard/atkbd.c:1025:
+		if (!(new_dev = input_allocate_device()))

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#397: FILE: drivers/input/keyboard/atkbd.c:1053:
+		if (!(new_dev = input_allocate_device()))

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#423: FILE: drivers/input/keyboard/atkbd.c:1084:
+		if (!(new_dev = input_allocate_device()))

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#450: FILE: drivers/input/keyboard/atkbd.c:1116:
+		if (!(new_dev = input_allocate_device()))

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#479: FILE: drivers/input/keyboard/atkbd.c:1146:
+		if (!(new_dev = input_allocate_device()))

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#541: FILE: drivers/input/keyboard/amikbd.c:204:
+		printk(KERN_ERR "amikbd: not enough memory for input device\n");

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#609: FILE: drivers/input/keyboard/lkkbd.c:277:
+	if (test_bit (LED, lk->dev->led))	\

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#628: FILE: drivers/input/keyboard/lkkbd.c:426:
+		DBG (KERN_INFO "Ignoring a byte on %s\n", lk->name);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#637: FILE: drivers/input/keyboard/lkkbd.c:437:
+			input_regs (lk->dev, regs);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#642: FILE: drivers/input/keyboard/lkkbd.c:440:
+					input_report_key (lk->dev, lk->keycode[i], 0);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#643: FILE: drivers/input/keyboard/lkkbd.c:441:
+			input_sync (lk->dev);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#647: FILE: drivers/input/keyboard/lkkbd.c:444:
+			DBG (KERN_INFO "Got %#d and don't "

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#658: FILE: drivers/input/keyboard/lkkbd.c:484:
+				input_regs (lk->dev, regs);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#659: FILE: drivers/input/keyboard/lkkbd.c:485:
+				if (!test_bit (lk->keycode[data], lk->dev->key))

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#660: FILE: drivers/input/keyboard/lkkbd.c:486:
+					input_report_key (lk->dev, lk->keycode[data], 1);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#664: FILE: drivers/input/keyboard/lkkbd.c:488:
+					input_report_key (lk->dev, lk->keycode[data], 0);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#665: FILE: drivers/input/keyboard/lkkbd.c:489:
+				input_sync (lk->dev);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#674: FILE: drivers/input/keyboard/lkkbd.c:607:
+	if (test_bit (SND_CLICK, lk->dev->snd)) {

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#683: FILE: drivers/input/keyboard/lkkbd.c:618:
+	if (test_bit (SND_BELL, lk->dev->snd))

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#711: FILE: drivers/input/keyboard/lkkbd.c:633:
+	lk = kzalloc (sizeof (struct lkkbd), GFP_KERNEL);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#711: FILE: drivers/input/keyboard/lkkbd.c:633:
+	lk = kzalloc (sizeof (struct lkkbd), GFP_KERNEL);

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*lk)...) over kzalloc(sizeof (struct lkkbd)...)
#711: FILE: drivers/input/keyboard/lkkbd.c:633:
+	lk = kzalloc (sizeof (struct lkkbd), GFP_KERNEL);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#712: FILE: drivers/input/keyboard/lkkbd.c:634:
+	input_dev = input_allocate_device ();

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#726: FILE: drivers/input/keyboard/lkkbd.c:646:
+	memcpy (lk->keycode, lkkbd_keycode, sizeof (lk_keycode_t) * LK_NUM_KEYCODES);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#726: FILE: drivers/input/keyboard/lkkbd.c:646:
+	memcpy (lk->keycode, lkkbd_keycode, sizeof (lk_keycode_t) * LK_NUM_KEYCODES);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#731: FILE: drivers/input/keyboard/lkkbd.c:648:
+	strlcpy (lk->name, "DEC LK keyboard", sizeof(lk->name));

WARNING:STRLCPY: Prefer strscpy over strlcpy - see: https://lore.kernel.org/r/CAHk-=wgfRnXz0W3D37d01q3JFkr_i_uTL=V6A6G1oUZcprmknw@mail.gmail.com/
#731: FILE: drivers/input/keyboard/lkkbd.c:648:
+	strlcpy (lk->name, "DEC LK keyboard", sizeof(lk->name));

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#732: FILE: drivers/input/keyboard/lkkbd.c:649:
+	snprintf (lk->phys, sizeof(lk->phys), "%s/input0", serio->phys);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#746: FILE: drivers/input/keyboard/lkkbd.c:661:
+	set_bit (EV_KEY, input_dev->evbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#747: FILE: drivers/input/keyboard/lkkbd.c:662:
+	set_bit (EV_LED, input_dev->evbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#748: FILE: drivers/input/keyboard/lkkbd.c:663:
+	set_bit (EV_SND, input_dev->evbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#749: FILE: drivers/input/keyboard/lkkbd.c:664:
+	set_bit (EV_REP, input_dev->evbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#750: FILE: drivers/input/keyboard/lkkbd.c:665:
+	set_bit (LED_CAPSL, input_dev->ledbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#751: FILE: drivers/input/keyboard/lkkbd.c:666:
+	set_bit (LED_SLEEP, input_dev->ledbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#752: FILE: drivers/input/keyboard/lkkbd.c:667:
+	set_bit (LED_COMPOSE, input_dev->ledbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#753: FILE: drivers/input/keyboard/lkkbd.c:668:
+	set_bit (LED_SCROLLL, input_dev->ledbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#754: FILE: drivers/input/keyboard/lkkbd.c:669:
+	set_bit (SND_BELL, input_dev->sndbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#755: FILE: drivers/input/keyboard/lkkbd.c:670:
+	set_bit (SND_CLICK, input_dev->sndbit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#758: FILE: drivers/input/keyboard/lkkbd.c:673:
+	input_dev->keycodesize = sizeof (lk_keycode_t);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#761: FILE: drivers/input/keyboard/lkkbd.c:676:
+		set_bit (lk->keycode[i], input_dev->keybit);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#792: FILE: drivers/input/keyboard/lkkbd.c:684:
+	input_register_device (lk->dev);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#797: FILE: drivers/input/keyboard/lkkbd.c:689:
+ fail:	serio_set_drvdata (serio, NULL);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#798: FILE: drivers/input/keyboard/lkkbd.c:690:
+	input_free_device (input_dev);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#799: FILE: drivers/input/keyboard/lkkbd.c:691:
+	kfree (lk);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#809: FILE: drivers/input/keyboard/lkkbd.c:703:
+	input_get_device (lk->dev);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#810: FILE: drivers/input/keyboard/lkkbd.c:704:
+	input_unregister_device (lk->dev);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#813: FILE: drivers/input/keyboard/lkkbd.c:707:
+	input_put_device (lk->dev);

WARNING:LONG_LINE: line length of 106 exceeds 100 columns
#845: FILE: drivers/input/keyboard/corgikbd.c:171:
+			input_report_key(corgikbd_data->input, corgikbd_data->keycode[scancode], pressed);

WARNING:LONG_LINE: line length of 118 exceeds 100 columns
#873: FILE: drivers/input/keyboard/corgikbd.c:251:
+			input_report_switch(corgikbd_data->input, SW_0, ((sharpsl_hinge_state & CORGI_SCP_SWA) != 0));

WARNING:LONG_LINE: line length of 118 exceeds 100 columns
#874: FILE: drivers/input/keyboard/corgikbd.c:252:
+			input_report_switch(corgikbd_data->input, SW_1, ((sharpsl_hinge_state & CORGI_SCP_SWB) != 0));

WARNING:LONG_LINE: line length of 120 exceeds 100 columns
#998: FILE: drivers/input/keyboard/xtkbd.c:79:
+				input_report_key(xtkbd->dev, xtkbd->keycode[data & XTKBD_KEY], !(data & XTKBD_RELEASE));

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*xtkbd)...) over kmalloc(sizeof(struct xtkbd)...)
#1018: FILE: drivers/input/keyboard/xtkbd.c:96:
+	xtkbd = kmalloc(sizeof(struct xtkbd), GFP_KERNEL);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1132: FILE: drivers/input/keyboard/newtonkbd.c:80:
+		printk(KERN_INFO "input: %s on %s\n", nkbd->dev->name, serio->phys);

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*nkbd)...) over kzalloc(sizeof(struct nkbd)...)
#1151: FILE: drivers/input/keyboard/newtonkbd.c:92:
+	nkbd = kzalloc(sizeof(struct nkbd), GFP_KERNEL);

WARNING:LONG_LINE: line length of 124 exceeds 100 columns
#1265: FILE: drivers/input/keyboard/sunkbd.c:133:
+                                input_report_key(sunkbd->dev, sunkbd->keycode[data & SUNKBD_KEY], !(data & SUNKBD_RELEASE));

ERROR:CODE_INDENT: code indent should use tabs where possible
#1265: FILE: drivers/input/keyboard/sunkbd.c:133:
+                                input_report_key(sunkbd->dev, sunkbd->keycode[data & SUNKBD_KEY], !(data & SUNKBD_RELEASE));$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#1265: FILE: drivers/input/keyboard/sunkbd.c:133:
+                                input_report_key(sunkbd->dev, sunkbd->keycode[data & SUNKBD_KEY], !(data & SUNKBD_RELEASE));$

WARNING:LONG_LINE: line length of 115 exceeds 100 columns
#1287: FILE: drivers/input/keyboard/sunkbd.c:220:
+		(!!test_bit(LED_CAPSL, sunkbd->dev->led) << 3) | (!!test_bit(LED_SCROLLL, sunkbd->dev->led) << 2) |

WARNING:LONG_LINE: line length of 107 exceeds 100 columns
#1288: FILE: drivers/input/keyboard/sunkbd.c:221:
+		(!!test_bit(LED_COMPOSE, sunkbd->dev->led) << 1) | !!test_bit(LED_NUML, sunkbd->dev->led));

WARNING:LONG_LINE: line length of 106 exceeds 100 columns
#1289: FILE: drivers/input/keyboard/sunkbd.c:222:
+	sunkbd->serio->write(sunkbd->serio, SUNKBD_CMD_NOCLICK - !!test_bit(SND_CLICK, sunkbd->dev->snd));

WARNING:LONG_LINE: line length of 105 exceeds 100 columns
#1290: FILE: drivers/input/keyboard/sunkbd.c:223:
+	sunkbd->serio->write(sunkbd->serio, SUNKBD_CMD_BELLOFF - !!test_bit(SND_BELL, sunkbd->dev->snd));

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*sunkbd)...) over kzalloc(sizeof(struct sunkbd)...)
#1321: FILE: drivers/input/keyboard/sunkbd.c:244:
+	sunkbd = kzalloc(sizeof(struct sunkbd), GFP_KERNEL);

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#1458: FILE: drivers/input/keyboard/maple_keyb.c:55:
+	for (i = 2; i < 8; i++) {
+

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!memscan"
#1459: FILE: drivers/input/keyboard/maple_keyb.c:56:
+		if (kbd->old[i] > 3 && memscan(kbd->new + 2, kbd->old[i], 6) == NULL) {

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "memscan"
#1468: FILE: drivers/input/keyboard/maple_keyb.c:64:
+		if (kbd->new[i] > 3 && memscan(kbd->old + 2, kbd->new[i], 6) != NULL) {

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#1510: FILE: drivers/input/keyboard/maple_keyb.c:98:
+	dev->private_data = kbd = kzalloc(sizeof(struct dc_kbd), GFP_KERNEL);

Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*kbd)...) over kzalloc(sizeof(struct dc_kbd)...)
#1510: FILE: drivers/input/keyboard/maple_keyb.c:98:
+	dev->private_data = kbd = kzalloc(sizeof(struct dc_kbd), GFP_KERNEL);

WARNING:LONG_LINE: line length of 106 exceeds 100 columns
#1578: FILE: drivers/input/keyboard/spitzkbd.c:212:
+			input_report_key(spitzkbd_data->input, spitzkbd_data->keycode[scancode], pressed);

WARNING:LONG_LINE: line length of 122 exceeds 100 columns
#1588: FILE: drivers/input/keyboard/spitzkbd.c:222:
+	input_report_key(spitzkbd_data->input, SPITZ_KEY_SYNC, (GPLR(SPITZ_GPIO_SYNC) & GPIO_bit(SPITZ_GPIO_SYNC)) != 0 );

ERROR:SPACING: space prohibited before that close parenthesis ')'
#1588: FILE: drivers/input/keyboard/spitzkbd.c:222:
+	input_report_key(spitzkbd_data->input, SPITZ_KEY_SYNC, (GPLR(SPITZ_GPIO_SYNC) & GPIO_bit(SPITZ_GPIO_SYNC)) != 0 );

WARNING:LONG_LINE: line length of 122 exceeds 100 columns
#1617: FILE: drivers/input/keyboard/spitzkbd.c:301:
+		input_report_switch(spitzkbd_data->input, SW_0, ((GPLR(SPITZ_GPIO_SWA) & GPIO_bit(SPITZ_GPIO_SWA)) != 0));

WARNING:LONG_LINE: line length of 122 exceeds 100 columns
#1618: FILE: drivers/input/keyboard/spitzkbd.c:302:
+		input_report_switch(spitzkbd_data->input, SW_1, ((GPLR(SPITZ_GPIO_SWB) & GPIO_bit(SPITZ_GPIO_SWB)) != 0));

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000150991.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 9 errors, 59 warnings, 10 checks, 1552 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000150991.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
