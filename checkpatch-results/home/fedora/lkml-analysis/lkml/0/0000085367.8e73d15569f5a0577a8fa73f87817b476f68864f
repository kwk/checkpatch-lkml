WARNING:COMMIT_LOG_LONG_LINE: Possible unwrapped commit description (prefer a maximum 75 chars per line)
#54: 
- be able to control/know which processes share a socket, and which processes 

WARNING:TYPO_SPELLING: 'childs' may be misspelled - perhaps 'children'?
#72: 
it has access to all the sockets of its childs (domains). The same for 
                                        ^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#271: FILE: hooks.c:1:
+

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:EMBEDDED_FILENAME: It's generally not useful to have the filename in the file
#278: FILE: hooks.c:8:
+ *  Based on the SELinux hooks.c

Embedding the complete filename path inside the file isn't particularly
useful as often the path is moved around and becomes incorrect.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#281: FILE: hooks.c:11:
+ *  Its sole purpose is to label processes, and files, so that the sk_filter $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:CORRUPTED_PATCH: patch seems to be corrupt (line wrapped?)
#282: FILE: hooks.c:11:
context match

The patch seems to be corrupted or lines are wrapped.
Please regenerate the patch file before sending it to the maintainer.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#285: FILE: hooks.c:14:
+ *  You shouldn't use SELinux and Fireflier LSM at the same time $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#287: FILE: hooks.c:16:
+ *   - Having SELinux compiled in your kernel, and disabled at boot, and $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#289: FILE: hooks.c:17:
+ *   - Having SELinux compiled in your kernel, and enabled at boot, and $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#291: FILE: hooks.c:18:
+ *^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#292: FILE: hooks.c:19:
+ *  Currently you have to turn off the capability module $

ERROR:INITIALISED_STATIC: do not initialise statics to NULL
#318: FILE: hooks.c:44:
+static struct security_operations *original_ops = NULL;

Static variables should not be initialized explicitly to zero.
Your compiler (or rather your loader) automatically does
it for you.

ERROR:INITIALISED_STATIC: do not initialise statics to NULL
#319: FILE: hooks.c:45:
+static struct security_operations *secondary_ops = NULL;

CHECK:LINE_SPACING: Please don't use multiple blank lines
#322: FILE: hooks.c:48:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:COMPLEX_MACRO: Macros with complex values should be enclosed in parentheses
#324: FILE: hooks.c:50:
+#define XATTR_NAME_FIREFLIER XATTR_SECURITY_PREFIX XATTR_FIREFLIER_SUFFIX

CHECK:LINE_SPACING: Please don't use multiple blank lines
#326: FILE: hooks.c:52:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#331: FILE: hooks.c:57:
+ * @ops:  the stacked module's security_operations $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#333: FILE: hooks.c:59:
+static int fireflier_register_security (const char *name, struct $

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#333: FILE: hooks.c:59:
+static int fireflier_register_security (const char *name, struct 

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:CODE_INDENT: code indent should use tabs where possible
#336: FILE: hooks.c:61:
+        if (secondary_ops != original_ops)$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#336: FILE: hooks.c:61:
+        if (secondary_ops != original_ops)$

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#336: FILE: hooks.c:61:
+        if (secondary_ops != original_ops)
+        {

The opening brace should be following the function definitions on the
next line.  For any non-functional block it should be on the same line
as the last construct.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

ERROR:CODE_INDENT: code indent should use tabs where possible
#337: FILE: hooks.c:62:
+        {$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#337: FILE: hooks.c:62:
+        {$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#338: FILE: hooks.c:63:
+                printk(KERN_INFO "%s:  There is already a secondary $

ERROR:CODE_INDENT: code indent should use tabs where possible
#338: FILE: hooks.c:63:
+                printk(KERN_INFO "%s:  There is already a secondary $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#338: FILE: hooks.c:63:
+                printk(KERN_INFO "%s:  There is already a secondary $

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#338: FILE: hooks.c:63:
+                printk(KERN_INFO "%s:  There is already a secondary 

ERROR:CODE_INDENT: code indent should use tabs where possible
#340: FILE: hooks.c:64:
+                       "module registered.\n", __FUNCTION__);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#340: FILE: hooks.c:64:
+                       "module registered.\n", __FUNCTION__);$

ERROR:CODE_INDENT: code indent should use tabs where possible
#341: FILE: hooks.c:65:
+                return -EINVAL;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#341: FILE: hooks.c:65:
+                return -EINVAL;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#342: FILE: hooks.c:66:
+        }$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#342: FILE: hooks.c:66:
+        }$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#343: FILE: hooks.c:67:
+^I$

ERROR:CODE_INDENT: code indent should use tabs where possible
#344: FILE: hooks.c:68:
+        secondary_ops = ops;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#344: FILE: hooks.c:68:
+        secondary_ops = ops;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#345: FILE: hooks.c:69:
+^I$

ERROR:CODE_INDENT: code indent should use tabs where possible
#346: FILE: hooks.c:70:
+        printk(KERN_INFO "%s:  Registering secondary module %s\n",$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#346: FILE: hooks.c:70:
+        printk(KERN_INFO "%s:  Registering secondary module %s\n",$

CHECK:SPACING: spaces preferred around that '%' (ctx:VxV)
#346: FILE: hooks.c:70:
+        printk(KERN_INFO "%s:  Registering secondary module %s\n",
                           ^

ERROR:SPACING: spaces required around that ':' (ctx:VxW)
#346: FILE: hooks.c:70:
+        printk(KERN_INFO "%s:  Registering secondary module %s\n",
                             ^

CHECK:SPACING: spaces preferred around that '%' (ctx:WxV)
#346: FILE: hooks.c:70:
+        printk(KERN_INFO "%s:  Registering secondary module %s\n",
                                                             ^

CHECK:CAMELCASE: Avoid CamelCase: <Registering>
#346: FILE: hooks.c:70:
+        printk(KERN_INFO "%s:  Registering secondary module %s\n",

Avoid CamelCase Identifiers.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#naming

ERROR:CODE_INDENT: code indent should use tabs where possible
#347: FILE: hooks.c:71:
+               __FUNCTION__,$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#347: FILE: hooks.c:71:
+               __FUNCTION__,$

ERROR:CODE_INDENT: code indent should use tabs where possible
#348: FILE: hooks.c:72:
+               name);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#348: FILE: hooks.c:72:
+               name);$

ERROR:CODE_INDENT: code indent should use tabs where possible
#350: FILE: hooks.c:74:
+        return 0;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#350: FILE: hooks.c:74:
+        return 0;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#354: FILE: hooks.c:78:
+ * fireflier_unregister_security - unregister a stacked security $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#354: FILE: hooks.c:78:
+ * fireflier_unregister_security - unregister a stacked security $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#355: FILE: hooks.c:79:
+ * @name: the name of the secondary security module to unregister$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#356: FILE: hooks.c:80:
+ * @ops:  the security_operations of the stacked module$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#357: FILE: hooks.c:81:
+ */$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#358: FILE: hooks.c:82:
+static int fireflier_unregister_security (const char *name, struct $

ERROR:CODE_INDENT: code indent should use tabs where possible
#361: FILE: hooks.c:84:
+        if (ops != secondary_ops)$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#361: FILE: hooks.c:84:
+        if (ops != secondary_ops)$

ERROR:CODE_INDENT: code indent should use tabs where possible
#362: FILE: hooks.c:85:
+        {$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#362: FILE: hooks.c:85:
+        {$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#363: FILE: hooks.c:86:
+                printk (KERN_INFO "%s:  trying to unregister a security $

ERROR:CODE_INDENT: code indent should use tabs where possible
#363: FILE: hooks.c:86:
+                printk (KERN_INFO "%s:  trying to unregister a security $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#363: FILE: hooks.c:86:
+                printk (KERN_INFO "%s:  trying to unregister a security $

CHECK:SPACING: spaces preferred around that '%' (ctx:VxV)
#363: FILE: hooks.c:86:
+                printk (KERN_INFO "%s:  trying to unregister a security 
                                    ^

ERROR:SPACING: spaces required around that ':' (ctx:VxW)
#363: FILE: hooks.c:86:
+                printk (KERN_INFO "%s:  trying to unregister a security 
                                      ^

ERROR:CODE_INDENT: code indent should use tabs where possible
#365: FILE: hooks.c:87:
+                        "that is not registered.\n", __FUNCTION__);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#365: FILE: hooks.c:87:
+                        "that is not registered.\n", __FUNCTION__);$

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#365: FILE: hooks.c:87:
+                        "that is not registered.\n", __FUNCTION__);

ERROR:CODE_INDENT: code indent should use tabs where possible
#366: FILE: hooks.c:88:
+                return -EINVAL;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#366: FILE: hooks.c:88:
+                return -EINVAL;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#367: FILE: hooks.c:89:
+        }$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#367: FILE: hooks.c:89:
+        }$

ERROR:CODE_INDENT: code indent should use tabs where possible
#369: FILE: hooks.c:91:
+        secondary_ops = original_ops;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#369: FILE: hooks.c:91:
+        secondary_ops = original_ops;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#371: FILE: hooks.c:93:
+        return 0;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#371: FILE: hooks.c:93:
+        return 0;$

CHECK:LINE_SPACING: Please don't use multiple blank lines
#374: FILE: hooks.c:96:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#385: FILE: hooks.c:107:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#389: FILE: hooks.c:111:
+^I$

CHECK:LINE_SPACING: Please don't use multiple blank lines
#390: FILE: hooks.c:112:
+	
+

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#392: FILE: hooks.c:114:
+	tsec->osid = tsec->sid = tsec->ptrace_sid = FIREFLIER_SID_UNLABELED;

Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.

ERROR:TRAILING_WHITESPACE: trailing whitespace
#394: FILE: hooks.c:116:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#404: FILE: hooks.c:126:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#407: FILE: hooks.c:129:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#413: FILE: hooks.c:135:
+ * fireflier_task_alloc_security - allocate & initialize the security $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#424: FILE: hooks.c:145:
+
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#426: FILE: hooks.c:147:
+	int rc;
+	rc = task_alloc_security(tsk);

ERROR:SPACING: space required before the open parenthesis '('
#430: FILE: hooks.c:151:
+	if(tsec_current) {

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#436: FILE: hooks.c:157:
+		/* Retain ptracer SID across fork, if any.
+		   This will be reset by the ptrace hook upon any

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#437: FILE: hooks.c:158:
+		   subsequent ptrace_attach operations. */

CHECK:LINE_SPACING: Please don't use multiple blank lines
#444: FILE: hooks.c:165:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#446: FILE: hooks.c:167:
+ * fireflier_bprm_alloc_security - allocate & initialize a linux_bprm $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#449: FILE: hooks.c:169:
+ * Returns -ENOMEM on allocation failure, otherwise calls stacked security $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#461: FILE: hooks.c:180:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#467: FILE: hooks.c:186:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#475: FILE: hooks.c:194:
+ * this function is responsible for computing the SID of the process that is $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#484: FILE: hooks.c:202:
+^Ibsec = bprm->security;^I^I$

ERROR:SPACING: space required after that ',' (ctx:VxV)
#488: FILE: hooks.c:206:
+	bsec->sid = get_or_generate_sid(bprm->file,0);
 	                                          ^

ERROR:CODE_INDENT: code indent should use tabs where possible
#489: FILE: hooks.c:207:
+        printk(KERN_DEBUG "sid:%d\n",bsec->sid);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#489: FILE: hooks.c:207:
+        printk(KERN_DEBUG "sid:%d\n",bsec->sid);$

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#489: FILE: hooks.c:207:
+        printk(KERN_DEBUG "sid:%d\n",bsec->sid);

ERROR:SPACING: space required after that ',' (ctx:VxV)
#489: FILE: hooks.c:207:
+        printk(KERN_DEBUG "sid:%d\n",bsec->sid);
                                     ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#505: FILE: hooks.c:223:
+ * fireflier_bprm_apply_creds - compute the sid of the current task based on $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#517: FILE: hooks.c:234:
+
+

CHECK:LINE_SPACING: Please don't use multiple blank lines
#524: FILE: hooks.c:241:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#528: FILE: hooks.c:245:
+^I^Iif(unsafe & (LSM_UNSAFE_SHARE | LSM_UNSAFE_PTRACE|LSM_UNSAFE_PTRACE_CAP)) $

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#528: FILE: hooks.c:245:
+		if(unsafe & (LSM_UNSAFE_SHARE | LSM_UNSAFE_PTRACE|LSM_UNSAFE_PTRACE_CAP)) 
+		{	   

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#528: FILE: hooks.c:245:
+		if(unsafe & (LSM_UNSAFE_SHARE | LSM_UNSAFE_PTRACE|LSM_UNSAFE_PTRACE_CAP)) 
 		                                                 ^

ERROR:SPACING: space required before the open parenthesis '('
#528: FILE: hooks.c:245:
+		if(unsafe & (LSM_UNSAFE_SHARE | LSM_UNSAFE_PTRACE|LSM_UNSAFE_PTRACE_CAP)) 

ERROR:TRAILING_WHITESPACE: trailing whitespace
#529: FILE: hooks.c:246:
+^I^I{^I   $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#530: FILE: hooks.c:247:
+^I^I$

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#530: FILE: hooks.c:247:
+		{	   
+		

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#531: FILE: hooks.c:248:
+			printk(KERN_DEBUG "marking SID as unsafe\n");

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#532: FILE: hooks.c:249:
+			bsec->unsafe=unsafe;
 			            ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#534: FILE: hooks.c:251:
+^I   $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#536: FILE: hooks.c:253:
+^I}^I$

CHECK:LINE_SPACING: Please don't use multiple blank lines
#539: FILE: hooks.c:256:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#544: FILE: hooks.c:261:
+ * A task has accessed this file, add the task's SID to the group SID of $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#547: FILE: hooks.c:263:
+ * based on inode_has_perm $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#549: FILE: hooks.c:265:
+static void inode_update_perm(struct task_struct *tsk,struct inode *inode)
                                                      ^

ERROR:CODE_INDENT: code indent should use tabs where possible
#553: FILE: hooks.c:269:
+        u32 sid;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#553: FILE: hooks.c:269:
+        u32 sid;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#554: FILE: hooks.c:270:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#554: FILE: hooks.c:270:
+   $

ERROR:CODE_INDENT: code indent should use tabs where possible
#555: FILE: hooks.c:271:
+     ^Itsec = tsk->security;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#555: FILE: hooks.c:271:
+     ^Itsec = tsk->security;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#555: FILE: hooks.c:271:
+     ^Itsec = tsk->security;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#556: FILE: hooks.c:272:
+   ^Iisec = inode->i_security;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#556: FILE: hooks.c:272:
+   ^Iisec = inode->i_security;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#556: FILE: hooks.c:272:
+   ^Iisec = inode->i_security;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#557: FILE: hooks.c:273:
+   ^Iif(!isec) $

ERROR:CODE_INDENT: code indent should use tabs where possible
#557: FILE: hooks.c:273:
+   ^Iif(!isec) $

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#557: FILE: hooks.c:273:
+   ^Iif(!isec) $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#557: FILE: hooks.c:273:
+   ^Iif(!isec) $

ERROR:SPACING: space required before the open parenthesis '('
#557: FILE: hooks.c:273:
+   	if(!isec) 

ERROR:CODE_INDENT: code indent should use tabs where possible
#558: FILE: hooks.c:274:
+     ^I^Ireturn;$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#558: FILE: hooks.c:274:
+     ^I^Ireturn;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#558: FILE: hooks.c:274:
+     ^I^Ireturn;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#559: FILE: hooks.c:275:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#559: FILE: hooks.c:275:
+   $

ERROR:CODE_INDENT: code indent should use tabs where possible
#560: FILE: hooks.c:276:
+        if(unlikely(!tsec))$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#560: FILE: hooks.c:276:
+        if(unlikely(!tsec))$

ERROR:SPACING: space required before the open parenthesis '('
#560: FILE: hooks.c:276:
+        if(unlikely(!tsec))

ERROR:CODE_INDENT: code indent should use tabs where possible
#561: FILE: hooks.c:277:
+       ^I^Isid = compute_inode_sid(isec->sid,FIREFLIER_SID_UNLABELED);$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#561: FILE: hooks.c:277:
+       ^I^Isid = compute_inode_sid(isec->sid,FIREFLIER_SID_UNLABELED);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#561: FILE: hooks.c:277:
+       ^I^Isid = compute_inode_sid(isec->sid,FIREFLIER_SID_UNLABELED);$

ERROR:SPACING: space required after that ',' (ctx:VxV)
#561: FILE: hooks.c:277:
+       		sid = compute_inode_sid(isec->sid,FIREFLIER_SID_UNLABELED);
        		                                 ^

ERROR:CODE_INDENT: code indent should use tabs where possible
#562: FILE: hooks.c:278:
+   ^Ielse$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#562: FILE: hooks.c:278:
+   ^Ielse$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#562: FILE: hooks.c:278:
+   ^Ielse$

ERROR:CODE_INDENT: code indent should use tabs where possible
#563: FILE: hooks.c:279:
+     ^I^Isid = compute_inode_sid(isec->sid,tsec->sid);$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#563: FILE: hooks.c:279:
+     ^I^Isid = compute_inode_sid(isec->sid,tsec->sid);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#563: FILE: hooks.c:279:
+     ^I^Isid = compute_inode_sid(isec->sid,tsec->sid);$

ERROR:SPACING: space required after that ',' (ctx:VxV)
#563: FILE: hooks.c:279:
+     		sid = compute_inode_sid(isec->sid,tsec->sid);
      		                                 ^

ERROR:CODE_INDENT: code indent should use tabs where possible
#564: FILE: hooks.c:280:
+        spin_lock(&isec->sid_lock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#564: FILE: hooks.c:280:
+        spin_lock(&isec->sid_lock);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#565: FILE: hooks.c:281:
+        isec->sid=sid;     $

ERROR:CODE_INDENT: code indent should use tabs where possible
#565: FILE: hooks.c:281:
+        isec->sid=sid;     $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#565: FILE: hooks.c:281:
+        isec->sid=sid;     $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#565: FILE: hooks.c:281:
+        isec->sid=sid;     
                  ^

ERROR:CODE_INDENT: code indent should use tabs where possible
#566: FILE: hooks.c:282:
+        spin_unlock(&isec->sid_lock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#566: FILE: hooks.c:282:
+        spin_unlock(&isec->sid_lock);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#567: FILE: hooks.c:283:
+         ^I$

ERROR:CODE_INDENT: code indent should use tabs where possible
#567: FILE: hooks.c:283:
+         ^I$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#567: FILE: hooks.c:283:
+         ^I$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#567: FILE: hooks.c:283:
+         ^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#568: FILE: hooks.c:284:
+^Iprintk(KERN_DEBUG "computed inode sid: %ld->%d\n",inode->i_ino,isec->sid);   $

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#568: FILE: hooks.c:284:
+	printk(KERN_DEBUG "computed inode sid: %ld->%d\n",inode->i_ino,isec->sid);   

ERROR:SPACING: space required after that ',' (ctx:VxV)
#568: FILE: hooks.c:284:
+	printk(KERN_DEBUG "computed inode sid: %ld->%d\n",inode->i_ino,isec->sid);   
 	                                                 ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#568: FILE: hooks.c:284:
+	printk(KERN_DEBUG "computed inode sid: %ld->%d\n",inode->i_ino,isec->sid);   
 	                                                              ^

CHECK:LINE_SPACING: Please don't use multiple blank lines
#571: FILE: hooks.c:287:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#573: FILE: hooks.c:289:
+/** $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#577: FILE: hooks.c:293:
+ * A task has accessed this file, add the task's SID to the group SID of $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#580: FILE: hooks.c:295:
+ * Based on file_has_perm $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#582: FILE: hooks.c:297:
+static  inline void file_update_perm(struct task_struct *tsk, struct file $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#588: FILE: hooks.c:302:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#589: FILE: hooks.c:303:
+  $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#589: FILE: hooks.c:303:
+  $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#590: FILE: hooks.c:304:
+ $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#590: FILE: hooks.c:304:
+  
+ 

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#590: FILE: hooks.c:304:
+ $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#591: FILE: hooks.c:305:
+/** $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#594: FILE: hooks.c:308:
+ * Derived from fs/exec.c:flush_old_files. $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#595: FILE: hooks.c:309:
+ *  Should deal only with sockets $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#597: FILE: hooks.c:311:
+static inline void update_files_auth(struct files_struct * files)  $

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#597: FILE: hooks.c:311:
+static inline void update_files_auth(struct files_struct * files)  

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#599: FILE: hooks.c:313:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#599: FILE: hooks.c:313:
+   $

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#599: FILE: hooks.c:313:
+{
+   

ERROR:TRAILING_WHITESPACE: trailing whitespace
#600: FILE: hooks.c:314:
+   $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#600: FILE: hooks.c:314:
+   
+   

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#600: FILE: hooks.c:314:
+   $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#604: FILE: hooks.c:318:
+  $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#604: FILE: hooks.c:318:
+  $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#607: FILE: hooks.c:321:
+^Ifor (;;) $

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#607: FILE: hooks.c:321:
+	for (;;) 
+	{

ERROR:TRAILING_WHITESPACE: trailing whitespace
#610: FILE: hooks.c:324:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#620: FILE: hooks.c:334:
+^I^Ifor ( ; set ; i++,set >>= 1) $

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#620: FILE: hooks.c:334:
+		for ( ; set ; i++,set >>= 1) 
+		{

ERROR:SPACING: space required after that ',' (ctx:OxV)
#620: FILE: hooks.c:334:
+		for ( ; set ; i++,set >>= 1) 
 		                 ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#622: FILE: hooks.c:336:
+^I^I^Iif (set & 1) $

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#622: FILE: hooks.c:336:
+			if (set & 1) 
+			{

ERROR:SPACING: space required after that ',' (ctx:VxV)
#627: FILE: hooks.c:341:
+				file_update_perm(current,file);
 				                        ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#636: FILE: hooks.c:350:
+^I $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#636: FILE: hooks.c:350:
+
+	 

WARNING:LINE_SPACING: Missing a blank line after declarations
#646: FILE: hooks.c:360:
+	struct fireflier_bprm_security_struct *bsec  = bprm->security;
+	secondary_ops->bprm_post_apply_creds(bprm);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#647: FILE: hooks.c:361:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#648: FILE: hooks.c:362:
+^Iif(bsec->unsafe) $

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#648: FILE: hooks.c:362:
+	if(bsec->unsafe) 
+	{

ERROR:SPACING: space required before the open parenthesis '('
#648: FILE: hooks.c:362:
+	if(bsec->unsafe) 

ERROR:TRAILING_WHITESPACE: trailing whitespace
#650: FILE: hooks.c:364:
+^I$

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#650: FILE: hooks.c:364:
+	{
+	

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#651: FILE: hooks.c:365:
+		printk(KERN_DEBUG "computing unsafe SID\n");

ERROR:SPACING: space required after that ',' (ctx:VxV)
#652: FILE: hooks.c:366:
+		tsec->sid = get_or_generate_unsafe_sid(tsec->sid,bsec->unsafe);
 		                                                ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#653: FILE: hooks.c:367:
+^I$

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#654: FILE: hooks.c:368:
+	
+	}

ERROR:TRAILING_WHITESPACE: trailing whitespace
#655: FILE: hooks.c:369:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#655: FILE: hooks.c:369:
+   $

ERROR:CODE_INDENT: code indent should use tabs where possible
#659: FILE: hooks.c:373:
+   ^I//SID changed, so update the files's SIDs, i.e. turn them into group SIDs$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#659: FILE: hooks.c:373:
+   ^I//SID changed, so update the files's SIDs, i.e. turn them into group SIDs$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#659: FILE: hooks.c:373:
+   ^I//SID changed, so update the files's SIDs, i.e. turn them into group SIDs$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#664: FILE: hooks.c:378:
+ * fireflier_inode_alloc_security - allocate the security structure of an $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#673: FILE: hooks.c:386:
+^I     $

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kzalloc(sizeof(*isec)...) over kzalloc(sizeof(struct fireflier_inode_security_struct)...)
#674: FILE: hooks.c:387:
+	isec = kzalloc(sizeof(struct fireflier_inode_security_struct), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

ERROR:TRAILING_WHITESPACE: trailing whitespace
#677: FILE: hooks.c:390:
+^I     $

ERROR:CODE_INDENT: code indent should use tabs where possible
#684: FILE: hooks.c:397:
+        spin_lock_init(&isec->sid_lock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#684: FILE: hooks.c:397:
+        spin_lock_init(&isec->sid_lock);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#688: FILE: hooks.c:401:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#697: FILE: hooks.c:410:
+//^Istruct fireflier_superblock_security_struct *sbsec = $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#699: FILE: hooks.c:411:
+^I     $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#702: FILE: hooks.c:414:
+^I     $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#707: FILE: hooks.c:419:
+static int fireflier_socket_accept(struct socket *sock, struct socket $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#710: FILE: hooks.c:421:
+^Istruct fireflier_inode_security_struct *isec = SOCK_INODE(sock)->i_security;        $

ERROR:CODE_INDENT: code indent should use tabs where possible
#711: FILE: hooks.c:422:
+        struct inode* newinode = SOCK_INODE(newsock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#711: FILE: hooks.c:422:
+        struct inode* newinode = SOCK_INODE(newsock);$

ERROR:POINTER_LOCATION: "foo* bar" should be "foo *bar"
#711: FILE: hooks.c:422:
+        struct inode* newinode = SOCK_INODE(newsock);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#713: FILE: hooks.c:424:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#713: FILE: hooks.c:424:
+   $

ERROR:CODE_INDENT: code indent should use tabs where possible
#714: FILE: hooks.c:425:
+        inode_alloc_security(newinode);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#714: FILE: hooks.c:425:
+        inode_alloc_security(newinode);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#715: FILE: hooks.c:426:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#715: FILE: hooks.c:426:
+   $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#716: FILE: hooks.c:427:
+        newisec = newinode->i_security;    $

ERROR:CODE_INDENT: code indent should use tabs where possible
#716: FILE: hooks.c:427:
+        newisec = newinode->i_security;    $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#716: FILE: hooks.c:427:
+        newisec = newinode->i_security;    $

ERROR:CODE_INDENT: code indent should use tabs where possible
#717: FILE: hooks.c:428:
+        spin_lock(&isec->sid_lock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#717: FILE: hooks.c:428:
+        spin_lock(&isec->sid_lock);$

ERROR:CODE_INDENT: code indent should use tabs where possible
#718: FILE: hooks.c:429:
+        newisec->sid = isec->sid;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#718: FILE: hooks.c:429:
+        newisec->sid = isec->sid;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#719: FILE: hooks.c:430:
+        spin_unlock(&isec->sid_lock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#719: FILE: hooks.c:430:
+        spin_unlock(&isec->sid_lock);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#720: FILE: hooks.c:431:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#720: FILE: hooks.c:431:
+   $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#721: FILE: hooks.c:432:
+	return secondary_ops->socket_accept(sock,newsock);
 	                                        ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#723: FILE: hooks.c:434:
+^I$

ERROR:POINTER_LOCATION: "foo* bar" should be "foo *bar"
#728: FILE: hooks.c:439:
+static int fireflier_file_receive(struct file* file)

ERROR:SPACING: space required after that ',' (ctx:VxV)
#730: FILE: hooks.c:441:
+	file_update_perm(current,file);
 	                        ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#741: FILE: hooks.c:452:
+static int fireflier_inode_getsecurity(struct inode *inode, const char *name, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#743: FILE: hooks.c:453:
+static int fireflier_inode_getsecurity(struct inode *inode, const char *name, 
+{

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#745: FILE: hooks.c:455:
+	char *context=NULL;/* required!*/
 	             ^

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#746: FILE: hooks.c:456:
+	unsigned len;

ERROR:TRAILING_WHITESPACE: trailing whitespace
#753: FILE: hooks.c:463:
+     $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#753: FILE: hooks.c:463:
+     $

ERROR:CODE_INDENT: code indent should use tabs where possible
#774: FILE: hooks.c:484:
+        return 0;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#774: FILE: hooks.c:484:
+        return 0;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#777: FILE: hooks.c:487:
+static int fireflier_inode_listsecurity(struct inode *inode, char *buffer, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#779: FILE: hooks.c:488:
+static int fireflier_inode_listsecurity(struct inode *inode, char *buffer, 
+{

ERROR:TRAILING_WHITESPACE: trailing whitespace
#780: FILE: hooks.c:489:
+^Iif(inode->i_security) $

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#780: FILE: hooks.c:489:
+	if(inode->i_security) 
+	{

ERROR:SPACING: space required before the open parenthesis '('
#780: FILE: hooks.c:489:
+	if(inode->i_security) 

ERROR:TRAILING_WHITESPACE: trailing whitespace
#782: FILE: hooks.c:491:
+^I$

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#782: FILE: hooks.c:491:
+	{
+	

WARNING:LINE_SPACING: Missing a blank line after declarations
#784: FILE: hooks.c:493:
+		const int len = sizeof(XATTR_NAME_FIREFLIER);
+		if (buffer && len <= buffer_size)

ERROR:TRAILING_WHITESPACE: trailing whitespace
#788: FILE: hooks.c:497:
+^Ielse $

ERROR:ELSE_AFTER_BRACE: else should follow close brace '}'
#788: FILE: hooks.c:497:
+	}
+	else 

`else {` should follow the closing block `}` on the same line.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#790: FILE: hooks.c:499:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#790: FILE: hooks.c:499:
+   $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#791: FILE: hooks.c:500:
+   
+

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#792: FILE: hooks.c:501:
+
+}

ERROR:CODE_INDENT: code indent should use tabs where possible
#799: FILE: hooks.c:508:
+        struct inode* inode=SOCK_INODE(sock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#799: FILE: hooks.c:508:
+        struct inode* inode=SOCK_INODE(sock);$

ERROR:POINTER_LOCATION: "foo* bar" should be "foo *bar"
#799: FILE: hooks.c:508:
+        struct inode* inode=SOCK_INODE(sock);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#799: FILE: hooks.c:508:
+        struct inode* inode=SOCK_INODE(sock);
                            ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#800: FILE: hooks.c:509:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#800: FILE: hooks.c:509:
+   $

ERROR:SPACING: space required after that ',' (ctx:VxV)
#801: FILE: hooks.c:510:
+	secondary_ops->socket_post_create(sock,family,type,protocol,kern);
 	                                      ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#801: FILE: hooks.c:510:
+	secondary_ops->socket_post_create(sock,family,type,protocol,kern);
 	                                             ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#801: FILE: hooks.c:510:
+	secondary_ops->socket_post_create(sock,family,type,protocol,kern);
 	                                                  ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#801: FILE: hooks.c:510:
+	secondary_ops->socket_post_create(sock,family,type,protocol,kern);
 	                                                           ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#802: FILE: hooks.c:511:
+^I$

ERROR:CODE_INDENT: code indent should use tabs where possible
#803: FILE: hooks.c:512:
+        inode_alloc_security(inode);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#803: FILE: hooks.c:512:
+        inode_alloc_security(inode);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#805: FILE: hooks.c:514:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#805: FILE: hooks.c:514:
+   $

ERROR:CODE_INDENT: code indent should use tabs where possible
#806: FILE: hooks.c:515:
+        spin_lock(&isec->sid_lock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#806: FILE: hooks.c:515:
+        spin_lock(&isec->sid_lock);$

ERROR:CODE_INDENT: code indent should use tabs where possible
#808: FILE: hooks.c:517:
+        spin_unlock(&isec->sid_lock);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#808: FILE: hooks.c:517:
+        spin_unlock(&isec->sid_lock);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#809: FILE: hooks.c:518:
+   $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#809: FILE: hooks.c:518:
+   $

WARNING:RETURN_VOID: void function return statements are not generally useful
#811: FILE: hooks.c:520:
+	return;
+}

ERROR:TRAILING_WHITESPACE: trailing whitespace
#815: FILE: hooks.c:524:
+ * Unused security hooks will be automatically redirected to the dummy $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#817: FILE: hooks.c:525:
+ * Does the dummy module call the secondary module? Maybe we should implement $

ERROR:OPEN_BRACE: that open brace { should be on the previous line
#822: FILE: hooks.c:529:
+static struct security_operations fireflier_ops =
+{

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#823: FILE: hooks.c:530:
+^I.bprm_alloc_security  ^I= fireflier_bprm_alloc_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#824: FILE: hooks.c:531:
+^I.bprm_free_security  ^I= fireflier_bprm_free_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#825: FILE: hooks.c:532:
+^I.bprm_apply_creds  ^I= fireflier_bprm_apply_creds,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#827: FILE: hooks.c:534:
+^I.bprm_set_security ^I= fireflier_bprm_set_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#828: FILE: hooks.c:535:
+^I.inode_free_security ^I= fireflier_inode_free_security,$

ERROR:CODE_INDENT: code indent should use tabs where possible
#829: FILE: hooks.c:536:
+    ^I.inode_getsecurity ^I= fireflier_inode_getsecurity,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#829: FILE: hooks.c:536:
+    ^I.inode_getsecurity ^I= fireflier_inode_getsecurity,$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#829: FILE: hooks.c:536:
+    ^I.inode_getsecurity ^I= fireflier_inode_getsecurity,$

ERROR:CODE_INDENT: code indent should use tabs where possible
#830: FILE: hooks.c:537:
+   ^I.inode_listsecurity ^I= fireflier_inode_listsecurity,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#830: FILE: hooks.c:537:
+   ^I.inode_listsecurity ^I= fireflier_inode_listsecurity,$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#830: FILE: hooks.c:537:
+   ^I.inode_listsecurity ^I= fireflier_inode_listsecurity,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#831: FILE: hooks.c:538:
+^I.file_receive ^I^I= fireflier_file_receive,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#832: FILE: hooks.c:539:
+^I.task_alloc_security ^I= fireflier_task_alloc_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#833: FILE: hooks.c:540:
+^I.task_free_security ^I= task_free_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#834: FILE: hooks.c:541:
+^I.socket_post_create ^I= fireflier_socket_post_create,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#835: FILE: hooks.c:542:
+^I.socket_accept ^I^I= fireflier_socket_accept,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#836: FILE: hooks.c:543:
+^I.register_security ^I= fireflier_register_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#837: FILE: hooks.c:544:
+^I.unregister_security ^I= fireflier_unregister_security,$

ERROR:INITIALISED_STATIC: do not initialise statics to 0
#843: FILE: hooks.c:550:
+static int stacked=0;

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#843: FILE: hooks.c:550:
+static int stacked=0;
                   ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#847: FILE: hooks.c:554:
+ * Can this be done at all? Or do we need to have fireflier loaded during $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#852: FILE: hooks.c:558:
+^I/* Labeling running processes without using the task_lock seems not possible $

ERROR:CODE_INDENT: code indent should use tabs where possible
#854: FILE: hooks.c:559:
+        /* TODO: label processes that are already running */$

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#854: FILE: hooks.c:559:
+	/* Labeling running processes without using the task_lock seems not possible 
+        /* TODO: label processes that are already running */

ERROR:TRAILING_WHITESPACE: trailing whitespace
#855: FILE: hooks.c:560:
+        /* TODO: prevent processes from being spawned while we label the $

ERROR:CODE_INDENT: code indent should use tabs where possible
#855: FILE: hooks.c:560:
+        /* TODO: prevent processes from being spawned while we label the $

WARNING:BLOCK_COMMENT_STYLE: Block comments use * on subsequent lines
#857: FILE: hooks.c:561:
+        /* TODO: prevent processes from being spawned while we label the 
+	/* TODO Priority:Low, it works without this too */

ERROR:SPACING: space required before the open parenthesis '('
#866: FILE: hooks.c:570:
+	if(stacked) {

ERROR:SPACING: space required after that ',' (ctx:VxO)
#867: FILE: hooks.c:571:
+		if(mod_unreg_security("fireflier",&fireflier_ops))
 		                                 ^

ERROR:SPACING: space required before that '&' (ctx:OxV)
#867: FILE: hooks.c:571:
+		if(mod_unreg_security("fireflier",&fireflier_ops))
 		                                  ^

ERROR:SPACING: space required before the open parenthesis '('
#867: FILE: hooks.c:571:
+		if(mod_unreg_security("fireflier",&fireflier_ops))

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#868: FILE: hooks.c:572:
+			printk(KERN_ERR "Fireflier: Error unregistering stacked security module.

ERROR:SPACING: spaces required around that ':' (ctx:VxW)
#873: FILE: hooks.c:576:
+			printk(KERN_ERR "Fireflier: Error unregistering security module.\n");
 			                          ^

CHECK:CAMELCASE: Avoid CamelCase: <Fireflier>
#873: FILE: hooks.c:576:
+			printk(KERN_ERR "Fireflier: Error unregistering security module.\n");

CHECK:CAMELCASE: Avoid CamelCase: <Error>
#873: FILE: hooks.c:576:
+			printk(KERN_ERR "Fireflier: Error unregistering security module.\n");

CHECK:CAMELCASE: Avoid CamelCase: <Enable>
#878: FILE: hooks.c:581:
+MODULE_PARM_DESC(ff_debug,"Enable debug info dumping in debugfs");

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#880: FILE: hooks.c:583:
+ * fireflier_init - module loading initialization$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#881: FILE: hooks.c:584:
+ * Registers fireflier as primary or secondary security module$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#882: FILE: hooks.c:585:
+ */$

ERROR:CODE_INDENT: code indent should use tabs where possible
#885: FILE: hooks.c:588:
+        /*Register security_ops with kernel*/$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#885: FILE: hooks.c:588:
+        /*Register security_ops with kernel*/$

ERROR:CODE_INDENT: code indent should use tabs where possible
#886: FILE: hooks.c:589:
+        int err;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#886: FILE: hooks.c:589:
+        int err;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#888: FILE: hooks.c:591:
+        original_ops = security_ops;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#888: FILE: hooks.c:591:
+        original_ops = security_ops;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#889: FILE: hooks.c:592:
+        /* initialize dummy_security_ops to dummy ops */$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#889: FILE: hooks.c:592:
+        /* initialize dummy_security_ops to dummy ops */$

ERROR:CODE_INDENT: code indent should use tabs where possible
#890: FILE: hooks.c:593:
+        register_security(&dummy_security_ops);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#890: FILE: hooks.c:593:
+        register_security(&dummy_security_ops);$

ERROR:CODE_INDENT: code indent should use tabs where possible
#891: FILE: hooks.c:594:
+        unregister_security(&dummy_security_ops);$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#891: FILE: hooks.c:594:
+        unregister_security(&dummy_security_ops);$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#892: FILE: hooks.c:595:
+        secondary_ops = &dummy_security_ops;//avoid recursion with capability $

ERROR:CODE_INDENT: code indent should use tabs where possible
#892: FILE: hooks.c:595:
+        secondary_ops = &dummy_security_ops;//avoid recursion with capability $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#892: FILE: hooks.c:595:
+        secondary_ops = &dummy_security_ops;//avoid recursion with capability $

ERROR:CODE_INDENT: code indent should use tabs where possible
#894: FILE: hooks.c:596:
+        if (!secondary_ops) {$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#894: FILE: hooks.c:596:
+        if (!secondary_ops) {$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#895: FILE: hooks.c:597:
+                printk (KERN_ERR "Fireflier: No initial security $

ERROR:CODE_INDENT: code indent should use tabs where possible
#895: FILE: hooks.c:597:
+                printk (KERN_ERR "Fireflier: No initial security $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#895: FILE: hooks.c:597:
+                printk (KERN_ERR "Fireflier: No initial security $

ERROR:SPACING: spaces required around that ':' (ctx:VxW)
#895: FILE: hooks.c:597:
+                printk (KERN_ERR "Fireflier: No initial security 
                                            ^

CHECK:CAMELCASE: Avoid CamelCase: <No>
#895: FILE: hooks.c:597:
+                printk (KERN_ERR "Fireflier: No initial security 

ERROR:CODE_INDENT: code indent should use tabs where possible
#897: FILE: hooks.c:598:
+                return -EAGAIN;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#897: FILE: hooks.c:598:
+                return -EAGAIN;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#898: FILE: hooks.c:599:
+        }$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#898: FILE: hooks.c:599:
+        }$

ERROR:CODE_INDENT: code indent should use tabs where possible
#899: FILE: hooks.c:600:
+        if ((err=register_security (&fireflier_ops))) {$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#899: FILE: hooks.c:600:
+        if ((err=register_security (&fireflier_ops))) {$

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#899: FILE: hooks.c:600:
+        if ((err=register_security (&fireflier_ops))) {
                 ^

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around '&fireflier_ops'
#899: FILE: hooks.c:600:
+        if ((err=register_security (&fireflier_ops))) {

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#899: FILE: hooks.c:600:
+        if ((err=register_security (&fireflier_ops))) {

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

ERROR:TRAILING_WHITESPACE: trailing whitespace
#900: FILE: hooks.c:601:
+                printk(KERN_INFO "Fireflier: Unable to register as primary $

ERROR:CODE_INDENT: code indent should use tabs where possible
#900: FILE: hooks.c:601:
+                printk(KERN_INFO "Fireflier: Unable to register as primary $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#900: FILE: hooks.c:601:
+                printk(KERN_INFO "Fireflier: Unable to register as primary $

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#900: FILE: hooks.c:601:
+                printk(KERN_INFO "Fireflier: Unable to register as primary 

ERROR:CODE_INDENT: code indent should use tabs where possible
#902: FILE: hooks.c:602:
+                stacked=1;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#902: FILE: hooks.c:602:
+                stacked=1;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#903: FILE: hooks.c:603:
+                if((err=mod_reg_security("fireflier",&fireflier_ops))) {$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#903: FILE: hooks.c:603:
+                if((err=mod_reg_security("fireflier",&fireflier_ops))) {$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#904: FILE: hooks.c:604:
+                        printk(KERN_ERR "Fireflier: Unable to register with $

ERROR:CODE_INDENT: code indent should use tabs where possible
#904: FILE: hooks.c:604:
+                        printk(KERN_ERR "Fireflier: Unable to register with $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#904: FILE: hooks.c:604:
+                        printk(KERN_ERR "Fireflier: Unable to register with $

ERROR:SPACING: spaces required around that ':' (ctx:VxW)
#904: FILE: hooks.c:604:
+                        printk(KERN_ERR "Fireflier: Unable to register with 
                                                   ^

CHECK:CAMELCASE: Avoid CamelCase: <Unable>
#904: FILE: hooks.c:604:
+                        printk(KERN_ERR "Fireflier: Unable to register with 

ERROR:CODE_INDENT: code indent should use tabs where possible
#906: FILE: hooks.c:605:
+                        return err;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#906: FILE: hooks.c:605:
+                        return err;$

ERROR:CODE_INDENT: code indent should use tabs where possible
#907: FILE: hooks.c:606:
+                }$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#907: FILE: hooks.c:606:
+                }$

ERROR:CODE_INDENT: code indent should use tabs where possible
#908: FILE: hooks.c:607:
+        }$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#908: FILE: hooks.c:607:
+        }$

ERROR:CODE_INDENT: code indent should use tabs where possible
#909: FILE: hooks.c:608:
+        else$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#909: FILE: hooks.c:608:
+        else$

ERROR:ELSE_AFTER_BRACE: else should follow close brace '}'
#909: FILE: hooks.c:608:
+        }
+        else

ERROR:CODE_INDENT: code indent should use tabs where possible
#910: FILE: hooks.c:609:
+                stacked=0;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#910: FILE: hooks.c:609:
+                stacked=0;$

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#910: FILE: hooks.c:609:
+                stacked=0;
                        ^

ERROR:CODE_INDENT: code indent should use tabs where possible
#911: FILE: hooks.c:610:
+        /* Do initialization */$

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#912: FILE: hooks.c:611:
+	if((err=autolabel_init())) {
 	       ^

ERROR:SPACING: space required before the open parenthesis '('
#912: FILE: hooks.c:611:
+	if((err=autolabel_init())) {

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#912: FILE: hooks.c:611:
+	if((err=autolabel_init())) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_err([subsystem]dev, ... then dev_err(dev, ... then pr_err(...  to printk(KERN_ERR ...
#913: FILE: hooks.c:612:
+		printk(KERN_ERR "Fireflier: autolabeling initialization failed (OOM?)\n");

ERROR:CODE_INDENT: code indent should use tabs where possible
#917: FILE: hooks.c:616:
+        label_all_processes();$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#917: FILE: hooks.c:616:
+        label_all_processes();$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#918: FILE: hooks.c:617:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#921: FILE: hooks.c:620:
+^I$

ERROR:CODE_INDENT: code indent should use tabs where possible
#922: FILE: hooks.c:621:
+        return 0;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#922: FILE: hooks.c:621:
+        return 0;$

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#937: FILE: structures.h:1:
+/*

ERROR:TRAILING_WHITESPACE: trailing whitespace
#957: FILE: structures.h:21:
+/* Structures copied from SELinux, and prefixed with fireflier_ to avoid $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#960: FILE: structures.h:23:
+ */ $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#961: FILE: structures.h:24:
+ $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#961: FILE: structures.h:24:
+ $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#962: FILE: structures.h:25:
+ $

CHECK:LINE_SPACING: Please don't use multiple blank lines
#962: FILE: structures.h:25:
+ 
+ 

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#962: FILE: structures.h:25:
+ $

ERROR:CODE_INDENT: code indent should use tabs where possible
#972: FILE: structures.h:35:
+        spinlock_t sid_lock;$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#972: FILE: structures.h:35:
+        spinlock_t sid_lock;$

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#987: FILE: structures.h:50:
+};
+/**

ERROR:TRAILING_WHITESPACE: trailing whitespace
#991: FILE: structures.h:54:
+static inline u32 getsid_safe(const struct fireflier_task_security_struct* $

ERROR:SPACING: space required before the open parenthesis '('
#994: FILE: structures.h:56:
+	if(likely(tsec))

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000085367.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 240 errors, 144 warnings, 39 checks, 726 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000085367.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
