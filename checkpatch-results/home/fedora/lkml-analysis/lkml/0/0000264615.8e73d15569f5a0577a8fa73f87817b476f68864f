WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#63: FILE: drivers/char/Kconfig:427:
+config SGI_SNSC
+	bool "SGI Altix system controller communication support"
+	help
+	  If you have an SGI Altix and you want to enable system
+	  controller communication from user space (you want this!),
+	  say Y.  Otherwise, say N.
+

Kconfig symbols should have a help text which fully describes
it.

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#88: FILE: drivers/char/snsc.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

CHECK:LINE_SPACING: Please don't use multiple blank lines
#115: FILE: drivers/char/snsc.c:28:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#121: FILE: drivers/char/snsc.c:34:
+#define DPRINTF(x...)	printk(x)

ERROR:SPACING: space required before the open parenthesis '('
#123: FILE: drivers/char/snsc.c:36:
+#define DPRINTF(x...)	do {} while(0)

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:CONST_STRUCT: struct file_operations should normally be const
#134: FILE: drivers/char/snsc.c:47:
+static struct file_operations scdrv_fops = {

Using const is generally a good idea.  Checkpatch reads
a list of frequently used structs that are always or
almost always constant.

The existing structs list can be viewed from
`scripts/const_structs.checkpatch`.

See: https://lore.kernel.org/lkml/alpine.DEB.2.10.1608281509480.3321@hadrien/

WARNING:BRACES: braces {} are not necessary for any arm of this statement
#162: FILE: drivers/char/snsc.c:75:
+	if (timeout) {
[...]
+	} else {
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:BRACES: braces {} are not necessary for single statement blocks
#170: FILE: drivers/char/snsc.c:83:
+	if (signal_pending(current)) {
+		return (timeout ? -ret : -1);
+	}

ERROR:RETURN_PARENTHESES: return is not a function, parentheses are not required
#171: FILE: drivers/char/snsc.c:84:
+		return (timeout ? -ret : -1);

return is not a function and as such doesn't need parentheses::

  return (bar);

can simply be::

  return bar;

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#196: FILE: drivers/char/snsc.c:109:
+	if (alloc_chrdev_region(&first_dev, 0, (MAX_SLABS*nummodules), "snsc")
 	                                                 ^

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#198: FILE: drivers/char/snsc.c:111:
+		printk("%s: failed to register SN system controller device\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#199: FILE: drivers/char/snsc.c:112:
+		       __FUNCTION__);

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#207: FILE: drivers/char/snsc.c:120:
+		for (i = 0; i <= MAX_SLABS; i++) {
+

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#221: FILE: drivers/char/snsc.c:134:
+			scd = kmalloc(sizeof (struct sysctl_data_s),

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*scd)...) over kmalloc(sizeof (struct sysctl_data_s)...)
#221: FILE: drivers/char/snsc.c:134:
+			scd = kmalloc(sizeof (struct sysctl_data_s),

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#224: FILE: drivers/char/snsc.c:137:
+				printk("%s: failed to allocate device info"

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#224: FILE: drivers/char/snsc.c:137:
+			if (!scd) {
+				printk("%s: failed to allocate device info"

WARNING:SPLIT_STRING: quoted string split across lines
#225: FILE: drivers/char/snsc.c:138:
+				printk("%s: failed to allocate device info"
+				       "for %s/%s\n", __FUNCTION__,

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

WARNING:MISSING_SPACE: break quoted strings at a space character
#225: FILE: drivers/char/snsc.c:138:
+				printk("%s: failed to allocate device info"
+				       "for %s/%s\n", __FUNCTION__,

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#225: FILE: drivers/char/snsc.c:138:
+				       "for %s/%s\n", __FUNCTION__,

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#229: FILE: drivers/char/snsc.c:142:
+			memset(scd, 0, sizeof (struct sysctl_data_s));

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#233: FILE: drivers/char/snsc.c:146:
+			if (!(salbuf = kmalloc(SCDRV_BUFSZ, GFP_KERNEL))) {

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#234: FILE: drivers/char/snsc.c:147:
+				printk("%s: failed to allocate driver buffer"

WARNING:SPLIT_STRING: quoted string split across lines
#235: FILE: drivers/char/snsc.c:148:
+				printk("%s: failed to allocate driver buffer"
+				       "(%s%s)\n", __FUNCTION__,

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#235: FILE: drivers/char/snsc.c:148:
+				       "(%s%s)\n", __FUNCTION__,

WARNING:SPLIT_STRING: quoted string split across lines
#245: FILE: drivers/char/snsc.c:158:
+				    ("%s: failed to initialize SAL for"
+				     " system controller communication"

WARNING:SPLIT_STRING: quoted string split across lines
#246: FILE: drivers/char/snsc.c:159:
+				     " system controller communication"
+				     " (%s/%s): outdated PROM?\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#247: FILE: drivers/char/snsc.c:160:
+				     __FUNCTION__, SYSCTL_BASENAME, devname);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#256: FILE: drivers/char/snsc.c:169:
+				printk("%s: failed to register system"

WARNING:SPLIT_STRING: quoted string split across lines
#257: FILE: drivers/char/snsc.c:170:
+				printk("%s: failed to register system"
+				       " controller device (%s%s)\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#258: FILE: drivers/char/snsc.c:171:
+				       __FUNCTION__, SYSCTL_BASENAME, devname);

ERROR:SPACING: space prohibited before that ',' (ctx:WxE)
#268: FILE: drivers/char/snsc.c:181:
+						 0 /*ignored */ ,
 						                ^

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#292: FILE: drivers/char/snsc.c:205:
+		printk("%s: no such device\n", __FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#292: FILE: drivers/char/snsc.c:205:
+		printk("%s: no such device\n", __FUNCTION__);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#297: FILE: drivers/char/snsc.c:210:
+	sd = kmalloc(sizeof (struct subch_data_s), GFP_KERNEL);

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*sd)...) over kmalloc(sizeof (struct subch_data_s)...)
#297: FILE: drivers/char/snsc.c:210:
+	sd = kmalloc(sizeof (struct subch_data_s), GFP_KERNEL);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!sd"
#298: FILE: drivers/char/snsc.c:211:
+	if (sd == NULL) {

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#299: FILE: drivers/char/snsc.c:212:
+		printk("%s: couldn't allocate subchannel data\n",

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#299: FILE: drivers/char/snsc.c:212:
+	if (sd == NULL) {
+		printk("%s: couldn't allocate subchannel data\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#300: FILE: drivers/char/snsc.c:213:
+		       __FUNCTION__);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#305: FILE: drivers/char/snsc.c:218:
+	memset(sd, 0, sizeof (struct subch_data_s));

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#311: FILE: drivers/char/snsc.c:224:
+		printk("%s: couldn't allocate subchannel\n", __FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#311: FILE: drivers/char/snsc.c:224:
+		printk("%s: couldn't allocate subchannel\n", __FUNCTION__);

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#331: FILE: drivers/char/snsc.c:244:
+		printk("%s: irq request failed (%d)\n", __FUNCTION__, rv);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#331: FILE: drivers/char/snsc.c:244:
+		printk("%s: irq request failed (%d)\n", __FUNCTION__, rv);

CHECK:SPACING: No space is necessary after a cast
#347: FILE: drivers/char/snsc.c:260:
+	struct subch_data_s *sd = (struct subch_data_s *) file->private_data;

CHECK:SPACING: No space is necessary after a cast
#379: FILE: drivers/char/snsc.c:292:
+	struct subch_data_s *sd = (struct subch_data_s *) file->private_data;

WARNING:BRACES: braces {} are not necessary for single statement blocks
#386: FILE: drivers/char/snsc.c:299:
+		if (file->f_flags & O_NONBLOCK) {
+			return -EAGAIN;
+		}

CHECK:SPACING: No space is necessary after a cast
#424: FILE: drivers/char/snsc.c:337:
+				__FUNCTION__, (int) count, len);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#424: FILE: drivers/char/snsc.c:337:
+				__FUNCTION__, (int) count, len);

CHECK:SPACING: No space is necessary after a cast
#426: FILE: drivers/char/snsc.c:339:
+		len = min((int) count, len);

CHECK:SPACING: No space is necessary after a cast
#459: FILE: drivers/char/snsc.c:372:
+	struct subch_data_s *sd = (struct subch_data_s *) file->private_data;

WARNING:BRACES: braces {} are not necessary for single statement blocks
#466: FILE: drivers/char/snsc.c:379:
+		if (file->f_flags & O_NONBLOCK) {
+			return -EAGAIN;
+		}

CHECK:SPACING: No space is necessary after a cast
#476: FILE: drivers/char/snsc.c:389:
+	count = min((int) count, CHUNKSIZE);

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around 'status >= 0'
#507: FILE: drivers/char/snsc.c:420:
+	if ((status >= 0) && (status < count)) {

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around 'status < count'
#507: FILE: drivers/char/snsc.c:420:
+	if ((status >= 0) && (status < count)) {

CHECK:SPACING: No space is necessary after a cast
#509: FILE: drivers/char/snsc.c:422:
+			status, (int) count);

CHECK:SPACING: No space is necessary after a cast
#533: FILE: drivers/char/snsc.c:446:
+	struct subch_data_s *sd = (struct subch_data_s *) file->private_data;

WARNING:BRACES: braces {} are not necessary for single statement blocks
#544: FILE: drivers/char/snsc.c:457:
+		if (status & SAL_IROUTER_INTR_RECV) {
+			mask |= POLLIN | POLLRDNORM;
+		}

WARNING:BRACES: braces {} are not necessary for single statement blocks
#547: FILE: drivers/char/snsc.c:460:
+		if (status & SAL_IROUTER_INTR_XMIT) {
+			mask |= POLLOUT | POLLWRNORM;
+		}

CHECK:SPACING: No space is necessary after a cast
#558: FILE: drivers/char/snsc.c:471:
+	struct subch_data_s *sd = (struct subch_data_s *) subch_data;

WARNING:BRACES: braces {} are not necessary for single statement blocks
#566: FILE: drivers/char/snsc.c:479:
+		if (status & SAL_IROUTER_INTR_RECV) {
+			wake_up_all(&sd->sd_rq);
+		}

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#585: FILE: drivers/char/snsc.h:1:
+/*

CHECK:LINE_SPACING: Please don't use multiple blank lines
#689: FILE: include/asm-ia64/sn/sn_sal.h:107:
+
+

WARNING:LINE_SPACING: Missing a blank line after declarations
#708: FILE: include/asm-ia64/sn/sn_sal.h:737:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_OPEN, nasid,

CHECK:SPACING: No space is necessary after a cast
#710: FILE: include/asm-ia64/sn/sn_sal.h:739:
+	return (int) rv.v0;

WARNING:LINE_SPACING: Missing a blank line after declarations
#720: FILE: include/asm-ia64/sn/sn_sal.h:749:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_CLOSE,

CHECK:SPACING: No space is necessary after a cast
#721: FILE: include/asm-ia64/sn/sn_sal.h:750:
+			   (u64) nasid, (u64) subch, 0, 0, 0, 0);

CHECK:SPACING: No space is necessary after a cast
#722: FILE: include/asm-ia64/sn/sn_sal.h:751:
+	return (int) rv.status;

WARNING:LINE_SPACING: Missing a blank line after declarations
#737: FILE: include/asm-ia64/sn/sn_sal.h:766:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_RECV,

CHECK:SPACING: No space is necessary after a cast
#738: FILE: include/asm-ia64/sn/sn_sal.h:767:
+			   (u64) nasid, (u64) subch, (u64) buf, (u64) len,

CHECK:SPACING: No space is necessary after a cast
#740: FILE: include/asm-ia64/sn/sn_sal.h:769:
+	return (int) rv.status;

WARNING:LINE_SPACING: Missing a blank line after declarations
#755: FILE: include/asm-ia64/sn/sn_sal.h:784:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_SEND,

CHECK:SPACING: No space is necessary after a cast
#756: FILE: include/asm-ia64/sn/sn_sal.h:785:
+			   (u64) nasid, (u64) subch, (u64) buf, (u64) len,

CHECK:SPACING: No space is necessary after a cast
#758: FILE: include/asm-ia64/sn/sn_sal.h:787:
+	return (int) rv.v0;

WARNING:LINE_SPACING: Missing a blank line after declarations
#771: FILE: include/asm-ia64/sn/sn_sal.h:800:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_INTR_STATUS,

CHECK:SPACING: No space is necessary after a cast
#772: FILE: include/asm-ia64/sn/sn_sal.h:801:
+			   (u64) nasid, (u64) subch, 0, 0, 0, 0);

CHECK:SPACING: No space is necessary after a cast
#773: FILE: include/asm-ia64/sn/sn_sal.h:802:
+	return (int) rv.v0;

WARNING:LINE_SPACING: Missing a blank line after declarations
#784: FILE: include/asm-ia64/sn/sn_sal.h:813:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_INTR_ON,

CHECK:SPACING: No space is necessary after a cast
#785: FILE: include/asm-ia64/sn/sn_sal.h:814:
+			   (u64) nasid, (u64) subch, intr, 0, 0, 0);

CHECK:SPACING: No space is necessary after a cast
#786: FILE: include/asm-ia64/sn/sn_sal.h:815:
+	return (int) rv.v0;

WARNING:LINE_SPACING: Missing a blank line after declarations
#797: FILE: include/asm-ia64/sn/sn_sal.h:826:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_INTR_OFF,

CHECK:SPACING: No space is necessary after a cast
#798: FILE: include/asm-ia64/sn/sn_sal.h:827:
+			   (u64) nasid, (u64) subch, intr, 0, 0, 0);

CHECK:SPACING: No space is necessary after a cast
#799: FILE: include/asm-ia64/sn/sn_sal.h:828:
+	return (int) rv.v0;

WARNING:LINE_SPACING: Missing a blank line after declarations
#813: FILE: include/asm-ia64/sn/sn_sal.h:842:
+	struct ia64_sal_retval rv;
+	SAL_CALL_REENTRANT(rv, SN_SAL_IROUTER_OP, SAL_IROUTER_INIT,

CHECK:SPACING: No space is necessary after a cast
#814: FILE: include/asm-ia64/sn/sn_sal.h:843:
+			   (u64) nasid, (u64) buf, (u64) len, 0, 0, 0);

CHECK:SPACING: No space is necessary after a cast
#815: FILE: include/asm-ia64/sn/sn_sal.h:844:
+	return (int) rv.status;

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000264615.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 4 errors, 50 warnings, 33 checks, 743 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000264615.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
