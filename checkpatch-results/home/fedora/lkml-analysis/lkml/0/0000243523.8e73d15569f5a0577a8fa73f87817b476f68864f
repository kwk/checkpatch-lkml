WARNING:BAD_SIGN_OFF: 'Signed-off-by:' is the preferred signature form
#40: 
Signed-Off-By: Serge E. Hallyn <serue@us.ibm.com>

The signed-off-by line does not fall in line with the standards
specified by the community.

See: https://www.kernel.org/doc/html/latest/process/submitting-patches.html#developer-s-certificate-of-origin-1-1

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#47: FILE: security/bsdjail.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:EMBEDDED_FILENAME: It's generally not useful to have the filename in the file
#48: FILE: security/bsdjail.c:2:
+ * File: linux/security/bsdjail.c

Embedding the complete filename path inside the file isn't particularly
useful as often the path is moved around and becomes incorrect.

WARNING:INCLUDE_LINUX: Use #include <linux/uaccess.h> instead of <asm/uaccess.h>
#76: FILE: security/bsdjail.c:30:
+#include <asm/uaccess.h>

ERROR:INITIALISED_STATIC: do not initialise statics to 0
#84: FILE: security/bsdjail.c:38:
+static int jail_debug = 0;

Static variables should not be initialized explicitly to zero.
Your compiler (or rather your loader) automatically does
it for you.

ERROR:SPACING: space prohibited before that close parenthesis ')'
#90: FILE: security/bsdjail.c:44:
+#define bsdj_debug(how, fmt, arg... ) \

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:MACRO_ARG_PRECEDENCE: Macro argument 'how' may be better as '(how)' to avoid precedence issues
#90: FILE: security/bsdjail.c:44:
+#define bsdj_debug(how, fmt, arg... ) \
+	do { \
+		if ( how || jail_debug ) \
+			printk(KERN_NOTICE "%s: %s: " fmt, \
+				MY_NAME, __FUNCTION__, \
+				## arg ); \
+	} while ( 0 )

ERROR:SPACING: space prohibited after that open parenthesis '('
#92: FILE: security/bsdjail.c:46:
+		if ( how || jail_debug ) \

ERROR:SPACING: space prohibited before that close parenthesis ')'
#92: FILE: security/bsdjail.c:46:
+		if ( how || jail_debug ) \

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_notice([subsystem]dev, ... then dev_notice(dev, ... then pr_notice(...  to printk(KERN_NOTICE ...
#93: FILE: security/bsdjail.c:47:
+			printk(KERN_NOTICE "%s: %s: " fmt, \

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#94: FILE: security/bsdjail.c:48:
+				MY_NAME, __FUNCTION__, \

ERROR:SPACING: space prohibited before that close parenthesis ')'
#95: FILE: security/bsdjail.c:49:
+				## arg ); \

ERROR:SPACING: space prohibited after that open parenthesis '('
#96: FILE: security/bsdjail.c:50:
+	} while ( 0 )

ERROR:SPACING: space prohibited before that close parenthesis ')'
#96: FILE: security/bsdjail.c:50:
+	} while ( 0 )

ERROR:INITIALISED_STATIC: do not initialise statics to 0
#101: FILE: security/bsdjail.c:55:
+static int secondary = 0;

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#118: FILE: security/bsdjail.c:72:
+^I__u32 addr4;      ^I/* internal form of ip4_addr_name */$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#128: FILE: security/bsdjail.c:82:
+^Ilong nice;      ^I/* nice level for processes in this jail */$

CHECK:LINE_SPACING: Please don't use multiple blank lines
#154: FILE: security/bsdjail.c:108:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:LINE_SPACING: Missing a blank line after declarations
#213: FILE: security/bsdjail.c:167:
+	struct jail_struct *tsec;
+	tsec = kmalloc(sizeof(struct jail_struct), GFP_KERNEL);

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*tsec)...) over kmalloc(sizeof(struct jail_struct)...)
#213: FILE: security/bsdjail.c:167:
+	tsec = kmalloc(sizeof(struct jail_struct), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#249: FILE: security/bsdjail.c:203:
+		if (sscanf(tsec->ip4_addr_name, "%u.%u.%u.%u",
+					&a, &b, &c, &d) != 4)

ERROR:SPACING: spaces required around that '>' (ctx:VxV)
#251: FILE: security/bsdjail.c:205:
+		if (a>255 || b>255 || c>255 || d>255)
 		     ^

ERROR:SPACING: spaces required around that '>' (ctx:VxV)
#251: FILE: security/bsdjail.c:205:
+		if (a>255 || b>255 || c>255 || d>255)
 		              ^

ERROR:SPACING: spaces required around that '>' (ctx:VxV)
#251: FILE: security/bsdjail.c:205:
+		if (a>255 || b>255 || c>255 || d>255)
 		                       ^

ERROR:SPACING: spaces required around that '>' (ctx:VxV)
#251: FILE: security/bsdjail.c:205:
+		if (a>255 || b>255 || c>255 || d>255)
 		                                ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#253: FILE: security/bsdjail.c:207:
+		tsec->addr4 = htonl((a<<24) | (b<<16) | (c<<8) | d);
 		                      ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#253: FILE: security/bsdjail.c:207:
+		tsec->addr4 = htonl((a<<24) | (b<<16) | (c<<8) | d);
 		                                ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#253: FILE: security/bsdjail.c:207:
+		tsec->addr4 = htonl((a<<24) | (b<<16) | (c<<8) | d);
 		                                          ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#256: FILE: security/bsdjail.c:210:
+		bsdj_debug(DBG, "Network (ipv4) set up (%s)\n",
+			tsec->ip4_addr_name);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#261: FILE: security/bsdjail.c:215:
+		if (sscanf(tsec->ip6_addr_name, "%x:%x:%x:%x:%x:%x:%x:%x",
+			&x[0], &x[1], &x[2], &x[3], &x[4], &x[5], &x[6],

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#263: FILE: security/bsdjail.c:217:
+			printk(KERN_INFO "%s: bad ipv6 addr %s\n", __FUNCTION__,

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#263: FILE: security/bsdjail.c:217:
+			printk(KERN_INFO "%s: bad ipv6 addr %s\n", __FUNCTION__,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#264: FILE: security/bsdjail.c:218:
+			printk(KERN_INFO "%s: bad ipv6 addr %s\n", __FUNCTION__,
+				tsec->ip6_addr_name);

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#267: FILE: security/bsdjail.c:221:
+		for (i=0; i<8; i++) {
 		      ^

ERROR:SPACING: spaces required around that '<' (ctx:VxV)
#267: FILE: security/bsdjail.c:221:
+		for (i=0; i<8; i++) {
 		           ^

WARNING:PRINTK_WITHOUT_KERN_LEVEL: printk() should include KERN_<LEVEL> facility level
#269: FILE: security/bsdjail.c:223:
+				printk("%s: %x > 65535 at %d\n", __FUNCTION__, x[i], i);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#269: FILE: security/bsdjail.c:223:
+				printk("%s: %x > 65535 at %d\n", __FUNCTION__, x[i], i);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#276: FILE: security/bsdjail.c:230:
+		bsdj_debug(DBG, "Network (ipv6) set up (%s)\n",
+			tsec->ip6_addr_name);

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#291: FILE: security/bsdjail.c:245:
+	struct nameidata nd;
 	                 ^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:ONE_SEMICOLON: Statements terminations use 1 semicolon
#292: FILE: security/bsdjail.c:246:
+	struct jail_struct *tsec = tsk->security;;

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#317: FILE: security/bsdjail.c:271:
+	retval = path_lookup(tsec->root_pathname, LOOKUP_FOLLOW | LOOKUP_DIRECTORY, &nd);
 	                                                                             ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#324: FILE: security/bsdjail.c:278:
+	set_fs_root(tsk->fs, nd.mnt, nd.dentry);
 	                     ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#324: FILE: security/bsdjail.c:278:
+	set_fs_root(tsk->fs, nd.mnt, nd.dentry);
 	                             ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#325: FILE: security/bsdjail.c:279:
+	set_fs_pwd(tsk->fs, nd.mnt, nd.dentry);
 	                    ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#325: FILE: security/bsdjail.c:279:
+	set_fs_pwd(tsk->fs, nd.mnt, nd.dentry);
 	                            ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#349: FILE: security/bsdjail.c:303:
+	tsec->mnt = mntget(nd.mnt);
 	                   ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#350: FILE: security/bsdjail.c:304:
+	tsec->dentry = dget(nd.dentry);
 	                    ^^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#351: FILE: security/bsdjail.c:305:
+	path_release(&nd);
 	              ^^

CHECK:BRACES: braces {} should be used on all arms of this statement
#385: FILE: security/bsdjail.c:339:
+	if (strncmp(value, "root ", 5) == 0) {
[...]
+	} else if (strncmp(value, "ip ", 3) == 0) {
[...]
+	} else if (strncmp(value, "ip6 ", 4) == 0) {
[...]
+	} else if (strncmp(value, "slice ", 6) == 0) {
[...]
+	} else if (strncmp(value, "timeslice ", 10) == 0) {
[...]
+	} else if (strncmp(value, "nrtask ", 7) == 0) {
[...]
+	} else if (strncmp(value, "memlock ", 8) == 0) {
[...]
+	} else if (strncmp(value, "data ", 5) == 0) {
[...]
+	} else if (strncmp(value, "nice ", 5) == 0) {
[...]
+	} else
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:NEEDLESS_IF: kfree(NULL) is safe and this check is probably not required
#392: FILE: security/bsdjail.c:346:
+		if (tsec->root_pathname)
+			kfree(tsec->root_pathname);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#394: FILE: security/bsdjail.c:348:
+		len = size-start;
 		          ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#395: FILE: security/bsdjail.c:349:
+		tsec->root_pathname = kmalloc(len+1, GFP_KERNEL);
 		                                 ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#398: FILE: security/bsdjail.c:352:
+		strlcpy(tsec->root_pathname, value+start, len+1);
 		                                  ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#398: FILE: security/bsdjail.c:352:
+		strlcpy(tsec->root_pathname, value+start, len+1);
 		                                             ^

WARNING:STRLCPY: Prefer strscpy over strlcpy - see: https://lore.kernel.org/r/CAHk-=wgfRnXz0W3D37d01q3JFkr_i_uTL=V6A6G1oUZcprmknw@mail.gmail.com/
#398: FILE: security/bsdjail.c:352:
+		strlcpy(tsec->root_pathname, value+start, len+1);

WARNING:NEEDLESS_IF: kfree(NULL) is safe and this check is probably not required
#406: FILE: security/bsdjail.c:360:
+		if (tsec->ip4_addr_name)
+			kfree(tsec->ip4_addr_name);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#408: FILE: security/bsdjail.c:362:
+		len = size-start;
 		          ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#409: FILE: security/bsdjail.c:363:
+		tsec->ip4_addr_name = kmalloc(len+1, GFP_KERNEL);
 		                                 ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#412: FILE: security/bsdjail.c:366:
+		strlcpy(tsec->ip4_addr_name, value+start, len+1);
 		                                  ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#412: FILE: security/bsdjail.c:366:
+		strlcpy(tsec->ip4_addr_name, value+start, len+1);
 		                                             ^

WARNING:STRLCPY: Prefer strscpy over strlcpy - see: https://lore.kernel.org/r/CAHk-=wgfRnXz0W3D37d01q3JFkr_i_uTL=V6A6G1oUZcprmknw@mail.gmail.com/
#412: FILE: security/bsdjail.c:366:
+		strlcpy(tsec->ip4_addr_name, value+start, len+1);

WARNING:NEEDLESS_IF: kfree(NULL) is safe and this check is probably not required
#420: FILE: security/bsdjail.c:374:
+		if (tsec->ip6_addr_name)
+			kfree(tsec->ip6_addr_name);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#422: FILE: security/bsdjail.c:376:
+		len = size-start;
 		          ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#423: FILE: security/bsdjail.c:377:
+		tsec->ip6_addr_name = kmalloc(len+1, GFP_KERNEL);
 		                                 ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#426: FILE: security/bsdjail.c:380:
+		strlcpy(tsec->ip6_addr_name, value+start, len+1);
 		                                  ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#426: FILE: security/bsdjail.c:380:
+		strlcpy(tsec->ip6_addr_name, value+start, len+1);
 		                                             ^

WARNING:STRLCPY: Prefer strscpy over strlcpy - see: https://lore.kernel.org/r/CAHk-=wgfRnXz0W3D37d01q3JFkr_i_uTL=V6A6G1oUZcprmknw@mail.gmail.com/
#426: FILE: security/bsdjail.c:380:
+		strlcpy(tsec->ip6_addr_name, value+start, len+1);

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#435: FILE: security/bsdjail.c:389:
+		val = simple_strtoul(value+6, NULL, 0);
 		                          ^

WARNING:CONSIDER_KSTRTO: simple_strtoul is obsolete, use kstrtoul instead
#435: FILE: security/bsdjail.c:389:
+		val = simple_strtoul(value+6, NULL, 0);

The simple_strtol(), simple_strtoll(), simple_strtoul(), and
simple_strtoull() functions explicitly ignore overflows, which
may lead to unexpected results in callers.  The respective kstrtol(),
kstrtoll(), kstrtoul(), and kstrtoull() functions tend to be the
correct replacements.

See: https://www.kernel.org/doc/html/latest/process/deprecated.html#simple-strtol-simple-strtoll-simple-strtoul-simple-strtoull

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#443: FILE: security/bsdjail.c:397:
+		val = simple_strtoul(value+10, NULL, 0);
 		                          ^

WARNING:CONSIDER_KSTRTO: simple_strtoul is obsolete, use kstrtoul instead
#443: FILE: security/bsdjail.c:397:
+		val = simple_strtoul(value+10, NULL, 0);

CHECK:SPACING: No space is necessary after a cast
#451: FILE: security/bsdjail.c:405:
+		val = (int) simple_strtol(value+7, NULL, 0);

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#451: FILE: security/bsdjail.c:405:
+		val = (int) simple_strtol(value+7, NULL, 0);
 		                               ^

WARNING:CONSIDER_KSTRTO: simple_strtol is obsolete, use kstrtol instead
#451: FILE: security/bsdjail.c:405:
+		val = (int) simple_strtol(value+7, NULL, 0);

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#461: FILE: security/bsdjail.c:415:
+		val = simple_strtoul(value+8, NULL, 0);
 		                          ^

WARNING:CONSIDER_KSTRTO: simple_strtoul is obsolete, use kstrtoul instead
#461: FILE: security/bsdjail.c:415:
+		val = simple_strtoul(value+8, NULL, 0);

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#469: FILE: security/bsdjail.c:423:
+		val = simple_strtoul(value+5, NULL, 0);
 		                          ^

WARNING:CONSIDER_KSTRTO: simple_strtoul is obsolete, use kstrtoul instead
#469: FILE: security/bsdjail.c:423:
+		val = simple_strtoul(value+5, NULL, 0);

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#477: FILE: security/bsdjail.c:431:
+		val = simple_strtoul(value+5, NULL, 0);
 		                          ^

WARNING:CONSIDER_KSTRTO: simple_strtoul is obsolete, use kstrtoul instead
#477: FILE: security/bsdjail.c:431:
+		val = simple_strtoul(value+5, NULL, 0);

CHECK:BRACES: Unbalanced braces around else statement
#479: FILE: security/bsdjail.c:433:
+	} else

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#492: FILE: security/bsdjail.c:446:
+		len += snprintf(buf, maxcnt-len, "%s\n", j->ip6_addr_name);
 		                           ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#527: FILE: security/bsdjail.c:481:
+			err = print_jail_net_info(current->security, value,
+				size);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#536: FILE: security/bsdjail.c:490:
+		err = snprintf(value, size,
+			"Valid keywords:\n"

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#556: FILE: security/bsdjail.c:510:
+		err = snprintf(value, size,
+			"Root: %s\nIPv4: %s\nIPv6: %s\n"

WARNING:SPLIT_STRING: quoted string split across lines
#558: FILE: security/bsdjail.c:512:
+			"max_nrtask %d current nrtask %d max_timeslice %lu "
+			"nice %lu\n"

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#581: FILE: security/bsdjail.c:535:
+jail_file_send_sigiotask(struct task_struct *tsk, struct fown_struct *fown,
+       int fd, int reason)

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#581: FILE: security/bsdjail.c:535:
+       int fd, int reason)$

ERROR:CODE_INDENT: code indent should use tabs where possible
#589: FILE: security/bsdjail.c:543:
+        file = (struct file *) ((long)fown - offsetof(struct file, f_owner));$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

CHECK:SPACING: No space is necessary after a cast
#589: FILE: security/bsdjail.c:543:
+        file = (struct file *) ((long)fown - offsetof(struct file, f_owner));

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#589: FILE: security/bsdjail.c:543:
+        file = (struct file *) ((long)fown - offsetof(struct file, f_owner));$

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#650: FILE: security/bsdjail.c:604:
+jail_ptrace (struct task_struct *tracer, struct task_struct *tracee)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#668: FILE: security/bsdjail.c:622:
+static int jail_socket_unix_bind(struct socket *sock, struct sockaddr *address,
+		int addrlen);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#673: FILE: security/bsdjail.c:627:
+static inline int jail_inet4_bind(struct socket *sock, struct sockaddr *address,
+	int addrlen, struct jail_struct *tsec)

CHECK:SPACING: No space is necessary after a cast
#681: FILE: security/bsdjail.c:635:
+	inaddr = (struct sockaddr_in *) address;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#692: FILE: security/bsdjail.c:646:
+		bsdj_debug(DBG, "Converted to: %u.%u.%u.%u\n",
+			NIPQUAD(sin_addr));

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#701: FILE: security/bsdjail.c:655:
+jail_inet6_bind(struct socket *sock, struct sockaddr *address, int addrlen,
+	struct jail_struct *tsec)

CHECK:SPACING: No space is necessary after a cast
#709: FILE: security/bsdjail.c:663:
+	inaddr6 = (struct sockaddr_in6 *) address;

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_notice([subsystem]dev, ... then dev_notice(dev, ... then pr_notice(...  to printk(KERN_NOTICE ...
#721: FILE: security/bsdjail.c:675:
+	printk(KERN_NOTICE "%s: DENYING\n", __FUNCTION__);

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#721: FILE: security/bsdjail.c:675:
+	printk(KERN_NOTICE "%s: DENYING\n", __FUNCTION__);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_notice([subsystem]dev, ... then dev_notice(dev, ... then pr_notice(...  to printk(KERN_NOTICE ...
#722: FILE: security/bsdjail.c:676:
+	printk(KERN_NOTICE "%s: a %04x:%04x:%04x:%04x:%04x:%04x:%04x:%04x "

WARNING:SPLIT_STRING: quoted string split across lines
#723: FILE: security/bsdjail.c:677:
+	printk(KERN_NOTICE "%s: a %04x:%04x:%04x:%04x:%04x:%04x:%04x:%04x "
+		"j %04x:%04x:%04x:%04x:%04x:%04x:%04x:%04x\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#724: FILE: security/bsdjail.c:678:
+		__FUNCTION__,

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#745: FILE: security/bsdjail.c:699:
+		 * For now we just allow it. */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#748: FILE: security/bsdjail.c:702:
+	switch(address->sa_family) {
+		case AF_INET:
[...]
+		case AF_INET6:
[...]
+		default:

switch should be at the same indent as case.
Example::

  switch (suffix) {
  case 'G':
  case 'g':
          mem <<= 30;
          break;
  case 'M':
  case 'm':
          mem <<= 20;
          break;
  case 'K':
  case 'k':
          mem <<= 10;
          fallthrough;
  default:
          break;
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

ERROR:SPACING: space required before the open parenthesis '('
#748: FILE: security/bsdjail.c:702:
+	switch(address->sa_family) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#769: FILE: security/bsdjail.c:723:
+	if (!tsec || kern || !(tsec->jail_flags & IN_USE) ||
+			!(tsec->jail_flags & (GOT_IPV4 | GOT_IPV6)))

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#772: FILE: security/bsdjail.c:726:
+	switch(family) {
+		case AF_INET:
[...]
+		case AF_INET6:
[...]
+		default:

ERROR:SPACING: space required before the open parenthesis '('
#772: FILE: security/bsdjail.c:726:
+	switch(family) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#790: FILE: security/bsdjail.c:744:
+jail_socket_post_create(struct socket *sock, int family, int type,
+	int protocol, int kern)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#797: FILE: security/bsdjail.c:751:
+	if (!tsec || kern || !(tsec->jail_flags & IN_USE) ||
+			!(tsec->jail_flags & (GOT_IPV4 | GOT_IPV6)))

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#800: FILE: security/bsdjail.c:754:
+	switch(family) {
+		case AF_INET:
[...]
+		case AF_INET6:
[...]
+		default:

ERROR:SPACING: space required before the open parenthesis '('
#800: FILE: security/bsdjail.c:754:
+	switch(family) {

WARNING:RETURN_VOID: void function return statements are not generally useful
#814: FILE: security/bsdjail.c:768:
+	return;
+}

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#824: FILE: security/bsdjail.c:778:
+	if (!tsec || !(tsec->jail_flags & IN_USE) ||
+			!(tsec->jail_flags & (GOT_IPV4 | GOT_IPV6)))

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#827: FILE: security/bsdjail.c:781:
+	switch (sock->sk->sk_family) {
+		case AF_INET:
[...]
+		case AF_INET6:
[...]
+		default:

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#843: FILE: security/bsdjail.c:797:
+
+	}

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#863: FILE: security/bsdjail.c:817:
+jail_socket_unix_bind(struct socket *sock, struct sockaddr *address,
+	int addrlen)

CHECK:SPACING: No space is necessary after a cast
#871: FILE: security/bsdjail.c:825:
+	sunaddr = (struct sockaddr_un *) address;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#902: FILE: security/bsdjail.c:856:
+jail_socket_unix_stream_connect(struct socket *sock,
+	      struct socket *other, struct sock *newsk)

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#916: FILE: security/bsdjail.c:870:
+jail_mount(char * dev_name, struct nameidata *nd, char * type,
                                               ^^

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#916: FILE: security/bsdjail.c:870:
+jail_mount(char * dev_name, struct nameidata *nd, char * type,

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#916: FILE: security/bsdjail.c:870:
+jail_mount(char * dev_name, struct nameidata *nd, char * type,

ERROR:CODE_INDENT: code indent should use tabs where possible
#917: FILE: security/bsdjail.c:871:
+                         unsigned long flags, void * data)$

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#917: FILE: security/bsdjail.c:871:
+jail_mount(char * dev_name, struct nameidata *nd, char * type,
+                         unsigned long flags, void * data)

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#917: FILE: security/bsdjail.c:871:
+                         unsigned long flags, void * data)$

ERROR:POINTER_LOCATION: "foo * bar" should be "foo *bar"
#917: FILE: security/bsdjail.c:871:
+                         unsigned long flags, void * data)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#941: FILE: security/bsdjail.c:895:
+jail_capable (struct task_struct *tsk, int cap)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#954: FILE: security/bsdjail.c:908:
+	if (cap_is_fs_cap (cap) ? tsk->fsuid == 0 : tsk->euid == 0)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#968: FILE: security/bsdjail.c:922:
+jail_security_task_create (unsigned long clone_flags)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1054: FILE: security/bsdjail.c:1008:
+static unsigned name_to_int(struct dentry *dentry)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1058: FILE: security/bsdjail.c:1012:
+	unsigned n = 0;

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1063: FILE: security/bsdjail.c:1017:
+		unsigned c = *name++ - '0';

WARNING:LINE_SPACING: Missing a blank line after declarations
#1064: FILE: security/bsdjail.c:1018:
+		unsigned c = *name++ - '0';
+		if (c > 9)

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#1066: FILE: security/bsdjail.c:1020:
+		if (n >= (~0U-9)/10)
 		             ^

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#1066: FILE: security/bsdjail.c:1020:
+		if (n >= (~0U-9)/10)
 		                ^

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1088: FILE: security/bsdjail.c:1042:
+				    struct nameidata *nd)
 				                      ^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1088: FILE: security/bsdjail.c:1042:
+jail_proc_inode_permission(struct inode *inode, int mask,
+				    struct nameidata *nd)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1092: FILE: security/bsdjail.c:1046:
+	unsigned pid;

WARNING:LINE_SPACING: Missing a blank line after declarations
#1097: FILE: security/bsdjail.c:1051:
+		struct qstr *dname = &dentry->d_name;
+		if (strcmp(dname->name, "scsi") == 0 ||

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1098: FILE: security/bsdjail.c:1052:
+		if (strcmp(dname->name, "scsi") == 0 ||
+			strcmp(dname->name, "sys") == 0 ||

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1117: FILE: security/bsdjail.c:1071:
+is_jailroot_parent(struct dentry *candidate, struct dentry *root,
+	struct vfsmount *rootmnt)

ERROR:SPACING: spaces required around that '!=' (ctx:VxV)
#1132: FILE: security/bsdjail.c:1086:
+	if (rootmnt->mnt_root == root && rootmnt->mnt_mountpoint!=root) {
 	                                                        ^

CHECK:LINE_SPACING: Please use a blank line after function/struct/union/enum declarations
#1157: FILE: security/bsdjail.c:1111:
+}
+/*

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#1176: FILE: security/bsdjail.c:1130:
+ * ^Imay deny permission.$

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1182: FILE: security/bsdjail.c:1136:
+				    struct nameidata *nd)
 				                      ^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1182: FILE: security/bsdjail.c:1136:
+jail_inode_permission(struct inode *inode, int mask,
+				    struct nameidata *nd)

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1189: FILE: security/bsdjail.c:1143:
+	if (!nd)
 	     ^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1193: FILE: security/bsdjail.c:1147:
+	if (nd->dentry &&
+		strcmp(nd->dentry->d_sb->s_type->name, "proc") == 0) {

WARNING:TYPO_SPELLING: 'nd' may be misspelled - perhaps 'and'?
#1194: FILE: security/bsdjail.c:1148:
+		return jail_proc_inode_permission(inode, mask, nd);
 		                                               ^^

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#1196: FILE: security/bsdjail.c:1150:
+
+	}

CHECK:SPACING: spaces preferred around that '&' (ctx:VxV)
#1198: FILE: security/bsdjail.c:1152:
+	if (!(mask&MAY_EXEC))
 	          ^

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1222: FILE: security/bsdjail.c:1176:
+	unsigned pid = name_to_int(dentry);

ERROR:SPACING: spaces required around that '==' (ctx:VxV)
#1266: FILE: security/bsdjail.c:1220:
+	if (sig==SIGCHLD)
 	       ^

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1276: FILE: security/bsdjail.c:1230:
+static int jail_task_setrlimit (unsigned int resource, struct rlimit *new_rlim)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1284: FILE: security/bsdjail.c:1238:
+static int jail_task_setscheduler (struct task_struct *p, int policy,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1285: FILE: security/bsdjail.c:1239:
+static int jail_task_setscheduler (struct task_struct *p, int policy,
+				    struct sched_param *lp)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1318: FILE: security/bsdjail.c:1272:
+jail_shm_alloc_security (struct shmid_kernel *shp)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1330: FILE: security/bsdjail.c:1284:
+jail_shm_free_security (struct shmid_kernel *shp)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1336: FILE: security/bsdjail.c:1290:
+jail_shm_associate (struct shmid_kernel *shp, int shmflg)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1396: FILE: security/bsdjail.c:1350:
+jail_msg_queue_msgrcv(struct msg_queue *msq, struct msg_msg *msg,
+		struct task_struct *target, long type, int mode)

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1435: FILE: security/bsdjail.c:1389:
+jail_sem_semop(struct sem_array *sma, struct sembuf *sops, unsigned nsops,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1436: FILE: security/bsdjail.c:1390:
+jail_sem_semop(struct sem_array *sma, struct sembuf *sops, unsigned nsops,
+	int alter)

ERROR:CODE_INDENT: code indent should use tabs where possible
#1467: FILE: security/bsdjail.c:1421:
+        .unix_stream_connect =^I^Ijail_socket_unix_stream_connect,$

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#1467: FILE: security/bsdjail.c:1421:
+        .unix_stream_connect =^I^Ijail_socket_unix_stream_connect,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#1480: FILE: security/bsdjail.c:1434:
+^I.shm_alloc_security = ^I^Ijail_shm_alloc_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#1481: FILE: security/bsdjail.c:1435:
+^I.shm_free_security = ^I^Ijail_shm_free_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#1493: FILE: security/bsdjail.c:1447:
+^I.sem_alloc_security = ^I^Ijail_sem_alloc_security,$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#1494: FILE: security/bsdjail.c:1448:
+^I.sem_free_security =  ^I^Ijail_sem_free_security,$

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1500: FILE: security/bsdjail.c:1454:
+static int __init bsdjail_init (void)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1504: FILE: security/bsdjail.c:1458:
+	if (register_security (&bsdjail_security_ops)) {

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around '&bsdjail_security_ops'
#1504: FILE: security/bsdjail.c:1458:
+	if (register_security (&bsdjail_security_ops)) {

Parentheses are not required in the following cases:

  1. Function pointer uses::

      (foo->bar)();

    could be::

      foo->bar();

  2. Comparisons in if::

      if ((foo->bar) && (foo->baz))
      if ((foo == bar))

    could be::

      if (foo->bar && foo->baz)
      if (foo == bar)

  3. addressof/dereference single Lvalues::

      &(foo->bar)
      *(foo->bar)

    could be::

      &foo->bar
      *foo->bar

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1505: FILE: security/bsdjail.c:1459:
+		printk (KERN_INFO

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1505: FILE: security/bsdjail.c:1459:
+		printk (KERN_INFO

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1510: FILE: security/bsdjail.c:1464:
+			printk (KERN_INFO "Failure registering BSD Jail "

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1510: FILE: security/bsdjail.c:1464:
+			printk (KERN_INFO "Failure registering BSD Jail "

WARNING:SPLIT_STRING: quoted string split across lines
#1511: FILE: security/bsdjail.c:1465:
+			printk (KERN_INFO "Failure registering BSD Jail "
+				" module with primary security module.\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1516: FILE: security/bsdjail.c:1470:
+	printk (KERN_INFO "BSD Jail module initialized.\n");

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1516: FILE: security/bsdjail.c:1470:
+	printk (KERN_INFO "BSD Jail module initialized.\n");

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1521: FILE: security/bsdjail.c:1475:
+static void __exit bsdjail_exit (void)

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1524: FILE: security/bsdjail.c:1478:
+		if (mod_unreg_security (MY_NAME, &bsdjail_security_ops))

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1525: FILE: security/bsdjail.c:1479:
+			printk (KERN_INFO "Failure unregistering BSD Jail "

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1525: FILE: security/bsdjail.c:1479:
+			printk (KERN_INFO "Failure unregistering BSD Jail "

WARNING:SPLIT_STRING: quoted string split across lines
#1526: FILE: security/bsdjail.c:1480:
+			printk (KERN_INFO "Failure unregistering BSD Jail "
+				" module with primary module.\n");

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1528: FILE: security/bsdjail.c:1482:
+		if (unregister_security (&bsdjail_security_ops)) {

CHECK:UNNECESSARY_PARENTHESES: Unnecessary parentheses around '&bsdjail_security_ops'
#1528: FILE: security/bsdjail.c:1482:
+		if (unregister_security (&bsdjail_security_ops)) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1529: FILE: security/bsdjail.c:1483:
+			printk (KERN_INFO "Failure unregistering BSD Jail "

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1529: FILE: security/bsdjail.c:1483:
+			printk (KERN_INFO "Failure unregistering BSD Jail "

WARNING:SPLIT_STRING: quoted string split across lines
#1530: FILE: security/bsdjail.c:1484:
+			printk (KERN_INFO "Failure unregistering BSD Jail "
+				"module with the kernel\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#1534: FILE: security/bsdjail.c:1488:
+	printk (KERN_INFO "BSD Jail module removed\n");

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1534: FILE: security/bsdjail.c:1488:
+	printk (KERN_INFO "BSD Jail module removed\n");

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1537: FILE: security/bsdjail.c:1491:
+security_initcall (bsdjail_init);

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#1538: FILE: security/bsdjail.c:1492:
+module_exit (bsdjail_exit);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#1557: FILE: security/Kconfig:57:
+^I  $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000243523.commit.8e73d15569f5a0577a8fa73f87817b476f68864f total: 30 errors, 96 warnings, 68 checks, 1515 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

./tmp.EfiDkiSq0Q//home/fedora/lkml-analysis/lkml/0/patch.offset.0000243523.commit.8e73d15569f5a0577a8fa73f87817b476f68864f has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
