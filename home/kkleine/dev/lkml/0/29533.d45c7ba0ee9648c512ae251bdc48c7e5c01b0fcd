WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#61: FILE: drivers/misc/ioc4.c:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#137: FILE: drivers/misc/ioc4.c:77:
+			printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#139: FILE: drivers/misc/ioc4.c:79:
+			       "%s: IOC4 submodule %s probe failed "
+			       "for pci_dev %s",

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#140: FILE: drivers/misc/ioc4.c:80:
+			       __FUNCTION__, module_name(is->is_owner),

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#164: FILE: drivers/misc/ioc4.c:104:
+			printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#166: FILE: drivers/misc/ioc4.c:106:
+			       "%s: IOC4 submodule %s remove failed "
+			       "for pci_dev %s.\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#167: FILE: drivers/misc/ioc4.c:107:
+			       __FUNCTION__, module_name(is->is_owner),

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#180: FILE: drivers/misc/ioc4.c:120:
+	(1000*IOC4_EXTINT_COUNT_DIVISOR/IOC4_CALIBRATE_LOW_MHZ)
 	     ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#180: FILE: drivers/misc/ioc4.c:120:
+	(1000*IOC4_EXTINT_COUNT_DIVISOR/IOC4_CALIBRATE_LOW_MHZ)
 	                               ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#182: FILE: drivers/misc/ioc4.c:122:
+	(1000*IOC4_EXTINT_COUNT_DIVISOR/IOC4_CALIBRATE_HIGH_MHZ)
 	     ^

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#182: FILE: drivers/misc/ioc4.c:122:
+	(1000*IOC4_EXTINT_COUNT_DIVISOR/IOC4_CALIBRATE_HIGH_MHZ)
 	                               ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#184: FILE: drivers/misc/ioc4.c:124:
+	(1000*IOC4_EXTINT_COUNT_DIVISOR/IOC4_CALIBRATE_DEFAULT_MHZ)
 	     ^

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#184: FILE: drivers/misc/ioc4.c:124:
+	(1000*IOC4_EXTINT_COUNT_DIVISOR/IOC4_CALIBRATE_DEFAULT_MHZ)
 	                               ^

CHECK:PREFER_KERNEL_TYPES: Prefer kernel type 'u64' over 'uint64_t'
#210: FILE: drivers/misc/ioc4.c:150:
+	uint64_t start, end, period;

CHECK:BRACES: braces {} should be used on all arms of this statement
#237: FILE: drivers/misc/ioc4.c:177:
+			if (count == IOC4_CALIBRATE_END) {
[...]
+			} else if (count == IOC4_CALIBRATE_DISCARD)
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#264: FILE: drivers/misc/ioc4.c:204:
+		printk(KERN_INFO

WARNING:SPLIT_STRING: quoted string split across lines
#266: FILE: drivers/misc/ioc4.c:206:
+		       "IOC4 %s: Clock calibration failed.  Assuming"
+		       "PCI clock is %d ns.\n",

WARNING:MISSING_SPACE: break quoted strings at a space character
#266: FILE: drivers/misc/ioc4.c:206:
+		       "IOC4 %s: Clock calibration failed.  Assuming"
+		       "PCI clock is %d ns.\n",

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#271: FILE: drivers/misc/ioc4.c:211:
+		printk(KERN_DEBUG

WARNING:TYPO_SPELLING: 'extint' may be misspelled - perhaps 'extinct'?
#277: FILE: drivers/misc/ioc4.c:217:
+	/* Remember results.  We store the extint clock period rather
 	                                   ^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:CONSTANT_COMPARISON: Comparisons should place the constant on the right side of the test
#305: FILE: drivers/misc/ioc4.c:245:
+		    3 == PCI_SLOT(pdev->devfn))

Comparisons with a constant or upper case identifier on the left
side of the test should be avoided.

WARNING:CONSTANT_COMPARISON: Comparisons should place the constant on the right side of the test
#309: FILE: drivers/misc/ioc4.c:249:
+	if (NULL != pdev)

WARNING:CONSTANT_COMPARISON: Comparisons should place the constant on the right side of the test
#319: FILE: drivers/misc/ioc4.c:259:
+		    3 == PCI_SLOT(pdev->devfn))

WARNING:CONSTANT_COMPARISON: Comparisons should place the constant on the right side of the test
#323: FILE: drivers/misc/ioc4.c:263:
+	if (NULL != pdev)

CHECK:PREFER_KERNEL_TYPES: Prefer kernel type 'u32' over 'uint32_t'
#336: FILE: drivers/misc/ioc4.c:276:
+	uint32_t pcmd;

ERROR:ASSIGN_IN_IF: do not use assignment in if condition
#340: FILE: drivers/misc/ioc4.c:280:
+	if ((ret = pci_enable_device(pdev))) {

Do not use assignments in if condition.
Example::

  if ((foo = bar(...)) < BAZ) {

should be written as::

  foo = bar(...);
  if (foo < BAZ) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#341: FILE: drivers/misc/ioc4.c:281:
+		printk(KERN_WARNING

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#343: FILE: drivers/misc/ioc4.c:283:
+		       __FUNCTION__, pci_name(pdev));

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*idd)...) over kmalloc(sizeof(struct ioc4_driver_data)...)
#349: FILE: drivers/misc/ioc4.c:289:
+	idd = kmalloc(sizeof(struct ioc4_driver_data), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#351: FILE: drivers/misc/ioc4.c:291:
+		printk(KERN_WARNING

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#351: FILE: drivers/misc/ioc4.c:291:
+	if (!idd) {
+		printk(KERN_WARNING

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#353: FILE: drivers/misc/ioc4.c:293:
+		       __FUNCTION__, pci_name(pdev));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#365: FILE: drivers/misc/ioc4.c:305:
+		printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#367: FILE: drivers/misc/ioc4.c:307:
+		       "%s: Unable to find IOC4 misc resource "
+		       "for pci_dev %s.\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#368: FILE: drivers/misc/ioc4.c:308:
+		       __FUNCTION__, pci_name(idd->idd_pdev));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#374: FILE: drivers/misc/ioc4.c:314:
+		printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#376: FILE: drivers/misc/ioc4.c:316:
+		       "%s: Unable to request IOC4 misc region "
+		       "for pci_dev %s.\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#377: FILE: drivers/misc/ioc4.c:317:
+		       __FUNCTION__, pci_name(idd->idd_pdev));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#384: FILE: drivers/misc/ioc4.c:324:
+		printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#386: FILE: drivers/misc/ioc4.c:326:
+		       "%s: Unable to remap IOC4 misc region "
+		       "for pci_dev %s.\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#387: FILE: drivers/misc/ioc4.c:327:
+		       __FUNCTION__, pci_name(idd->idd_pdev));

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#396: FILE: drivers/misc/ioc4.c:336:
+	printk(KERN_INFO "IOC4 %s: %s card detected.\n", pci_name(pdev),

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#430: FILE: drivers/misc/ioc4.c:370:
+			printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#432: FILE: drivers/misc/ioc4.c:372:
+			       "%s: IOC4 submodule 0x%s probe failed "
+			       "for pci_dev %s.\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#433: FILE: drivers/misc/ioc4.c:373:
+			       __FUNCTION__, module_name(is->is_owner),

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#464: FILE: drivers/misc/ioc4.c:404:
+			printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#466: FILE: drivers/misc/ioc4.c:406:
+			       "%s: IOC4 submodule 0x%s remove failed "
+			       "for pci_dev %s.\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#467: FILE: drivers/misc/ioc4.c:407:
+			       __FUNCTION__, module_name(is->is_owner),

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#476: FILE: drivers/misc/ioc4.c:416:
+		printk(KERN_WARNING

WARNING:SPLIT_STRING: quoted string split across lines
#478: FILE: drivers/misc/ioc4.c:418:
+		       "%s: Unable to get IOC4 misc mapping for pci_dev %s. "
+		       "Device removal may be incomplete.\n",

WARNING:USE_FUNC: __func__ should be used instead of gcc specific __FUNCTION__
#479: FILE: drivers/misc/ioc4.c:419:
+		       __FUNCTION__, pci_name(idd->idd_pdev));

WARNING:HOTPLUG_SECTION: Using __devinit is unnecessary
#513: FILE: drivers/misc/ioc4.c:453:
+static int __devinit

WARNING:HOTPLUG_SECTION: Using __devexit is unnecessary
#520: FILE: drivers/misc/ioc4.c:460:
+static void __devexit

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#533: FILE: drivers/misc/ioc4.c:473:
+EXPORT_SYMBOL(ioc4_register_submodule);

EXPORT_SYMBOL should immediately follow the symbol to be exported.

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#534: FILE: drivers/misc/ioc4.c:474:
+EXPORT_SYMBOL(ioc4_unregister_submodule);

WARNING:CONFIG_DESCRIPTION: please write a help paragraph that fully describes the config symbol
#1091: FILE: drivers/misc/Kconfig:31:
+config SGI_IOC4
+	tristate "SGI IOC4 Base IO support"
+	default m
+	---help---
+	  This option enables basic support for the IOC4 chip on certain
+	  SGI IO controller cards (IO9, IO10, and PCI-RT).  This option
+	  does not enable any specific functions on such a card, but provides
+	  necessary infrastructure for other drivers to utilize.
+
+	  If you have an SGI Altix with an IOC4-based card say Y.
+	  Otherwise say N.
+

Kconfig symbols should have a help text which fully describes
it.

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.29533.commit.d45c7ba0ee9648c512ae251bdc48c7e5c01b0fcd total: 1 errors, 45 warnings, 10 checks, 553 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.29533.commit.d45c7ba0ee9648c512ae251bdc48c7e5c01b0fcd has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
