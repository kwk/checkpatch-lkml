CHECK:LINE_SPACING: Please don't use multiple blank lines
#79: FILE: drivers/scsi/sata_nv.c:115:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'off' - possible side-effects?
#83: FILE: drivers/scsi/sata_nv.c:119:
+#define BF_INS(v, ins, off, bc)				\
+	(((v) & ~((((1 << (bc)) - 1)) << (off))) |	\
+	(((u8)(ins)) << (off)))

CHECK:MACRO_ARG_REUSE: Macro argument reuse 'off' - possible side-effects?
#90: FILE: drivers/scsi/sata_nv.c:126:
+#define BF_INS_U32(v, ins, off, bc)			\
+	(((v) & ~((((1 << (bc)) - 1)) << (off))) |	\
+	(((u32)(ins)) << (off)))

ERROR:TRAILING_WHITESPACE: trailing whitespace
#97: FILE: drivers/scsi/sata_nv.c:133:
+#define SET_CMD(v, cmd)^I^IBF_INS(v, cmd, 5, 3) $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#106: FILE: drivers/scsi/sata_nv.c:142:
+union nv_sgpio_nvcr $

ERROR:OPEN_BRACE: open brace '{' following union go on the same line
#107: FILE: drivers/scsi/sata_nv.c:143:
+union nv_sgpio_nvcr 
+{

The opening brace should be following the function definitions on the
next line.  For any non-functional block it should be on the same line
as the last construct.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#117: FILE: drivers/scsi/sata_nv.c:153:
+union nv_sgpio_tx $

ERROR:OPEN_BRACE: open brace '{' following union go on the same line
#118: FILE: drivers/scsi/sata_nv.c:154:
+union nv_sgpio_tx 
+{

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#120: FILE: drivers/scsi/sata_nv.c:156:
+^Iu32 ^Iall;$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#123: FILE: drivers/scsi/sata_nv.c:159:
+struct nv_sgpio_cb $

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#124: FILE: drivers/scsi/sata_nv.c:160:
+struct nv_sgpio_cb 
+{

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#133: FILE: drivers/scsi/sata_nv.c:169:
+struct nv_sgpio_host_share
+{

CHECK:UNCOMMENTED_DEFINITION: spinlock_t definition without comment
#134: FILE: drivers/scsi/sata_nv.c:170:
+	spinlock_t	*plock;

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#139: FILE: drivers/scsi/sata_nv.c:175:
+struct nv_sgpio_host_flags
+{

ERROR:TRAILING_WHITESPACE: trailing whitespace
#144: FILE: drivers/scsi/sata_nv.c:180:
+^I$

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#146: FILE: drivers/scsi/sata_nv.c:182:
+struct nv_host_sgpio
+{

ERROR:TRAILING_WHITESPACE: trailing whitespace
#149: FILE: drivers/scsi/sata_nv.c:185:
+^Istruct nv_sgpio_cb^I^I*pcb;^I$

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#155: FILE: drivers/scsi/sata_nv.c:191:
+struct nv_sgpio_port_flags
+{

ERROR:TRAILING_WHITESPACE: trailing whitespace
#161: FILE: drivers/scsi/sata_nv.c:197:
+struct nv_sgpio_led $

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#162: FILE: drivers/scsi/sata_nv.c:198:
+struct nv_sgpio_led 
+{

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#165: FILE: drivers/scsi/sata_nv.c:201:
+^Iu8      ^I^I^Ilast_cons_active;$

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#169: FILE: drivers/scsi/sata_nv.c:205:
+struct nv_port_sgpio
+{

WARNING:LINE_SPACING: Missing a blank line after declarations
#189: FILE: drivers/scsi/sata_nv.c:225:
+	u8 devfn = (to_pci_dev(host_set->dev))->devfn;
+	return (PCI_FUNC(devfn));

ERROR:RETURN_PARENTHESES: return is not a function, parentheses are not required
#189: FILE: drivers/scsi/sata_nv.c:225:
+	return (PCI_FUNC(devfn));

return is not a function and as such doesn't need parentheses::

  return (bar);

can simply be::

  return bar;

CHECK:SPACING: spaces preferred around that '/' (ctx:VxV)
#194: FILE: drivers/scsi/sata_nv.c:230:
+	return (nv_sgpio_get_func(host_set)/NV_CNTRLR_SHARE_INIT);
 	                                   ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:LINE_SPACING: Missing a blank line after declarations
#206: FILE: drivers/scsi/sata_nv.c:242:
+	u8 cntrlr = nv_sgpio_get_func(ap->host_set);
+	return (nv_sgpio_calc_tx_offset(cntrlr, ap->port_no));

ERROR:RETURN_PARENTHESES: return is not a function, parentheses are not required
#206: FILE: drivers/scsi/sata_nv.c:242:
+	return (nv_sgpio_calc_tx_offset(cntrlr, ap->port_no));

ERROR:CORRUPTED_PATCH: patch seems to be corrupt (line wrapped?)
#217: FILE: drivers/scsi/sata_nv.c:252:
pci_device_id *ent);

The patch seems to be corrupted or lines are wrapped.
Please regenerate the patch file before sending it to the maintainer.

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#226: FILE: drivers/scsi/sata_nv.c:262:
+static void nv_host_stop (struct ata_host_set *host_set);

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#238: FILE: drivers/scsi/sata_nv.c:323:
+struct nv_host
+{

ERROR:OPEN_BRACE: open brace '{' following struct go on the same line
#244: FILE: drivers/scsi/sata_nv.c:329:
+struct nv_port
+{

ERROR:TRAILING_WHITESPACE: trailing whitespace
#251: FILE: drivers/scsi/sata_nv.c:336:
+static void nv_sgpio_set_timer(struct timer_list *ptimer, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#252: FILE: drivers/scsi/sata_nv.c:337:
+static void nv_sgpio_set_timer(struct timer_list *ptimer, 
+				unsigned int timeout_msec);

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*host)...) over kmalloc(sizeof(struct nv_host)...)
#343: FILE: drivers/scsi/sata_nv.c:721:
+	host = kmalloc(sizeof(struct nv_host), GFP_KERNEL);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

WARNING:BRACES: braces {} are not necessary for single statement blocks
#372: FILE: drivers/scsi/sata_nv.c:779:
+	if (stat) {
+		return stat;
+	}

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*port)...) over kmalloc(sizeof(struct nv_port)...)
#376: FILE: drivers/scsi/sata_nv.c:783:
+	port = kmalloc(sizeof(struct nv_port), GFP_KERNEL);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#377: FILE: drivers/scsi/sata_nv.c:784:
+^Iif (!port) $

WARNING:NEEDLESS_IF: kfree(NULL) is safe and this check is probably not required
#394: FILE: drivers/scsi/sata_nv.c:801:
+	if (ap->private_data) {
+		kfree(ap->private_data);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#404: FILE: drivers/scsi/sata_nv.c:811:
+^Iif (port) $

ERROR:RETURN_PARENTHESES: return is not a function, parentheses are not required
#406: FILE: drivers/scsi/sata_nv.c:813:
+	return (ata_qc_issue_prot(qc));

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#423: FILE: drivers/scsi/sata_nv.c:830:
+static void nv_host_stop (struct ata_host_set *host_set)

CHECK:LINE_SPACING: Please don't use multiple blank lines
#427: FILE: drivers/scsi/sata_nv.c:834:
+
+

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#432: FILE: drivers/scsi/sata_nv.c:839:
+
+}

ERROR:TRAILING_WHITESPACE: trailing whitespace
#436: FILE: drivers/scsi/sata_nv.c:843:
+^Iu16 csr_add; $

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#440: FILE: drivers/scsi/sata_nv.c:847:
+	u8 pro=0;
 	      ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#441: FILE: drivers/scsi/sata_nv.c:848:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#445: FILE: drivers/scsi/sata_nv.c:852:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#448: FILE: drivers/scsi/sata_nv.c:855:
+^I$

CHECK:SPACING: spaces preferred around that '&' (ctx:VxV)
#449: FILE: drivers/scsi/sata_nv.c:856:
+	if (!(pro&0x40))
 	         ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#450: FILE: drivers/scsi/sata_nv.c:857:
+^I^Ireturn;^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#451: FILE: drivers/scsi/sata_nv.c:858:
+^I^I$

ERROR:SPACING: spaces required around that '!=' (ctx:VxV)
#456: FILE: drivers/scsi/sata_nv.c:863:
+	if (phost->host_sgpio.pcb->nvcr.bit.init_cnt!=0x2 ||
 	                                            ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#458: FILE: drivers/scsi/sata_nv.c:864:
+	if (phost->host_sgpio.pcb->nvcr.bit.init_cnt!=0x2 ||
+		return;

ERROR:TRAILING_WHITESPACE: trailing whitespace
#459: FILE: drivers/scsi/sata_nv.c:865:
+^I^I$

ERROR:SPACING: spaces required around that '<=' (ctx:WxV)
#460: FILE: drivers/scsi/sata_nv.c:866:
+	if (temp32 <=0x200 || temp32 >=0xFFFE )
 	           ^

ERROR:SPACING: spaces required around that '>=' (ctx:WxV)
#460: FILE: drivers/scsi/sata_nv.c:866:
+	if (temp32 <=0x200 || temp32 >=0xFFFE )
 	                             ^

ERROR:SPACING: space prohibited before that close parenthesis ')'
#460: FILE: drivers/scsi/sata_nv.c:866:
+	if (temp32 <=0x200 || temp32 >=0xFFFE )

ERROR:TRAILING_WHITESPACE: trailing whitespace
#462: FILE: drivers/scsi/sata_nv.c:868:
+^I^I$

ERROR:SPACING: spaces required around that '<=' (ctx:VxV)
#463: FILE: drivers/scsi/sata_nv.c:869:
+	if (cb_add<=0x80000 || cb_add>=0x9FC00)
 	          ^

ERROR:SPACING: spaces required around that '>=' (ctx:VxV)
#463: FILE: drivers/scsi/sata_nv.c:869:
+	if (cb_add<=0x80000 || cb_add>=0x9FC00)
 	                             ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#465: FILE: drivers/scsi/sata_nv.c:871:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#470: FILE: drivers/scsi/sata_nv.c:876:
+^I^Iphost->host_sgpio.pcb->scratch_space = $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#474: FILE: drivers/scsi/sata_nv.c:880:
+^I^Iphost->host_sgpio.pcb->cr0 = $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#480: FILE: drivers/scsi/sata_nv.c:886:
+^Iphost->host_sgpio.share = $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#487: FILE: drivers/scsi/sata_nv.c:893:
+^Inv_sgpio_set_timer(&phost->host_sgpio.sgpio_timer, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#488: FILE: drivers/scsi/sata_nv.c:894:
+	nv_sgpio_set_timer(&phost->host_sgpio.sgpio_timer, 
+				NV_SGPIO_UPDATE_TICK);

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#503: FILE: drivers/scsi/sata_nv.c:908:
+{
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#514: FILE: drivers/scsi/sata_nv.c:919:
+^Ielse $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#527: FILE: drivers/scsi/sata_nv.c:932:
+^I^Istruct ata_port *ap; $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#530: FILE: drivers/scsi/sata_nv.c:935:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#536: FILE: drivers/scsi/sata_nv.c:941:
+^I^I^Icontinue;            ^I^I$

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#536: FILE: drivers/scsi/sata_nv.c:941:
+^I^I^Icontinue;            ^I^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#541: FILE: drivers/scsi/sata_nv.c:945:
+^I^I^Itx.tx_port[port_offset] = $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#541: FILE: drivers/scsi/sata_nv.c:945:
+		if (nv_sgpio_update_led(&port->port_sgpio.activity,
+			tx.tx_port[port_offset] = 

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#544: FILE: drivers/scsi/sata_nv.c:947:
+				SET_ACTIVITY(tx.tx_port[port_offset],
+			host->host_sgpio.flags.need_update = 1;

WARNING:TABSTOP: Statements should start on a tabstop
#545: FILE: drivers/scsi/sata_nv.c:948:
+	       }

CHECK:LINE_SPACING: Please don't use multiple blank lines
#548: FILE: drivers/scsi/sata_nv.c:951:
+
+

ERROR:TRAILING_WHITESPACE: trailing whitespace
#550: FILE: drivers/scsi/sata_nv.c:953:
+^I^Ispin_lock(host->host_sgpio.share.plock);    $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#551: FILE: drivers/scsi/sata_nv.c:954:
+^I^Iif (nv_sgpio_get_func(host_set) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#564: FILE: drivers/scsi/sata_nv.c:965:
+^I^Ispin_unlock(host->host_sgpio.share.plock);     $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#565: FILE: drivers/scsi/sata_nv.c:966:
+ $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#565: FILE: drivers/scsi/sata_nv.c:966:
+ $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#566: FILE: drivers/scsi/sata_nv.c:967:
+^I^Iif (nv_sgpio_send_cmd(host, NV_SGPIO_CMD_WRITE_DATA)) { $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#571: FILE: drivers/scsi/sata_nv.c:972:
+^I^Inv_sgpio_set_timer(&host->host_sgpio.sgpio_timer, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#572: FILE: drivers/scsi/sata_nv.c:973:
+		nv_sgpio_set_timer(&host->host_sgpio.sgpio_timer, 
+				NV_SGPIO_UPDATE_TICK);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#583: FILE: drivers/scsi/sata_nv.c:984:
+^Ispin_lock(host->host_sgpio.share.plock);    $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#592: FILE: drivers/scsi/sata_nv.c:990:
+^I^I^I$

CHECK:BRACES: Blank lines aren't necessary after an open brace '{'
#592: FILE: drivers/scsi/sata_nv.c:990:
+			(GET_CMD_STATUS(csr) == NV_SGPIO_CMD_ACTIVE)) {
+			

ERROR:TRAILING_WHITESPACE: trailing whitespace
#594: FILE: drivers/scsi/sata_nv.c:992:
+^I^I^Ihost->host_sgpio.pcb->cr0 = $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#598: FILE: drivers/scsi/sata_nv.c:996:
+^I^I^Inv_sgpio_set_csr(csr, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#599: FILE: drivers/scsi/sata_nv.c:997:
+			nv_sgpio_set_csr(csr, 
+				(unsigned long)host->host_sgpio.pcsr);

ERROR:TRAILING_WHITESPACE: trailing whitespace
#603: FILE: drivers/scsi/sata_nv.c:1001:
+^I^Inv_sgpio_set_timer(&host->host_sgpio.sgpio_timer, $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#604: FILE: drivers/scsi/sata_nv.c:1002:
+		nv_sgpio_set_timer(&host->host_sgpio.sgpio_timer, 
+			NV_SGPIO_UPDATE_TICK);

WARNING:UNNECESSARY_ELSE: else is not generally useful after a break or return
#606: FILE: drivers/scsi/sata_nv.c:1004:
+		return 1;
+	} else {

ERROR:TRAILING_WHITESPACE: trailing whitespace
#608: FILE: drivers/scsi/sata_nv.c:1006:
+^I^Inv_sgpio_set_timer(&host->host_sgpio.sgpio_timer, $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#609: FILE: drivers/scsi/sata_nv.c:1007:
+^I^I^I^I(NV_SGPIO_MIN_UPDATE_DELTA - $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#609: FILE: drivers/scsi/sata_nv.c:1007:
+		nv_sgpio_set_timer(&host->host_sgpio.sgpio_timer, 
+				(NV_SGPIO_MIN_UPDATE_DELTA - 

ERROR:TRAILING_WHITESPACE: trailing whitespace
#634: FILE: drivers/scsi/sata_nv.c:1031:
+^Iif (*on_off) $

ERROR:TRAILING_WHITESPACE: trailing whitespace
#635: FILE: drivers/scsi/sata_nv.c:1032:
+^I^Iled->last_cons_active++;^I$

ERROR:SPACING: space required after that ',' (ctx:VxV)
#671: FILE: drivers/scsi/sata_nv.c:1067:
+		nv_sgpio_set_csr(csr,(unsigned
 		                    ^

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.23079.commit.0f519908848aee39a1733dcd84fd3e1d475481ef total: 66 errors, 12 warnings, 22 checks, 652 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.23079.commit.0f519908848aee39a1733dcd84fd3e1d475481ef has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
