WARNING:TYPO_SPELLING: 'acconting' may be misspelled - perhaps 'accounting'?
#25: 
Subject: [RFC][PATCH 6/7] UBC: kernel memory acconting (mark objects)
                                             ^^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

WARNING:BAD_SIGN_OFF: 'Signed-off-by:' is the preferred signature form
#36: 
Signed-Off-By: Pavel Emelianov <xemul@sw.ru>

The signed-off-by line does not fall in line with the standards
specified by the community.

See: https://www.kernel.org/doc/html/latest/process/submitting-patches.html#developer-s-certificate-of-origin-1-1

WARNING:BAD_SIGN_OFF: 'Signed-off-by:' is the preferred signature form
#37: 
Signed-Off-By: Kirill Korotaev <dev@sw.ru>

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#70: FILE: arch/i386/kernel/ldt.c:42:
+		newldt = vmalloc_ub(mincount*LDT_ENTRY_SIZE);
 		                            ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#73: FILE: arch/i386/kernel/ldt.c:44:
+		newldt = kmalloc(mincount*LDT_ENTRY_SIZE, GFP_KERNEL_UBC);
 		                         ^

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#104: FILE: arch/i386/mm/pgtable.c:161:
+	pte = alloc_pages(GFP_KERNEL|__GFP_HIGHMEM|__GFP_REPEAT|__GFP_ZERO|
 	                            ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#104: FILE: arch/i386/mm/pgtable.c:161:
+	pte = alloc_pages(GFP_KERNEL|__GFP_HIGHMEM|__GFP_REPEAT|__GFP_ZERO|
 	                                          ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#104: FILE: arch/i386/mm/pgtable.c:161:
+	pte = alloc_pages(GFP_KERNEL|__GFP_HIGHMEM|__GFP_REPEAT|__GFP_ZERO|
 	                                                       ^

CHECK:SPACING: space preferred before that '|' (ctx:VxE)
#104: FILE: arch/i386/mm/pgtable.c:161:
+	pte = alloc_pages(GFP_KERNEL|__GFP_HIGHMEM|__GFP_REPEAT|__GFP_ZERO|
 	                                                                  ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#108: FILE: arch/i386/mm/pgtable.c:164:
+	pte = alloc_pages(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO|
 	                            ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#108: FILE: arch/i386/mm/pgtable.c:164:
+	pte = alloc_pages(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO|
 	                                         ^

CHECK:SPACING: space preferred before that '|' (ctx:VxE)
#108: FILE: arch/i386/mm/pgtable.c:164:
+	pte = alloc_pages(GFP_KERNEL|__GFP_REPEAT|__GFP_ZERO|
 	                                                    ^

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*tty)...) over kmalloc(sizeof(struct tty_struct)...)
#120: FILE: drivers/char/tty_io.c:161:
+	tty = kmalloc(sizeof(struct tty_struct), GFP_KERNEL_UBC);

The allocation style is bad.  In general for family of
allocation functions using sizeof() to get memory size,
constructs like::

  p = alloc(sizeof(struct foo), ...)

should be::

  p = alloc(sizeof(*p), ...)

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:SPACING: No space is necessary after a cast
#167: FILE: fs/file.c:47:
+		new_fds = (struct file **) kmalloc(size, GFP_KERNEL_UBC);

WARNING:UNNECESSARY_CASTS: unnecessary cast may hide bugs, see http://c-faq.com/malloc/mallocnocast.html
#167: FILE: fs/file.c:47:
+		new_fds = (struct file **) kmalloc(size, GFP_KERNEL_UBC);

CHECK:SPACING: No space is necessary after a cast
#170: FILE: fs/file.c:49:
+		new_fds = (struct file **) vmalloc_ub(size);

CHECK:SPACING: No space is necessary after a cast
#179: FILE: fs/file.c:216:
+		new_fdset = (fd_set *) kmalloc(size, GFP_KERNEL_UBC);

WARNING:UNNECESSARY_CASTS: unnecessary cast may hide bugs, see http://c-faq.com/malloc/mallocnocast.html
#179: FILE: fs/file.c:216:
+		new_fdset = (fd_set *) kmalloc(size, GFP_KERNEL_UBC);

CHECK:SPACING: No space is necessary after a cast
#182: FILE: fs/file.c:218:
+		new_fdset = (fd_set *) vmalloc_ub(size);

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#282: FILE: include/asm-ia64/pgalloc.h:51:
+		if (charge && ub_page_charge(virt_to_page(ret),
+					0, __GFP_UBC_LIMIT)) {

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#357: FILE: include/asm-x86_64/pgalloc.h:34:
+	return (pmd_t *)get_zeroed_page(GFP_KERNEL|__GFP_REPEAT|
 	                                          ^

CHECK:SPACING: space preferred before that '|' (ctx:VxE)
#357: FILE: include/asm-x86_64/pgalloc.h:34:
+	return (pmd_t *)get_zeroed_page(GFP_KERNEL|__GFP_REPEAT|
 	                                                       ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#364: FILE: include/asm-x86_64/pgalloc.h:40:
+	return (pud_t *)get_zeroed_page(GFP_KERNEL|__GFP_REPEAT|
 	                                          ^

CHECK:SPACING: space preferred before that '|' (ctx:VxE)
#364: FILE: include/asm-x86_64/pgalloc.h:40:
+	return (pud_t *)get_zeroed_page(GFP_KERNEL|__GFP_REPEAT|
 	                                                       ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#374: FILE: include/asm-x86_64/pgalloc.h:79:
+	pgd_t *pgd = (pgd_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|
 	                                                ^

CHECK:SPACING: space preferred before that '|' (ctx:VxE)
#374: FILE: include/asm-x86_64/pgalloc.h:79:
+	pgd_t *pgd = (pgd_t *)__get_free_page(GFP_KERNEL|__GFP_REPEAT|
 	                                                             ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#384: FILE: include/asm-x86_64/pgalloc.h:111:
+	void *p = (void *)get_zeroed_page(GFP_KERNEL|__GFP_REPEAT|
 	                                            ^

CHECK:SPACING: space preferred before that '|' (ctx:VxE)
#384: FILE: include/asm-x86_64/pgalloc.h:111:
+	void *p = (void *)get_zeroed_page(GFP_KERNEL|__GFP_REPEAT|
 	                                                         ^

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:SPACING: No space is necessary after a cast
#396: FILE: include/asm-x86_64/thread_info.h:81:
+	ret = ((struct thread_info *) __get_free_pages(GFP_KERNEL_UBC,	\

WARNING:SPACE_BEFORE_TAB: please, no space before tabs
#397: FILE: include/asm-x86_64/thread_info.h:82:
+^I^I^I^ITHREAD_ORDER)); ^I^I\$

CHECK:SPACING: No space is necessary after a cast
#405: FILE: include/asm-x86_64/thread_info.h:89:
+	((struct thread_info *) __get_free_pages(GFP_KERNEL_UBC,THREAD_ORDER))

ERROR:SPACING: space required after that ',' (ctx:VxV)
#405: FILE: include/asm-x86_64/thread_info.h:89:
+	((struct thread_info *) __get_free_pages(GFP_KERNEL_UBC,THREAD_ORDER))
 	                                                       ^

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:UNNECESSARY_CASTS: unnecessary cast may hide bugs, see http://c-faq.com/malloc/mallocnocast.html
#416: FILE: ipc/msgutil.c:39:
+	msg = (struct msg_msg *)kmalloc(sizeof(*msg) + alen, GFP_KERNEL_UBC);

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:UNNECESSARY_CASTS: unnecessary cast may hide bugs, see http://c-faq.com/malloc/mallocnocast.html
#445: FILE: ipc/sem.c:1022:
+	new = (struct sem_undo *) kmalloc(sizeof(struct sem_undo) +

CHECK:ALLOC_SIZEOF_STRUCT: Prefer kmalloc(sizeof(*new)...) over kmalloc(sizeof(struct sem_undo)...)
#445: FILE: ipc/sem.c:1022:
+	new = (struct sem_undo *) kmalloc(sizeof(struct sem_undo) +

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#446: FILE: ipc/sem.c:1023:
+			sizeof(short)*nsems, GFP_KERNEL_UBC);
 			             ^

CHECK:SPACING: spaces preferred around that '*' (ctx:VxV)
#455: FILE: ipc/sem.c:1081:
+		sops = kmalloc(sizeof(*sops)*nsops,GFP_KERNEL_UBC);
 		                            ^

ERROR:SPACING: space required after that ',' (ctx:VxV)
#455: FILE: ipc/sem.c:1081:
+		sops = kmalloc(sizeof(*sops)*nsops,GFP_KERNEL_UBC);
 		                                  ^

WARNING:ALLOC_WITH_MULTIPLY: Prefer kmalloc_array over kmalloc with multiply
#455: FILE: ipc/sem.c:1081:
+		sops = kmalloc(sizeof(*sops)*nsops,GFP_KERNEL_UBC);

Prefer kmalloc_array/kcalloc over kmalloc/kzalloc with a
sizeof multiply.

See: https://www.kernel.org/doc/html/latest/core-api/memory-allocation.html

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:LINE_CONTINUATIONS: Avoid unnecessary line continuations
#506: FILE: kernel/fork.c:1428:
+			SLAB_HWCACHE_ALIGN | SLAB_PANIC | \

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#512: FILE: kernel/fork.c:1433:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                  ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#512: FILE: kernel/fork.c:1433:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                             ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#516: FILE: kernel/fork.c:1436:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                  ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#516: FILE: kernel/fork.c:1436:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                             ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#520: FILE: kernel/fork.c:1439:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                  ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#520: FILE: kernel/fork.c:1439:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                             ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#524: FILE: kernel/fork.c:1442:
+			SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			          ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#528: FILE: kernel/fork.c:1445:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                  ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#528: FILE: kernel/fork.c:1445:
+			SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                             ^

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:SPACING: space prohibited between function name and open parenthesis '('
#539: FILE: kernel/posix-timers.c:245:
+					sizeof (struct k_itimer), 0, SLAB_UBC,

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#560: FILE: kernel/user.c:200:
+			0, SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                     ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#560: FILE: kernel/user.c:200:
+			0, SLAB_HWCACHE_ALIGN|SLAB_PANIC|SLAB_UBC, NULL, NULL);
 			                                ^

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#571: FILE: mm/rmap.c:182:
+			0, SLAB_DESTROY_BY_RCU|SLAB_PANIC|SLAB_UBC,
 			                      ^

CHECK:SPACING: spaces preferred around that '|' (ctx:VxV)
#571: FILE: mm/rmap.c:182:
+			0, SLAB_DESTROY_BY_RCU|SLAB_PANIC|SLAB_UBC,
 			                                 ^

WARNING:PATCH_PREFIX: patch prefix '.' exists, appears to be a -p0 patch

WARNING:LINE_CONTINUATIONS: Avoid unnecessary line continuations
#583: FILE: mm/shmem.c:370:
+		page = shmem_dir_alloc(mapping_gfp_mask(inode->i_mapping) | \

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.47258.commit.32446c5db64250b18fe2c2cbe5f6cad190fa78cb total: 2 errors, 33 warnings, 41 checks, 440 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.47258.commit.32446c5db64250b18fe2c2cbe5f6cad190fa78cb has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
