WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#48: FILE: include/linux/ltt-facilities.h:1:
+/*

The source file is missing or has an improper SPDX identifier tag.
The Linux kernel requires the precise SPDX identifier in all source files,
and it is thoroughly documented in the kernel docs.

See: https://www.kernel.org/doc/html/latest/process/license-rules.html

WARNING:EMBEDDED_FILENAME: It's generally not useful to have the filename in the file
#49: FILE: include/linux/ltt-facilities.h:2:
+ * linux/include/linux/ltt-facilities.h

Embedding the complete filename path inside the file isn't particularly
useful as often the path is moved around and becomes incorrect.

WARNING:INCLUDE_LINUX: Use #include <linux/atomic.h> instead of <asm/atomic.h>
#69: FILE: include/linux/ltt-facilities.h:22:
+#include <asm/atomic.h>

WARNING:NEW_TYPEDEFS: do not add new typedefs
#95: FILE: include/linux/ltt-facilities.h:48:
+typedef unsigned long ltt_facility_t;

CHECK:LINE_SPACING: Please don't use multiple blank lines
#128: FILE: include/linux/ltt-facilities.h:81:
+
+

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#130: FILE: include/linux/ltt-facilities.h:83:
+int ltt_facility_register(enum ltt_facility_type type,
+		const char *name,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#140: FILE: include/linux/ltt-facilities.h:93:
+int ltt_facility_verify(enum ltt_facility_type type,
+		const char *name,

WARNING:SPDX_LICENSE_TAG: Missing or malformed SPDX-License-Identifier tag in line 1
#164: FILE: ltt/ltt-facilities.c:1:
+/*

ERROR:TRAILING_WHITESPACE: trailing whitespace
#177: FILE: ltt/ltt-facilities.c:14:
+ * $

Trailing whitespace should always be removed.
Some editors highlight the trailing whitespace and cause visual
distractions when editing files.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#197: FILE: ltt/ltt-facilities.c:34:
+ * User ltt_facility_verify for this. */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#199: FILE: ltt/ltt-facilities.c:36:
+int ltt_facility_register(enum ltt_facility_type type,
+		const char *name,

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#210: FILE: ltt/ltt-facilities.c:47:
+	int found=0;
 	         ^

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#211: FILE: ltt/ltt-facilities.c:48:
+  $

WARNING:LEADING_SPACE: please, no spaces at the start of a line
#211: FILE: ltt/ltt-facilities.c:48:
+  $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#214: FILE: ltt/ltt-facilities.c:51:
+	if (type == LTT_FACILITY_TYPE_KERNEL &&
+			strncmp(name, "core", sizeof("core")) == 0) {

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#218: FILE: ltt/ltt-facilities.c:55:
+		 * find an empty slot */

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#219: FILE: ltt/ltt-facilities.c:56:
+		chk_fac_id = fac_id = checksum % LTT_MAX_NUM_FACILITIES;

Multiple assignments on a single line makes the code unnecessarily
complicated. So on a single line assign value to a single variable
only, this makes the code more readable and helps avoid typos.

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#225: FILE: ltt/ltt-facilities.c:62:
+			fac_id = (fac_id+1) % LTT_MAX_NUM_FACILITIES;
 			                ^

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#233: FILE: ltt/ltt-facilities.c:70:
+	switch (type) {
+		case LTT_FACILITY_TYPE_USER:
[...]
+		case LTT_FACILITY_TYPE_KERNEL:

switch should be at the same indent as case.
Example::

  switch (suffix) {
  case 'G':
  case 'g':
          mem <<= 30;
          break;
  case 'M':
  case 'm':
          mem <<= 20;
          break;
  case 'K':
  case 'k':
          mem <<= 10;
          fallthrough;
  default:
          break;
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#235: FILE: ltt/ltt-facilities.c:72:
+			if (strncmp(name, "user_", sizeof("user_")-1) != 0) {
 			                                          ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#243: FILE: ltt/ltt-facilities.c:80:
+	strncpy(facilities[fac_id].name, name, FACNAME_LEN-1);
 	                                                  ^

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#244: FILE: ltt/ltt-facilities.c:81:
+	facilities[fac_id].name[FACNAME_LEN-1] = '\0';
 	                                   ^

CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#256: FILE: ltt/ltt-facilities.c:93:
+		trace_core_facility_load(

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#276: FILE: ltt/ltt-facilities.c:113:
+ * If the facility is already registered, increment its refcount. */

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#278: FILE: ltt/ltt-facilities.c:115:
+int ltt_facility_verify(enum ltt_facility_type type,
+		const char *name,

ERROR:SPACING: spaces required around that '=' (ctx:VxV)
#289: FILE: ltt/ltt-facilities.c:126:
+	int found=0;
 	         ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#290: FILE: ltt/ltt-facilities.c:127:
+^I$

ERROR:TRAILING_WHITESPACE: trailing whitespace
#292: FILE: ltt/ltt-facilities.c:129:
+^Iif (type == LTT_FACILITY_TYPE_KERNEL && $

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#293: FILE: ltt/ltt-facilities.c:130:
+	if (type == LTT_FACILITY_TYPE_KERNEL && 
+			strncmp(name, "core", sizeof("core")) == 0) {

ERROR:SWITCH_CASE_INDENT_LEVEL: switch and case should be at the same indent
#297: FILE: ltt/ltt-facilities.c:134:
+		switch (type) {
+			case LTT_FACILITY_TYPE_USER:
[...]
+			case LTT_FACILITY_TYPE_KERNEL:

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#300: FILE: ltt/ltt-facilities.c:137:
+				if (strncmp(name,
+					"user_", sizeof("user_")-1) != 0) {

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#300: FILE: ltt/ltt-facilities.c:137:
+					"user_", sizeof("user_")-1) != 0) {
 					                        ^

CHECK:MULTIPLE_ASSIGNMENTS: multiple assignments should be avoided
#309: FILE: ltt/ltt-facilities.c:146:
+		chk_fac_id = fac_id = checksum % LTT_MAX_NUM_FACILITIES;

CHECK:LOGICAL_CONTINUATIONS: Logical continuations should be on the previous line
#314: FILE: ltt/ltt-facilities.c:151:
+				if ((atomic_read(&facilities[fac_id].ref) > 0)
+				&& strncmp(facilities[fac_id].name,

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#315: FILE: ltt/ltt-facilities.c:152:
+						name, FACNAME_LEN-1) == 0 &&
 						                 ^

CHECK:SPACING: spaces preferred around that '+' (ctx:VxV)
#329: FILE: ltt/ltt-facilities.c:166:
+			fac_id = (fac_id+1) % LTT_MAX_NUM_FACILITIES;
 			                ^

ERROR:TRAILING_WHITESPACE: trailing whitespace
#331: FILE: ltt/ltt-facilities.c:168:
+^I^I$

CHECK:LINE_SPACING: Please don't use multiple blank lines
#343: FILE: ltt/ltt-facilities.c:180:
+
+

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#348: FILE: ltt/ltt-facilities.c:185:
+	alignment = sizeof(void*);

When using pointer data or a function that returns a pointer type,
the preferred use of * is adjacent to the data name or function name
and not adjacent to the type name.
Examples::

  char *linux_banner;
  unsigned long long memparse(char *ptr, char **retptr);
  char *match_strdup(substring_t *s);

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#355: FILE: ltt/ltt-facilities.c:192:
+			sizeof(int), sizeof(long), sizeof(void*),

ERROR:TRAILING_WHITESPACE: trailing whitespace
#371: FILE: ltt/ltt-facilities.c:208:
+^I$

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#377: FILE: ltt/ltt-facilities.c:214:
+	printk(KERN_DEBUG "LTT unregister facility %lu\n", facility_id);

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#381: FILE: ltt/ltt-facilities.c:218:
+	 * RCU coherent. */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#388: FILE: ltt/ltt-facilities.c:225:
+	 * ltt_facility_free_unused()). */

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#402: FILE: ltt/ltt-facilities.c:239:
+	 * FIXME : this unload could go away. */

ERROR:TRAILING_WHITESPACE: trailing whitespace
#427: FILE: ltt/ltt-facilities.c:264:
+^I$

ERROR:POINTER_LOCATION: "(foo*)" should be "(foo *)"
#443: FILE: ltt/ltt-facilities.c:280:
+	pointer_size = sizeof(void*);

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_dbg([subsystem]dev, ... then dev_dbg(dev, ... then pr_debug(...  to printk(KERN_DEBUG ...
#450: FILE: ltt/ltt-facilities.c:287:
+			printk(KERN_DEBUG "Dumping facility %s\n",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#451: FILE: ltt/ltt-facilities.c:288:
+			printk(KERN_DEBUG "Dumping facility %s\n",
+					facility->name);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#453: FILE: ltt/ltt-facilities.c:290:
+			trace_core_state_dump_facility_load(trace,
+					facility->name,

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#466: FILE: ltt/ltt-facilities.c:303:
+EXPORT_SYMBOL(ltt_facility_kernel_register);

EXPORT_SYMBOL should immediately follow the symbol to be exported.

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#467: FILE: ltt/ltt-facilities.c:304:
+EXPORT_SYMBOL(ltt_facility_ref);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#468: FILE: ltt/ltt-facilities.c:305:
+EXPORT_SYMBOL(ltt_facility_unregister);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#469: FILE: ltt/ltt-facilities.c:306:
+EXPORT_SYMBOL(ltt_facility_free_unused);

WARNING:EXPORT_SYMBOL: EXPORT_SYMBOL(foo); should immediately follow its function/variable
#470: FILE: ltt/ltt-facilities.c:307:
+EXPORT_SYMBOL(ltt_facility_state_dump);

WARNING:LINE_SPACING: Missing a blank line after declarations
#475: FILE: ltt/ltt-facilities.c:312:
+	int i;
+	printk(KERN_INFO "LTT : ltt-facilities init\n");

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_info([subsystem]dev, ... then dev_info(dev, ... then pr_info(...  to printk(KERN_INFO ...
#475: FILE: ltt/ltt-facilities.c:312:
+	printk(KERN_INFO "LTT : ltt-facilities init\n");

WARNING:BRACES: braces {} are not necessary for single statement blocks
#478: FILE: ltt/ltt-facilities.c:315:
+	for (i = 0; i < LTT_MAX_NUM_FACILITIES; i++) {
+		atomic_set(&facilities[i].ref, 0);
+	}

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

ERROR:TRAILING_WHITESPACE: trailing whitespace
#481: FILE: ltt/ltt-facilities.c:318:
+^I$

WARNING:USE_DEVICE_INITCALL: please use device_initcall() or more appropriate function instead of __initcall() (see include/linux/init.h)
#484: FILE: ltt/ltt-facilities.c:321:
+__initcall(ltt_facilities_init);

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.15326.commit.27bca404e1949e438ef99acdffc83cd0d848593b total: 15 errors, 23 warnings, 22 checks, 435 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.15326.commit.27bca404e1949e438ef99acdffc83cd0d848593b has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
