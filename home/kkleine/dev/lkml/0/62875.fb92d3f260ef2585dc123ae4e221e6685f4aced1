CHECK:OPEN_ENDED_LINE: Lines should not end with a '('
#216: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1351:
+		pd->port_rcvhdrtail_kvaddr = dma_alloc_coherent(

WARNING:OOM_MESSAGE: Possible unnecessary 'out of memory' message
#219: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1354:
+		if (!pd->port_rcvhdrtail_kvaddr) {
+			ipath_dev_err(dd, "attempt to allocate 1 page "

WARNING:SPLIT_STRING: quoted string split across lines
#220: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1355:
+			ipath_dev_err(dd, "attempt to allocate 1 page "
+				      "for port %u rcvhdrqtailaddr failed\n",

Quoted strings that appear as messages in userspace and can be
grepped, should not be split across multiple lines.

See: https://lore.kernel.org/lkml/20120203052727.GA15035@leaf/

CHECK:SPACING: No space is necessary after a cast
#243: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1373:
+			   (unsigned long long) phys_hdrqtail);

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

ERROR:ELSE_AFTER_BRACE: else should follow close brace '}'
#245: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1375:
+	}
+	else

`else {` should follow the closing block `}` on the same line.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:BLOCK_COMMENT_STYLE: Block comments use a trailing */ on a separate line
#287: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1491:
+	 * they don't block SMA and other MAD packets */

The comment style is incorrect.  The preferred style for multi-
line comments is::

  /*
  * This is the preferred style
  * for multi line comments.
  */

The networking comment style is a bit different, with the first line
not empty like the former::

  /* This is the preferred comment style
  * for files in net/ and drivers/net/
  */

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#commenting

ERROR:CODE_INDENT: code indent should use tabs where possible
#292: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1496:
+^I^I                    (unsigned)(dd->ipath_piobcnt2k +$

Code indent should use tabs instead of spaces.
Outside of comments, documentation and Kconfig,
spaces are never used for indentation.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#indentation

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#292: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1496:
+		ipath_disarm_piobufs(dd, dd->ipath_lastport_piobuf,
+		                    (unsigned)(dd->ipath_piobcnt2k +

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#292: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1496:
+		                    (unsigned)(dd->ipath_piobcnt2k +

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#370: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1670:
+			dma_free_coherent(&dd->pcidev->dev, PAGE_SIZE,
+					 (void *)pd->port_rcvhdrtail_kvaddr,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#376: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1676:
+		unsigned e;

WARNING:SPLIT_STRING: quoted string split across lines
#383: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1683:
+			ipath_cdbg(VERBOSE, "egrbuf free(%p, %lu), "
+				   "chunk %u/%u\n", base,

CHECK:SPACING: No space is necessary after a cast
#384: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1684:
+				   (unsigned long) size,

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#387: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1687:
+			dma_free_coherent(&dd->pcidev->dev, size,
+				base, pd->port_rcvegrbuf_phys[e]);

WARNING:LINE_SPACING: Missing a blank line after declarations
#425: FILE: drivers/infiniband/hw/ipath/ipath_driver.c:1837:
+		struct ipath_portdata *pd = dd->ipath_pd[port];
+		dd->ipath_pd[port] = NULL;

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:BRACES: Blank lines aren't necessary before a close brace '}'
#452: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:794:
 
+	}

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#548: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:863:
+	ipath_cdbg(VERBOSE, "Wrote port%d egrhead %x from tail regs\n",
+		pd->port_port, head32);

WARNING:TYPO_SPELLING: 'explictly' may be misspelled - perhaps 'explicitly'?
#556: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:872:
+	 * We explictly set the in-memory copy to 0 beforehand, so we don't
 	      ^^^^^^^^^

Some words may have been misspelled.  Consider reviewing them.

CHECK:LINE_SPACING: Please don't use multiple blank lines
#571: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:886:
+
+

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#574: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:889:
+static int ipath_mmap_mem(struct vm_area_struct *vma,
+			     struct ipath_portdata *pd, unsigned len,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#574: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:889:
+			     struct ipath_portdata *pd, unsigned len,

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#578: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:893:
+	unsigned pfn = (unsigned long)addr >> PAGE_SHIFT;

ERROR:CODE_INDENT: code indent should use tabs where possible
#583: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:898:
+^I^I         "FAIL on %s: len %lx > %x\n", what,$

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#607: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:922:
+			 write_ok?'w':'o', ret);
 			         ^

CHECK:SPACING: spaces required around that ':' (ctx:VxV)
#607: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:922:
+			 write_ok?'w':'o', ret);
 			             ^

WARNING:TYPO_SPELLING: 'mmaped' may be misspelled - perhaps 'mapped'?
#609: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:924:
+		ipath_cdbg(VERBOSE, "%s port%u mmaped %lx, %x bytes r%c\n",
 		                               ^^^^^^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#610: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:925:
+		ipath_cdbg(VERBOSE, "%s port%u mmaped %lx, %x bytes r%c\n",
+			what, pd->port_port, (unsigned long)addr, len,

CHECK:SPACING: spaces required around that '?' (ctx:VxV)
#611: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:926:
+			 write_ok?'w':'o');
 			         ^

CHECK:SPACING: spaces required around that ':' (ctx:VxV)
#611: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:926:
+			 write_ok?'w':'o');
 			             ^

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#797: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1085:
+	if (!pgaddr || pgaddr >= (1ULL<<40))  {
 	                              ^

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#799: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1087:
+		ipath_dev_err(dd, "Bad phys addr %llx, start %lx, end %lx\n",
+			(unsigned long long)pgaddr, vma->vm_start, vma->vm_end);

CHECK:SPACING: spaces preferred around that '-' (ctx:VxV)
#815: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1098:
+	if (vma->vm_start & (PAGE_SIZE-1)) {
 	                              ^

CHECK:BRACES: braces {} should be used on all arms of this statement
#815: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1098:
+	if (vma->vm_start & (PAGE_SIZE-1)) {
[...]
+	else if (pgaddr == ureg)
[...]
 	else if (pgaddr == pd->port_piobufs)
[...]
 	else if (pgaddr == (u64) pd->port_rcvegr_phys)
[...]
-	else if (pgaddr == (u64) pd->port_rcvhdrq_phys)
[...]
+				     "rcvhdrq");
[...]
+				     pd->port_rcvhdrqtailaddr_phys,
[...]
+		ret = ipath_mmap_mem(vma, pd, PAGE_SIZE, 0,
[...]

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#817: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1100:
+		ipath_dev_err(dd,
+			"vm_start not aligned: %lx, end=%lx phys %lx\n",

ERROR:ELSE_AFTER_BRACE: else should follow close brace '}'
#821: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1104:
+	}
+	else if (pgaddr == ureg)

CHECK:SPACING: No space is necessary after a cast
#829: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1110:
+	else if (pgaddr == (u64) pd->port_rcvhdrq_phys) {

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#835: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1116:
+		unsigned total_size =

ERROR:ELSE_AFTER_BRACE: else should follow close brace '}'
#842: FILE: drivers/infiniband/hw/ipath/ipath_file_ops.c:1123:
+	}
+	else if (pgaddr == (u64)pd->port_rcvhdrqtailaddr_phys)

WARNING:LINE_SPACING: Missing a blank line after declarations
#953: FILE: drivers/infiniband/hw/ipath/ipath_init_chip.c:823:
+		struct ipath_portdata *pd = dd->ipath_pd[0];
+		dd->ipath_pd[0] = NULL;

WARNING:VOLATILE: Use of volatile is usually wrong: see Documentation/process/volatile-considered-harmful.rst
#961: FILE: drivers/infiniband/hw/ipath/ipath_init_chip.c:830:
+			(volatile __le64 *)pd->port_rcvhdrtail_kvaddr;

CHECK:SPACING: No space is necessary after a cast
#1025: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:128:
+			  "ACTIVE\n", (unsigned long long) errs);

WARNING:SPLIT_STRING: quoted string split across lines
#1025: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:128:
+		ipath_dbg("Ignoring packet errors %llx, because link not "
+			  "ACTIVE\n", (unsigned long long) errs);

CHECK:LOGICAL_CONTINUATIONS: Logical continuations should be on the previous line
#1042: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:177:
+	if ((lstate != IPATH_IBSTATE_ARM && lstate != IPATH_IBSTATE_ACTIVE)
+		&& (dd->ipath_flags & (IPATH_LINKARMED | IPATH_LINKACTIVE))) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1044: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:179:
+		dev_info(&dd->pcidev->dev, "Link state changed from %s to %s\n",
+				 (dd->ipath_flags & IPATH_LINKARMED) ? "ARM" : "ACTIVE",

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1053: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:188:
+		ipath_disarm_piobufs(dd, dd->ipath_lastport_piobuf,
+							(unsigned)(dd->ipath_piobcnt2k +

WARNING:UNSPECIFIED_INT: Prefer 'unsigned int' to bare use of 'unsigned'
#1053: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:188:
+							(unsigned)(dd->ipath_piobcnt2k +

ERROR:ELSE_AFTER_BRACE: else should follow close brace '}'
#1057: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:192:
+	}
+	else if (lstate == IPATH_IBSTATE_INIT || lstate == IPATH_IBSTATE_ARM ||

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1058: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:193:
+	else if (lstate == IPATH_IBSTATE_INIT || lstate == IPATH_IBSTATE_ARM ||
 	    lstate == IPATH_IBSTATE_ACTIVE) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#1066: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:416:
+	else if ((errs & E_SUM_LINK_PKTERRS) &&
+	    !(dd->ipath_flags & IPATH_LINKACTIVE)) {

CHECK:SPACING: No space is necessary after a cast
#1075: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:425:
+			  "ACTIVE\n", (unsigned long long) errs);

WARNING:SPLIT_STRING: quoted string split across lines
#1075: FILE: drivers/infiniband/hw/ipath/ipath_intr.c:425:
+		ipath_dbg("Ignoring packet errors %llx, because link not "
+			  "ACTIVE\n", (unsigned long long) errs);

WARNING:VOLATILE: Use of volatile is usually wrong: see Documentation/process/volatile-considered-harmful.rst
#1091: FILE: drivers/infiniband/hw/ipath/ipath_kernel.h:65:
+	volatile __le64 *port_rcvhdrtail_kvaddr;

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct ipath_devdata *' should also have an identifier name
#1125: FILE: drivers/infiniband/hw/ipath/ipath_kernel.h:571:
+void ipath_free_pddata(struct ipath_devdata *, struct ipath_portdata *);

This warning is emitted due to any of the following reasons:

  1. Arguments for the function declaration do not follow
     the identifier name.  Example::

       void foo
       (int bar, int baz)

     This should be corrected to::

       void foo(int bar, int baz)

  2. Some arguments for the function definition do not
     have an identifier name.  Example::

       void foo(int)

     All arguments should have identifier names.

WARNING:FUNCTION_ARGUMENTS: function definition argument 'struct ipath_portdata *' should also have an identifier name
#1125: FILE: drivers/infiniband/hw/ipath/ipath_kernel.h:571:
+void ipath_free_pddata(struct ipath_devdata *, struct ipath_portdata *);

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.62875.commit.fb92d3f260ef2585dc123ae4e221e6685f4aced1 total: 6 errors, 20 warnings, 28 checks, 1022 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

NOTE: Whitespace errors detected.
      You may wish to use scripts/cleanpatch or scripts/cleanfile

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.62875.commit.fb92d3f260ef2585dc123ae4e221e6685f4aced1 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
