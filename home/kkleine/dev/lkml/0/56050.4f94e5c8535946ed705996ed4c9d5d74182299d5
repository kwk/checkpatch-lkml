CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#242: FILE: drivers/scsi/stex.c:403:
+static void stex_internal_copy(struct scsi_cmnd *cmd,
+	const void *src, size_t *count, int sg_count)

WARNING:LINE_SPACING: Missing a blank line after declarations
#250: FILE: drivers/scsi/stex.c:408:
+	void *s, *d, *base = NULL;
+	if (*count > cmd->request_bufflen)

Vertical space is wasted given the limited number of lines an
editor window can display when multiple blank lines are used.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:BRACES: braces {} should be used on all arms of this statement
#256: FILE: drivers/scsi/stex.c:414:
+		if (cmd->use_sg) {
[...]
+		} else
[...]

The placement of braces is stylistically incorrect.
The preferred way is to put the opening brace last on the line,
and put the closing brace first::

  if (x is true) {
          we do y
  }

This applies for all non-functional blocks.
However, there is one special case, namely functions: they have the
opening brace at the beginning of the next line, thus::

  int function(int x)
  {
          body of function
  }

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#placing-braces-and-spaces

WARNING:LINE_SPACING: Missing a blank line after declarations
#258: FILE: drivers/scsi/stex.c:416:
+			size_t offset = *count - lcount;
+			s += offset;

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#260: FILE: drivers/scsi/stex.c:418:
+			base = scsi_kmap_atomic_sg(cmd->request_buffer,
+				sg_count, &offset, &len);

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!base"
#261: FILE: drivers/scsi/stex.c:419:
+			if (base == NULL) {

Comparisons to NULL in the form (foo == NULL) or (foo != NULL)
are better written as (!foo) and (foo).

CHECK:BRACES: Unbalanced braces around else statement
#266: FILE: drivers/scsi/stex.c:424:
+		} else

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#278: FILE: drivers/scsi/stex.c:436:
+static int stex_direct_copy(struct scsi_cmnd *cmd,
+	const void *src, size_t count)

CHECK:SPACING: No space is necessary after a cast
#280: FILE: drivers/scsi/stex.c:438:
+	struct st_hba *hba = (struct st_hba *) &cmd->device->host->hostdata[0];

Whitespace style used in the kernel sources is described in kernel docs.

See: https://www.kernel.org/doc/html/latest/process/coding-style.html#spaces

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#291: FILE: drivers/scsi/stex.c:444:
+		n_elem = pci_map_sg(hba->pdev, cmd->request_buffer,
+			cmd->use_sg, cmd->sc_data_direction);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#303: FILE: drivers/scsi/stex.c:453:
+		pci_unmap_sg(hba->pdev, cmd->request_buffer,
+			cmd->use_sg, cmd->sc_data_direction);

ERROR:SPACING: space prohibited after that '*' (ctx:BxW)
#338: FILE: drivers/scsi/stex.c:508:
+stex_queuecommand(struct scsi_cmnd *cmd, void (* done)(struct scsi_cmnd *))
                                                ^

ERROR:SPACING: space required before the open parenthesis '('
#359: FILE: drivers/scsi/stex.c:533:
+		if(lun == 0 && (cmd->cmnd[1] & INQUIRY_EVPD) == 0) {

CHECK:BRACES: braces {} should be used on all arms of this statement
#359: FILE: drivers/scsi/stex.c:533:
+		if(lun == 0 && (cmd->cmnd[1] & INQUIRY_EVPD) == 0) {
[...]
 		} else
[...]

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#361: FILE: drivers/scsi/stex.c:535:
+			stex_direct_copy(cmd, console_inq_page,
 				sizeof(console_inq_page));

WARNING:LINE_SPACING: Missing a blank line after declarations
#454: FILE: drivers/scsi/stex.c:644:
+	size_t count = variable;
+	if (resp->scsi_status != SAM_STAT_GOOD) {

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!ccb->cmd"
#461: FILE: drivers/scsi/stex.c:651:
+	if (ccb->cmd == NULL)

CHECK:COMPARISON_TO_NULL: Comparison to NULL could be written "!hba->wait_ccb"
#491: FILE: drivers/scsi/stex.c:871:
+	if (hba->wait_ccb == NULL) {

WARNING:PREFER_PR_LEVEL: Prefer [subsystem eg: netdev]_warn([subsystem]dev, ... then dev_warn(dev, ... then pr_warn(...  to printk(KERN_WARNING ...
#492: FILE: drivers/scsi/stex.c:872:
+		printk(KERN_WARNING DRV_NAME

WARNING:LINE_SPACING: Missing a blank line after declarations
#505: FILE: drivers/scsi/stex.c:891:
+	u8 control;
+	for (i = 0; i < 16; i++)

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#507: FILE: drivers/scsi/stex.c:893:
+		pci_read_config_dword(hba->pdev, i * 4,
+			&hba->pdev->saved_config_space[i]);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#511: FILE: drivers/scsi/stex.c:897:
+		pci_write_config_dword(hba->pdev, 4,
+			hba->pdev->saved_config_space[1] & 0xfffffff9);

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#515: FILE: drivers/scsi/stex.c:901:
+		control |= (1<<6);
 		             ^

WARNING:MSLEEP: msleep < 20ms can sleep for up to 20ms; see Documentation/timers/timers-howto.rst
#517: FILE: drivers/scsi/stex.c:903:
+		msleep(1);

CHECK:SPACING: spaces preferred around that '<<' (ctx:VxV)
#518: FILE: drivers/scsi/stex.c:904:
+		control &= ~(1<<6);
 		              ^

WARNING:MSLEEP: msleep < 20ms can sleep for up to 20ms; see Documentation/timers/timers-howto.rst
#526: FILE: drivers/scsi/stex.c:912:
+		msleep(1);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#532: FILE: drivers/scsi/stex.c:918:
+		pci_write_config_dword(hba->pdev, i * 4,
+			hba->pdev->saved_config_space[i]);

CHECK:LOGICAL_CONTINUATIONS: Logical continuations should be on the previous line
#613: FILE: drivers/scsi/stex.c:1042:
 	if (!pci_set_dma_mask(pdev, DMA_64BIT_MASK)
+		&& !pci_set_consistent_dma_mask(pdev, DMA_64BIT_MASK))

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#625: FILE: drivers/scsi/stex.c:1099:
+	hba->dma_mem = pci_alloc_consistent(pdev,
+		STEX_BUFFER_SIZE, &hba->dma_handle);

CHECK:SPACING: No space is necessary after a cast
#640: FILE: drivers/scsi/stex.c:1112:
+	hba->cardtype = (unsigned int) id->driver_data;

WARNING:LINE_SPACING: Missing a blank line after declarations
#644: FILE: drivers/scsi/stex.c:1116:
+		u8 atu_bus;
+		while ((bus0 = pci_get_device(0x8086, 0x0370, bus0)) != NULL) {

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#678: FILE: drivers/scsi/stex.c:1164:
+	pci_free_consistent(pdev, STEX_BUFFER_SIZE,
 		hba->dma_mem, hba->dma_handle);

CHECK:PARENTHESIS_ALIGNMENT: Alignment should match open parenthesis
#687: FILE: drivers/scsi/stex.c:1215:
+	pci_free_consistent(hba->pdev, STEX_BUFFER_SIZE,
 			hba->dma_mem, hba->dma_handle);

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.56050.commit.4f94e5c8535946ed705996ed4c9d5d74182299d5 total: 2 errors, 8 warnings, 23 checks, 599 lines checked

NOTE: For some of the reported defects, checkpatch may be able to
      mechanically convert to the typical style using --fix or --fix-inplace.

/tmp/tmp.gGZ8aIRHtl//home/kkleine/dev/lkml/0/patch.offset.56050.commit.4f94e5c8535946ed705996ed4c9d5d74182299d5 has style problems, please review.

NOTE: If any of the errors are false positives, please report
      them to the maintainer, see CHECKPATCH in MAINTAINERS.
